{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/TerrainDepthTest.glsl.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{ReadDepth as e}from\"../output/ReadDepth.glsl.js\";import{If as r,glsl as t}from\"../../shaderModules/glsl.js\";import{Texture2DBindUniform as o}from\"../../shaderModules/Texture2DBindUniform.js\";function i(i,{occlusionPass:d,terrainDepthTest:a,cullAboveTerrain:n}){const{vertex:s,fragment:p,varyings:h}=i;if(!a)return s.code.add(\"void forwardViewPosDepth(vec3 pos) {}\"),void p.code.add(`${d?\"bool\":\"void\"} discardByTerrainDepth() { ${r(d,\"return false;\")}}`);h.add(\"viewPosDepth\",\"float\",{invariant:!0}),s.code.add(\"void forwardViewPosDepth(vec3 pos) {\\n    viewPosDepth = pos.z;\\n  }\"),p.include(e),p.uniforms.add(new o(\"terrainDepthTexture\",e=>e.terrainDepth?.attachment)).code.add(t`\n    ${d?\"bool\":\"void\"} discardByTerrainDepth() {\n      float depth = texelFetch(terrainDepthTexture, ivec2(gl_FragCoord.xy), 0).r;\n      float linearDepth = linearizeDepth(depth);\n      ${d?\"return viewPosDepth < linearDepth && depth < 1.0;\":`if(viewPosDepth ${n?\">\":\"<=\"} linearDepth) discard;`}\n    }`)}export{i as terrainDepthTest};\n"],
  "mappings": ";;;;;;;;;;;;AAIsM,SAAS,EAAEA,IAAE,EAAC,eAAc,GAAE,kBAAiBC,IAAE,kBAAiBC,GAAC,GAAE;AAAC,QAAK,EAAC,QAAO,GAAE,UAAS,GAAE,UAAS,EAAC,IAAEF;AAAE,MAAG,CAACC,GAAE,QAAO,EAAE,KAAK,IAAI,uCAAuC,GAAE,KAAK,EAAE,KAAK,IAAI,GAAG,IAAE,SAAO,MAAM,8BAA8B,EAAE,GAAE,eAAe,CAAC,GAAG;AAAE,IAAE,IAAI,gBAAe,SAAQ,EAAC,WAAU,KAAE,CAAC,GAAE,EAAE,KAAK,IAAI,sEAAsE,GAAE,EAAE,QAAQ,CAAC,GAAE,EAAE,SAAS,IAAI,IAAI,EAAE,uBAAsB,CAAAE,OAAGA,GAAE,cAAc,UAAU,CAAC,EAAE,KAAK,IAAI;AAAA,MACzqB,IAAE,SAAO,MAAM;AAAA;AAAA;AAAA,QAGb,IAAE,sDAAoD,mBAAmBD,KAAE,MAAI,IAAI,wBAAwB;AAAA,MAC7G;AAAC;",
  "names": ["i", "a", "n", "e"]
}
