{
  "version": 3,
  "sources": ["../../@arcgis/core/symbols/support/utils.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport e from\"../../Color.js\";import{forEach as t}from\"../../core/asyncUtils.js\";import\"../../core/has.js\";import{px2pt as r}from\"../../core/screenUtils.js\";import{ONES as o}from\"../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{effectFunctionsFromJSON as n}from\"../../layers/effects/jsonUtils.js\";import{applyCIMSymbolRotation as l,getCIMSymbolColor as i}from\"./cimSymbolUtils.js\";import{getStroke as c}from\"./gfxUtils.js\";import{Symbol3DMaterial as s}from\"./Symbol3DMaterial.js\";import{isSymbol3D as u,isSymbol2D as a}from\"./typeUtils.js\";function f(e){const t=e.symbolLayers?.at(-1);if(t&&\"outline\"in t)return t?.outline?.size}function m(e){if(!e)return 0;if(u(e)){const t=f(e);return null!=t?t:0}return r(c(e)?.width)}function y(e){const t=e.symbolLayers?.at(-1);if(t&&\"outline\"in t)return t?.outline?.color}function p(t){if(!t)return null;if(u(t))return y(t);const r=c(t)?.color;return r?new e(r):null}function h(e){if(null==e||!(\"symbolLayers\"in e)||null==e.symbolLayers)return!1;switch(e.type){case\"point-3d\":return e.symbolLayers.some(e=>\"object\"===e.type);case\"line-3d\":return e.symbolLayers.some(e=>\"path\"===e.type);case\"polygon-3d\":return e.symbolLayers.some(e=>\"object\"===e.type||\"extrude\"===e.type);default:return!1}}function d(e){return e.resource?.href??\"\"}function b(t,r){if(!t)return null;let o=null;return u(t)?o=w(t):a(t)&&(o=\"cim\"===t.type?i(t):t.color?new e(t.color):null),o?k(o,r):null}function w(t){const r=t.symbolLayers;if(!r)return null;let o=null;return r.forEach(e=>{\"object\"===e.type&&e.resource?.href||(o=\"water\"===e.type?e.color:e.material?e.material.color:null)}),o?new e(o):null}function k(t,r){if(null==r||null==t)return t;const o=t.toRgba();return o[3]=o[3]*r,new e(o)}function j(t,r,o){const n=t.symbolLayers;if(!n)return;const l=(t,n=!1)=>{let l=r??t??null;return null!=o?.override&&(!l&&n&&(l=new e([255,255,255])),l&&(l.a=o.override)),k(l,o?.add)};n.forEach(e=>{if(\"water\"===e.type)return void(e.color=k(e.color,o?.add));const t=null!=e.material?e.material.color:null,r=l(t,\"icon\"===e.type&&null!=e.resource?.href);null==e.material?e.material=new s({color:r}):e.material.color=r,\"outline\"in e&&e.outline?.color&&null!=o?.add&&(e.outline.color=k(e.outline.color,o.add)),\"marker\"in e&&null!=e.marker&&(e.marker.color=l(e.marker.color))})}function g(e,t,r){t=t??e.color,null!=r?.override&&t&&(t.a=r.override),t&&(e.color=k(t,r?.add)),\"outline\"in e&&e.outline?.color&&(e.outline.color=k(e.outline.color,r?.add))}function L(t,r,o){t&&(r||null!=o)&&(r&&(r=new e(r)),u(t)?j(t,r,o):a(t)&&g(t,r,o))}async function v(e,r){const o=e.symbolLayers;o&&await t(o,async e=>z(e,r))}async function z(e,t){switch(e.type){case\"extrude\":U(e,t);break;case\"icon\":case\"line\":case\"text\":x(e,t);break;case\"path\":O(e,t);break;case\"object\":await E(e,t)}}function x(e,t){const r=S(t);null!=r&&(e.size=r)}function S(e){for(const t of e)if(\"number\"==typeof t)return t;return null}function U(e,t){const r=t[2];\"number\"==typeof r&&(e.size=r)}async function E(e,t){const{resourceSize:r,symbolSize:o}=await C(e),n=R(t,r,o);null!=n&&(e.width=D(t[0],o[0],r[0],n),e.depth=D(t[1],o[1],r[1],n),e.height=D(t[2],o[2],r[2],n))}function O(e,t){const r=R(t,o,[e.width,void 0,e.height]);null!=r&&(e.width=D(t[0],e.width,1,r),e.height=D(t[2],e.height,1,r))}function R(e,t,r){for(let o=0;o<3;o++){const n=e[o];switch(n){case\"symbol-value\":{const e=r[o];return null!=e?e/t[o]:1}case\"proportional\":break;default:if(n&&t[o])return n/t[o]}}return null}async function C(e){const{computeObjectLayerResourceSize:t}=await import(\"./symbolLayerUtils.js\"),r=await t(e,10),{width:o,height:n,depth:l}=e,i=[o,l,n];let c=1;for(let s=0;s<3;s++){const e=i[s];if(null!=e){c=e/r[s];break}}for(let s=0;s<3;s++)null==i[s]&&(i[s]=r[s]*c);return{resourceSize:r,symbolSize:i}}function D(e,t,r,o){switch(e){case\"proportional\":return r*o;case\"symbol-value\":return null!=t?t:r;default:return e}}function J(e,t){const r=S(t);if(null!=r)switch(e.type){case\"simple-marker\":e.size=r;break;case\"picture-marker\":{const t=e.width/e.height;t>1?(e.width=r,e.height=r*t):(e.width=r*t,e.height=r);break}case\"simple-line\":e.width=r;break;case\"text\":e.font.size=r}}async function M(e,t){if(e&&t)return u(e)?v(e,t):void(a(e)&&J(e,t))}function N(e,t,r){if(e&&null!=t)if(u(e)){const o=e.symbolLayers;o&&o.forEach(e=>{if(\"object\"===e.type)switch(r){case\"tilt\":e.tilt=(e.tilt??0)+t;break;case\"roll\":e.roll=(e.roll??0)+t;break;default:e.heading=(e.heading??0)+t}\"icon\"===e.type&&(e.angle+=t)})}else if(a(e))switch(e.type){case\"simple-marker\":case\"picture-marker\":case\"text\":e.angle+=t;break;case\"cim\":l(e,t,!0)}}function q(e,t){if(!e)return null;const r=(t?e.effects:e.effects.filter(e=>\"bloom\"!==e.type)).map(e=>e.toJSON());return n(r)}function A(e){return null!=e&&\"polygon-3d\"===e.type&&e.symbolLayers.some(e=>\"extrude\"===e.type)}export{L as applyColorToSymbol,k as applyOpacityToColor,N as applyRotationToSymbol,M as applySizesToSymbol,q as getCSSFilterFromEffectList,b as getColorFromSymbol,d as getIconHref,p as getSymbolOutlineColor,m as getSymbolOutlineSize,h as isVolumetricSymbol,A as symbolHasExtrudeSymbolLayer};\n"],
  "mappings": "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",
  "names": ["e", "e", "u", "k", "t", "n", "l", "r", "S", "i", "e"]
}
