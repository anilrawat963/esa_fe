import {
  I,
  S,
  d,
  g
} from "./chunk-EMNCXHLH.js";
import "./chunk-7VJQTJLO.js";
import {
  o as o2,
  s
} from "./chunk-VKFTCFFM.js";
import {
  f as f3
} from "./chunk-TCDV4P3G.js";
import {
  b2 as b,
  y
} from "./chunk-CZOYDK6P.js";
import "./chunk-RS755KXS.js";
import "./chunk-TMUM75KQ.js";
import "./chunk-UOYGMZIS.js";
import "./chunk-RXH2WNPA.js";
import "./chunk-TWU3GKHX.js";
import "./chunk-BGIBV6LL.js";
import "./chunk-UQXJMFRI.js";
import "./chunk-DY7N5RAZ.js";
import {
  j as j2
} from "./chunk-6TCXGIIN.js";
import {
  l as l2
} from "./chunk-NP2TBOXH.js";
import "./chunk-WX3525ER.js";
import "./chunk-FHCV4NTV.js";
import "./chunk-HCTBVF3W.js";
import "./chunk-NH6FXYCM.js";
import "./chunk-YE4E5JCT.js";
import "./chunk-SXZO7ULH.js";
import "./chunk-H34D76ZQ.js";
import "./chunk-QTRET3PG.js";
import "./chunk-FMOL5XMB.js";
import "./chunk-VNSHGTPN.js";
import "./chunk-OEBAFVQK.js";
import "./chunk-EK7HOTRR.js";
import "./chunk-TTLSEJNG.js";
import "./chunk-ZVTEFYZX.js";
import "./chunk-LPUPM55U.js";
import "./chunk-EKZRA6TO.js";
import "./chunk-M5SP6ZBM.js";
import "./chunk-2HGIYEIL.js";
import "./chunk-MDJNYPVI.js";
import "./chunk-Z6VKIQV2.js";
import "./chunk-4PXNA4MD.js";
import "./chunk-7HTU7ZUX.js";
import "./chunk-QZQPB5XR.js";
import "./chunk-AQFRVV3U.js";
import {
  p
} from "./chunk-PEL3D3ZN.js";
import "./chunk-Q5KWD3VQ.js";
import "./chunk-BUQC3CLV.js";
import {
  t
} from "./chunk-W5S3VUFT.js";
import "./chunk-7YH7T6CS.js";
import "./chunk-3T4IXPP4.js";
import "./chunk-XTZAIV4X.js";
import "./chunk-63LDVRFI.js";
import "./chunk-C3FRY5U4.js";
import "./chunk-JNJX34GB.js";
import "./chunk-3STJRSDT.js";
import "./chunk-67Q6KVC6.js";
import "./chunk-23NJHA5Q.js";
import "./chunk-4LA6K4VI.js";
import "./chunk-KEZCWFAR.js";
import "./chunk-JZUJ34RR.js";
import "./chunk-PMGS7UDU.js";
import "./chunk-3GHCGAH2.js";
import "./chunk-HWUOAPTX.js";
import "./chunk-QHCKOBU7.js";
import "./chunk-K2OZ6WVC.js";
import "./chunk-MC6NAKKX.js";
import "./chunk-TF6255HN.js";
import "./chunk-GD4FJL3C.js";
import "./chunk-C5OQVQZF.js";
import "./chunk-F7DKSAOI.js";
import "./chunk-4SOQWNPG.js";
import "./chunk-LTULADK2.js";
import "./chunk-35ST7YRB.js";
import "./chunk-EDA5QFHZ.js";
import {
  l as l3
} from "./chunk-XXBJY7RN.js";
import "./chunk-CNYNCKEV.js";
import "./chunk-XL5QPCXN.js";
import "./chunk-2LC2762W.js";
import "./chunk-W6HOAVT4.js";
import "./chunk-DTZUXJMD.js";
import "./chunk-YLAGKT2D.js";
import "./chunk-6YRQYUCY.js";
import "./chunk-W75DBJD7.js";
import {
  b as b2
} from "./chunk-P6IKJIMO.js";
import "./chunk-MHV23XAQ.js";
import "./chunk-V2X4OKYI.js";
import "./chunk-LPZUGJNG.js";
import "./chunk-XLOINTMG.js";
import "./chunk-MA3QDRC3.js";
import "./chunk-W6J7XCPU.js";
import "./chunk-ONXWBTTM.js";
import "./chunk-T7F6Q6JJ.js";
import {
  O
} from "./chunk-YDTPM7OQ.js";
import "./chunk-75XOUSSS.js";
import "./chunk-TH4EQWJJ.js";
import "./chunk-7P2ANHQ3.js";
import {
  u
} from "./chunk-XCKT47LJ.js";
import "./chunk-3FUHCAX3.js";
import "./chunk-PZ5RULLK.js";
import "./chunk-OPJX4KXH.js";
import "./chunk-LTPHDYPK.js";
import "./chunk-3OVERDFX.js";
import "./chunk-FPMLKIDB.js";
import "./chunk-AZXJIEZ6.js";
import "./chunk-Q75WYS7K.js";
import {
  z
} from "./chunk-H74Q4SYB.js";
import {
  U,
  a as a2,
  j,
  l
} from "./chunk-2OFHDVO5.js";
import {
  n
} from "./chunk-TFJXG32O.js";
import "./chunk-DDOCCRD4.js";
import "./chunk-5UPBUJPC.js";
import "./chunk-THQO67BJ.js";
import "./chunk-4YDOPHTZ.js";
import "./chunk-YY5PITIH.js";
import "./chunk-CCQFL76O.js";
import "./chunk-CSMCPN64.js";
import "./chunk-GY6YF4EN.js";
import "./chunk-7H3U4IJR.js";
import "./chunk-SMWUT52Z.js";
import "./chunk-AXZMNHTN.js";
import {
  f as f2
} from "./chunk-5T3MJDSR.js";
import "./chunk-NMQNUPE4.js";
import "./chunk-6KIXN4DJ.js";
import "./chunk-7DGJB37R.js";
import "./chunk-234CIOHE.js";
import {
  qt
} from "./chunk-V2H77UEV.js";
import "./chunk-WRA2WBYC.js";
import {
  o
} from "./chunk-XWE6BM2U.js";
import {
  r
} from "./chunk-SOIZOFSB.js";
import {
  a as a3
} from "./chunk-XXLHAM2M.js";
import {
  m
} from "./chunk-5EI5H4QX.js";
import {
  a2 as a,
  w
} from "./chunk-ZIE53VIV.js";
import {
  __decorate
} from "./chunk-SS5CLIUY.js";
import "./chunk-R54Q5TGA.js";
import "./chunk-6SSZNBOK.js";
import "./chunk-LZ2XTYP2.js";
import "./chunk-45CFSCQX.js";
import "./chunk-A5XN2VFT.js";
import "./chunk-65HD3WXL.js";
import "./chunk-4DGC7CBY.js";
import {
  f2 as f
} from "./chunk-GNMPGHLQ.js";
import {
  c
} from "./chunk-QY7XKUIV.js";
import "./chunk-AL6YUTZM.js";
import "./chunk-G26ADAPQ.js";

// node_modules/@arcgis/core/graphic/isKMLGraphicOrigin.js
var i = Symbol("isKMLGraphicOrigin");

// node_modules/@arcgis/core/graphic/KMLGraphicOrigin.js
var e;
var s2 = class extends s {
  get [(e = i, o2)]() {
    return this.layer;
  }
  constructor(r2, i2) {
    super(), this[e] = true, this.type = "kml", this.layer = r2, this.sublayer = i2;
  }
  get id() {
    return `${this.layer.id}:__${this.sublayer.id}__`;
  }
};

// node_modules/@arcgis/core/layers/support/KMLSublayer.js
var S2;
var g2 = S2 = class extends n(a3(u)) {
  constructor(...e2) {
    super(...e2), this.description = null, this.fullExtent = null, this.id = null, this.networkLink = null, this.parent = null, this.sublayers = null, this.title = null, this.sourceJSON = null, this.layer = null, this.addHandles([a2(() => this.sublayers, "after-add", ({ item: e3 }) => {
      e3.parent = this, e3.layer = this.layer;
    }, U), a2(() => this.sublayers, "after-remove", ({ item: e3 }) => {
      e3.layer = e3.parent = null;
    }, U), l(() => this.sublayers, (e3, t2) => {
      if (t2) for (const r2 of t2) r2.layer = r2.parent = null;
      if (e3) for (const r2 of e3) r2.parent = this, r2.layer = this.layer;
    }, U), l(() => this.layer, (e3) => {
      if (this.sublayers) for (const t2 of this.sublayers) t2.layer = e3;
    }, U)]);
  }
  initialize() {
    j(() => this.networkLink).then(() => j(() => true === this.visible)).then(() => this.load());
  }
  load(e2) {
    if (!this.networkLink) return;
    if (this.networkLink.viewFormat) return;
    const r2 = null != e2 ? e2.signal : null, i2 = this._fetchService(this._get("networkLink")?.href ?? "", r2).then((e3) => {
      const r3 = I(e3.sublayers);
      this.fullExtent = z.fromJSON(r3), this.sourceJSON = e3;
      const i3 = w(O.ofType(S2), S(S2, e3));
      this.sublayers ? this.sublayers.addMany(i3) : this.sublayers = i3, this.layer?.emit("sublayer-update"), this.layer && this.layer.notifyChange("visibleSublayers");
    });
    return this.addResolvingPromise(i2), Promise.resolve(this);
  }
  get visible() {
    return this._get("visible");
  }
  set visible(e2) {
    this._get("visible") !== e2 && (this._set("visible", e2), this.layer && this.layer.notifyChange("visibleSublayers"));
  }
  readVisible(e2, t2) {
    return !!t2.visibility;
  }
  get origin() {
    return this.layer ? new s2(this.layer, this) : null;
  }
  _fetchService(e2, t2) {
    return g(e2, this.layer.outSpatialReference, this.layer.refreshInterval, t2).then((e3) => d(e3.data));
  }
};
__decorate([m()], g2.prototype, "description", void 0), __decorate([m({ type: z })], g2.prototype, "fullExtent", void 0), __decorate([m()], g2.prototype, "id", void 0), __decorate([m({ readOnly: true, value: null })], g2.prototype, "networkLink", void 0), __decorate([m({ json: { write: { allowNull: true } } })], g2.prototype, "parent", void 0), __decorate([m({ type: O.ofType(g2), json: { write: { allowNull: true } } })], g2.prototype, "sublayers", void 0), __decorate([m({ value: null, json: { read: { source: "name", reader: (e2) => c(e2) } } })], g2.prototype, "title", void 0), __decorate([m({ value: true })], g2.prototype, "visible", null), __decorate([o("visible", ["visibility"])], g2.prototype, "readVisible", null), __decorate([m()], g2.prototype, "sourceJSON", void 0), __decorate([m()], g2.prototype, "layer", void 0), __decorate([m()], g2.prototype, "origin", null), g2 = S2 = __decorate([a("esri.layers.support.KMLSublayer")], g2);

// node_modules/@arcgis/core/layers/KMLLayer.js
var E = ["kml", "xml"];
var F = class extends p(f3(t(b(j2(l2(b2)))))) {
  constructor(...e2) {
    super(...e2), this._visibleFolders = [], this.allSublayers = new l3({ getCollections: () => [this.sublayers], getChildrenFunction: (e3) => e3.sublayers }), this.outSpatialReference = f2.WGS84, this.path = null, this.legendEnabled = false, this.operationalLayerType = "KML", this.sublayers = null, this.type = "kml", this.url = null;
  }
  initialize() {
    this.addHandles([l(() => this.sublayers, (e2, r2) => {
      r2 && r2.forEach((e3) => {
        e3.parent = null, e3.layer = null;
      }), e2 && e2.forEach((e3) => {
        e3.parent = this, e3.layer = this;
      });
    }, U), this.on("sublayer-update", () => this.notifyChange("fullExtent"))]);
  }
  normalizeCtorArgs(e2, r2) {
    return "string" == typeof e2 ? { url: e2, ...r2 } : e2;
  }
  get sublayerById() {
    const e2 = /* @__PURE__ */ new Map();
    for (const r2 of this.allSublayers) e2.set(r2.id, r2);
    return e2;
  }
  readSublayersFromItemOrWebMap(e2, r2) {
    this._visibleFolders = r2.visibleFolders;
  }
  readSublayers(e2, r2, t2) {
    return S(g2, r2, t2, this._visibleFolders);
  }
  writeSublayers(e2, r2) {
    const t2 = [], o3 = e2.toArray();
    for (; o3.length; ) {
      const e3 = o3[0];
      e3.networkLink || (e3.visible && t2.push(e3.id), e3.sublayers && o3.push(...e3.sublayers.toArray())), o3.shift();
    }
    r2.visibleFolders = t2;
  }
  get title() {
    const e2 = this._get("title");
    return e2 && "defaults" !== this.originOf("title") ? e2 : this.url ? qt(this.url, E) || "KML" : e2;
  }
  set title(e2) {
    this._set("title", e2);
  }
  get visibleSublayers() {
    const e2 = this.sublayers, r2 = [], t2 = (e3) => {
      e3.visible && (r2.push(e3), e3.sublayers && e3.sublayers.forEach(t2));
    };
    return e2?.forEach(t2), r2;
  }
  get fullExtent() {
    return this._recomputeFullExtent();
  }
  load(e2) {
    const r2 = null != e2 ? e2.signal : null;
    return this.addResolvingPromise(this.loadFromPortal({ supportedTypes: ["KML"], supportsData: false }, e2).catch(f).then(() => this._fetchService(r2))), Promise.resolve(this);
  }
  destroy() {
    super.destroy(), this.allSublayers.destroy();
  }
  async _fetchService(e2) {
    const r2 = await Promise.resolve().then(() => this.resourceInfo ? { ssl: false, data: this.resourceInfo } : g(this.url ?? "", this.outSpatialReference, this.refreshInterval, e2)), t2 = d(r2.data);
    t2 && this.read(t2, { origin: "service" });
  }
  _recomputeFullExtent() {
    let e2 = null;
    null != this.extent && (e2 = this.extent.clone());
    const r2 = (t2) => {
      if (t2.sublayers) for (const o3 of t2.sublayers.items) r2(o3), o3.visible && o3.fullExtent && (null != e2 ? e2.union(o3.fullExtent) : e2 = o3.fullExtent.clone());
    };
    return r2(this), e2;
  }
};
__decorate([m({ readOnly: true })], F.prototype, "allSublayers", void 0), __decorate([m({ readOnly: true })], F.prototype, "sublayerById", null), __decorate([m({ type: f2 })], F.prototype, "outSpatialReference", void 0), __decorate([m({ type: String, json: { origins: { "web-scene": { read: true, write: true } }, read: false } })], F.prototype, "path", void 0), __decorate([m({ readOnly: true, json: { read: false, write: false } })], F.prototype, "legendEnabled", void 0), __decorate([m({ type: ["show", "hide", "hide-children"] })], F.prototype, "listMode", void 0), __decorate([m({ type: ["KML"] })], F.prototype, "operationalLayerType", void 0), __decorate([m({})], F.prototype, "resourceInfo", void 0), __decorate([m({ type: O.ofType(g2), json: { write: { ignoreOrigin: true } } })], F.prototype, "sublayers", void 0), __decorate([o(["web-map", "portal-item"], "sublayers", ["visibleFolders"])], F.prototype, "readSublayersFromItemOrWebMap", null), __decorate([o("service", "sublayers", ["sublayers"])], F.prototype, "readSublayers", null), __decorate([r("sublayers")], F.prototype, "writeSublayers", null), __decorate([m({ readOnly: true, json: { read: false } })], F.prototype, "type", void 0), __decorate([m({ json: { origins: { "web-map": { read: { source: "title" } } }, write: { ignoreOrigin: true } } })], F.prototype, "title", null), __decorate([m(y)], F.prototype, "url", void 0), __decorate([m({ readOnly: true })], F.prototype, "visibleSublayers", null), __decorate([m({ type: z })], F.prototype, "extent", void 0), __decorate([m()], F.prototype, "fullExtent", null), F = __decorate([a("esri.layers.KMLLayer")], F);
var O2 = F;
export {
  O2 as default
};
//# sourceMappingURL=KMLLayer-UCVJ3SF3.js.map
