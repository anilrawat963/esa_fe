import {
  e
} from "./chunk-U2MAPSMR.js";
import {
  f as f4
} from "./chunk-QPBITBUR.js";
import "./chunk-PJJUVY7C.js";
import {
  o as o3
} from "./chunk-7VJQTJLO.js";
import {
  c
} from "./chunk-SQ4OSZIG.js";
import "./chunk-MA6OR5A6.js";
import "./chunk-RCHRSC54.js";
import {
  a as a3
} from "./chunk-ZEI5DZXH.js";
import {
  s as s4
} from "./chunk-RGWH5UES.js";
import {
  l as l3
} from "./chunk-CJZPTLIZ.js";
import "./chunk-2U5X5TIX.js";
import {
  A,
  l as l5
} from "./chunk-EVZ7KLPS.js";
import {
  l as l4
} from "./chunk-JSH3APTG.js";
import "./chunk-WQT2KLDB.js";
import {
  d
} from "./chunk-UVDECGZC.js";
import {
  o as o2,
  s as s2
} from "./chunk-VKFTCFFM.js";
import {
  s as s3
} from "./chunk-ZETARPSI.js";
import {
  f as f3
} from "./chunk-TCDV4P3G.js";
import {
  b2,
  d as d2,
  j as j2,
  l as l6,
  p as p2,
  s as s5,
  v,
  y as y3
} from "./chunk-CZOYDK6P.js";
import {
  m as m3,
  u
} from "./chunk-RS755KXS.js";
import "./chunk-TMUM75KQ.js";
import {
  te
} from "./chunk-KY5OS6CK.js";
import "./chunk-3U5UUY3S.js";
import "./chunk-UOYGMZIS.js";
import "./chunk-RXH2WNPA.js";
import "./chunk-TWU3GKHX.js";
import "./chunk-BGIBV6LL.js";
import "./chunk-UQXJMFRI.js";
import "./chunk-DY7N5RAZ.js";
import {
  j
} from "./chunk-6TCXGIIN.js";
import {
  l
} from "./chunk-NP2TBOXH.js";
import {
  _
} from "./chunk-CXUJAI27.js";
import "./chunk-WBYRWTBX.js";
import "./chunk-WFCLXKCE.js";
import "./chunk-WX3525ER.js";
import "./chunk-FHCV4NTV.js";
import "./chunk-NH6FXYCM.js";
import "./chunk-YE4E5JCT.js";
import "./chunk-SXZO7ULH.js";
import {
  t as t3
} from "./chunk-5BAQPFKY.js";
import "./chunk-H34D76ZQ.js";
import "./chunk-QTRET3PG.js";
import "./chunk-FMOL5XMB.js";
import "./chunk-VNSHGTPN.js";
import "./chunk-OEBAFVQK.js";
import "./chunk-76V6RN4F.js";
import "./chunk-EK7HOTRR.js";
import "./chunk-GCTH5LET.js";
import "./chunk-TTLSEJNG.js";
import "./chunk-ZVTEFYZX.js";
import "./chunk-LPUPM55U.js";
import "./chunk-EKZRA6TO.js";
import "./chunk-M5SP6ZBM.js";
import "./chunk-2HGIYEIL.js";
import "./chunk-MDJNYPVI.js";
import "./chunk-Z6VKIQV2.js";
import "./chunk-4PXNA4MD.js";
import "./chunk-7HTU7ZUX.js";
import {
  b
} from "./chunk-647DAMHU.js";
import "./chunk-O6G3PPOK.js";
import "./chunk-ZKNZTIAS.js";
import "./chunk-OJMISN3F.js";
import "./chunk-EFV6H5NA.js";
import {
  m as m2
} from "./chunk-QZQPB5XR.js";
import "./chunk-AQFRVV3U.js";
import {
  p
} from "./chunk-PEL3D3ZN.js";
import "./chunk-Q5KWD3VQ.js";
import "./chunk-BUQC3CLV.js";
import {
  t as t2
} from "./chunk-W5S3VUFT.js";
import "./chunk-7YH7T6CS.js";
import {
  c as c2
} from "./chunk-3T4IXPP4.js";
import "./chunk-XTZAIV4X.js";
import "./chunk-63LDVRFI.js";
import {
  n as n2
} from "./chunk-C3FRY5U4.js";
import {
  n2 as n3,
  q
} from "./chunk-JNJX34GB.js";
import "./chunk-3STJRSDT.js";
import "./chunk-67Q6KVC6.js";
import "./chunk-23NJHA5Q.js";
import "./chunk-4LA6K4VI.js";
import "./chunk-KEZCWFAR.js";
import "./chunk-JZUJ34RR.js";
import {
  y
} from "./chunk-PMGS7UDU.js";
import "./chunk-3GHCGAH2.js";
import "./chunk-HWUOAPTX.js";
import "./chunk-QHCKOBU7.js";
import "./chunk-K2OZ6WVC.js";
import {
  F,
  y2
} from "./chunk-MC6NAKKX.js";
import "./chunk-TF6255HN.js";
import "./chunk-GD4FJL3C.js";
import "./chunk-C5OQVQZF.js";
import "./chunk-F7DKSAOI.js";
import "./chunk-4SOQWNPG.js";
import "./chunk-LTULADK2.js";
import "./chunk-35ST7YRB.js";
import "./chunk-EDA5QFHZ.js";
import "./chunk-JW6DU3OK.js";
import "./chunk-CNYNCKEV.js";
import "./chunk-XL5QPCXN.js";
import "./chunk-2LC2762W.js";
import "./chunk-W6HOAVT4.js";
import "./chunk-DTZUXJMD.js";
import "./chunk-YLAGKT2D.js";
import "./chunk-6YRQYUCY.js";
import "./chunk-W75DBJD7.js";
import "./chunk-QF7FRVN6.js";
import {
  b as b3
} from "./chunk-P6IKJIMO.js";
import "./chunk-MHV23XAQ.js";
import "./chunk-V2X4OKYI.js";
import "./chunk-LPZUGJNG.js";
import "./chunk-XLOINTMG.js";
import "./chunk-MA3QDRC3.js";
import "./chunk-W6J7XCPU.js";
import "./chunk-ONXWBTTM.js";
import {
  l as l2
} from "./chunk-T7F6Q6JJ.js";
import "./chunk-YDTPM7OQ.js";
import "./chunk-75XOUSSS.js";
import "./chunk-TH4EQWJJ.js";
import "./chunk-7P2ANHQ3.js";
import "./chunk-XCKT47LJ.js";
import "./chunk-3FUHCAX3.js";
import "./chunk-PZ5RULLK.js";
import "./chunk-OPJX4KXH.js";
import "./chunk-LTPHDYPK.js";
import "./chunk-3OVERDFX.js";
import "./chunk-FPMLKIDB.js";
import "./chunk-AZXJIEZ6.js";
import "./chunk-Q75WYS7K.js";
import {
  z
} from "./chunk-H74Q4SYB.js";
import "./chunk-2OFHDVO5.js";
import "./chunk-TFJXG32O.js";
import "./chunk-DDOCCRD4.js";
import "./chunk-5UPBUJPC.js";
import "./chunk-THQO67BJ.js";
import "./chunk-4YDOPHTZ.js";
import "./chunk-YY5PITIH.js";
import "./chunk-CCQFL76O.js";
import "./chunk-CSMCPN64.js";
import "./chunk-GY6YF4EN.js";
import "./chunk-7H3U4IJR.js";
import "./chunk-SMWUT52Z.js";
import "./chunk-AXZMNHTN.js";
import {
  f as f2
} from "./chunk-5T3MJDSR.js";
import "./chunk-NMQNUPE4.js";
import "./chunk-6KIXN4DJ.js";
import "./chunk-7DGJB37R.js";
import "./chunk-234CIOHE.js";
import {
  H2 as H
} from "./chunk-V2H77UEV.js";
import "./chunk-WRA2WBYC.js";
import {
  o
} from "./chunk-XWE6BM2U.js";
import "./chunk-SOIZOFSB.js";
import {
  n
} from "./chunk-XXLHAM2M.js";
import {
  m
} from "./chunk-5EI5H4QX.js";
import {
  a2,
  x
} from "./chunk-ZIE53VIV.js";
import {
  __decorate
} from "./chunk-SS5CLIUY.js";
import "./chunk-R54Q5TGA.js";
import "./chunk-6SSZNBOK.js";
import "./chunk-LZ2XTYP2.js";
import "./chunk-45CFSCQX.js";
import "./chunk-A5XN2VFT.js";
import "./chunk-65HD3WXL.js";
import "./chunk-4DGC7CBY.js";
import {
  L,
  f2 as f,
  t
} from "./chunk-GNMPGHLQ.js";
import {
  a,
  i3 as i,
  s2 as s
} from "./chunk-QY7XKUIV.js";
import "./chunk-AL6YUTZM.js";
import "./chunk-G26ADAPQ.js";

// node_modules/@arcgis/core/graphic/isStreamGraphicOrigin.js
var i2 = Symbol("isStreamGraphicOrigin");

// node_modules/@arcgis/core/graphic/StreamGraphicOrigin.js
var o4;
var a4 = class extends s2 {
  get [(o4 = i2, n3)]() {
    return this.layer;
  }
  get [n2]() {
    return this.layer;
  }
  get [o2]() {
    return this.layer;
  }
  constructor(r) {
    super(), this[o4] = true, this.type = "stream", this.layer = r;
  }
  get id() {
    return this.layer.id;
  }
};

// node_modules/@arcgis/core/layers/support/PurgeOptions.js
var s6;
var _a;
var i3 = (_a = class extends n {
  constructor() {
    super(...arguments), this.age = null, this.ageReceived = null, this.displayCount = null, this.maxObservations = 1;
  }
  clone() {
    return new s6({ age: this.age, ageReceived: this.ageReceived, displayCount: this.displayCount, maxObservations: this.maxObservations });
  }
}, s6 = _a, _a);
__decorate([m({ type: Number, json: { write: true } })], i3.prototype, "age", void 0), __decorate([m({ type: Number, json: { write: true } })], i3.prototype, "ageReceived", void 0), __decorate([m({ type: Number, json: { write: true } })], i3.prototype, "displayCount", void 0), __decorate([m({ type: Number, json: { write: true } })], i3.prototype, "maxObservations", void 0), i3 = s6 = __decorate([a2("esri.layers.support.PurgeOptions")], i3);

// node_modules/@arcgis/core/layers/StreamLayer.js
var te2 = s4();
function re(e2, t4) {
  return new s("layer:unsupported", `Layer (${e2.title}, ${e2.id}) of type '${e2.declaredClass}' ${t4}`, { layer: e2 });
}
var ie = class extends a3(f4(c(p(l4(e(t2(f3(l3(b2(j(l(s3(l2(b3)))))))))))))) {
  constructor(...e2) {
    super(...e2), this.copyright = null, this.definitionExpression = null, this.displayField = null, this.elevationInfo = null, this.fields = null, this.fieldsIndex = null, this.geometryDefinition = null, this.geometryType = null, this.graphicOrigin = new a4(this), this.labelsVisible = true, this.labelingInfo = null, this.legendEnabled = true, this.maxReconnectionAttempts = 0, this.maxReconnectionInterval = 20, this.maxScale = 0, this.minScale = 0, this.objectIdField = null, this.operationalLayerType = "ArcGISStreamLayer", this.outFields = ["*"], this.popupEnabled = true, this.popupTemplate = null, this.purgeOptions = new i3(), this.refreshInterval = 0, this.screenSizePerspectiveEnabled = true, this.sourceJSON = null, this.spatialReference = f2.WGS84, this.type = "stream", this.url = null, this.updateInterval = 300, this.useViewTime = true, this.webSocketUrl = null, this._debouncedSaveOperations = L(async (e3, t4, r) => {
      const { save: i4, saveAs: o5 } = await import("./streamLayerUtils-V53C2DMY.js");
      switch (e3) {
        case 0:
          return i4(this, t4);
        case 1:
          return o5(this, r, t4);
      }
    });
  }
  normalizeCtorArgs(e2, t4) {
    return "string" == typeof e2 ? { url: e2, ...t4 } : e2;
  }
  load(e2) {
    if (!("WebSocket" in globalThis)) return this.addResolvingPromise(Promise.reject(new s("stream-layer:websocket-unsupported", "WebSocket is not supported in this browser. StreamLayer will not have real-time connection with the stream service."))), Promise.resolve(this);
    const t4 = null != e2 ? e2.signal : null;
    return this.addResolvingPromise(this.loadFromPortal({ supportedTypes: ["Stream Service", "Feed"] }, e2).catch(f).then(() => this._fetchService(t4))), Promise.resolve(this);
  }
  get defaultPopupTemplate() {
    return this.createPopupTemplate();
  }
  set featureReduction(e2) {
    const t4 = this._normalizeFeatureReduction(e2);
    this._set("featureReduction", t4);
  }
  set renderer(e2) {
    y2(e2, this.fieldsIndex), this._set("renderer", e2);
  }
  readRenderer(e2, t4, r) {
    t4 = t4.layerDefinition || t4;
    const i4 = t4.drawingInfo?.renderer;
    if (i4) {
      const e3 = o3(i4, t4, r) || void 0;
      return e3 || i.getLogger(this).error("Failed to create renderer", { rendererDefinition: t4.drawingInfo.renderer, layer: this, context: r }), e3;
    }
    return te(t4, r);
  }
  async connect(e2) {
    const [{ createConnection: t4 }] = await Promise.all([import("./createConnection-ZBQGM3E7.js"), this.load()]), r = this.geometryType ? y.toJSON(this.geometryType) : null, { customParameters: i4 = null, definitionExpression: o5 = null, geometryDefinition: n4 = null, maxReconnectionAttempts: a5 = 0, maxReconnectionInterval: p3 = 20, spatialReference: l7 = this.spatialReference } = e2 || this.createConnectionParameters(), m4 = t4(this.parsedUrl, this.spatialReference, l7, r, o5, n4, a5, p3, i4 ?? void 0), d3 = t([this.on("send-message-to-socket", (e3) => m4.sendMessageToSocket(e3)), this.on("send-message-to-client", (e3) => m4.sendMessageToClient(e3))]);
    return m4.once("destroy", d3.remove), m4;
  }
  createConnectionParameters() {
    return { spatialReference: this.spatialReference, customParameters: this.customParameters, definitionExpression: this.definitionExpression, geometryDefinition: this.geometryDefinition, maxReconnectionAttempts: this.maxReconnectionAttempts, maxReconnectionInterval: this.maxReconnectionInterval };
  }
  createPopupTemplate(e2) {
    return d(this, e2);
  }
  createQuery() {
    const e2 = new b();
    return e2.returnGeometry = true, e2.outFields = ["*"], e2.where = this.definitionExpression || "1=1", e2;
  }
  getFieldDomain(e2, t4) {
    if (!this.fields) return null;
    let r = null;
    return this.fields.some((t5) => (t5.name === e2 && (r = t5.domain), !!r)), r;
  }
  getField(e2) {
    return this.fieldsIndex.get(e2);
  }
  serviceSupportsSpatialReference(e2) {
    return true;
  }
  sendMessageToSocket(e2) {
    this.emit("send-message-to-socket", e2);
  }
  sendMessageToClient(e2) {
    this.emit("send-message-to-client", e2);
  }
  async save(e2) {
    return this._debouncedSaveOperations(0, e2);
  }
  async saveAs(e2, t4) {
    return this._debouncedSaveOperations(1, t4, e2);
  }
  write(e2, t4) {
    const r = t4?.messages;
    return this.webSocketUrl ? (r?.push(re(this, "using a custom websocket connection cannot be written to web scenes and web maps")), null) : this.parsedUrl ? super.write(e2, t4) : (r?.push(re(this, "using a client-side only connection without a url cannot be written to web scenes and web maps")), null);
  }
  async _fetchService(e2) {
    if (!!!this.webSocketUrl && this.parsedUrl) {
      if (!this.sourceJSON) {
        const { data: t4 } = await H(this.parsedUrl.path, { query: { f: "json", ...this.customParameters, ...this.parsedUrl.query }, responseType: "json", signal: e2 });
        this.sourceJSON = t4;
      }
    } else {
      if (!this.timeInfo?.trackIdField) throw new s("stream-layer:missing-metadata", "The stream layer trackIdField must be specified.");
      if (!this.objectIdField) {
        const e3 = this.fields.find((e4) => "oid" === e4.type)?.name;
        if (!e3) throw new s("stream-layer:missing-metadata", "The stream layer objectIdField must be specified.");
        this.objectIdField = e3;
      }
      if (!this.fields) throw new s("stream-layer:missing-metadata", "The stream layer fields must be specified.");
      if (this.fields.some((e3) => e3.name === this.objectIdField) || this.fields.push(new m2({ name: this.objectIdField, alias: this.objectIdField, type: "oid" })), !this.geometryType) throw new s("stream-layer:missing-metadata", "The stream layer geometryType must be specified.");
      this.webSocketUrl && (this.url = this.webSocketUrl);
    }
    return this.read(this.sourceJSON, { origin: "service", portalItem: this.portalItem, portal: this.portalItem?.portal, url: this.parsedUrl }), y2(this.renderer, this.fieldsIndex), F(this.timeInfo, this.fieldsIndex), this.objectIdField || (this.objectIdField = _), t3(this, { origin: "service" });
  }
};
__decorate([m({ type: String })], ie.prototype, "copyright", void 0), __decorate([m({ readOnly: true })], ie.prototype, "defaultPopupTemplate", null), __decorate([m({ type: String, json: { name: "layerDefinition.definitionExpression", write: { enabled: true, allowNull: true } } })], ie.prototype, "definitionExpression", void 0), __decorate([m({ type: String })], ie.prototype, "displayField", void 0), __decorate([m({ type: c2 })], ie.prototype, "elevationInfo", void 0), __decorate([m({ json: { origins: { "web-map": { read: false, write: false }, "portal-item": { read: false, write: false }, "web-scene": { read: false, write: false } } } })], ie.prototype, "featureReduction", null), __decorate([m(te2.fields)], ie.prototype, "fields", void 0), __decorate([m(te2.fieldsIndex)], ie.prototype, "fieldsIndex", void 0), __decorate([m({ type: z, json: { name: "layerDefinition.definitionGeometry", write: true } })], ie.prototype, "geometryDefinition", void 0), __decorate([m({ type: y.apiValues, json: { read: { reader: y.read } } })], ie.prototype, "geometryType", void 0), __decorate([m({ readOnly: true, clonable: false })], ie.prototype, "graphicOrigin", void 0), __decorate([m(p2)], ie.prototype, "labelsVisible", void 0), __decorate([m({ type: [A], json: { name: "layerDefinition.drawingInfo.labelingInfo", read: { reader: l5 }, write: true } })], ie.prototype, "labelingInfo", void 0), __decorate([m(d2)], ie.prototype, "legendEnabled", void 0), __decorate([m({ type: ["show", "hide"], json: { origins: { "portal-item": { read: false, write: false } } } })], ie.prototype, "listMode", void 0), __decorate([m({ type: x })], ie.prototype, "maxReconnectionAttempts", void 0), __decorate([m({ type: x })], ie.prototype, "maxReconnectionInterval", void 0), __decorate([m(v)], ie.prototype, "maxScale", void 0), __decorate([m(j2)], ie.prototype, "minScale", void 0), __decorate([m({ type: String })], ie.prototype, "objectIdField", void 0), __decorate([m({ value: "ArcGISStreamLayer", type: ["ArcGISStreamLayer"] })], ie.prototype, "operationalLayerType", void 0), __decorate([m({ readOnly: true })], ie.prototype, "outFields", void 0), __decorate([m(l6)], ie.prototype, "popupEnabled", void 0), __decorate([m({ type: q, json: { name: "popupInfo", write: true } })], ie.prototype, "popupTemplate", void 0), __decorate([m({ type: i3 })], ie.prototype, "purgeOptions", void 0), __decorate([m({ json: { read: false, write: false } })], ie.prototype, "refreshInterval", void 0), __decorate([m({ types: m3, json: { origins: { service: { write: { target: "drawingInfo.renderer", enabled: false } }, "web-scene": { name: "layerDefinition.drawingInfo.renderer", types: u, write: true } }, write: { target: "layerDefinition.drawingInfo.renderer" } } })], ie.prototype, "renderer", null), __decorate([o("service", "renderer", ["drawingInfo.renderer", "defaultSymbol"]), o("renderer", ["layerDefinition.drawingInfo.renderer", "layerDefinition.defaultSymbol"])], ie.prototype, "readRenderer", null), __decorate([m((() => {
  const e2 = a(s5);
  return e2.json.origins["portal-item"] = { read: false, write: false }, e2;
})())], ie.prototype, "screenSizePerspectiveEnabled", void 0), __decorate([m()], ie.prototype, "sourceJSON", void 0), __decorate([m({ type: f2, json: { origins: { service: { read: { source: "spatialReference" } } } } })], ie.prototype, "spatialReference", void 0), __decorate([m({ json: { read: false } })], ie.prototype, "type", void 0), __decorate([m(y3)], ie.prototype, "url", void 0), __decorate([m({ type: Number })], ie.prototype, "updateInterval", void 0), __decorate([m({ json: { read: false, write: false } })], ie.prototype, "useViewTime", void 0), __decorate([m({ type: String })], ie.prototype, "webSocketUrl", void 0), ie = __decorate([a2("esri.layers.StreamLayer")], ie);
var oe = ie;
export {
  oe as default
};
//# sourceMappingURL=StreamLayer-ENIEDTES.js.map
