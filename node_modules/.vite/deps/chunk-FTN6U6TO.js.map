{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/support/flow/FlowQuery3D.js", "../../@arcgis/core/views/3d/support/flow/loadUtils.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{Cyclical as t}from\"../../../../core/Cyclical.js\";import{height as e,fromExtent as n}from\"../../../../geometry/support/aaBoundingRect.js\";import{getInfo as i}from\"../../../../geometry/support/spatialReferenceUtils.js\";class o{constructor(t,e,n,i,o){this.extent=t,this.timeExtent=e,this.size=n,this.pixelRatio=i,this.time=o}get flowExtentInfo(){return{modelSize:this.size,valid:i(this.extent.spatialReference)?.valid,extent:n(this.extent)}}insideMapExtent(t,e){return r(this.flowExtentInfo,t,e)}modelToMapSpace(t,e,n){return l(this.flowExtentInfo,t,e,n)}}function r(t,e,n){const{extent:i,valid:o}=t,[r,l,s,a]=i;return!(n<l||n>a)&&(null!=o&&r>s?e>=s||e<=r:e>=r&&e<=s)}function l(n,i,o,r){const{extent:l,modelSize:s,valid:u}=n,[c,f,x]=l,m=a(c,x,u);let p=i/s[0]*m+c;if(null!=u&&r){p=new t(u[0],u[1]).normalize(p)}return[p,(s[1]-o)/s[1]*e(l)+f]}function s(t,e,n){return null!=n&&Math.abs(t-n.valid[0])<n.dx&&Math.abs(e-n.valid[1])<n.dx}function a(t,e,n){if(null!=n&&t>e){const[i,o]=n;return o-t+(e-i)}return e-t}export{o as FlowQuery3D,r as insideMapExtent,s as isFullExtent,l as modelToMapSpace,a as wrappedWidth};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{containsXY as t,width as n,height as e,create as r}from\"../../../../geometry/support/aaBoundingRect.js\";import{createFlowFieldFromData as l}from\"../../../2d/engine/flow/dataUtils.js\";import{getFeatureTileId as o}from\"../../layers/support/FeatureTileDescriptor.js\";import{modelToMapSpace as i,insideMapExtent as u,isFullExtent as s}from\"./FlowQuery3D.js\";function f(t){return t?4:3}function a(t){return t[0].vertices instanceof Float32Array}class c{constructor(t,n,e,r,l,o){this.data=t,this.mask=n,this.width=e,this.height=r,this.lij=l,this.extent=o}}function h(t){return o(t.lij[0],t.lij[1],t.lij[2])}function m(t,n){let[e,l,o,i]=[null,null,null,null];for(const r of t){const t=r.extent;e=p(t[0],e),l=p(t[1],l),o=d(t[2],o),i=d(t[3],i)}if(null==e||null==l||null==o||null==i)return null;if(s(e,o,n)){const n=[...t].toSorted((t,n)=>t.extent[0]-n.extent[0]);let r=n[0].extent[2],l=0,i=0,u=0;for(let t=1;t<n.length;t++){const[e,o,s]=n[t].extent;if(r<e&&(u++,l=r,i=e,u>1))break;r=Math.max(r,s)}1===u&&(e=i,o=l)}return r([e,l,o,i])}function d(t,n){return null==n?t:Math.max(t,n)}function p(t,n){return null==n?t:Math.min(t,n)}function x(r,o,s){const[f,a]=s.modelSize;let c=null;const h=new Map;o.forEach(t=>{h.set(t.lij,l(r,t))});const m=(n,e,r)=>t(n.extent,e,r);return(t,l)=>{const d=Math.round(t),p=Math.round(l);if(!r.wrapAround&&(d<0||d>=f||p<0||p>=a))return[0,0];const[x,j]=i(s,t,l,!0);if(!u(s,x,j))return[0,0];if(null==c||!m(c,x,j)){c=null;for(const[t,n]of o)if(m(n,x,j)){c=n;break}}if(null==c?.data)return[0,0];const g=h.get(c.lij);if(null==g)return[0,0];const{width:w,height:M,extent:y}=c;return g((x-y[0])/n(y)*w,M-(j-y[1])/e(y)*M)}}export{c as FlowDataTile,m as boundingRectOfTiles,x as createFlowFieldFromDataTiled,a as isFlowPathBuffer,h as tileToKey,f as valuesPerFlowVertex};\n"],
  "mappings": ";;;;;;;;;;;;;AAIgjB,SAAS,EAAE,GAAE,GAAEA,IAAE;AAAC,QAAK,EAAC,QAAOC,IAAE,OAAMC,GAAC,IAAE,GAAE,CAACC,IAAEC,IAAEC,IAAEC,EAAC,IAAEL;AAAE,SAAM,EAAED,KAAEI,MAAGJ,KAAEM,QAAK,QAAMJ,MAAGC,KAAEE,KAAE,KAAGA,MAAG,KAAGF,KAAE,KAAGA,MAAG,KAAGE;AAAE;AAAC,SAASD,GAAEJ,IAAEC,IAAEC,IAAEC,IAAE;AAAC,QAAK,EAAC,QAAOC,IAAE,WAAUC,IAAE,OAAM,EAAC,IAAEL,IAAE,CAAC,GAAEO,IAAEC,EAAC,IAAEJ,IAAE,IAAE,EAAE,GAAEI,IAAE,CAAC;AAAE,MAAI,IAAEP,KAAEI,GAAE,CAAC,IAAE,IAAE;AAAE,MAAG,QAAM,KAAGF,IAAE;AAAC,QAAE,IAAI,EAAE,EAAE,CAAC,GAAE,EAAE,CAAC,CAAC,EAAE,UAAU,CAAC;AAAA,EAAC;AAAC,SAAM,CAAC,IAAGE,GAAE,CAAC,IAAEH,MAAGG,GAAE,CAAC,IAAE,EAAED,EAAC,IAAEG,EAAC;AAAC;AAA4F,SAAS,EAAE,GAAE,GAAEE,IAAE;AAAC,MAAG,QAAMA,MAAG,IAAE,GAAE;AAAC,UAAK,CAACC,IAAEC,EAAC,IAAEF;AAAE,WAAOE,KAAE,KAAG,IAAED;AAAA,EAAE;AAAC,SAAO,IAAE;AAAC;;;ACA3oB,SAASE,GAAE,GAAE;AAAC,SAAO,IAAE,IAAE;AAAC;AAAmuB,SAAS,EAAEC,IAAEC,IAAEC,IAAE;AAAC,QAAK,CAACC,IAAEC,EAAC,IAAEF,GAAE;AAAU,MAAI,IAAE;AAAK,QAAMG,KAAE,oBAAI;AAAI,EAAAJ,GAAE,QAAQ,OAAG;AAAC,IAAAI,GAAE,IAAI,EAAE,KAAI,EAAEL,IAAE,CAAC,CAAC;AAAA,EAAC,CAAC;AAAE,QAAM,IAAE,CAACM,IAAE,GAAEN,OAAI,EAAEM,GAAE,QAAO,GAAEN,EAAC;AAAE,SAAM,CAAC,GAAEO,OAAI;AAAC,UAAM,IAAE,KAAK,MAAM,CAAC,GAAE,IAAE,KAAK,MAAMA,EAAC;AAAE,QAAG,CAACP,GAAE,eAAa,IAAE,KAAG,KAAGG,MAAG,IAAE,KAAG,KAAGC,IAAG,QAAM,CAAC,GAAE,CAAC;AAAE,UAAK,CAACI,IAAE,CAAC,IAAED,GAAEL,IAAE,GAAEK,IAAE,IAAE;AAAE,QAAG,CAAC,EAAEL,IAAEM,IAAE,CAAC,EAAE,QAAM,CAAC,GAAE,CAAC;AAAE,QAAG,QAAM,KAAG,CAAC,EAAE,GAAEA,IAAE,CAAC,GAAE;AAAC,UAAE;AAAK,iBAAS,CAACC,IAAEH,EAAC,KAAIL,GAAE,KAAG,EAAEK,IAAEE,IAAE,CAAC,GAAE;AAAC,YAAEF;AAAE;AAAA,MAAK;AAAA,IAAC;AAAC,QAAG,QAAM,GAAG,KAAK,QAAM,CAAC,GAAE,CAAC;AAAE,UAAM,IAAED,GAAE,IAAI,EAAE,GAAG;AAAE,QAAG,QAAM,EAAE,QAAM,CAAC,GAAE,CAAC;AAAE,UAAK,EAAC,OAAM,GAAE,QAAO,GAAE,QAAOK,GAAC,IAAE;AAAE,WAAO,GAAGF,KAAEE,GAAE,CAAC,KAAG,EAAEA,EAAC,IAAE,GAAE,KAAG,IAAEA,GAAE,CAAC,KAAG,EAAEA,EAAC,IAAE,CAAC;AAAA,EAAC;AAAC;",
  "names": ["n", "i", "o", "r", "l", "s", "a", "f", "x", "n", "i", "o", "f", "r", "o", "s", "f", "a", "h", "n", "l", "x", "t", "y"]
}
