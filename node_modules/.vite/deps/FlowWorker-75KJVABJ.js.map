{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/support/flow/FlowWorker.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as t}from\"tslib\";import\"../../../../core/Logger.js\";import\"../../../../core/has.js\";import\"../../../../core/RandomLCG.js\";import\"../../../../core/Error.js\";import{subclass as e}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{createFlowFieldFromData as s,traceFlowPaths as r}from\"../../../2d/engine/flow/dataUtils.js\";import{createFlowFieldFromDataTiled as o,valuesPerFlowVertex as a}from\"./loadUtils.js\";let i=class{constructor(){this._tileData=new Map}async generateStreamlines(t){const{flowData:e,flowExtentInfo:r,needsMagnitude:o,simulationSettings:a,startPositions:i}=t,n=l(s(a,e),a,r.modelSize,o,i);return{result:{streamlines:n},transferList:n?.map(t=>t.vertices.buffer)}}async generateTiledStreamlines(t){const{flowDataTiles:e,flowExtentInfo:s,needsMagnitude:r,reset:a,simulationSettings:i,startPositions:n}=t;this._updateTileData(e,a);const c=l(o(i,this._tileData,s),i,s.modelSize,r,n);return{result:{streamlines:c},transferList:c?.map(t=>t.vertices.buffer)??[]}}_updateTileData(t,e){e&&this._tileData.forEach((e,s)=>{null==t.get(s)&&this._tileData.delete(s)}),t.forEach((t,e)=>{\"delete\"===t.type?this._tileData.delete(e):\"on-worker\"!==t.type&&\"waiting\"!==t.type&&this._tileData.set(e,t.data)})}};i=t([e(\"esri.views.3d.support.flow.FlowWorker\")],i);const n=i;function l(t,e,s,o,i){if(null==t)return;const n=r(e,t,s[0],s[1],{positions:i}),l=[],c=a(o);for(const{vertices:r,stage:a}of n){const t=new Float32Array(r.length*c);for(let e=0;e<r.length;e++)t[e*c]=r[e].x,t[e*c+1]=r[e].y,t[e*c+2]=r[e].t,o&&(t[e*c+3]=r[e].speed);l.push({vertices:t,stage:a,hasMagnitude:o})}return l}export{n as default};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAI2b,IAAI,IAAE,MAAK;AAAA,EAAC,cAAa;AAAC,SAAK,YAAU,oBAAI;AAAA,EAAG;AAAA,EAAC,MAAM,oBAAoB,GAAE;AAAC,UAAK,EAAC,UAAS,GAAE,gBAAe,GAAE,gBAAe,GAAE,oBAAmBA,IAAE,gBAAeC,GAAC,IAAE,GAAEC,KAAE,EAAE,EAAEF,IAAE,CAAC,GAAEA,IAAE,EAAE,WAAU,GAAEC,EAAC;AAAE,WAAM,EAAC,QAAO,EAAC,aAAYC,GAAC,GAAE,cAAaA,IAAG,IAAI,CAAAC,OAAGA,GAAE,SAAS,MAAM,EAAC;AAAA,EAAC;AAAA,EAAC,MAAM,yBAAyB,GAAE;AAAC,UAAK,EAAC,eAAc,GAAE,gBAAe,GAAE,gBAAe,GAAE,OAAMH,IAAE,oBAAmBC,IAAE,gBAAeC,GAAC,IAAE;AAAE,SAAK,gBAAgB,GAAEF,EAAC;AAAE,UAAM,IAAE,EAAE,EAAEC,IAAE,KAAK,WAAU,CAAC,GAAEA,IAAE,EAAE,WAAU,GAAEC,EAAC;AAAE,WAAM,EAAC,QAAO,EAAC,aAAY,EAAC,GAAE,cAAa,GAAG,IAAI,CAAAC,OAAGA,GAAE,SAAS,MAAM,KAAG,CAAC,EAAC;AAAA,EAAC;AAAA,EAAC,gBAAgB,GAAE,GAAE;AAAC,SAAG,KAAK,UAAU,QAAQ,CAACC,IAAE,MAAI;AAAC,cAAM,EAAE,IAAI,CAAC,KAAG,KAAK,UAAU,OAAO,CAAC;AAAA,IAAC,CAAC,GAAE,EAAE,QAAQ,CAACD,IAAEC,OAAI;AAAC,mBAAWD,GAAE,OAAK,KAAK,UAAU,OAAOC,EAAC,IAAE,gBAAcD,GAAE,QAAM,cAAYA,GAAE,QAAM,KAAK,UAAU,IAAIC,IAAED,GAAE,IAAI;AAAA,IAAC,CAAC;AAAA,EAAC;AAAC;AAAE,IAAE,WAAE,CAAC,EAAE,uCAAuC,CAAC,GAAE,CAAC;AAAE,IAAM,IAAE;AAAE,SAAS,EAAE,GAAE,GAAE,GAAE,GAAEF,IAAE;AAAC,MAAG,QAAM,EAAE;AAAO,QAAMC,KAAE,EAAE,GAAE,GAAE,EAAE,CAAC,GAAE,EAAE,CAAC,GAAE,EAAC,WAAUD,GAAC,CAAC,GAAEI,KAAE,CAAC,GAAE,IAAEC,GAAE,CAAC;AAAE,aAAS,EAAC,UAAS,GAAE,OAAMN,GAAC,KAAIE,IAAE;AAAC,UAAMC,KAAE,IAAI,aAAa,EAAE,SAAO,CAAC;AAAE,aAAQC,KAAE,GAAEA,KAAE,EAAE,QAAOA,KAAI,CAAAD,GAAEC,KAAE,CAAC,IAAE,EAAEA,EAAC,EAAE,GAAED,GAAEC,KAAE,IAAE,CAAC,IAAE,EAAEA,EAAC,EAAE,GAAED,GAAEC,KAAE,IAAE,CAAC,IAAE,EAAEA,EAAC,EAAE,GAAE,MAAID,GAAEC,KAAE,IAAE,CAAC,IAAE,EAAEA,EAAC,EAAE;AAAO,IAAAC,GAAE,KAAK,EAAC,UAASF,IAAE,OAAMH,IAAE,cAAa,EAAC,CAAC;AAAA,EAAC;AAAC,SAAOK;AAAC;",
  "names": ["a", "i", "n", "t", "e", "l", "f"]
}
