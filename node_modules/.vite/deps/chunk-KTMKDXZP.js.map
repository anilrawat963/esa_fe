{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/MaskedColor.glsl.js", "../../@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{glsl as o}from\"../../shaderModules/glsl.js\";function r(r){r.code.add(o`struct MaskedColor {\nvec4 color;\nbvec4 mask;\n};`)}function e(e){e.include(r),e.code.add(o`\n    MaskedColor createMaskedFromUInt8NaNColor(vec4 color) {\n      return MaskedColor(color * ${o.float(1/254)}, equal(color, vec4(255)));\n    }\n  `)}function c(e){e.include(r),e.code.add(o`vec4 maskedColorSelectOrOne(MaskedColor color) {\nreturn vec4(\ncolor.mask.r ? 1.0 : color.color.r,\ncolor.mask.g ? 1.0 : color.color.g,\ncolor.mask.b ? 1.0 : color.color.b,\ncolor.mask.a ? 1.0 : color.color.a\n);\n}\nMaskedColor multiplyMaskedColors(MaskedColor color1, MaskedColor color2) {\nvec4 masked1 = maskedColorSelectOrOne(color1);\nvec4 masked2 = maskedColorSelectOrOne(color2);\nreturn MaskedColor(masked1 * masked2, bvec4(ivec4(color1.mask) & ivec4(color2.mask)));\n}`)}function l(e){e.include(r),e.code.add(o`MaskedColor createMaskedFromNaNColor(vec4 color) {\nreturn MaskedColor(color, isnan(color));\n}`)}export{l as CreateMaskedFromNaNColor,e as CreateMaskedFromUInt8NaNColor,r as MaskedColorDefinition,c as MultiplyMaskedColors};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{MaskedColorDefinition as o,MultiplyMaskedColors as e,CreateMaskedFromNaNColor as r}from\"../attributes/MaskedColor.glsl.js\";import{Float3PassUniform as a}from\"../../shaderModules/Float3PassUniform.js\";import{Float4PassUniform as t}from\"../../shaderModules/Float4PassUniform.js\";import{Float4sPassUniform as v}from\"../../shaderModules/Float4sPassUniform.js\";import{FloatsPassUniform as l}from\"../../shaderModules/FloatsPassUniform.js\";import{glsl as i}from\"../../shaderModules/glsl.js\";import{Matrix3PassUniform as s}from\"../../shaderModules/Matrix3PassUniform.js\";import{vvColorNumber as n}from\"../../../materials/VisualVariablePassParameters.js\";function u(u,c){const{vertex:m,attributes:d}=u;c.hasVVInstancing&&(c.hasVVSize||c.hasVVColor)&&d.add(\"instanceFeatureAttribute\",\"vec4\"),c.hasVVSize?(m.uniforms.add(new a(\"vvSizeMinSize\",o=>o.vvSize.minSize)),m.uniforms.add(new a(\"vvSizeMaxSize\",o=>o.vvSize.maxSize)),m.uniforms.add(new a(\"vvSizeOffset\",o=>o.vvSize.offset)),m.uniforms.add(new a(\"vvSizeFactor\",o=>o.vvSize.factor)),m.uniforms.add(new a(\"vvSizeFallback\",o=>o.vvSize.fallback)),m.uniforms.add(new s(\"vvSymbolRotationMatrix\",o=>o.vvSymbolRotationMatrix)),m.uniforms.add(new a(\"vvSymbolAnchor\",o=>o.vvSymbolAnchor)),m.code.add(i`vec3 vvScale(vec4 _featureAttribute) {\nif (isnan(_featureAttribute.x)) {\nreturn vvSizeFallback;\n}\nreturn clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n}\nvec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\nreturn vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n}`),m.code.add(i`\n      const float eps = 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 scale = max(vvScale(_featureAttribute), eps);\n        return vec4(vvSymbolRotationMatrix * _normal / scale, 1.0);\n      }\n\n      ${c.hasVVInstancing?i`\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }`:\"\"}\n    `)):m.code.add(i`vec4 localPosition() { return vec4(position, 1.0); }\nvec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }`),u.vertex.include(o),c.hasVVColor?(m.constants.add(\"vvColorNumber\",\"int\",n),m.uniforms.add(new l(\"vvColorValues\",o=>o.vvColor.values,n),new v(\"vvColorColors\",o=>o.vvColor.colors,n),new t(\"vvColorFallback\",o=>o.vvColor.fallback,{supportsNaN:!0})),c.hasVVInstancing&&(u.vertex.include(e),u.vertex.include(r)),m.code.add(i`\n      vec4 interpolateVVColor(float value) {\n        if (isnan(value)) {\n          return vvColorFallback;\n        }\n\n        if (value <= vvColorValues[0]) {\n          return vvColorColors[0];\n        }\n\n        for (int i = 1; i < vvColorNumber; ++i) {\n          if (vvColorValues[i] >= value) {\n            float f = (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);\n            return mix(vvColorColors[i-1], vvColorColors[i], f);\n          }\n        }\n        return vvColorColors[vvColorNumber - 1];\n      }\n\n      vec4 vvGetColor(vec4 featureAttribute) {\n        return interpolateVVColor(featureAttribute.y);\n      }\n\n      ${c.hasVVInstancing?i`\n            vec4 vvColor() {\n              return vvGetColor(instanceFeatureAttribute);\n            }\n\n            MaskedColor applyVVColor(MaskedColor color) {\n              return multiplyMaskedColors(color, createMaskedFromNaNColor(vvColor()));\n            }\n            `:i`\n            vec4 vvColor() {\n              return vec4(1.0);\n            }\n\n            MaskedColor applyVVColor(MaskedColor color) {\n              return color;\n            }\n            `}\n    `)):m.code.add(i`vec4 vvColor() {\nreturn vec4(1.0);\n}\nMaskedColor applyVVColor(MaskedColor color) {\nreturn color;\n}`)}export{u as VisualVariables};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;AAImD,SAASA,GAAEA,IAAE;AAAC,EAAAA,GAAE,KAAK,IAAI;AAAA;AAAA;AAAA,GAGzE;AAAC;AAAC,SAASC,GAAEA,IAAE;AAAC,EAAAA,GAAE,QAAQD,EAAC,GAAEC,GAAE,KAAK,IAAI;AAAA;AAAA,mCAER,EAAE,MAAM,IAAE,GAAG,CAAC;AAAA;AAAA,GAE9C;AAAC;AAAC,SAAS,EAAEA,IAAE;AAAC,EAAAA,GAAE,QAAQD,EAAC,GAAEC,GAAE,KAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYzC;AAAC;AAAC,SAAS,EAAEA,IAAE;AAAC,EAAAA,GAAE,QAAQD,EAAC,GAAEC,GAAE,KAAK,IAAI;AAAA;AAAA,EAExC;AAAC;;;ACrB0oB,SAAS,EAAEC,IAAEC,IAAE;AAAC,QAAK,EAAC,QAAO,GAAE,YAAW,EAAC,IAAED;AAAE,EAAAC,GAAE,oBAAkBA,GAAE,aAAWA,GAAE,eAAa,EAAE,IAAI,4BAA2B,MAAM,GAAEA,GAAE,aAAW,EAAE,SAAS,IAAI,IAAI,EAAE,iBAAgB,OAAG,EAAE,OAAO,OAAO,CAAC,GAAE,EAAE,SAAS,IAAI,IAAI,EAAE,iBAAgB,OAAG,EAAE,OAAO,OAAO,CAAC,GAAE,EAAE,SAAS,IAAI,IAAI,EAAE,gBAAe,OAAG,EAAE,OAAO,MAAM,CAAC,GAAE,EAAE,SAAS,IAAI,IAAI,EAAE,gBAAe,OAAG,EAAE,OAAO,MAAM,CAAC,GAAE,EAAE,SAAS,IAAI,IAAI,EAAE,kBAAiB,OAAG,EAAE,OAAO,QAAQ,CAAC,GAAE,EAAE,SAAS,IAAI,IAAIC,GAAE,0BAAyB,OAAG,EAAE,sBAAsB,CAAC,GAAE,EAAE,SAAS,IAAI,IAAI,EAAE,kBAAiB,OAAG,EAAE,cAAc,CAAC,GAAE,EAAE,KAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQxtC,GAAE,EAAE,KAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAOPD,GAAE,kBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAOjB,EAAE;AAAA,KACN,KAAG,EAAE,KAAK,IAAI;AAAA,gEAC6C,GAAED,GAAE,OAAO,QAAQG,EAAC,GAAEF,GAAE,cAAY,EAAE,UAAU,IAAI,iBAAgB,OAAME,EAAC,GAAE,EAAE,SAAS,IAAI,IAAI,EAAE,iBAAgB,OAAG,EAAE,QAAQ,QAAOA,EAAC,GAAE,IAAIC,GAAE,iBAAgB,OAAG,EAAE,QAAQ,QAAOD,EAAC,GAAE,IAAIC,GAAE,mBAAkB,OAAG,EAAE,QAAQ,UAAS,EAAC,aAAY,KAAE,CAAC,CAAC,GAAEH,GAAE,oBAAkBD,GAAE,OAAO,QAAQ,CAAC,GAAEA,GAAE,OAAO,QAAQ,CAAC,IAAG,EAAE,KAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAuBvXC,GAAE,kBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAQZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAQD;AAAA,KACR,KAAG,EAAE,KAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,EAKjB;AAAC;",
  "names": ["r", "e", "u", "c", "t", "r", "e"]
}
