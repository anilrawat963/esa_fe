import {
  p as p2
} from "./chunk-EXLKWVG4.js";
import {
  f as f5,
  l2 as l5,
  t as t10
} from "./chunk-Q4G6BRR7.js";
import {
  v as v3
} from "./chunk-RGS3EXFB.js";
import {
  a as a11
} from "./chunk-2NWCGDTW.js";
import {
  g as g3,
  o as o9
} from "./chunk-XT4FPCQ7.js";
import {
  h as h7
} from "./chunk-MGOPGTLA.js";
import {
  a as a10,
  o as o8,
  u as u4
} from "./chunk-FCCU7SSP.js";
import {
  a as a9,
  m as m5
} from "./chunk-TCP5RDVE.js";
import {
  l as l4,
  n as n12
} from "./chunk-4R2LU43U.js";
import {
  h as h6
} from "./chunk-7LPDSYJP.js";
import {
  t as t9
} from "./chunk-O53GWXXZ.js";
import {
  a as a6,
  a3 as a7,
  c2 as c7,
  d as d2,
  d2 as d3,
  e2 as e6,
  f as f4,
  h2 as h5,
  i2 as i6,
  i3 as i7,
  l as l3,
  m2 as m3,
  p,
  s as s4,
  s2 as s5,
  t as t7
} from "./chunk-VIIQX37N.js";
import {
  n as n11
} from "./chunk-UR6CZJPX.js";
import {
  r as r10
} from "./chunk-QTS3W27E.js";
import {
  o as o6
} from "./chunk-3RABUJDL.js";
import {
  _ as _4,
  a as a8,
  g as g2,
  i as i8,
  i2 as i9,
  j as j4,
  m as m4,
  s as s6,
  t as t6,
  tt
} from "./chunk-CYVJEU2B.js";
import {
  T,
  _ as _3,
  d,
  r as r9
} from "./chunk-FDSAQJ3R.js";
import {
  b as b5,
  f as f3,
  o as o5,
  t2 as t5,
  u as u3
} from "./chunk-I4DSU5MJ.js";
import {
  e as e7,
  t as t4,
  t2 as t8
} from "./chunk-F43BIMML.js";
import {
  o2 as o7
} from "./chunk-BZBDEPRV.js";
import {
  c as c6
} from "./chunk-BZV32YR7.js";
import {
  D,
  P,
  S2 as S
} from "./chunk-U6CJFTOF.js";
import {
  h as h3
} from "./chunk-C7T2CCN3.js";
import {
  m as m2
} from "./chunk-2JMKFI2D.js";
import {
  j as j3,
  v as v2,
  w as w2
} from "./chunk-WBXDB33U.js";
import {
  Q as Q2
} from "./chunk-2AOVWXAQ.js";
import {
  n as n10
} from "./chunk-ALR6N4CF.js";
import {
  c as c5,
  f as f2,
  s as s3,
  u as u2
} from "./chunk-TLTSPUO7.js";
import {
  a as a5,
  n as n7
} from "./chunk-ZVTEFYZX.js";
import {
  a as a4,
  s,
  z
} from "./chunk-LPUPM55U.js";
import {
  w as w3
} from "./chunk-T3SYSTKO.js";
import {
  A as A2,
  h as h4
} from "./chunk-U55FA2EK.js";
import {
  R,
  _ as _2,
  n as n9
} from "./chunk-QNVJVDYZ.js";
import {
  n as n8
} from "./chunk-WDTGOP77.js";
import {
  A,
  E,
  H,
  c as c4,
  g,
  j as j2,
  o as o4,
  r as r8,
  s as s2,
  y
} from "./chunk-VYMBX5H5.js";
import {
  F,
  f
} from "./chunk-XDLV73DB.js";
import {
  r as r3
} from "./chunk-EM7Y2JZC.js";
import {
  e as e5,
  i as i5
} from "./chunk-QHCKOBU7.js";
import {
  e as e4,
  r as r7
} from "./chunk-K2OZ6WVC.js";
import {
  o as o3
} from "./chunk-DTZUXJMD.js";
import {
  Q,
  X,
  b as b3,
  c as c3,
  h as h2,
  i as i4,
  n as n6,
  q
} from "./chunk-XLOINTMG.js";
import {
  c as c2,
  n as n5,
  r as r5
} from "./chunk-75XOUSSS.js";
import {
  e as e3
} from "./chunk-3OVERDFX.js";
import {
  G,
  a as a3,
  i as i3
} from "./chunk-FPMLKIDB.js";
import {
  _,
  b as b4,
  e as e2,
  j,
  l as l2,
  o as o2,
  r as r6,
  u,
  v,
  x
} from "./chunk-AZXJIEZ6.js";
import {
  a as a2,
  h,
  l,
  w
} from "./chunk-2OFHDVO5.js";
import {
  i as i2
} from "./chunk-TFJXG32O.js";
import {
  b as b2,
  o,
  r as r4
} from "./chunk-SMWUT52Z.js";
import {
  t as t3
} from "./chunk-6KIXN4DJ.js";
import {
  b,
  e4 as e,
  m,
  n2 as n4
} from "./chunk-5EI5H4QX.js";
import {
  a2 as a
} from "./chunk-ZIE53VIV.js";
import {
  __decorate
} from "./chunk-SS5CLIUY.js";
import {
  n as n3
} from "./chunk-45CFSCQX.js";
import {
  r as r2
} from "./chunk-A5XN2VFT.js";
import {
  n as n2,
  t
} from "./chunk-4DGC7CBY.js";
import {
  r2 as r,
  t2
} from "./chunk-GNMPGHLQ.js";
import {
  i3 as i
} from "./chunk-QY7XKUIV.js";
import {
  c,
  has,
  n
} from "./chunk-AL6YUTZM.js";

// node_modules/@arcgis/core/views/3d/terrain/Overlay.js
var r11 = class {
  constructor() {
    this._extent = i3(), this.resolution = 0, this.renderLocalOrigin = t10(0, 0, 0, "O"), this.pixelRatio = 1, this.mapUnitsPerPixel = 1, this.canvasGeometries = new o10();
  }
  get extent() {
    return this._extent;
  }
  setExtent(t15) {
    a4(this._extent, t15);
  }
  setupGeometryViews(e9) {
    if (this._setupGeometryView(), !e9) return;
    const t15 = 1e-3 * e9.range;
    if (this._extent[0] - t15 <= e9.min) {
      const t16 = this.canvasGeometries.extents[this.canvasGeometries.numViews++];
      G(this._extent, e9.range, 0, t16);
    }
    if (this._extent[2] + t15 >= e9.max) {
      const t16 = this.canvasGeometries.extents[this.canvasGeometries.numViews++];
      G(this._extent, -e9.range, 0, t16);
    }
  }
  _setupGeometryView() {
    this.canvasGeometries.numViews = 1, a3(this.canvasGeometries.extents[0], this._extent);
  }
  hasSomeSizedView() {
    for (let e9 = 0; e9 < this.canvasGeometries.numViews; e9++) {
      const t15 = this.canvasGeometries.extents[e9];
      if (t15[0] !== t15[2] && t15[1] !== t15[3]) return true;
    }
    return false;
  }
};
var o10 = class {
  constructor() {
    this.extents = [i3(), i3(), i3()], this.numViews = 0;
  }
};

// node_modules/@arcgis/core/views/3d/terrain/OverlayFramebufferObject.js
var t11 = class {
  constructor(e9, t15, h10) {
    this._fbos = e9, this._format = t15, this._name = h10;
  }
  get valid() {
    return null != this._handle?.getTexture();
  }
  dispose() {
    this._handle = t2(this._handle);
  }
  get texture() {
    return this._handle?.getTexture();
  }
  ensureFramebuffer(e9, t15) {
    this._handle && this._handle.fbo?.width === e9 && this._handle.fbo?.height === t15 || (this._handle?.release(), this._handle = this._fbos.acquire(e9, t15, this._name, this._format));
  }
  bind(e9) {
    e9.bindFramebuffer(this._handle?.fbo);
  }
  generateMipMap() {
    this._handle?.getTexture()?.descriptor?.hasMipmap && this._handle?.getTexture()?.generateMipmap();
  }
};

// node_modules/@arcgis/core/views/3d/terrain/OverlayRenderTargets.js
var r12 = class {
  constructor(t15, r18, s14, o14, i12 = 1, a16 = 6) {
    this.output = s14, this.content = o14, this.redrawOnRequest = i12, this.fbo = new t11(t15, a16, r18);
  }
  handleRenderRequest(e9) {
    return 1 === e9 || e9 === this.redrawOnRequest;
  }
  get valid() {
    return this.fbo.valid;
  }
};
var s7 = class {
  constructor(e9) {
    this.targets = [new r12(e9, "overlay color", 0, 0), new r12(e9, "overlay IM color", 0, 1), new r12(e9, "overlay highlight", 9, 2, 1, 3), new r12(e9, "overlay water", 3, 3, 0), new r12(e9, "overlay occluded", 0, 4)], e7() && this.targets.push(new r12(e9, "overlay olid", 10, 5, 1, 5));
  }
  getTexture(e9) {
    return this.targets[e9]?.fbo.texture;
  }
  dispose(e9) {
    if (0 !== e9) for (const t15 of this.targets) t15.fbo.dispose();
    else this.targets[3].fbo.dispose();
  }
  computeValidity() {
    return this.targets.reduce((e9, t15, r18) => t15.valid ? e9 |= 1 << r18 : e9, 0);
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/effects/RenderPlugin.js
var r13 = { required: [] };
var s8 = class extends b {
  precompile(e9) {
    return !!this.acquireTechniques(e9);
  }
  consumes() {
    return r13;
  }
  get usedMemory() {
    return 0;
  }
  get renderOccludedFlags() {
    return 1;
  }
  get isDecoration() {
    return false;
  }
  get readyToRun() {
    return false;
  }
  get numGeometries() {
    return 0;
  }
  get hasOccludees() {
    return false;
  }
  get hasEmitters() {
    return false;
  }
  forEachGeometry(e9) {
  }
};
var n13 = class extends s8 {
};
var u5 = class extends s8 {
};

// node_modules/@arcgis/core/views/3d/webgl-engine/effects/highlight/HighlightApplyTechnique.js
var n14 = class extends m4 {
  constructor(r18, o14) {
    super(r18, o14, new t6(a11, () => import("./HighlightApply.glsl-DKXLOSN2.js")), n10(i8));
  }
  initializePipeline() {
    return T({ blending: r9, colorWrite: d });
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/effects/highlight/HighlightBlurTechnique.js
var a12 = class extends m4 {
  constructor(r18, i12) {
    super(r18, i12, new t6(g3, () => import("./HighlightBlur.glsl-KIT5KVXS.js")), n10(i8));
  }
  initializePipeline() {
    return T({ colorWrite: d });
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/effects/highlight/HighlightDownsampleTechnique.js
var l6 = class extends m4 {
  constructor(r18, i12) {
    super(r18, i12, new t6(a10, () => import("./HighlightDownsample.glsl-3VMKONNJ.js")), s6);
  }
  initializePipeline() {
    return T({ colorWrite: d });
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/effects/highlight/HighlightPassParameters.js
var e8 = class extends c6 {
  constructor() {
    super(...arguments), this.occludedFactor = w3, this.verticalCellCount = 0, this.horizontalCellCount = 0, this.highlightLevel = 0, this.pixelRatio = 1;
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/effects/highlight/HighlightToSingleTechnique.js
var a13 = class extends m4 {
  constructor(r18, t15) {
    super(r18, t15, new t6(h7, () => import("./HighlightToSingle.glsl-347W6ROJ.js")), n10(i8));
  }
  initializePipeline() {
    return T({ colorWrite: d });
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexArrayObject.js
var r14 = class extends h6 {
};

// node_modules/@arcgis/core/views/3d/webgl-engine/effects/highlight/Highlight.js
var q2 = class extends a8 {
  constructor() {
    super(...arguments), this.produces = j4.HIGHLIGHTS, this.consumes = { required: [j4.HIGHLIGHTS, "highlights"] }, this._downsampleDrawParameters = new o8(), this._passParameters = new e8(), this._highlightBlurDrawParameters = new o9(), this._grid = new P2();
  }
  initialize() {
    this.addHandles([l(() => this._updateOptionsTexture(), () => {
    }, h)]);
  }
  destroy() {
    this._grid.coverage = t2(this._grid.coverage), this._grid.vao = r(this._grid.vao), this._passParameters.highlightOptionsTexture = t2(this._passParameters.highlightOptionsTexture);
  }
  _updateOptionsTexture() {
    if (null == this._passParameters.highlightOptionsTexture) {
      const e9 = new h4(16, 2);
      e9.internalFormat = 6408, e9.samplingMode = 9728, this._passParameters.highlightOptionsTexture = new A2(this.renderingContext, e9, null);
    }
    this._passParameters.highlightOptionsTexture.setData(O(this.view.state.highlights)), this.requestRender(1);
  }
  precompile() {
    this.techniques.precompile(l6), this.techniques.precompile(a13), this.techniques.precompile(a12), this.techniques.precompile(n14);
  }
  render(e9) {
    const t15 = e9.find(({ name: e10 }) => e10 === j4.HIGHLIGHTS), { techniques: r18, bindParameters: i12 } = this;
    if (!i12.decorations) return t15;
    if (!r18.get(l6).compiled) return this.requestRender(1), t15;
    const s14 = e9.find(({ name: e10 }) => "highlights" === e10).getTexture();
    return this._renderHighlightPostprocess(s14, t15), t15;
  }
  _prepareAndDownSample(e9) {
    this._gridUpdateResources(e9);
    const t15 = this.techniques.get(l6), r18 = this._gridComputeCoverage(t15, e9), { horizontalCellCount: i12, verticalCellCount: s14 } = r18, o14 = this._passParameters;
    return o14.horizontalCellCount = i12, o14.verticalCellCount = s14, o14.coverageTexture = r18.coverage?.getTexture(), r18;
  }
  _renderGrid(e9) {
    const t15 = e9.verticalCellCount * e9.horizontalCellCount;
    this.renderingContext.bindVAO(e9.vao), this.renderingContext.drawElementsInstanced(_2.TRIANGLES, 6, R.UNSIGNED_BYTE, 0, t15);
  }
  _renderHighlightPostprocess(e9, t15) {
    const { fboCache: r18, techniques: i12, bindParameters: s14, _passParameters: o14, renderingContext: h10 } = this, l9 = i12.get(a13), a16 = i12.get(a12), u6 = i12.get(n14);
    if (!u6.compiled || !a16.compiled || !l9.compiled) return void this.requestRender(1);
    o14.highlightTexture = e9;
    const p4 = this._prepareAndDownSample(e9), { width: d5, height: f7 } = e9.descriptor;
    o14.highlightTexture = e9;
    const { camera: b7 } = s14, { fullWidth: w5, fullHeight: x2, pixelRatio: T3, fullViewport: C2 } = b7, _6 = Math.ceil(w5 / T3), v7 = Math.ceil(x2 / T3), { _highlightBlurDrawParameters: j6 } = this, H3 = this.view.stage.renderView.renderer, { highlights: q3 } = s14;
    for (let g7 = 0; g7 < q3.length; ++g7) {
      const { name: e10 } = q3[g7];
      if (!H3.hasHighlight(e10)) continue;
      o14.highlightLevel = g7, h10.setClearColor(0, 0, 0, 0);
      const i13 = r18.acquire(d5, f7, "single highlight", 2);
      h10.bindFramebuffer(i13.fbo), h10.setViewport(0, 0, d5, f7), h10.clear(16384), h10.bindTechnique(l9, s14, o14), this._renderGrid(p4), j6.blurInput = i13.getTexture(), o2(j6.blurSize, 1 / _6, 0);
      const c9 = r18.acquire(_6, v7, "single highlight blur", 2);
      h10.unbindTexture(c9.fbo?.colorTexture), h10.bindFramebuffer(c9.fbo), h10.setViewport(0, 0, _6, v7), h10.clear(16384), h10.bindTechnique(a16, s14, o14, j6), this._renderGrid(p4), i13.release(), o2(j6.blurSize, 0, 1 / v7), o14.highlightBlurTexture = c9.getTexture(), h10.bindFramebuffer(t15.fbo), h10.setViewport4fv(C2), h10.bindTechnique(u6, s14, o14, j6), this._renderGrid(p4), c9.release();
    }
    o14.coverageTexture = o14.highlightTexture = null;
  }
  _gridUpdateResources(e9) {
    const t15 = this._grid, { width: r18, height: i12 } = e9.descriptor;
    if (t15.horizontalCellCount = Math.ceil(r18 / u4), t15.verticalCellCount = Math.ceil(i12 / u4), t15.vao) return;
    const s14 = this.renderingContext, o14 = o6.createIndex(s14, 35044, S2);
    t15.vao = new r14(s14, new r10(s14, i8), o14);
  }
  _gridComputeCoverage(e9, t15) {
    const r18 = this.renderingContext, i12 = this._grid, s14 = t15.descriptor, o14 = Math.ceil(s14.width / u4), h10 = Math.ceil(s14.height / u4);
    this._downsampleDrawParameters.input = t15;
    const { highlights: n17 } = this.bindParameters;
    i12.coverage?.release();
    const l9 = this.fboCache.acquire(o14, h10, "highlight coverage", n17.length > I ? 3 : 1);
    return i12.coverage = l9, r18.bindFramebuffer(l9.fbo), r18.bindTechnique(e9, this.bindParameters, this._passParameters, this._downsampleDrawParameters), r18.setViewport(0, 0, o14, h10), r18.screen.draw(), i12;
  }
  get test() {
  }
};
__decorate([m()], q2.prototype, "produces", void 0), __decorate([m()], q2.prototype, "consumes", void 0), q2 = __decorate([a("esri.views.3d.webgl-engine.effects.highlight.Highlight")], q2);
var P2 = class {
  constructor() {
    this.coverage = null, this.vao = null, this.verticalCellCount = 0, this.horizontalCellCount = 0, this.viewportWidth = 0, this.viewportHeight = 0;
  }
};
function O(e9) {
  const t15 = new Uint8Array(128);
  let r18 = 0;
  for (const i12 of e9) {
    const e10 = 4 * r18, s14 = 4 * r18 + 64;
    ++r18;
    const { color: o14 } = i12, h10 = i12.haloColor ?? o14;
    t15[e10 + 0] = o14.r, t15[e10 + 1] = o14.g, t15[e10 + 2] = o14.b, t15[e10 + 3] = i12.fillOpacity * o14.a * 255, t15[s14 + 0] = h10.r, t15[s14 + 1] = h10.g, t15[s14 + 2] = h10.b, t15[s14 + 3] = i12.haloOpacity * h10.a * 255;
  }
  return t15;
}
var y2 = 0;
function D2(e9) {
  let t15 = 0;
  for (const i12 of e9) {
    const { name: e10 } = i12;
    t15 += e10.length;
    const { color: r19, fillOpacity: s14, haloColor: o14, haloOpacity: h10 } = i12;
    t15 += r19.r + r19.g + r19.b + r19.a + s14, t15 += o14 ? o14.r + o14.g + o14.b + o14.a + h10 : 0;
  }
  const r18 = e9.at(0);
  if (r18) {
    const { shadowOpacity: e10, shadowDifference: i12, shadowColor: s14 } = r18;
    t15 += e10 + i12 + s14.r + s14.g + s14.b + s14.a;
  }
  return y2++ + (t15 >= 0 ? 0 : 1);
}
var S2 = new Uint8Array([0, 1, 2, 2, 1, 3]);
function G2(e9, t15, r18, i12, s14, o14 = 0) {
  const { highlights: h10 } = i12, l9 = h10.length > 1 ? t15.acquire(r18.width, r18.height, "highlight mix", h10.length > I ? 3 : 1) : null, { gl: a16 } = e9;
  if (l9) {
    const t16 = e9.getBoundFramebufferObject();
    e9.bindFramebuffer(l9.fbo), a16.clearBufferuiv(a16.COLOR, 0, [0, 0, 0, 0]), e9.bindFramebuffer(t16);
  }
  const g7 = l9?.getTexture();
  i12.highlightMixTexture = g7, o2(i12.highlightMixOrigin, o14, 0), h10.forEach((t16, h11) => {
    if (h11 > 0) {
      const t17 = A2.TEXTURE_UNIT_FOR_UPDATES;
      e9.bindTexture(g7, t17), e9.setActiveTexture(t17), a16.copyTexSubImage2D(3553, 0, 0, 0, o14, 0, r18.width, r18.height), e9.bindTexture(null, t17);
    }
    e9.clear(256), i12.highlightLevel = h11, s14();
  }), i12.highlightLevel = null, i12.highlightMixTexture = null, l9?.release();
}
var I = 4;

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/GLMaterialParameters.js
var t12 = class {
  constructor(t15, s14, e9, i12) {
    this.material = t15, this.output = s14, this.techniques = e9, this.textures = i12;
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/GLMaterialRepository.js
var a14 = class {
  constructor(e9, t15, i12, s14) {
    this._textures = e9, this._techniques = t15, this.materialChanged = i12, this.requestRender = s14, this._id2glMaterialRef = new t9();
  }
  dispose() {
    this._textures.destroy();
  }
  acquire(e9, t15, r18) {
    this._ownMaterial(e9);
    const s14 = e9.produces.get(t15);
    if (!s14?.(r18)) return null;
    let a16 = this._id2glMaterialRef.get(r18, e9.id);
    if (null == a16) {
      const t16 = e9.createGLMaterial(new t12(e9, r18, this._techniques, this._textures));
      a16 = new o11(t16), this._id2glMaterialRef.set(r18, e9.id, a16);
    }
    return a16.ref(), a16.glMaterial;
  }
  release(e9, r18) {
    const i12 = this._id2glMaterialRef.get(r18, e9.id);
    null != i12 && (i12.unref(), i12.referenced || (r(i12.glMaterial), this._id2glMaterialRef.delete(r18, e9.id)));
  }
  _ownMaterial(t15) {
    t15.repository && t15.repository !== this && i.getLogger("esri.views.3d.webgl-engine.lib.GLMaterialRepository").error("Material is already owned by a different material repository"), t15.repository = this;
  }
};
var o11 = class {
  constructor(e9) {
    this.glMaterial = e9, this._refCnt = 0;
  }
  ref() {
    ++this._refCnt;
  }
  unref() {
    --this._refCnt, s3(this._refCnt >= 0);
  }
  get referenced() {
    return this._refCnt > 0;
  }
};

// node_modules/@arcgis/core/views/3d/environment/Clouds.js
function n15(n17) {
  return null != n17 && !n17.readyToRun;
}

// node_modules/@arcgis/core/views/3d/environment/CloudsParameters.js
var v4 = class {
  constructor() {
    this.startTime = 0, this._data = r3(null), this.coverage = 0, this.absorption = 0, this._readChannels = 0, this.parallax = new g4(), this.parallaxNew = new g4(), this._anchorPoint = n5(), this._fadeState = r3(0), this._fadeFactor = r3(1);
  }
  get data() {
    return this._data.value;
  }
  set data(t15) {
    this._data.value = t15;
  }
  get readChannels() {
    return this._readChannels;
  }
  get fadeState() {
    return this._fadeState.value;
  }
  get fadeFactor() {
    return this._fadeFactor.value;
  }
  get opacity() {
    switch (this.fadeState) {
      case 0:
        return 0;
      case 4:
        return 1 - this.fadeFactor;
      case 1:
        return this.fadeFactor;
      case 2:
      case 3:
        return 1;
    }
  }
  fade(t15, e9, s14) {
    this.isFading && this.fadeFactor < 1 && (this._fadeFactor.value = s14 ? r4((e9 - this.startTime) / (b6 * s14), 0, 1) : 1, 1 === this.fadeFactor && this._endFade()), this._evaluateState(t15, e9), this._updateParallax(t15);
  }
  _evaluateState(t15, a16) {
    const e9 = t15.relativeElevation, s14 = this._updateAnchorPoint(t15);
    (e9 > 1.7 * p2 || e9 < -p2 || s14 > k) && this.opacity > 0 ? this._startFade(0, a16) : this.isFading || (e9 > p2 || e9 < -0.35 * p2 || s14 > j5 * k ? this.opacity > 0 && this._startFade(4, a16) : n15(this.data) && (0 === this.opacity ? this._startFade(1, a16) : 2 === this.data.state && (2 === this.fadeState ? this._startFade(3, a16) : this._startFade(2, a16))));
  }
  _updateParallax(t15) {
    const a16 = j2(t15.eye);
    this.parallax.radiusCurvatureCorrection = 0.84 * Math.sqrt(Math.max(a16 - t3.radius * t3.radius, 0)) / Math.sqrt(a16), v2(w4, this.parallax.anchorPoint, S3), b3(this.parallax.transform, r7, S3[3], w2(S3)), v2(w4, this.parallaxNew.anchorPoint, S3), b3(this.parallaxNew.transform, r7, S3[3], w2(S3));
  }
  _updateAnchorPoint(t15) {
    return A(this._anchorPoint, t15.eye), g(this._anchorPoint, this._anchorPoint, t3.radius), 0 === this.fadeState && 2 === this.data?.state ? (s2(this.parallax.anchorPoint, this._anchorPoint), 0) : r8(c4(C, this.parallax.anchorPoint, this._anchorPoint));
  }
  requestFade() {
    this._fadeFactor.value = 0;
  }
  _startFade(t15, a16) {
    switch (this._fadeState.value = t15, this.startTime = a16, t15) {
      case 3:
        this.requestFade(), this._switchReadChannels(), s2(this.parallaxNew.anchorPoint, this._anchorPoint);
        break;
      case 1:
        this.requestFade(), this._switchReadChannels(), s2(this.parallax.anchorPoint, this._anchorPoint), s2(this.parallaxNew.anchorPoint, this._anchorPoint);
        break;
      case 4:
        this.requestFade();
        break;
      case 2:
        this._switchReadChannels(), s2(this.parallax.anchorPoint, this._anchorPoint), s2(this.parallaxNew.anchorPoint, this._anchorPoint), this._endFade();
        break;
      case 0:
        this._endFade();
    }
  }
  _endFade() {
    switch (this._fadeFactor.value = 1, this.data && 2 !== this.data.state && (this.data.state = 0), this.fadeState) {
      case 3:
        s2(this.parallax.anchorPoint, this.parallaxNew.anchorPoint), this._fadeState.value = 2;
        break;
      case 1:
        this._fadeState.value = 2;
        break;
      case 4:
        this._fadeState.value = 0;
        break;
      case 2:
      case 0:
        break;
      default:
        n(this.fadeState);
    }
  }
  _switchReadChannels() {
    2 === this.data?.state && (this._readChannels = 1 - this._readChannels, this.data.state = 3);
  }
  get isFading() {
    return 4 === this.fadeState || 1 === this.fadeState || 3 === this.fadeState;
  }
};
var g4 = class {
  constructor() {
    this.anchorPoint = n5(), this.radiusCurvatureCorrection = 0, this.transform = e4();
  }
};
var w4 = r5(0, 0, 1);
var S3 = j3();
var C = n5();
var b6 = 1.25;
var j5 = 0.5;
var k = 2e5;

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/BindParameters.js
var g5 = class {
  constructor(i12) {
    this.shadowMap = i12, this.slot = 2, this.slicePlane = null, this.hasOccludees = false, this.enableFillLights = true, this.oitPass = 0, this.alignPixelEnabled = false, this.decorations = true, this.overlayStretch = 1, this.viewshedEnabled = false, this.cutFillEnabled = false, this._camera = new tt(), this._inverseViewport = n8(), this._oldLighting = new _4(), this._newLighting = new _4(), this._fadedLighting = new _4(), this._lighting = this._newLighting, this.ssr = new r15(), this.terrainDepthTest = false, this.cullAboveTerrain = false, this.highlights = new Array(), this.highlightOrderMap = /* @__PURE__ */ new Map(), this.highlightMixOrigin = n8(), this.highlightMixTexture = null, this.hudRenderStyle = 0, this.hudOccludedFragmentOpacity = 1, this.snowCover = 0, this.clouds = new v4(), this.shadowHighlightsVisible = false;
  }
  destroy() {
    this._camera = null, this.contentCamera = null, this.depth = null, this.geometryDepth = null, this.mainDepth = null, this.overlay = null, this.ssao = null, this.terrainDepth = null;
  }
  get camera() {
    return this._camera;
  }
  set camera(i12) {
    this._camera = i12, this._inverseViewport[0] = 1 / i12.fullViewport[2], this._inverseViewport[1] = 1 / i12.fullViewport[3];
  }
  get inverseViewport() {
    return this._inverseViewport;
  }
  get lighting() {
    return this._lighting;
  }
  fadeLighting() {
    switch (this.clouds.fadeFactor) {
      case 0:
        this._lighting = this._oldLighting;
        break;
      default:
        this._fadedLighting.lerpLighting(this._oldLighting, this._newLighting, this.clouds.fadeFactor), this._lighting = this._fadedLighting;
        break;
      case 1:
        this._lighting = this._newLighting, this._oldLighting.copyFrom(this._newLighting);
    }
  }
  updateLighting(i12, t15, h10, e9) {
    this._oldLighting.copyFrom(this.lighting), this._newLighting.noonFactor = t15, this._newLighting.globalFactor = h10, this._newLighting.set(i12), this._oldLighting.updateLegacy(), 1 === e9 && this.clouds.requestFade(), this.fadeLighting();
  }
  get highlight() {
    return null == this.highlightLevel ? null : this.highlights[this.highlightLevel];
  }
};
var r15 = class {
  constructor() {
    this.fadeFactor = 1, this.reprojectionMatrix = e4();
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/RenderContext.js
var r16 = class {
  constructor(r18, a16, m7) {
    this.rctx = r18, this.techniques = m7, this.lastFrameCamera = new tt(), this.output = 0, this.renderOccludedMask = s9, this.time = n3(0), this.bind = new g5(a16), this.bind.alignPixelEnabled = true;
  }
};
var s9 = 13;

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/CascadeCamera.js
var i10 = class extends tt {
  constructor() {
    super(...arguments), this._projectionMatrix = e4();
  }
  get projectionMatrix() {
    return this._projectionMatrix;
  }
};
__decorate([m()], i10.prototype, "_projectionMatrix", void 0), __decorate([m({ readOnly: true })], i10.prototype, "projectionMatrix", null), i10 = __decorate([a("esri.views.3d.webgl-engine.lib.CascadeCamera")], i10);

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/ShadowMap.js
var R2 = class {
  constructor() {
    this.camera = new i10(), this.lightMat = e4();
  }
};
var W = class {
  constructor() {
    this.maxNumCascadesHighQuality = 4, this.maxNumCascadesLowQuality = 4, this.textureSizeModHighQuality = 1.3, this.textureSizeModLowQuality = 0.9, this.splitSchemeLambda = 0;
  }
};
var z2 = class {
  constructor(t15, s14) {
    this._fbos = t15, this._viewingMode = s14, this._snapshots = new Array(), this._textureHeight = 0, this._numCascades = 1, this.settings = new W(), this._projectionView = e4(), this._projectionViewInverse = e4(), this._modelViewLight = e4(), this._cascadeDistances = [0, 0, 0, 0, 0], this._usedCascadeDistances = n7(), this._cascades = [new R2(), new R2(), new R2(), new R2()], this._lastOrigin = null, this._enabled = false, this._maxTextureWidth = Math.min(has("esri-mobile") ? 4096 : 16384, t15.rctx.parameters.maxTextureSize);
  }
  dispose() {
    this.enabled = false, this.disposeOffscreenBuffers();
  }
  get depthTexture() {
    return this._handle?.getTexture(n9);
  }
  get _textureWidth() {
    return this._textureHeight * this._numCascades;
  }
  get numCascades() {
    return this._numCascades;
  }
  get cascadeDistances() {
    return s(this._usedCascadeDistances, this._cascadeDistances[0], this._numCascades > 1 ? this._cascadeDistances[1] : 1 / 0, this._numCascades > 2 ? this._cascadeDistances[2] : 1 / 0, this._numCascades > 3 ? this._cascadeDistances[3] : 1 / 0);
  }
  disposeMainBuffer() {
    this._handle = t2(this._handle);
  }
  disposeOffscreenBuffers() {
    this.disposeMainBuffer(), this._discardSnapshots();
  }
  set maxCascades(s14) {
    this.settings.maxNumCascadesHighQuality = r4(Math.floor(s14), 1, 4);
  }
  get maxCascades() {
    return this.settings.maxNumCascadesHighQuality;
  }
  set enabled(t15) {
    this._enabled = t15, t15 || this.disposeOffscreenBuffers();
  }
  get enabled() {
    return this._enabled;
  }
  get ready() {
    return this._enabled && null != this.depthTexture;
  }
  get cascades() {
    for (let t15 = 0; t15 < this._numCascades; ++t15) X2[t15] = this._cascades[t15];
    return X2.length = this._numCascades, X2;
  }
  start(t15, s14, e9, i12, a16) {
    s3(this.enabled);
    const { near: r18, far: h10 } = xt(e9);
    this._computeCascadeDistances(r18, h10, i12), this._textureHeight = this._computeTextureHeight(t15, a16, i12), this._setupMatrices(t15, s14);
    const { viewMatrix: n17, projectionMatrix: o14 } = t15;
    for (let c9 = 0; c9 < this._numCascades; ++c9) this._constructCascade(c9, o14, n17, s14);
    this._lastOrigin = null, this.clear();
  }
  finish() {
    s3(this.enabled);
  }
  getShadowMapMatrices(t15) {
    if (!this._lastOrigin || !H(t15, this._lastOrigin)) {
      this._lastOrigin = this._lastOrigin || n5(), s2(this._lastOrigin, t15);
      for (let s14 = 0; s14 < this._numCascades; ++s14) {
        i4(Z, this._cascades[s14].lightMat, t15);
        for (let t16 = 0; t16 < 16; ++t16) $[16 * s14 + t16] = Z[t16];
      }
    }
    return $;
  }
  moveSnapshot(t15) {
    s3(this.enabled), this._snapshots[t15]?.release(), this._snapshots[t15] = this._handle, this._handle?.setName(0 === t15 ? "shadow map highlight" : "shadow map excluding highlight"), this._handle = null;
  }
  copySnapshot(t15) {
    if (!this.enabled) return;
    const s14 = this._handle?.getTexture(n9)?.descriptor;
    if (!s14) return;
    this._snapshots[t15]?.release();
    const e9 = 0 === t15 ? "shadow map highlight" : "shadow map excluding highlight", i12 = this._acquireFBO(e9);
    this._snapshots[t15] = i12;
    const a16 = this._handle?.fbo;
    if (!a16 || !i12?.fbo) return void console.error("No FBO");
    const { rctx: r18 } = this._fbos;
    r18.blitFramebuffer(a16, i12.fbo, 256);
  }
  getSnapshot(t15) {
    return this.enabled ? this._snapshots[t15]?.getTexture(n9) : null;
  }
  clear() {
    this._ensureFbo(), this.bindFbo(), this._fbos.rctx.clear(256);
  }
  _computeTextureHeight({ pixelRatio: t15, fullWidth: s14, fullHeight: e9 }, i12, a16) {
    const r18 = Math.min(window.devicePixelRatio, i12) / t15, h10 = a16 ? this.settings.textureSizeModHighQuality : this.settings.textureSizeModLowQuality;
    return n11(Math.max(s14, e9) * r18 * h10, this._maxTextureWidth / this._numCascades);
  }
  _ensureFbo() {
    this._handle?.fbo?.width === this._textureWidth && this._handle?.fbo.height === this._textureHeight || (this._handle?.release(), this._handle = this._acquireFBO("shadow map"));
  }
  _acquireFBO(t15) {
    const s14 = this._fbos.acquire(this._textureWidth, this._textureHeight, t15, 12);
    return s14.getTexture(n9)?.setShadowFiltering(true), s14;
  }
  _discardSnapshot(t15) {
    this._snapshots[t15] = t2(this._snapshots[t15]);
  }
  _discardSnapshots() {
    for (let t15 = 0; t15 < this._snapshots.length; ++t15) this._discardSnapshot(t15);
    this._snapshots.length = 0;
  }
  bindFbo() {
    this._fbos.rctx.bindFramebuffer(this._handle?.fbo);
  }
  _constructCascade(t15, s14, e9, i12) {
    const a16 = this._cascades[t15], n17 = -this._cascadeDistances[t15], o14 = -this._cascadeDistances[t15 + 1], c9 = (s14[10] * n17 + s14[14]) / Math.abs(s14[11] * n17 + s14[15]), l9 = (s14[10] * o14 + s14[14]) / Math.abs(s14[11] * o14 + s14[15]);
    s3(c9 < l9);
    for (let r18 = 0; r18 < 8; ++r18) {
      s(I2, r18 % 4 == 0 || r18 % 4 == 3 ? -1 : 1, r18 % 4 == 0 || r18 % 4 == 1 ? -1 : 1, r18 < 4 ? c9 : l9, 1);
      const t16 = U[r18];
      z(t16, I2, this._projectionViewInverse), t16[0] /= t16[3], t16[1] /= t16[3], t16[2] /= t16[3];
    }
    y(K, U[0]), a16.camera.viewMatrix = i4(A3, this._modelViewLight, K);
    for (let r18 = 0; r18 < 8; ++r18) E(U[r18], U[r18], a16.camera.viewMatrix);
    let d5 = U[0][2], u6 = U[0][2];
    for (let r18 = 1; r18 < 8; ++r18) d5 = Math.min(d5, U[r18][2]), u6 = Math.max(u6, U[r18][2]);
    d5 -= 200, u6 += 200, a16.camera.near = -u6, a16.camera.far = -d5, pt(e9, i12, d5, u6, a16.camera), c3(a16.lightMat, a16.camera.projectionMatrix, a16.camera.viewMatrix);
    const m7 = this._textureHeight;
    a16.camera.viewport = [t15 * m7, 0, m7, m7];
  }
  _setupMatrices(t15, s14) {
    c3(this._projectionView, t15.projectionMatrix, t15.viewMatrix), h2(this._projectionViewInverse, this._projectionView);
    const e9 = 1 === this._viewingMode ? t15.eye : o4(K, 0, 0, 1);
    X(this._modelViewLight, [0, 0, 0], [-s14[0], -s14[1], -s14[2]], e9);
  }
  _computeCascadeDistances(t15, e9, i12) {
    const a16 = i12 ? this.settings.maxNumCascadesHighQuality : this.settings.maxNumCascadesLowQuality;
    this._numCascades = Math.min(1 + Math.floor(u2(e9 / t15, 4)), a16);
    const r18 = (e9 - t15) / this._numCascades, h10 = (e9 / t15) ** (1 / this._numCascades);
    let n17 = t15, o14 = t15;
    for (let c9 = 0; c9 < this._numCascades + 1; ++c9) this._cascadeDistances[c9] = o(n17, o14, this.settings.splitSchemeLambda), n17 *= h10, o14 += r18;
  }
  get test() {
  }
};
var A3 = e4();
var I2 = n7();
var U = [];
for (let bt = 0; bt < 8; ++bt) U.push(n7());
var k2 = n8();
var P3 = n8();
var E2 = n8();
var G3 = n8();
var J = n8();
var K = n5();
var X2 = [];
var Z = e4();
var $ = r7.concat(r7, r7, r7);
var tt2 = n8();
var st = n8();
var et = [n8(), n8(), n8(), n8()];
var it = n8();
var at = n8();
var rt = n8();
var ht = n8();
var nt = n8();
var ot = n8();
var ct = n8();
function lt(t15, s14, e9, i12, a16, r18, h10, n17) {
  o2(tt2, 0, 0);
  for (let d5 = 0; d5 < 4; ++d5) u(tt2, tt2, t15[d5]);
  l2(tt2, tt2, 0.25), o2(st, 0, 0);
  for (let d5 = 4; d5 < 8; ++d5) u(st, st, t15[d5]);
  l2(st, st, 0.25), _(et[0], t15[4], t15[5], 0.5), _(et[1], t15[5], t15[6], 0.5), _(et[2], t15[6], t15[7], 0.5), _(et[3], t15[7], t15[4], 0.5);
  let o14 = 0, c9 = b4(et[0], tt2);
  for (let d5 = 1; d5 < 4; ++d5) {
    const t16 = b4(et[d5], tt2);
    t16 < c9 && (c9 = t16, o14 = d5);
  }
  e2(it, et[o14], t15[o14 + 4]);
  const l9 = it[0];
  let M, C2;
  it[0] = -it[1], it[1] = l9, e2(at, st, tt2), j(at, it) < 0 && x(it, it), _(it, it, at, e9), v(it, it), M = C2 = j(e2(rt, t15[0], tt2), it);
  for (let d5 = 1; d5 < 8; ++d5) {
    const s15 = j(e2(rt, t15[d5], tt2), it);
    s15 < M ? M = s15 : s15 > C2 && (C2 = s15);
  }
  r6(i12, tt2), l2(rt, it, M - s14), u(i12, i12, rt);
  let j6 = -1, y4 = 1, v7 = 0, S4 = 0;
  for (let d5 = 0; d5 < 8; ++d5) {
    e2(ht, t15[d5], i12), v(ht, ht);
    const s15 = it[0] * ht[1] - it[1] * ht[0];
    s15 > 0 ? s15 > j6 && (j6 = s15, v7 = d5) : s15 < y4 && (y4 = s15, S4 = d5);
  }
  c5(j6 > 0, "leftArea"), c5(y4 < 0, "rightArea"), l2(nt, it, M), u(nt, nt, tt2), l2(ot, it, C2), u(ot, ot, tt2), ct[0] = -it[1], ct[1] = it[0];
  const H3 = f2(i12, t15[S4], ot, u(rt, ot, ct), 1, a16), O2 = f2(i12, t15[v7], ot, rt, 1, r18), D3 = f2(i12, t15[v7], nt, u(rt, nt, ct), 1, h10), F2 = f2(i12, t15[S4], nt, rt, 1, n17);
  c5(H3, "rayRay"), c5(O2, "rayRay"), c5(D3, "rayRay"), c5(F2, "rayRay");
}
function dt(t15, s14) {
  return 3 * s14 + t15;
}
var ut = n8();
function mt(t15, s14) {
  return o2(ut, t15[s14], t15[s14 + 3]), ut;
}
var _t = n8();
var ft = e3();
function gt(t15, s14, e9, i12, a16) {
  e2(_t, e9, i12), l2(_t, _t, 0.5), ft[0] = _t[0], ft[1] = _t[1], ft[2] = 0, ft[3] = _t[1], ft[4] = -_t[0], ft[5] = 0, ft[6] = _t[0] * _t[0] + _t[1] * _t[1], ft[7] = _t[0] * _t[1] - _t[1] * _t[0], ft[8] = 1, ft[dt(0, 2)] = -j(mt(ft, 0), t15), ft[dt(1, 2)] = -j(mt(ft, 1), t15);
  let r18 = j(mt(ft, 0), e9) + ft[dt(0, 2)], h10 = j(mt(ft, 1), e9) + ft[dt(1, 2)], n17 = j(mt(ft, 0), i12) + ft[dt(0, 2)], o14 = j(mt(ft, 1), i12) + ft[dt(1, 2)];
  r18 = -(r18 + n17) / (h10 + o14), ft[dt(0, 0)] += ft[dt(1, 0)] * r18, ft[dt(0, 1)] += ft[dt(1, 1)] * r18, ft[dt(0, 2)] += ft[dt(1, 2)] * r18, r18 = 1 / (j(mt(ft, 0), e9) + ft[dt(0, 2)]), h10 = 1 / (j(mt(ft, 1), e9) + ft[dt(1, 2)]), ft[dt(0, 0)] *= r18, ft[dt(0, 1)] *= r18, ft[dt(0, 2)] *= r18, ft[dt(1, 0)] *= h10, ft[dt(1, 1)] *= h10, ft[dt(1, 2)] *= h10, ft[dt(2, 0)] = ft[dt(1, 0)], ft[dt(2, 1)] = ft[dt(1, 1)], ft[dt(2, 2)] = ft[dt(1, 2)], ft[dt(1, 2)] += 1, r18 = j(mt(ft, 1), s14) + ft[dt(1, 2)], h10 = j(mt(ft, 2), s14) + ft[dt(2, 2)], n17 = j(mt(ft, 1), e9) + ft[dt(1, 2)], o14 = j(mt(ft, 2), e9) + ft[dt(2, 2)], r18 = -0.5 * (r18 / h10 + n17 / o14), ft[dt(1, 0)] += ft[dt(2, 0)] * r18, ft[dt(1, 1)] += ft[dt(2, 1)] * r18, ft[dt(1, 2)] += ft[dt(2, 2)] * r18, r18 = j(mt(ft, 1), s14) + ft[dt(1, 2)], h10 = j(mt(ft, 2), s14) + ft[dt(2, 2)], n17 = -h10 / r18, ft[dt(1, 0)] *= n17, ft[dt(1, 1)] *= n17, ft[dt(1, 2)] *= n17, a16[0] = ft[0], a16[1] = ft[1], a16[2] = 0, a16[3] = ft[2], a16[4] = ft[3], a16[5] = ft[4], a16[6] = 0, a16[7] = ft[5], a16[8] = 0, a16[9] = 0, a16[10] = 1, a16[11] = 0, a16[12] = ft[6], a16[13] = ft[7], a16[14] = 0, a16[15] = ft[8];
}
function pt(t15, s14, i12, a16, r18) {
  const h10 = 1 / U[0][3], n17 = 1 / U[4][3];
  s3(h10 < n17);
  let o14 = h10 + Math.sqrt(h10 * n17);
  const c9 = Math.sin(b2(t15[2] * s14[0] + t15[6] * s14[1] + t15[10] * s14[2]));
  o14 /= c9, lt(U, o14, c9, k2, P3, E2, G3, J), gt(k2, P3, G3, J, r18.projectionMatrix), r18.projectionMatrix[10] = 2 / (i12 - a16), r18.projectionMatrix[14] = -(i12 + a16) / (i12 - a16);
}
function xt(t15) {
  let { near: s14, far: e9 } = t15;
  return s14 < 2 && (s14 = 2), e9 < 2 && (e9 = 2), s14 >= e9 && (s14 = 2, e9 = 4), { near: s14, far: e9 };
}

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/TextureTechnique.js
var a15 = class extends m4 {
  constructor(o14, i12) {
    super(o14, i12, new t6(m5, () => import("./TextureOnly.glsl-G7EO74RS.js")), s6);
  }
  initializePipeline(e9) {
    return e9.hasAlpha ? T({ blending: r9, colorWrite: d }) : T({ colorWrite: d });
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/TextureTechniqueConfiguration.js
var s10 = class extends a6 {
  constructor() {
    super(...arguments), this.hasAlpha = false;
  }
};
__decorate([i6()], s10.prototype, "hasAlpha", void 0);

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/OverlayCompositingTechnique.js
var t13 = class extends m4 {
  constructor(r18, t15) {
    super(r18, t15, new t6(l4, () => import("./OverlayCompositing.glsl-U3MGFWZI.js")), s6);
  }
};

// node_modules/@arcgis/core/views/3d/terrain/OverlayRenderer.js
var I3 = class extends n13 {
  constructor(e9) {
    super(e9), this._overlays = null, this._renderTargets = null, this._overlayParameters = new n12(), this.hasHighlights = false, this.renderOccludedFlags = 1, this._hasWater = false, this._renderers = /* @__PURE__ */ new Map(), this._sortedDrapeSourceRenderersDirty = false, this._sortedRenderers = new r2(), this._passParameters = new a9(), this._screenToWorldRatio = 1, this._localOriginFactory = null, this.unloadedMemory = 0, this.ignoresMemoryFactor = false, this._camera = new tt(), this.events = new i2(), this.longitudeCyclical = null, this.produces = /* @__PURE__ */ new Map([[18, (e10) => 9 !== e10 || this.hasHighlights], [19, () => this._hasWater]]), this._hasTargetWithoutRasterImage = false, this._hasDrapedFeatureSource = false, this._hasDrapedRasterSource = false, this._hasDrapedFlowSource = false;
  }
  initialize() {
    const e9 = this._view, r18 = e9.stage, t15 = r18.renderer.fboCache, { waterTextures: s14, techniques: i12 } = r18.renderView;
    this._renderContext = new r16(this._rctx, new z2(t15, e9.state.viewingMode), i12), this.addHandles([l(() => s14.updating, () => this.events.emit("content-changed"), w), l(() => this._spatialReference, (e10) => this._localOriginFactory = new f5(e10), w), a2(() => e9.allLayerViews, "after-changes", () => this._sortedDrapeSourceRenderersDirty = true), l(() => D2(e9.state.highlights), () => this._sortedDrapeSourceRenderersDirty = true, h), l(() => e9.state.highlights, (r19) => {
      this._bindParameters.highlights = r19, this._bindParameters.highlightOrderMap = e9.state.highlightOrderMap;
    }, h), e9.resourceController.scheduler.registerTask(f.OVERLAY_RENDERER, this)]);
    const { _bindParameters: n17, _camera: o14 } = this;
    o14.near = 1, o14.far = 1e4, o14.relativeElevation = null, n17.slot = 18, n17.mainDepth = null, n17.camera = o14, n17.oitPass = 0, n17.updateLighting([new i9(c2())], 0, 0, 0);
  }
  destroy() {
    this._renderers.forEach((e9) => e9.destroy()), this._renderers.clear(), this._passParameters.texture = r(this._passParameters.texture), this.disposeOverlays(), this._renderContext = null, this._sortedRenderers.prune();
  }
  get _bindParameters() {
    return this._renderContext.bind;
  }
  get _rctx() {
    return this._stage.renderView.renderingContext;
  }
  get _view() {
    return this.parent.view;
  }
  get _stage() {
    return this.parent.view.stage;
  }
  get _spatialReference() {
    return this.parent.spatialReference;
  }
  get _techniques() {
    return this._stage.renderView.techniques;
  }
  get rctx() {
    return this._rctx;
  }
  get materials() {
    return this._pluginContext.materials;
  }
  get screenToWorldRatio() {
    return this._screenToWorldRatio;
  }
  get localOriginFactory() {
    return this._localOriginFactory;
  }
  get pluginContext() {
    return this._pluginContext;
  }
  initializeRenderContext(e9) {
    const r18 = new a14(this._view.stage.renderView.textures, this._techniques, () => {
      this._onMaterialOrContentChanged(), this.events.emit("content-changed"), this.notifyChange("updating"), this.notifyChange("isEmpty");
    }, () => this.events.emit("content-changed"));
    this._pluginContext = { ...e9, materials: r18 }, this._techniques.precompile(t13);
  }
  uninitializeRenderContext() {
  }
  acquireTechniques() {
    return [];
  }
  render() {
  }
  get updating() {
    return this._sortedDrapeSourceRenderersDirty || n2(this._renderers, (e9) => e9.updating || e9.canCompact);
  }
  get hasOverlays() {
    return null != this._overlays && null != this._renderTargets;
  }
  getMaterialRenderer(e9) {
    for (const r18 of this._renderers.values()) {
      const t15 = r18.getMaterialRenderer(e9);
      if (t15) return t15;
    }
    return null;
  }
  get layers() {
    return this._sortedDrapeSourceRenderersDirty && this._updateSortedDrapeSourceRenderers(), c(this._sortedRenderers.map((e9) => e9.drapeSource.layer).filter((e9) => !!e9));
  }
  registerDrapeSource(e9, r18) {
    const t15 = this._renderers.get(e9);
    null != t15 && t15.destroy(), this._renderers.set(e9, r18), this._sortedDrapeSourceRenderersDirty = true, "fullOpacity" in e9 && this.addHandles(l(() => e9.fullOpacity, () => this.events.emit("content-changed")), e9);
  }
  removeDrapeSourceRenderer(e9) {
    if (null == e9) return;
    const r18 = this._renderers.get(e9);
    null != r18 && (this._sortedDrapeSourceRenderersDirty = true, this._renderers.delete(e9), this.removeHandles(e9), r18.destroy());
  }
  computeValidity() {
    return this._renderTargets?.computeValidity() ?? 0;
  }
  releaseRenderTargets(e9) {
    this._renderTargets?.dispose(e9);
  }
  get overlays() {
    return this._overlays ?? [];
  }
  ensureDrapeTargets(e9) {
    this._hasTargetWithoutRasterImage = !!this._overlays && n4(e9, (e10) => 1 === e10.drapeTargetType);
  }
  ensureDrapeSources(e9) {
    this._overlays ? (this._hasDrapedFeatureSource = n4(e9, (e10) => 1 === e10.drapeSourceType), this._hasDrapedRasterSource = n4(e9, (e10) => 0 === e10.drapeSourceType), this._hasDrapedFlowSource = n4(e9, (e10) => 2 === e10.drapeSourceType)) : this._hasDrapedFeatureSource = this._hasDrapedRasterSource = this._hasDrapedFlowSource = false;
  }
  get _needsColorWithoutRasterImage() {
    return this._hasDrapedRasterSource && this._hasDrapedFeatureSource && this._hasTargetWithoutRasterImage;
  }
  ensureOverlays(e9, r18, t15 = this._bindParameters.overlayStretch) {
    null == this._overlays && (this._renderTargets = new s7(this._stage.renderer.fboCache), this._overlays = [new r11(), new r11()]), this.ensureDrapeTargets(e9), this.ensureDrapeSources(r18), this._bindParameters.overlayStretch = t15;
  }
  disposeOverlays() {
    this._overlays = null, this._renderTargets?.dispose(1), this._renderTargets = null, this.events.emit("textures-disposed");
  }
  _useOverlayColorInsteadOfColorNoRasterImage(e9) {
    return 1 === e9 && !this._needsColorWithoutRasterImage && this._hasDrapedFeatureSource;
  }
  getTexture(e9) {
    const r18 = this._useOverlayColorInsteadOfColorNoRasterImage(e9);
    return this._renderTargets?.getTexture(r18 ? 0 : e9);
  }
  get readyToRun() {
    return this.updating;
  }
  runTask(e9) {
    this._processDrapeSources(e9, () => true);
  }
  _onMaterialOrContentChanged() {
    this.renderOccludedFlags = n2(this._renderers, (e9) => e9.hasOccluders) ? H2 : 1;
  }
  _processDrapeSources(e9, r18) {
    let t15 = false;
    for (const [s14, i12] of this._renderers) {
      if (e9.done) break;
      (s14.destroyed || r18(s14)) && (i12.commitChanges() && (t15 = true, e9.madeProgress()));
    }
    this._sortedDrapeSourceRenderersDirty && (this._sortedDrapeSourceRenderersDirty = false, t15 = true, this._updateSortedDrapeSourceRenderers(), e9.madeProgress()), this.compact(e9), t15 && (null != this._overlays && 0 === this._renderers.size && this.disposeOverlays(), this.notifyChange("updating"), this.notifyChange("isEmpty"), this._onMaterialOrContentChanged(), this.hasHighlights = n2(this._renderers, (e10) => e10.hasHighlights), this.events.emit("content-changed"));
  }
  compact(e9) {
    let r18 = false;
    for (const t15 of this._renderers.values()) {
      if (e9.done) break;
      r18 = t15.compact(e9) || r18;
    }
    return r18 && this.notifyChange("updating"), r18;
  }
  hasHighlight(e9) {
    return n2(this._renderers, (r18) => r18.hasHighlight(e9));
  }
  processSyncDrapeSources() {
    this._processDrapeSources(F, (e9) => 1 === e9.updatePolicy);
  }
  get isEmpty() {
    return !t4.OVERLAY_DRAW_DEBUG_TEXTURE && t(this._renderers, (e9) => e9.isEmpty);
  }
  get hasWater() {
    const e9 = n2(this._renderers, ({ hasWater: e10 }) => e10);
    return e9 !== this._hasWater && (this._hasWater = e9, this.events.emit("has-water")), this._hasWater;
  }
  renders(e9) {
    if (t4.OVERLAY_DRAW_DEBUG_TEXTURE && 4 !== e9 && 2 !== e9) return true;
    if (!this._overlays) return false;
    const r18 = this._overlays[0];
    for (const i12 of this._overlays) i12.setupGeometryViews(this.longitudeCyclical);
    if (!r18.hasSomeSizedView()) return false;
    const t15 = this._renderContext.output;
    this._renderContext.output = this._renderTargets?.targets.find((r19) => r19.content === e9)?.output ?? 0, ++this._techniques.precompiling;
    const s14 = this._sortedRenderers.some(({ renderer: e10 }) => e10.precompile(this._renderContext));
    return --this._techniques.precompiling, this._renderContext.output = t15, s14;
  }
  get mode() {
    return this.isEmpty ? 0 : this.hasWater && this.renders(3) ? 2 : this._renderTargets?.getTexture(0) ? 1 : 0;
  }
  updateAnimation(e9) {
    let r18 = false;
    return this._renderers.forEach((t15) => r18 = t15.updateAnimation(e9) || r18), r18 && this.parent.requestRender(0), r18;
  }
  updateDrapeSourceOrder() {
    this._sortedDrapeSourceRenderersDirty = true;
  }
  precompileShaders(e9) {
    if (!this._overlays || !this._renderTargets) return false;
    const r18 = this._bindParameters;
    r18.alignPixelEnabled = e9.alignPixelEnabled, ++this._techniques.precompiling;
    for (const t15 of this._renderTargets.targets) {
      if (1 === t15.content && !this._needsColorWithoutRasterImage) continue;
      const { output: e10 } = t15;
      this._renderContext.output = e10, r18.slot = 3 === e10 ? 19 : 18, 9 === e10 && (r18.highlightMixTexture = r18.highlights.length > 1 ? this._rctx.emptyTexture : null);
      const s14 = this._renderContext.renderOccludedMask;
      4 === t15.content && (this._renderContext.renderOccludedMask = H2), this._sortedRenderers.forAll(({ drapeSource: e11, renderer: r19 }) => {
        1 === t15.content && 0 === e11.drapeSourceType || 4 === t15.content && r19.hasOnlyOccluders || r19.precompile(this._renderContext);
      }), this._renderContext.renderOccludedMask = s14, r18.highlightMixTexture = null;
    }
    return --this._techniques.precompiling, true;
  }
  drawOverlays(e9, r18) {
    if (!this._overlays || !this._renderTargets) return;
    for (const s14 of this._overlays) s14.setupGeometryViews(this.longitudeCyclical);
    this._bindParameters.alignPixelEnabled = e9.alignPixelEnabled;
    const t15 = this.allSourcesOccluders;
    for (const s14 of this._renderTargets.targets) {
      if (!(0 === s14.content && this._hasDrapedFlowSource) && !s14.handleRenderRequest(r18) || 1 === s14.content && !this._needsColorWithoutRasterImage || 4 === s14.content && t15) continue;
      const e10 = this._drawTarget(0, s14), i12 = this._drawTarget(1, s14);
      (e10 || i12) && s14.fbo.generateMipMap();
    }
  }
  _drawTarget(e9, r18) {
    const t15 = this._overlays[e9], s14 = t15.canvasGeometries;
    if (0 === s14.numViews) return false;
    const i12 = this._view.state.contentPixelRatio;
    this._screenToWorldRatio = i12 * t15.mapUnitsPerPixel / this._bindParameters.overlayStretch;
    const { output: n17 } = r18;
    if (this.isEmpty || 3 === n17 && !this.hasWater || !t15.hasSomeSizedView()) return false;
    const { _rctx: o14, _camera: a16, _renderContext: h10, _bindParameters: d5 } = this;
    if (a16.pixelRatio = t15.pixelRatio * i12, h10.output = n17, d5.screenToWorldRatio = this._screenToWorldRatio, d5.screenToPCSRatio = this._screenToWorldRatio * this.parent.worldToPCSRatio, d5.slot = 3 === n17 ? 19 : 18, 4 === r18.content && (h10.renderOccludedMask = H2), !this.renders(r18.content)) return h10.renderOccludedMask = s9, false;
    const { resolution: l9 } = t15, c9 = 0 === e9, u6 = c9 ? 0 : l9;
    if (o14.setViewport(u6, 0, l9, l9), this._bindTargetFBO(r18), c9) if (9 !== r18.output) o14.setClearColor(0, 0, 0, 0), o14.clear(16384);
    else {
      const { gl: e10 } = o14;
      e10.clearBufferuiv(e10.COLOR, 0, [0, 0, 0, 0]);
    }
    if (t4.OVERLAY_DRAW_DEBUG_TEXTURE && 4 !== r18.content && 2 !== r18.content) {
      this._techniques.precompile(a15, z3);
      const r19 = this._techniques.get(a15, z3);
      for (let i13 = 0; i13 < s14.numViews; i13++) this._setViewParameters(s14.extents[i13], t15), this._ensureDebugPatternResources(t15.resolution, U2[e9]), o14.bindTechnique(r19, d5, this._passParameters), o14.screen.draw();
    }
    if (9 === r18.output) {
      const { fboCache: t16 } = this._stage.renderer, s15 = this._resolution;
      this._bindTargetFBO(r18), G2(o14, t16, { width: s15, height: s15 }, d5, () => this._renderAllGeometry(e9, r18), u6);
    } else this._renderAllGeometry(e9, r18);
    return o14.bindFramebuffer(null), h10.renderOccludedMask = s9, true;
  }
  get allSourcesOccluders() {
    return t(this._renderers, (e9) => e9.hasOnlyOccluders);
  }
  _renderAllGeometry(e9, r18) {
    const t15 = this._overlays[e9], s14 = t15.canvasGeometries;
    this._sortedRenderers.forAll(({ drapeSource: i12, renderer: n17 }) => {
      if (1 === r18.content && 0 === i12.drapeSourceType) return;
      const { fullOpacity: o14 } = i12, a16 = null != o14 && o14 < 1 && 0 === r18.output && this._bindTemporaryFBO();
      for (let e10 = 0; e10 < s14.numViews; e10++) this._setViewParameters(s14.extents[e10], t15), n17.render(this._renderContext);
      if (a16) {
        this._bindTargetFBO(r18), this._overlayParameters.texture = a16.getTexture(), this._overlayParameters.opacity = o14, this._overlayParameters.overlayIndex = e9;
        const t16 = this._techniques.get(t13);
        this._rctx.bindTechnique(t16, this._bindParameters, this._overlayParameters), this._rctx.screen.draw(), a16.release();
      }
    });
  }
  _bindTargetFBO(e9) {
    const r18 = this._resolution, t15 = 2 * r18;
    e9.fbo.ensureFramebuffer(t15, r18), e9.fbo.bind(this._rctx);
  }
  _bindTemporaryFBO() {
    const e9 = this._resolution, r18 = 2 * e9, t15 = this._stage.renderer.fboCache, s14 = t15.acquire(r18, e9, "overlay tmp");
    return t15.rctx.bindFramebuffer(s14.fbo), t15.rctx.clear(16384), s14;
  }
  get _resolution() {
    return this._overlays?.[0].resolution ?? 0;
  }
  notifyContentChanged() {
    this.events.emit("content-changed");
  }
  intersect(e9, r18, t15, s14) {
    this._sortedDrapeSourceRenderersDirty && this._updateSortedDrapeSourceRenderers();
    let i12 = 0;
    for (const { renderer: n17 } of this._sortedRenderers) i12 = n17.intersect?.(e9, r18, t15, s14, i12) ?? i12;
  }
  _updateSortedDrapeSourceRenderers() {
    if (this._sortedRenderers.clear(), 0 === this._renderers.size) return;
    const e9 = this._view.map.allLayers.map((e10) => e10.uid), r18 = e9.length;
    this._renderers.forEach((t15, s14) => {
      const i12 = e9.indexOf(s14.layer?.uid), n17 = i12 >= 0, o14 = s14.renderGroup ?? (n17 ? 0 : 1), a16 = s14.drapeSourcePriorityOffset ?? 0, h10 = r18 * o14 + (n17 ? i12 : 0) + a16;
      this._sortedRenderers.push(new L(s14, t15, h10));
    }), this._sortedRenderers.sort((e10, r19) => e10.index - r19.index);
  }
  _setViewParameters(e9, r18) {
    const t15 = this._camera;
    t15.viewport = [0, 0, r18.resolution, r18.resolution], Q(t15.projectionMatrix, 0, e9[2] - e9[0], 0, e9[3] - e9[1], t15.near, t15.far), q(t15.viewMatrix, [-e9[0], -e9[1], 0]);
  }
  _ensureDebugPatternResources(e9, r18) {
    if (o4(this._passParameters.color, r18[0], r18[1], r18[2]), this._passParameters.texture) return;
    const t15 = new Uint8Array(e9 * e9 * 4);
    let s14 = 0;
    for (let n17 = 0; n17 < e9; n17++) for (let r19 = 0; r19 < e9; r19++) {
      const i13 = Math.floor(r19 / 10), o14 = Math.floor(n17 / 10);
      i13 < 2 || o14 < 2 || 10 * i13 > e9 - 20 || 10 * o14 > e9 - 20 ? (t15[s14++] = 255, t15[s14++] = 255, t15[s14++] = 255, t15[s14++] = 255) : (t15[s14++] = 255, t15[s14++] = 255, t15[s14++] = 255, t15[s14++] = 1 & i13 && 1 & o14 ? 1 & r19 ^ 1 & n17 ? 0 : 255 : 1 & i13 ^ 1 & o14 ? 0 : 128);
    }
    const i12 = new h4(e9);
    i12.samplingMode = 9728, this._passParameters.texture = new A2(this._rctx, i12, t15);
  }
  get test() {
  }
};
__decorate([m()], I3.prototype, "hasHighlights", void 0), __decorate([m()], I3.prototype, "renderOccludedFlags", void 0), __decorate([m()], I3.prototype, "_sortedDrapeSourceRenderersDirty", void 0), __decorate([m({ constructOnly: true })], I3.prototype, "parent", void 0), __decorate([m({ readOnly: true })], I3.prototype, "_techniques", null), __decorate([m({ type: Boolean, readOnly: true })], I3.prototype, "updating", null), __decorate([m()], I3.prototype, "isEmpty", null), I3 = __decorate([a("esri.views.3d.terrain.OverlayRenderer")], I3);
var L = class {
  constructor(e9, r18, t15) {
    this.drapeSource = e9, this.renderer = r18, this.index = t15;
  }
};
var U2 = [[1, 0.5, 0.5], [0.5, 0.5, 1]];
var B = -2;
var H2 = 4;
var z3 = new s10();
z3.hasAlpha = true;

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/RenderGeometry.js
var h8 = class {
  constructor(r18, i12 = {}) {
    this.geometry = r18, this.screenToWorldRatio = 1, this._transformation = e4(), this._shaderTransformation = null, this._boundingSphere = null, this.id = e(), this.layerViewUid = i12.layerViewUid, this.graphicUid = i12.graphicUid, this.castShadow = i12.castShadow ?? false, i12.objectShaderTransformation && this.objectShaderTransformationChanged(i12.objectShaderTransformation);
  }
  get transformation() {
    return this._transformation;
  }
  set transformation(t15) {
    n6(this._transformation, t15), this._boundingSphere = null;
  }
  get boundingInfo() {
    return this.geometry.boundingInfo;
  }
  objectShaderTransformationChanged(t15) {
    null == t15 ? this._shaderTransformation = null : (this._shaderTransformation ??= e4(), c3(this._shaderTransformation, t15, this.geometry.transformation)), this._boundingSphere = null;
  }
  get boundingSphere() {
    return this.boundingInfo ? (null == this._boundingSphere && (this._boundingSphere ??= P(), D(this._boundingSphere, this.boundingInfo.center, this.shaderTransformation), this._boundingSphere[3] = this.boundingInfo.radius * m2(this.shaderTransformation)), this._boundingSphere) : S;
  }
  get material() {
    return this.geometry.material;
  }
  get type() {
    return this.geometry.type;
  }
  get shaderTransformation() {
    return this._shaderTransformation ?? this.transformation;
  }
  get attributes() {
    return this.geometry.attributes;
  }
  get positionAttribute() {
    return this.geometry.positionAttribute;
  }
  foreachHighlightOptions(t15) {
    this.geometry.foreachHighlightOptions(t15);
  }
  get hasHighlights() {
    return this.geometry.hasHighlights;
  }
  get occludees() {
    return this.geometry.occludees;
  }
  get visible() {
    return this.geometry.visible;
  }
  set visible(t15) {
    this.geometry.visible = t15;
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/materials/lineStippleUtils.js
var t14 = { dash: [4, 3], dot: [1, 3], "long-dash": [8, 3], "short-dash": [4, 1], "short-dot": [1, 1] };
var o12 = { dash: t14.dash, "dash-dot": [...t14.dash, ...t14.dot], dot: t14.dot, "long-dash": t14["long-dash"], "long-dash-dot": [...t14["long-dash"], ...t14.dot], "long-dash-dot-dot": [...t14["long-dash"], ...t14.dot, ...t14.dot], none: null, "short-dash": t14["short-dash"], "short-dash-dot": [...t14["short-dash"], ...t14["short-dot"]], "short-dash-dot-dot": [...t14["short-dash"], ...t14["short-dot"], ...t14["short-dot"]], "short-dot": t14["short-dot"], solid: null };
var d4 = 8;
function s11(t15, o14) {
  return null == t15 ? t15 : { pattern: t15.slice(), pixelRatio: o14 };
}
function h9(t15) {
  return { pattern: [t15, t15], pixelRatio: 2 };
}
function n16(t15) {
  return "style" === t15?.type ? l7(t15.style) : null;
}
function l7(t15) {
  return null != t15 ? s11(o12[t15], d4) : null;
}

// node_modules/@arcgis/core/views/3d/support/renderInfoUtils/line.js
function s12(o14, t15, i12, s14) {
  const p4 = "polygon" === o14.type ? 1 : 0, c9 = "polygon" === o14.type ? o14.rings : o14.paths, { position: a16, outlines: u6 } = h3(c9, !!o14.hasZ, p4, o14.spatialReference), f7 = e5(a16.length), m7 = l5(a16, o14.spatialReference, 0, f7, 0, a16, 0, a16.length / 3, t15, i12, s14), g7 = null != m7;
  return { lines: g7 ? l8(u6, a16, f7) : [], projectionSuccess: g7, sampledElevation: m7 };
}
function p3(e9, t15) {
  const r18 = "polygon" === e9.type ? 1 : 0, s14 = "polygon" === e9.type ? e9.rings : e9.paths, { position: p4, outlines: c9 } = h3(s14, false, r18), a16 = o3(p4, e9.spatialReference, 0, p4, t15, 0);
  for (let o14 = 2; o14 < p4.length; o14 += 3) p4[o14] = B;
  return { lines: a16 ? l8(c9, p4) : [], projectionSuccess: a16 };
}
function l8(o14, e9, n17 = null) {
  const r18 = new Array();
  for (const { index: i12, count: s14 } of o14) {
    if (s14 <= 1) continue;
    const o15 = 3 * i12, p4 = 3 * s14;
    r18.push({ position: i5(e9, 3 * i12, 3 * s14), mapPositions: null != n17 ? i5(n17, o15, p4) : void 0 });
  }
  return r18;
}

// node_modules/@arcgis/core/views/3d/webgl-engine/materials/TriangleMaterial.js
var i11 = class extends s4 {
  intersect(r18, t15, i12, s14, n17, o14) {
    return h5(r18, i12, s14, n17, void 0, o14);
  }
  intersectDraped(r18, e9, i12, s14) {
    return d3(i12[0], i12[1], r18, s14);
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ColorMaterialTechnique.js
var y3 = class extends m4 {
  constructor(e9, r18) {
    super(e9, r18, new t6(v3, () => import("./ColorMaterial.glsl-4ABP4EWR.js")), v5(r18).locations);
  }
  _createPipeline(e9, r18) {
    const { oitPass: o14, output: i12, transparent: l9, cullFace: h10, draped: j6, hasOccludees: S4, polygonOffset: y4 } = e9, v7 = 0 === o14;
    return T({ blending: o5(i12) && l9 ? a7(o14) : null, culling: _3(h10), depthTest: j6 ? null : { func: p(o14) }, depthWrite: i7(e9), drawBuffers: g2(i12, d2(o14, i12)), colorWrite: d, stencilWrite: S4 ? f4 : null, stencilTest: S4 ? r18 ? t7 : c7 : null, polygonOffset: v7 ? y4 ? T2 : null : m3(e9) });
  }
  initializePipeline(e9) {
    return this._occludeePipelineState = this._createPipeline(e9, true), this._createPipeline(e9, false);
  }
  getPipeline(e9) {
    return e9 ? this._occludeePipelineState : super.getPipeline();
  }
};
var T2 = { factor: 1, units: 1 };
function v5(e9) {
  const t15 = Q2().vec3f("position");
  return e7() && t15.vec4u8("olidColor"), e9.hasVVColor ? t15.f32("colorFeatureAttribute") : t15.vec4u8("color"), t15.freeze();
}

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ColorMaterialTechniqueConfiguration.js
var s13 = class extends e6 {
  constructor() {
    super(...arguments), this.cullFace = 0, this.hasVertexColors = false, this.transparent = false, this.discardInvisibleFragments = false, this.polygonOffset = false, this.enableOffset = true, this.writeDepth = true, this.hasOccludees = false, this.terrainDepthTest = false, this.cullAboveTerrain = false, this.hasVVColor = false, this.draped = false, this.textureCoordinateType = 0, this.emissionSource = 0, this.occlusionPass = false, this.olidColorInstanced = false, this.hasVVInstancing = false, this.hasVVSize = false, this.hasVVOpacity = false, this.snowCover = false;
  }
};
__decorate([i6({ count: 3 })], s13.prototype, "cullFace", void 0), __decorate([i6()], s13.prototype, "hasVertexColors", void 0), __decorate([i6()], s13.prototype, "transparent", void 0), __decorate([i6()], s13.prototype, "discardInvisibleFragments", void 0), __decorate([i6()], s13.prototype, "polygonOffset", void 0), __decorate([i6()], s13.prototype, "enableOffset", void 0), __decorate([i6()], s13.prototype, "writeDepth", void 0), __decorate([i6()], s13.prototype, "hasOccludees", void 0), __decorate([i6()], s13.prototype, "terrainDepthTest", void 0), __decorate([i6()], s13.prototype, "cullAboveTerrain", void 0), __decorate([i6()], s13.prototype, "hasVVColor", void 0), __decorate([i6()], s13.prototype, "draped", void 0);

// node_modules/@arcgis/core/views/3d/webgl-engine/materials/ColorMaterial.js
var m6 = class extends i11 {
  constructor(t15) {
    super(t15, _5), this._configuration = new s13(), this.supportsEdges = true, this.produces = /* @__PURE__ */ new Map([[2, (t16) => this._isOpaqueMaterialPass(t16)], [3, (t16) => this._isOpaqueNoSSAODepthPass(t16)], [4, (t16) => f3(t16) && this._transparent && this.parameters.writeDepth], [5, (t16) => b5(t16) && this._transparent && this.parameters.writeDepth], [8, (t16) => f3(t16) && this._transparent && !this.parameters.writeDepth], [18, (t16) => u3(t16)]]);
  }
  getConfiguration(t15, r18) {
    return super.getConfiguration(t15, r18, this._configuration), this._configuration.cullFace = this.parameters.cullFace, this._configuration.hasVertexColors = this.parameters.hasVertexColors && !this.parameters.vvColor, this._configuration.hasSlicePlane = this.parameters.hasSlicePlane, this._configuration.transparent = this._transparent, this._configuration.discardInvisibleFragments = this._transparent && !this._isOpaquePass(t15) && this.parameters.discardInvisibleFragments, this._configuration.polygonOffset = this.parameters.polygonOffset, this._configuration.writeDepth = this.parameters.writeDepth, this._configuration.hasOccludees = r18.hasOccludees, this._configuration.oitPass = r18.oitPass, this._configuration.enableOffset = r18.camera.relativeElevation < l3, this._configuration.terrainDepthTest = r18.terrainDepthTest && o5(t15), this._configuration.cullAboveTerrain = r18.cullAboveTerrain, this._configuration.hasVVColor = !!this.parameters.vvColor, this._configuration.draped = this.parameters.draped, this._configuration;
  }
  get visible() {
    return this.parameters.color[3] >= o7;
  }
  get _transparent() {
    return this.parameters.color[3] < 1 || this.parameters.forceTransparentMode;
  }
  _isOpaquePass(t15) {
    return this._isOpaqueMaterialPass(t15) || this._isOpaqueNoSSAODepthPass(t15);
  }
  _isOpaqueMaterialPass(t15) {
    return 9 === t15 || f3(t15) && !this._transparent;
  }
  _isOpaqueNoSSAODepthPass(t15) {
    return b5(t15) && this.parameters.writeDepth && !this._transparent;
  }
  createGLMaterial(t15) {
    return new g6(t15);
  }
  createBufferWriter() {
    return new s5(v5(this.parameters));
  }
};
var g6 = class extends t5 {
  beginSlot(t15) {
    return this.getTechnique(y3, t15);
  }
};
var _5 = class extends t8 {
  constructor() {
    super(...arguments), this.color = a5, this.forceTransparentMode = false, this.writeDepth = true, this.hasVertexColors = false, this.polygonOffset = false, this.hasSlicePlane = false, this.cullFace = 0, this.draped = false, this.discardInvisibleFragments = false;
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/materials/DefaultLayouts.js
var o13 = Q2().vec3f("position").freeze();
var f6 = Q2().vec3f("position").vec2f16("uv0").freeze();
var v6 = Q2().vec3f("position").vec4u8("color").freeze();
var r17 = Q2().vec3f("position").vec2f("uv0").freeze();
var c8 = Q2().vec3f("position").vec2f("uv0").vec4u8("olidColor").freeze();

export {
  r14 as r,
  u5 as u,
  B,
  h8 as h,
  i11 as i,
  m6 as m,
  h9 as h2,
  n16 as n,
  s12 as s,
  p3 as p,
  o13 as o,
  f6 as f,
  v6 as v,
  r17 as r2,
  c8 as c
};
//# sourceMappingURL=chunk-Z4LDNBNJ.js.map
