import {
  a3,
  c2 as c4,
  d as d2,
  e2 as e5,
  f as f2,
  h2 as h,
  i2,
  i3 as i4,
  l as l2,
  m2,
  p,
  s as s4,
  s2 as s5,
  t as t4
} from "./chunk-VIIQX37N.js";
import {
  r as r7
} from "./chunk-QTS3W27E.js";
import {
  K
} from "./chunk-V5R3CDPU.js";
import {
  z
} from "./chunk-HZVRMY4D.js";
import {
  c as c3,
  f
} from "./chunk-YTJAN3CY.js";
import {
  t as t5
} from "./chunk-T6CRNJ3D.js";
import {
  i2 as i3
} from "./chunk-KEMYAF6M.js";
import {
  d as d3,
  g as g4,
  m as m3,
  t as t3
} from "./chunk-CYVJEU2B.js";
import {
  T as T2,
  _,
  d
} from "./chunk-FDSAQJ3R.js";
import {
  n as n3,
  o as o2,
  r as r5,
  r2 as r6
} from "./chunk-I4DSU5MJ.js";
import {
  e as e6
} from "./chunk-F43BIMML.js";
import {
  o2 as o3
} from "./chunk-BZBDEPRV.js";
import {
  g as g3
} from "./chunk-2JMKFI2D.js";
import {
  Q,
  t
} from "./chunk-2AOVWXAQ.js";
import {
  t as t2
} from "./chunk-ALR6N4CF.js";
import {
  I,
  T,
  g as g2
} from "./chunk-NDFIZYZY.js";
import {
  s as s3
} from "./chunk-TLTSPUO7.js";
import {
  r as r3
} from "./chunk-ZVTEFYZX.js";
import {
  A,
  H,
  N,
  P,
  c as c2,
  g,
  o,
  r as r4,
  s as s2
} from "./chunk-VYMBX5H5.js";
import {
  e as e4
} from "./chunk-K2OZ6WVC.js";
import {
  c
} from "./chunk-XLOINTMG.js";
import {
  a as a2,
  e as e2,
  n,
  r as r2
} from "./chunk-75XOUSSS.js";
import {
  n as n2,
  s,
  u
} from "./chunk-LTPHDYPK.js";
import {
  e as e3
} from "./chunk-3OVERDFX.js";
import {
  i
} from "./chunk-TFJXG32O.js";
import {
  b,
  m
} from "./chunk-5EI5H4QX.js";
import {
  a2 as a
} from "./chunk-ZIE53VIV.js";
import {
  __decorate
} from "./chunk-SS5CLIUY.js";
import {
  e,
  l,
  r2 as r
} from "./chunk-AL6YUTZM.js";

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/lodRendering/BackedBufferObject.js
var r8 = class {
  constructor(r9, i5, s7) {
    this.elementSize = i5.stride, this._buffer = new r7(r9, t(i5, 1)), this.resize(s7);
  }
  destroy() {
    this._buffer.dispose();
  }
  get capacity() {
    return this._capacity;
  }
  get array() {
    return this._array;
  }
  get buffer() {
    return this._buffer;
  }
  get usedMemory() {
    return this._array.byteLength + this._buffer.usedMemory;
  }
  copyRange(e7, t6, r9, i5 = 0) {
    const s7 = new Uint8Array(this.array, e7 * this.elementSize, (t6 - e7) * this.elementSize);
    new Uint8Array(r9.array, i5 * this.elementSize).set(s7);
  }
  transferAll() {
    this._buffer.setData(this._array);
  }
  transferRange(e7, t6) {
    const r9 = e7 * this.elementSize, i5 = t6 * this.elementSize;
    this._buffer.setSubData(new Uint8Array(this._array), r9, r9, i5);
  }
  resize(e7) {
    const t6 = e7 * this.elementSize, r9 = new ArrayBuffer(t6);
    this._array && (e7 >= this._capacity ? new Uint8Array(r9).set(new Uint8Array(this._array)) : new Uint8Array(r9).set(new Uint8Array(this._array).subarray(0, e7 * this.elementSize))), this._array = r9, this._buffer.setSize(t6), this._capacity = e7;
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/lodRendering/InstanceData.js
var T3 = class {
  constructor(t6) {
    this.localTransform = t6.localTransform, this.globalTransform = t6.globalTransform, this.modelOrigin = t6.modelOrigin, this.model = t6.instanceModel, this.modelNormal = t6.instanceModelNormal, this.modelScaleFactors = t6.modelScaleFactors, this.boundingSphere = t6.boundingSphere, this.featureAttribute = t6.getField("instanceFeatureAttribute", T), this.color = t6.getField("instanceColor", g2), this.olidColor = t6.getField("instanceOlidColor", g2), this.state = t6.getField("state", I), this.lodLevel = t6.getField("lodLevel", I);
  }
};
var F = class extends b {
  constructor(t6, e7) {
    super(t6), this.events = new i(), this._capacity = 0, this._size = 0, this._next = 0, this._highlightOptionsMap = /* @__PURE__ */ new Map(), this._highlightOptionsMapPrev = /* @__PURE__ */ new Map(), this._layout = S(e7), this._capacity = A2, this._buffer = this._layout.createBuffer(this._capacity), this._view = new T3(this._buffer);
  }
  get capacity() {
    return this._capacity;
  }
  get size() {
    return this._size;
  }
  get view() {
    return this._view;
  }
  addInstance() {
    this._size + 1 > this._capacity && this._grow();
    const t6 = this._findSlot();
    return this._view.state.set(t6, 1), this._size++, this.events.emit("instances-changed"), t6;
  }
  removeInstance(t6) {
    const e7 = this._view.state;
    s3(t6 >= 0 && t6 < this._capacity && !!(1 & e7.get(t6)), "invalid instance handle"), this._getStateFlag(t6, 18) ? this._setStateFlags(t6, 32) : this.freeInstance(t6), this.events.emit("instances-changed");
  }
  freeInstance(t6) {
    const e7 = this._view.state;
    s3(t6 >= 0 && t6 < this._capacity && !!(1 & e7.get(t6)), "invalid instance handle"), e7.set(t6, 0), this._size--;
  }
  setLocalTransform(t6, e7, s7 = true) {
    this._view.localTransform.setMat(t6, e7), s7 && this.updateModelTransform(t6);
  }
  getLocalTransform(t6, e7) {
    this._view.localTransform.getMat(t6, e7);
  }
  setGlobalTransform(t6, e7, s7 = true) {
    this._view.globalTransform.setMat(t6, e7), s7 && this.updateModelTransform(t6);
  }
  getGlobalTransform(t6, e7) {
    this._view.globalTransform.getMat(t6, e7);
  }
  updateModelTransform(t6) {
    const e7 = this._view, s7 = j, i5 = x;
    e7.localTransform.getMat(t6, C), e7.globalTransform.getMat(t6, L);
    const a4 = c(L, L, C);
    o(s7, a4[12], a4[13], a4[14]), e7.modelOrigin.setVec(t6, s7), n2(i5, a4), e7.model.setMat(t6, i5);
    const r9 = g3(j, a4);
    r9.sort(), e7.modelScaleFactors.set(t6, 0, r9[1]), e7.modelScaleFactors.set(t6, 1, r9[2]), s(i5, i5), u(i5, i5), e7.modelNormal.setMat(t6, i5), this._setStateFlags(t6, 64), this.events.emit("instance-transform-changed", { index: t6 });
  }
  getModelTransform(t6, e7) {
    const s7 = this._view;
    s7.model.getMat(t6, x), s7.modelOrigin.getVec(t6, j), e7[0] = x[0], e7[1] = x[1], e7[2] = x[2], e7[3] = 0, e7[4] = x[3], e7[5] = x[4], e7[6] = x[5], e7[7] = 0, e7[8] = x[6], e7[9] = x[7], e7[10] = x[8], e7[11] = 0, e7[12] = j[0], e7[13] = j[1], e7[14] = j[2], e7[15] = 1;
  }
  applyShaderTransformation(t6, e7) {
    null != this.shaderTransformation && this.shaderTransformation.applyTransform(this, t6, e7);
  }
  getCombinedModelTransform(t6, e7) {
    return this.getModelTransform(t6, e7), null != this.shaderTransformation && this.shaderTransformation.applyTransform(this, t6, e7), e7;
  }
  getCombinedLocalTransform(t6, e7) {
    this._view.localTransform.getMat(t6, e7), null != this.shaderTransformation && this.shaderTransformation.applyTransform(this, t6, e7);
  }
  getCombinedMaxScaleFactor(t6) {
    let e7 = this._view.modelScaleFactors.get(t6, 1);
    return null != this.shaderTransformation && (this.shaderTransformation.scaleFactor(j, this, t6), e7 *= Math.max(j[0], j[1], j[2])), e7;
  }
  getCombinedMedianScaleFactor(t6) {
    let e7 = this._view.modelScaleFactors.get(t6, 0);
    return null != this.shaderTransformation && (this.shaderTransformation.scaleFactor(j, this, t6), e7 *= w(j[0], j[1], j[2])), e7;
  }
  getModel(t6, e7) {
    this._view.model.getMat(t6, e7);
  }
  setFeatureAttribute(t6, e7) {
    this._view.featureAttribute?.setVec(t6, e7);
  }
  getFeatureAttribute(t6, e7) {
    this._view.featureAttribute?.getVec(t6, e7);
  }
  setColor(t6, e7) {
    this._view.color?.setVec(t6, e7);
  }
  setObjectAndLayerIdColor(t6, e7) {
    this._view.olidColor?.setVec(t6, e7);
  }
  setVisible(t6, e7) {
    e7 !== this.getVisible(t6) && (this._setStateFlag(t6, 4, e7), this.events.emit("instance-visibility-changed", { index: t6 }));
  }
  getVisible(t6) {
    return this._getStateFlag(t6, 4);
  }
  setHighlight(t6, e7) {
    const { _highlightOptionsMap: s7 } = this, i5 = s7.get(t6);
    e7 ? e7 !== i5 && (s7.set(t6, e7), this._setStateFlag(t6, 8, true), this.events.emit("instance-highlight-changed")) : i5 && (s7.delete(t6), this._setStateFlag(t6, 8, false), this.events.emit("instance-highlight-changed"));
  }
  get highlightOptionsMap() {
    return this._highlightOptionsMap;
  }
  getHighlightStateFlag(t6) {
    return this._getStateFlag(t6, 8);
  }
  geHighlightOptionsPrev(t6) {
    const e7 = this._highlightOptionsMapPrev.get(t6) ?? null;
    return this._highlightOptionsMapPrev.delete(t6), e7;
  }
  getHighlightName(t6) {
    const e7 = this.highlightOptionsMap.get(t6) ?? null;
    return e7 ? this._highlightOptionsMapPrev.set(t6, e7) : this._highlightOptionsMapPrev.delete(t6), e7;
  }
  getState(t6) {
    return this._view.state.get(t6);
  }
  getLodLevel(t6) {
    return this._view.lodLevel.get(t6);
  }
  countFlags(t6) {
    let e7 = 0;
    for (let s7 = 0; s7 < this._capacity; ++s7) {
      this.getState(s7) & t6 && ++e7;
    }
    return e7;
  }
  _setStateFlags(t6, e7) {
    const s7 = this._view.state;
    e7 = s7.get(t6) | e7, s7.set(t6, e7);
  }
  _clearStateFlags(t6, e7) {
    const s7 = this._view.state;
    e7 = s7.get(t6) & ~e7, s7.set(t6, e7);
  }
  _setStateFlag(t6, e7, s7) {
    s7 ? this._setStateFlags(t6, e7) : this._clearStateFlags(t6, e7);
  }
  _getStateFlag(t6, e7) {
    return !!(this._view.state.get(t6) & e7);
  }
  _grow() {
    this._capacity = Math.max(A2, Math.floor(this._capacity * e)), this._buffer = this._layout.createBuffer(this._capacity).copyFrom(this._buffer), this._view = new T3(this._buffer);
  }
  _findSlot() {
    const t6 = this._view.state;
    let e7 = this._next;
    for (; 1 & t6.get(e7); ) e7 = e7 + 1 === this._capacity ? 0 : e7 + 1;
    return this._next = e7 + 1 === this._capacity ? 0 : e7 + 1, e7;
  }
};
function w(t6, e7, s7) {
  return Math.max(Math.min(t6, e7), Math.min(Math.max(t6, e7), s7));
}
__decorate([m({ constructOnly: true })], F.prototype, "shaderTransformation", void 0), __decorate([m()], F.prototype, "_size", void 0), __decorate([m({ readOnly: true })], F.prototype, "size", null), F = __decorate([a("esri.views.3d.webgl-engine.lib.lodRendering.InstanceData")], F);
var y = Q().mat4f64("localTransform").mat4f64("globalTransform").vec4f64("boundingSphere").vec3f64("modelOrigin").mat3f("instanceModel").mat3f("instanceModelNormal").vec2f("modelScaleFactors");
function S(t6) {
  return O(y.clone(), t6).u8("state").u8("lodLevel");
}
function O(t6, e7) {
  return e7.instancedFeatureAttribute && t6.vec4f("instanceFeatureAttribute"), e7.instancedColor && t6.vec4u8("instanceColor"), e6() && t6.vec4u8("instanceOlidColor"), t6;
}
var j = n();
var x = e3();
var C = e4();
var L = e4();
var A2 = 64;

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/lodRendering/RenderInstanceData.js
var c5 = class {
  constructor(t6) {
    this.model = t6.instanceModel, this.modelNormal = t6.instanceModelNormal, this.modelOriginHi = t6.instanceModelOriginHi, this.modelOriginLo = t6.instanceModelOriginLo, this.featureAttribute = t6.getField("instanceFeatureAttribute", T), this.color = t6.getField("instanceColor", g2), this.olidColor = t6.getField("instanceOlidColor", g2);
  }
};
var o4 = class {
  constructor(t6, i5) {
    this._rctx = t6, this._layout = i5, this._headIndex = 0, this._tailIndex = 0, this._firstIndex = null, this._captureFirstIndex = true, this._updating = false, this._prevHeadIndex = 0, this._resized = false, this._capacity = 1;
  }
  destroy() {
    this._buffer && this._buffer.destroy();
  }
  get buffer() {
    return this._buffer.buffer;
  }
  get view() {
    return this._view;
  }
  get capacity() {
    return this._capacity;
  }
  get size() {
    const t6 = this._headIndex, i5 = this._tailIndex;
    return t6 >= i5 ? t6 - i5 : t6 + this._capacity - i5;
  }
  get isEmpty() {
    return this._headIndex === this._tailIndex;
  }
  get isFull() {
    return this._tailIndex === (this._headIndex + 1) % this._capacity;
  }
  get headIndex() {
    return this._headIndex;
  }
  get tailIndex() {
    return this._tailIndex;
  }
  get firstIndex() {
    return this._firstIndex;
  }
  get usedMemory() {
    return this._buffer?.usedMemory ?? 0;
  }
  reset() {
    this._headIndex = 0, this._tailIndex = 0, this._firstIndex = null;
  }
  startUpdateCycle() {
    this._captureFirstIndex = true;
  }
  beginUpdate() {
    s3(!this._updating, "already updating"), this._updating = true, this._prevHeadIndex = this._headIndex;
  }
  endUpdate() {
    s3(this._updating, "not updating"), this.size < l * this.capacity && this._shrink(), this._resized ? (this._buffer.transferAll(), this._resized = false) : this._transferRange(this._prevHeadIndex, this._headIndex), this._updating = false;
  }
  allocateHead() {
    s3(this._updating, "not updating"), this.isFull && this._grow();
    const t6 = this.headIndex;
    return this._captureFirstIndex && (this._firstIndex = t6, this._captureFirstIndex = false), this._incrementHead(), s3(this._headIndex !== this._tailIndex, "invalid pointers"), t6;
  }
  freeTail() {
    s3(this._updating, "not updating"), s3(this.size > 0, "invalid size");
    const t6 = this._tailIndex === this._firstIndex;
    this._incrementTail(), t6 && (this._firstIndex = this._tailIndex);
  }
  _grow() {
    const t6 = Math.max(A2, Math.floor(this._capacity * e));
    this._resize(t6);
  }
  _shrink() {
    const t6 = Math.max(A2, Math.floor(this._capacity * r));
    this._resize(t6);
  }
  _resize(t6) {
    if (s3(this._updating, "not updating"), t6 === this._capacity) return;
    const i5 = new r8(this._rctx, this._layout, t6);
    if (this._buffer) {
      this._firstIndex && (this._firstIndex = (this._firstIndex + this._capacity - this._tailIndex) % this._capacity);
      const t7 = this.size, e7 = this._compactInstances(i5);
      s3(e7 === t7, "invalid compaction"), this._buffer.destroy(), this._tailIndex = 0, this._headIndex = e7, this._prevHeadIndex = 0;
    }
    this._resized = true, this._capacity = t6, this._buffer = i5, this._view = new c5(this._layout.createView(this._buffer.array));
  }
  _compactInstances(t6) {
    const i5 = this._headIndex, e7 = this._tailIndex;
    return e7 < i5 ? (this._buffer.copyRange(e7, i5, t6), i5 - e7) : e7 > i5 ? (this._buffer.copyRange(e7, this._capacity, t6), i5 > 0 && this._buffer.copyRange(0, i5, t6, this._capacity - e7), i5 + (this._capacity - e7)) : 0;
  }
  _incrementHead(t6 = 1) {
    this._headIndex = (this._headIndex + t6) % this._capacity;
  }
  _incrementTail(t6 = 1) {
    this._tailIndex = (this._tailIndex + t6) % this._capacity;
  }
  _transferRange(t6, i5) {
    t6 < i5 ? this._buffer.transferRange(t6, i5) : t6 > i5 && (i5 > 0 && this._buffer.transferRange(0, i5), this._buffer.transferRange(t6, this._capacity));
  }
};
var f3 = Q().vec3f("instanceModelOriginHi").vec3f("instanceModelOriginLo").mat3f("instanceModel").mat3f("instanceModelNormal");
function u2(t6) {
  return O(f3.clone(), t6);
}

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/DefaultMaterialTechnique.js
var w2 = class extends f {
  constructor() {
    super(...arguments), this.isSchematic = false, this.usePBR = false, this.mrrFactors = t5, this.hasVertexColors = false, this.hasSymbolColors = false, this.doubleSided = false, this.doubleSidedType = "normal", this.cullFace = 2, this.instanced = false, this.instancedFeatureAttribute = false, this.instancedColor = false, this.instanceColorEncodesAlphaIgnore = false, this.emissiveStrength = 0, this.emissiveSource = 1, this.emissiveBaseColor = a2, this.instancedDoublePrecision = false, this.normalType = 0, this.receiveShadows = true, this.receiveAmbientOcclusion = true, this.castShadows = true, this.ambient = e2(0.2, 0.2, 0.2), this.diffuse = e2(0.8, 0.8, 0.8), this.externalColor = r3(1, 1, 1, 1), this.colorMixMode = "multiply", this.opacity = 1, this.layerOpacity = 1, this.origin = n(), this.hasSlicePlane = false, this.offsetTransparentBackfaces = false, this.vvSize = null, this.vvColor = null, this.vvOpacity = null, this.vvSymbolAnchor = null, this.vvSymbolRotationMatrix = null, this.modelTransformation = null, this.drivenOpacity = false, this.writeDepth = true, this.customDepthTest = 0, this.textureAlphaMode = 0, this.textureAlphaCutoff = o3, this.textureAlphaPremultiplied = false, this.renderOccluded = 1, this.isDecoration = false;
  }
  get hasVVSize() {
    return !!this.vvSize;
  }
  get hasVVColor() {
    return !!this.vvColor;
  }
  get hasVVOpacity() {
    return !!this.vvOpacity;
  }
};
var A3 = class extends c3 {
  constructor() {
    super(...arguments), this.origin = n(), this.slicePlaneLocalOrigin = this.origin;
  }
};
var M = class extends m3 {
  constructor(e7, t6, i5 = new t3(K, () => import("./DefaultMaterial.glsl-HOXK4A3I.js"))) {
    const s7 = [t(F2(t6))];
    t6.instanced && t6.instancedDoublePrecision && s7.push(t(u2(t6))), super(e7, t6, i5, t2(s7));
  }
  _makePipeline(e7, t6) {
    const { oitPass: i5, output: s7, transparent: r9, cullFace: o6, customDepthTest: n4, hasOccludees: a4 } = e7;
    return T2({ blending: o2(s7) && r9 ? a3(i5) : null, culling: z2(e7) ? _(o6) : null, depthTest: { func: p(i5, k(n4)) }, depthWrite: i4(e7), drawBuffers: g4(s7, d2(i5, s7)), colorWrite: d, stencilWrite: a4 ? f2 : null, stencilTest: a4 ? t6 ? t4 : c4 : null, polygonOffset: m2(e7) });
  }
  initializePipeline(e7) {
    return this._occludeePipelineState = this._makePipeline(e7, true), this._makePipeline(e7, false);
  }
  getPipeline(e7) {
    return e7 ? this._occludeePipelineState : super.getPipeline();
  }
};
function k(e7) {
  switch (e7) {
    case 1:
      return 515;
    case 0:
    case 3:
      return 513;
    case 2:
      return 516;
  }
}
function z2(e7) {
  return 0 !== e7.cullFace || !e7.hasSlicePlane && (!e7.transparent && !e7.doubleSidedMode);
}
function F2(e7) {
  const t6 = Q().vec3f("position");
  return 1 === e7.normalType ? t6.vec2i16("normalCompressed", { glNormalized: true }) : t6.vec3f("normal"), e7.hasVertexTangents && t6.vec4f("tangent"), e7.hasTextures && t6.vec2f16("uv0"), e7.hasVertexColors && t6.vec4u8("color"), e7.hasSymbolColors && t6.vec4u8("symbolColor"), !e7.instanced && e6() && t6.vec4u8("olidColor"), t6;
}

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/DefaultMaterialTechniqueConfiguration.js
var s6 = class extends e5 {
  constructor(e7) {
    super(), this.spherical = e7, this.alphaDiscardMode = 1, this.doubleSidedMode = 0, this.pbrMode = 0, this.cullFace = 0, this.normalType = 0, this.customDepthTest = 0, this.emissionSource = 0, this.hasVertexColors = false, this.hasSymbolColors = false, this.hasVerticalOffset = false, this.hasColorTexture = false, this.hasMetallicRoughnessTexture = false, this.hasOcclusionTexture = false, this.hasNormalTexture = false, this.hasScreenSizePerspective = false, this.hasVertexTangents = false, this.hasOccludees = false, this.instanced = false, this.instancedDoublePrecision = false, this.hasModelTransformation = false, this.offsetBackfaces = false, this.hasVVSize = false, this.hasVVColor = false, this.receiveShadows = false, this.receiveAmbientOcclusion = false, this.textureAlphaPremultiplied = false, this.instancedFeatureAttribute = false, this.instancedColor = false, this.writeDepth = true, this.transparent = false, this.enableOffset = true, this.terrainDepthTest = false, this.cullAboveTerrain = false, this.snowCover = false, this.hasColorTextureTransform = false, this.hasEmissionTextureTransform = false, this.hasNormalTextureTransform = false, this.hasOcclusionTextureTransform = false, this.hasMetallicRoughnessTextureTransform = false, this.occlusionPass = false, this.useCustomDTRExponentForWater = false, this.useFillLights = true, this.draped = false;
  }
  get textureCoordinateType() {
    return this.hasTextures ? 1 : 0;
  }
  get hasTextures() {
    return this.hasColorTexture || this.hasNormalTexture || this.hasMetallicRoughnessTexture || 3 === this.emissionSource || this.hasOcclusionTexture;
  }
  get hasVVInstancing() {
    return this.instanced;
  }
  get discardInvisibleFragments() {
    return this.transparent;
  }
};
__decorate([i2({ count: 4 })], s6.prototype, "alphaDiscardMode", void 0), __decorate([i2({ count: 3 })], s6.prototype, "doubleSidedMode", void 0), __decorate([i2({ count: 7 })], s6.prototype, "pbrMode", void 0), __decorate([i2({ count: 3 })], s6.prototype, "cullFace", void 0), __decorate([i2({ count: 3 })], s6.prototype, "normalType", void 0), __decorate([i2({ count: 3 })], s6.prototype, "customDepthTest", void 0), __decorate([i2({ count: 8 })], s6.prototype, "emissionSource", void 0), __decorate([i2()], s6.prototype, "hasVertexColors", void 0), __decorate([i2()], s6.prototype, "hasSymbolColors", void 0), __decorate([i2()], s6.prototype, "hasVerticalOffset", void 0), __decorate([i2()], s6.prototype, "hasColorTexture", void 0), __decorate([i2()], s6.prototype, "hasMetallicRoughnessTexture", void 0), __decorate([i2()], s6.prototype, "hasOcclusionTexture", void 0), __decorate([i2()], s6.prototype, "hasNormalTexture", void 0), __decorate([i2()], s6.prototype, "hasScreenSizePerspective", void 0), __decorate([i2()], s6.prototype, "hasVertexTangents", void 0), __decorate([i2()], s6.prototype, "hasOccludees", void 0), __decorate([i2()], s6.prototype, "instanced", void 0), __decorate([i2()], s6.prototype, "instancedDoublePrecision", void 0), __decorate([i2()], s6.prototype, "hasModelTransformation", void 0), __decorate([i2()], s6.prototype, "offsetBackfaces", void 0), __decorate([i2()], s6.prototype, "hasVVSize", void 0), __decorate([i2()], s6.prototype, "hasVVColor", void 0), __decorate([i2()], s6.prototype, "receiveShadows", void 0), __decorate([i2()], s6.prototype, "receiveAmbientOcclusion", void 0), __decorate([i2()], s6.prototype, "textureAlphaPremultiplied", void 0), __decorate([i2()], s6.prototype, "instancedFeatureAttribute", void 0), __decorate([i2()], s6.prototype, "instancedColor", void 0), __decorate([i2()], s6.prototype, "writeDepth", void 0), __decorate([i2()], s6.prototype, "transparent", void 0), __decorate([i2()], s6.prototype, "enableOffset", void 0), __decorate([i2()], s6.prototype, "terrainDepthTest", void 0), __decorate([i2()], s6.prototype, "cullAboveTerrain", void 0), __decorate([i2()], s6.prototype, "snowCover", void 0), __decorate([i2()], s6.prototype, "hasColorTextureTransform", void 0), __decorate([i2()], s6.prototype, "hasEmissionTextureTransform", void 0), __decorate([i2()], s6.prototype, "hasNormalTextureTransform", void 0), __decorate([i2()], s6.prototype, "hasOcclusionTextureTransform", void 0), __decorate([i2()], s6.prototype, "hasMetallicRoughnessTextureTransform", void 0);

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/RealisticTreeTechnique.js
var o5 = class extends M {
  constructor(r9, o6) {
    super(r9, o6, new t3(z, () => import("./RealisticTree.glsl-JSMQ7F6F.js")));
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/materials/DefaultMaterial.js
var P2 = class extends s4 {
  constructor(e7, r9) {
    super(e7, j2), this.materialType = "default", this.supportsEdges = true, this.intersectDraped = void 0, this.produces = /* @__PURE__ */ new Map([[2, (e8) => (r5(e8) || n3(e8)) && !this.transparent], [4, (e8) => (r5(e8) || n3(e8)) && this.transparent && this.parameters.writeDepth], [8, (e8) => (r5(e8) || n3(e8)) && this.transparent && !this.parameters.writeDepth]]), this._layout = F2(this.parameters), this._configuration = new s6(r9.spherical);
  }
  isVisibleForOutput(e7) {
    return 4 !== e7 && 6 !== e7 && 5 !== e7 || this.parameters.castShadows;
  }
  get visible() {
    const { layerOpacity: e7, colorMixMode: r9, opacity: t6, externalColor: s7 } = this.parameters;
    return e7 * ("replace" === r9 ? 1 : t6) * ("ignore" === r9 || isNaN(s7[3]) ? 1 : s7[3]) >= o3;
  }
  get _hasEmissiveBase() {
    return !!this.parameters.emissiveTextureId || !H(this.parameters.emissiveBaseColor, a2);
  }
  get hasEmissions() {
    return this.parameters.emissiveStrength > 0 && (0 === this.parameters.emissiveSource && this._hasEmissiveBase || 1 === this.parameters.emissiveSource);
  }
  getConfiguration(e7, r9) {
    const { parameters: t6, _configuration: s7 } = this, { treeRendering: a4, doubleSided: i5, doubleSidedType: o6 } = t6;
    return super.getConfiguration(e7, r9, this._configuration), s7.hasNormalTexture = t6.hasNormalTexture, s7.hasColorTexture = t6.hasColorTexture, s7.hasMetallicRoughnessTexture = t6.hasMetallicRoughnessTexture, s7.hasOcclusionTexture = t6.hasOcclusionTexture, s7.hasVertexTangents = !a4 && t6.hasVertexTangents, s7.instanced = t6.instanced, s7.instancedDoublePrecision = t6.instancedDoublePrecision, s7.hasVVColor = !!t6.vvColor, s7.hasVVSize = !!t6.vvSize, s7.hasVerticalOffset = null != t6.verticalOffset, s7.hasScreenSizePerspective = null != t6.screenSizePerspective, s7.hasSlicePlane = t6.hasSlicePlane, s7.alphaDiscardMode = t6.textureAlphaMode, s7.normalType = a4 ? 0 : t6.normalType, s7.transparent = this.transparent, s7.writeDepth = t6.writeDepth, s7.customDepthTest = t6.customDepthTest ?? 0, s7.hasOccludees = r9.hasOccludees, s7.cullFace = t6.hasSlicePlane ? 0 : t6.cullFace, s7.cullAboveTerrain = r9.cullAboveTerrain, s7.hasModelTransformation = !a4 && null != t6.modelTransformation, s7.hasVertexColors = t6.hasVertexColors, s7.hasSymbolColors = t6.hasSymbolColors, s7.doubleSidedMode = a4 ? 2 : i5 && "normal" === o6 ? 1 : i5 && "winding-order" === o6 ? 2 : 0, s7.instancedFeatureAttribute = t6.instancedFeatureAttribute, s7.instancedColor = t6.instancedColor, o2(e7) ? (s7.terrainDepthTest = r9.terrainDepthTest, s7.receiveShadows = t6.receiveShadows, s7.receiveAmbientOcclusion = t6.receiveAmbientOcclusion && null != r9.ssao) : (s7.terrainDepthTest = false, s7.receiveShadows = s7.receiveAmbientOcclusion = false), s7.textureAlphaPremultiplied = !!t6.textureAlphaPremultiplied, s7.pbrMode = t6.usePBR ? t6.isSchematic ? 2 : 1 : 0, s7.emissionSource = t6.emissionSource, s7.offsetBackfaces = !(!this.transparent || !t6.offsetTransparentBackfaces), s7.oitPass = r9.oitPass, s7.enableOffset = r9.camera.relativeElevation < l2, s7.snowCover = r9.snowCover > 0, s7.hasColorTextureTransform = !!t6.colorTextureTransformMatrix, s7.hasNormalTextureTransform = !!t6.normalTextureTransformMatrix, s7.hasEmissionTextureTransform = !!t6.emissiveTextureTransformMatrix, s7.hasOcclusionTextureTransform = !!t6.occlusionTextureTransformMatrix, s7.hasMetallicRoughnessTextureTransform = !!t6.metallicRoughnessTextureTransformMatrix, s7;
  }
  intersect(e7, u3, c6, h2, m4, p2) {
    if (null != this.parameters.verticalOffset) {
      const e8 = c6.camera;
      o(z3, u3[12], u3[13], u3[14]);
      let p3 = null;
      switch (c6.viewingMode) {
        case 1:
          p3 = A(_2, z3);
          break;
        case 2:
          p3 = s2(_2, B);
      }
      let d4 = 0;
      const f4 = c2(E, z3, e8.eye), T4 = r4(f4), x2 = g(f4, f4, 1 / T4);
      let v = null;
      this.parameters.screenSizePerspective && (v = P(p3, x2)), d4 += i3(e8, T4, this.parameters.verticalOffset, v ?? 0, this.parameters.screenSizePerspective, null), g(p3, p3, d4), N(N2, p3, c6.transform.inverseRotation), h2 = c2(I2, h2, N2), m4 = c2(V, m4, N2);
    }
    h(e7, c6, h2, m4, d3(c6.verticalOffset), p2);
  }
  createGLMaterial(e7) {
    return new D(e7);
  }
  createBufferWriter() {
    return new s5(this._layout);
  }
  get transparent() {
    return A4(this.parameters);
  }
};
var D = class extends r6 {
  constructor(e7) {
    super({ ...e7, ...e7.material.parameters });
  }
  beginSlot(e7) {
    this._material.setParameters({ receiveShadows: e7.shadowMap.enabled });
    const t6 = this._material.parameters;
    this.updateTexture(t6.textureId);
    const s7 = e7.camera.viewInverseTransposeMatrix;
    return o(t6.origin, s7[3], s7[7], s7[11]), this._material.setParameters(this.textureBindParameters), this.getTechnique(t6.treeRendering ? o5 : M, e7);
  }
};
var j2 = class extends w2 {
  constructor() {
    super(...arguments), this.treeRendering = false, this.hasVertexTangents = false;
  }
  get hasNormalTexture() {
    return !this.treeRendering && !!this.normalTextureId;
  }
  get hasColorTexture() {
    return !!this.textureId;
  }
  get hasMetallicRoughnessTexture() {
    return !this.treeRendering && !!this.metallicRoughnessTextureId;
  }
  get hasOcclusionTexture() {
    return !this.treeRendering && !!this.occlusionTextureId;
  }
  get emissionSource() {
    return this.treeRendering ? 0 : null != this.emissiveTextureId && 0 === this.emissiveSource ? 3 : this.usePBR ? 0 === this.emissiveSource ? 2 : 1 : 0;
  }
  get hasTextures() {
    return this.hasColorTexture || this.hasNormalTexture || this.hasMetallicRoughnessTexture || 3 === this.emissionSource || this.hasOcclusionTexture;
  }
};
function A4(e7) {
  const { drivenOpacity: r9, opacity: t6, externalColor: s7, layerOpacity: a4, texture: i5, textureId: o6, textureAlphaMode: n4, colorMixMode: l3 } = e7, u3 = s7[3];
  return r9 || t6 < 1 && "replace" !== l3 || u3 < 1 && "ignore" !== l3 || a4 < 1 || (null != i5 || null != o6) && 1 !== n4 && 2 !== n4 && "replace" !== l3;
}
var I2 = n();
var V = n();
var B = r2(0, 0, 1);
var _2 = n();
var N2 = n();
var z3 = n();
var E = n();

export {
  F,
  o4 as o,
  u2 as u,
  A3 as A,
  P2 as P,
  j2 as j,
  A4 as A2
};
//# sourceMappingURL=chunk-3RNQTFH6.js.map
