import {
  f as f2,
  x
} from "./chunk-FTN6U6TO.js";
import {
  d,
  f
} from "./chunk-QW7RJMQR.js";
import "./chunk-5ONGWFJ3.js";
import "./chunk-FPMLKIDB.js";
import "./chunk-H74Q4SYB.js";
import "./chunk-SMWUT52Z.js";
import "./chunk-AXZMNHTN.js";
import "./chunk-5T3MJDSR.js";
import "./chunk-NMQNUPE4.js";
import "./chunk-6KIXN4DJ.js";
import "./chunk-7DGJB37R.js";
import "./chunk-234CIOHE.js";
import "./chunk-V2H77UEV.js";
import "./chunk-WRA2WBYC.js";
import "./chunk-XWE6BM2U.js";
import "./chunk-SOIZOFSB.js";
import "./chunk-XXLHAM2M.js";
import "./chunk-5EI5H4QX.js";
import {
  a2 as a
} from "./chunk-ZIE53VIV.js";
import {
  __decorate
} from "./chunk-SS5CLIUY.js";
import "./chunk-R54Q5TGA.js";
import "./chunk-6SSZNBOK.js";
import "./chunk-LZ2XTYP2.js";
import "./chunk-45CFSCQX.js";
import "./chunk-A5XN2VFT.js";
import "./chunk-65HD3WXL.js";
import "./chunk-4DGC7CBY.js";
import "./chunk-GNMPGHLQ.js";
import "./chunk-QY7XKUIV.js";
import "./chunk-AL6YUTZM.js";
import "./chunk-G26ADAPQ.js";

// node_modules/@arcgis/core/views/3d/support/flow/FlowWorker.js
var i = class {
  constructor() {
    this._tileData = /* @__PURE__ */ new Map();
  }
  async generateStreamlines(t) {
    const { flowData: e, flowExtentInfo: r, needsMagnitude: o, simulationSettings: a2, startPositions: i2 } = t, n2 = l(f(a2, e), a2, r.modelSize, o, i2);
    return { result: { streamlines: n2 }, transferList: n2?.map((t2) => t2.vertices.buffer) };
  }
  async generateTiledStreamlines(t) {
    const { flowDataTiles: e, flowExtentInfo: s, needsMagnitude: r, reset: a2, simulationSettings: i2, startPositions: n2 } = t;
    this._updateTileData(e, a2);
    const c = l(x(i2, this._tileData, s), i2, s.modelSize, r, n2);
    return { result: { streamlines: c }, transferList: c?.map((t2) => t2.vertices.buffer) ?? [] };
  }
  _updateTileData(t, e) {
    e && this._tileData.forEach((e2, s) => {
      null == t.get(s) && this._tileData.delete(s);
    }), t.forEach((t2, e2) => {
      "delete" === t2.type ? this._tileData.delete(e2) : "on-worker" !== t2.type && "waiting" !== t2.type && this._tileData.set(e2, t2.data);
    });
  }
};
i = __decorate([a("esri.views.3d.support.flow.FlowWorker")], i);
var n = i;
function l(t, e, s, o, i2) {
  if (null == t) return;
  const n2 = d(e, t, s[0], s[1], { positions: i2 }), l2 = [], c = f2(o);
  for (const { vertices: r, stage: a2 } of n2) {
    const t2 = new Float32Array(r.length * c);
    for (let e2 = 0; e2 < r.length; e2++) t2[e2 * c] = r[e2].x, t2[e2 * c + 1] = r[e2].y, t2[e2 * c + 2] = r[e2].t, o && (t2[e2 * c + 3] = r[e2].speed);
    l2.push({ vertices: t2, stage: a2, hasMagnitude: o });
  }
  return l2;
}
export {
  n as default
};
//# sourceMappingURL=FlowWorker-75KJVABJ.js.map
