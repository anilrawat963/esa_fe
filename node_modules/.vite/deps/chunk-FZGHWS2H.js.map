{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/webgl-engine/lib/intersectorUtilsConversions.js", "../../@arcgis/core/analysis/featureReferenceUtils.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{getScale as r}from\"../../../../core/libs/gl-matrix-2/math/mat4.js\";import{create as e}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{diameter as t}from\"../../../../geometry/support/aaBoundingBox.js\";import{g as n}from\"../../../../chunks/sphere.js\";import{isPclIntersectorResult as i,isVoxelIntersectorResult as l,isI3sIntersectorResult as a}from\"../../layers/i3s/Intersector.js\";import{isOverlayIntersectorResult as o,isTerrainIntersectorResult as u}from\"../../terrain/Intersector.js\";import{isHUDIntersectorResult as c}from\"./HUDIntersectorResult.js\";import{isObjectIntersectorResult as s}from\"./ObjectIntersectorResult.js\";import{isLodIntersectorResult as g}from\"./lodRendering/Intersector.js\";function p(r,e){return s(r)||c(r)?j(r.target?.object,e):u(r)?e.map?.ground:r.target&&\"layerViewUid\"in r.target?j(r.target,e):null}function f(r,e){const t=d(r,e);return\"graphic\"===t?.type?t.graphic:null}function d(r,e,t={}){if(null==r)return null;if(s(r)||c(r))return m(r.target?.object,e,t);if(i(r)){const e=r.target.createGraphic();return{type:\"graphic\",graphic:e,layer:e.layer}}if(l(r)){const e=r.target.createVoxelGraphic();return{type:\"graphic\",graphic:e,layer:e.layer}}return o(r)||g(r)?m(r.target,e,t):a(r)?h(r.target,e,t):null}function m(r,e,t){if(null==r?.graphicUid)return null;const n=j(r,e);if(null==n)return null;if(n===e.graphics)return null==e.graphicsView||\"number\"!=typeof r.graphicUid?null:e.graphicsView.getHit(r.graphicUid,t);const i=e.allLayerViews.find(r=>r.layer===n);return!i||i.suspended||null==r.graphicUid?null:\"getHit\"in i?i.getHit(r.graphicUid,t):null}function h(r,e,t){const n=j(r,e);if(null==n)return null;const i=e.allLayerViews.find(r=>r.layer===n);if(!i||i.suspended||!(\"getGraphicFromIntersectorTarget\"in i))return null;const l=t.defer;return V(i.getGraphicFromIntersectorTarget(r,{defer:l?r=>l(async()=>V(await r())):void 0}))}function y(r,e){const t=j(r,e);if(null==t)return null;const n=e.allLayerViews.find(r=>r.layer===t);return n&&!n.suspended&&\"getAABBFromIntersectorTarget\"in n?n.getAABBFromIntersectorTarget(r):null}function V(r){return null!=r?{type:\"graphic\",graphic:r,layer:r.layer}:null}function j(r,e){return null==r?.layerViewUid?null:null!=e.graphicsView&&r.layerViewUid===e.graphicsView.uid?e.graphics:e.allLayerViews.find(e=>e.uid===r.layerViewUid)?.layer}function w(e,i){if(s(e)||c(e))return n(e.target.object.boundingVolumeWorldSpace.bounds);if(g(e)){r(U,e.transformation);const t=Math.max(U[0],U[1],U[2]);return e.target.baseBoundingSphere.radius*t}if(a(e)){const r=y(e.target,i);return r?.5*t(r):null}return null}function b(r){return!s(r)&&!c(r)&&(g(r)?r.target.numLodLevels>1:!!a(r))}const U=e();export{w as getIntersectedFeatureBSRadius,b as hasLod,f as toGraphic,d as toHit,p as toOwner};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{a as e,b as t,c as r}from\"../chunks/vec32.js\";import{create as n}from\"../core/libs/gl-matrix-2/factories/vec3f64.js\";import{create as l,fromPoints as o}from\"../geometry/support/ray.js\";import{toGraphic as u,hasLod as i,getIntersectedFeatureBSRadius as a}from\"../views/3d/webgl-engine/lib/intersectorUtilsConversions.js\";function c(e,t){return s(e)===s(t)}function s(e){if(null==e)return null;const t=null!=e.layer?e.layer.id:\"\";let r=null;return r=null!=e.objectId?e.objectId:null!=e.layer&&\"objectIdField\"in e.layer&&null!=e.layer.objectIdField&&null!=e.attributes?e.attributes[e.layer.objectIdField]:e.uid,null==r?null:`o-${t}-${r}`}const d={json:{write:{writer:b,target:{\"feature.layerId\":{type:[Number,String],isRequired:!0},\"feature.objectId\":{type:[Number,String],isRequired:!0}}},origins:{\"web-scene\":{read:f}}},clonable:\"reference\"};function b(e,t){null!=e?.layer?.objectIdField&&null!=e.attributes&&(t.feature={layerId:e.layer.id,objectId:e.attributes[e.layer.objectIdField]})}function f(e){if(null!=e.layerId&&null!=e.objectId)return{uid:null,layer:{id:e.layerId,objectIdField:\"ObjectId\"},attributes:{ObjectId:e.objectId}}}function I(l,i,a,c){const{sceneIntersectionHelper:d}=l,{observer:b,observerFeatureId:f,targetFeatureId:I,target:m}=a;if(null==f&&null==I)return;c||(c=e=>e),e(g,b,m);const p=t(g),S=1;r(g,b,g,S/p);const v=o(g,m,y);i.options.store=2,d.intersectToolIntersectorRay(v,i);let F=null,N=null,R=null,w=null;for(const e of i.results.all){const t=u(e,l);if(null==t||null==e.distanceInRenderSpace)continue;const r=s(t);null!=r&&(null!=f&&r===f&&(F??=c(j(e,l,p)),e.distanceInRenderSpace-S<F&&(R=e)),null!=I&&r===I&&(N??=c(j(e,l,p)),null==w&&e.distanceInRenderSpace-S<p&&p-e.distanceInRenderSpace+S<N&&(w=e)))}const{observerAdjusted:T,targetAdjusted:h}=a;R?.getIntersectionPoint(T)?a.observerSurfaceNormal=R.getTransformedNormal(n()):a.observerSurfaceNormal=null,w?.getIntersectionPoint(h)?a.targetSurfaceNormal=w.getTransformedNormal(n()):a.targetSurfaceNormal=null}function j(e,t,r){if(i(e)){const n=a(e,t);if(null!=n)return Math.min(n*m,r)}return 1e-5*r}const m=.05,y=l(),g=n();export{c as featureReferenceEquals,d as featureReferenceProperty,s as getFeatureId,I as updatePointsFromFeatureReference};\n"],
  "mappings": ";;;;;;;;AAIymF,IAAM,IAAE,EAAE;;;ACA5yE,SAAS,EAAE,GAAE,GAAE;AAAC,SAAOA,GAAE,CAAC,MAAIA,GAAE,CAAC;AAAC;AAAC,SAASA,GAAE,GAAE;AAAC,MAAG,QAAM,EAAE,QAAO;AAAK,QAAM,IAAE,QAAM,EAAE,QAAM,EAAE,MAAM,KAAG;AAAG,MAAIC,KAAE;AAAK,SAAOA,KAAE,QAAM,EAAE,WAAS,EAAE,WAAS,QAAM,EAAE,SAAO,mBAAkB,EAAE,SAAO,QAAM,EAAE,MAAM,iBAAe,QAAM,EAAE,aAAW,EAAE,WAAW,EAAE,MAAM,aAAa,IAAE,EAAE,KAAI,QAAMA,KAAE,OAAK,KAAK,CAAC,IAAIA,EAAC;AAAE;AAAC,IAAM,IAAE,EAAC,MAAK,EAAC,OAAM,EAAC,QAAOC,IAAE,QAAO,EAAC,mBAAkB,EAAC,MAAK,CAAC,QAAO,MAAM,GAAE,YAAW,KAAE,GAAE,oBAAmB,EAAC,MAAK,CAAC,QAAO,MAAM,GAAE,YAAW,KAAE,EAAC,EAAC,GAAE,SAAQ,EAAC,aAAY,EAAC,MAAKC,GAAC,EAAC,EAAC,GAAE,UAAS,YAAW;AAAE,SAASD,GAAE,GAAE,GAAE;AAAC,UAAM,GAAG,OAAO,iBAAe,QAAM,EAAE,eAAa,EAAE,UAAQ,EAAC,SAAQ,EAAE,MAAM,IAAG,UAAS,EAAE,WAAW,EAAE,MAAM,aAAa,EAAC;AAAE;AAAC,SAASC,GAAE,GAAE;AAAC,MAAG,QAAM,EAAE,WAAS,QAAM,EAAE,SAAS,QAAM,EAAC,KAAI,MAAK,OAAM,EAAC,IAAG,EAAE,SAAQ,eAAc,WAAU,GAAE,YAAW,EAAC,UAAS,EAAE,SAAQ,EAAC;AAAC;AAA+6B,IAAY,IAAE,EAAE;AAAhB,IAAkB,IAAE,EAAE;",
  "names": ["s", "r", "b", "f"]
}
