import {
  A as A2,
  B as B3,
  C as C4,
  D as D2,
  E as E3,
  g as g3,
  h as h5,
  k,
  q,
  w as w3,
  x as x2,
  z
} from "./chunk-PG3227VO.js";
import {
  Ae,
  At,
  B as B2,
  C as C2,
  C2 as C3,
  Ct,
  Ge,
  Gt,
  Ht,
  I,
  J as J2,
  Lt,
  P as P2,
  Pt,
  Qt,
  Te,
  Tt,
  U,
  Ve,
  W,
  We,
  X,
  Xe,
  Y as Y2,
  Ye,
  Yt,
  _ as _3,
  _2 as _4,
  _e,
  _t,
  f as f3,
  f2 as f4,
  ft,
  g as g2,
  gt,
  hn,
  it,
  je,
  jt,
  l as l2,
  ln,
  m as m4,
  nt,
  oe,
  on,
  ot,
  rt,
  s as s5,
  se,
  st as st2,
  ue,
  un,
  ut,
  v,
  w as w2,
  we,
  wn,
  x,
  xt,
  ye,
  ze,
  zt
} from "./chunk-JGWZMI5Q.js";
import {
  n2
} from "./chunk-43423NKQ.js";
import {
  i as i5,
  m as m2,
  s as s4
} from "./chunk-NNZE65VM.js";
import {
  h as h3
} from "./chunk-7LPDSYJP.js";
import {
  r as r6
} from "./chunk-QTS3W27E.js";
import {
  o as o7
} from "./chunk-3RABUJDL.js";
import {
  e as e2,
  e2 as e3,
  g,
  n2 as n,
  o as o5,
  r as r5
} from "./chunk-GVFNGMIY.js";
import {
  B,
  C,
  D,
  E as E2,
  F,
  G as G2,
  H,
  J,
  K,
  L,
  d,
  e,
  f,
  h,
  i as i4,
  o as o6,
  p,
  r as r4,
  s as s3,
  w
} from "./chunk-RQGBRVDD.js";
import {
  Y
} from "./chunk-DRHU543D.js";
import {
  i as i3,
  o as o4
} from "./chunk-F7RQDGE7.js";
import {
  r as r3
} from "./chunk-CXUJAI27.js";
import {
  o as o3
} from "./chunk-SXZO7ULH.js";
import {
  t as t2
} from "./chunk-4X4BOGIG.js";
import {
  _
} from "./chunk-IRBX64M6.js";
import {
  a,
  d as d2,
  e as e4,
  f as f2,
  h as h4,
  l,
  m as m3,
  r as r7,
  u2 as u3
} from "./chunk-WKTI47FV.js";
import {
  t as t3
} from "./chunk-LQPKVYW2.js";
import {
  A,
  h as h2
} from "./chunk-U55FA2EK.js";
import {
  N as N3,
  O,
  P,
  c,
  o as o2,
  st,
  u as u2
} from "./chunk-JE2NJSBU.js";
import {
  E,
  G,
  N as N2,
  R,
  _ as _2
} from "./chunk-QNVJVDYZ.js";
import {
  m
} from "./chunk-63LDVRFI.js";
import {
  i as i2,
  s as s2
} from "./chunk-LTPHDYPK.js";
import {
  o,
  u
} from "./chunk-CSMCPN64.js";
import {
  ae
} from "./chunk-NMQNUPE4.js";
import {
  __decorate,
  __param
} from "./chunk-SS5CLIUY.js";
import {
  $,
  r2,
  y
} from "./chunk-GNMPGHLQ.js";
import {
  i3 as i,
  s2 as s
} from "./chunk-QY7XKUIV.js";
import {
  N,
  has,
  r,
  t
} from "./chunk-AL6YUTZM.js";

// node_modules/@arcgis/core/views/2d/engine/webgl/meshing/definitions.js
var T = { [R.BYTE]: 1, [R.UNSIGNED_BYTE]: 1, [R.SHORT]: 2, [R.UNSIGNED_SHORT]: 2, [R.HALF_FLOAT]: 2, [R.INT]: 4, [R.UNSIGNED_INT]: 4, [R.FLOAT]: 4 };

// node_modules/@arcgis/core/views/2d/engine/webgl/meshing/Mesh.js
var o8 = class {
  constructor(r10, t9) {
    this._boundPart = null, this.vertexBuffers = /* @__PURE__ */ new Map(), this.indexBuffers = /* @__PURE__ */ new Map(), this.groups = [];
    for (const e9 in t9.vertex) {
      const { data: s12, layout: o19 } = t9.vertex[e9], n16 = new r6(r10, o19, s12);
      this.vertexBuffers.set(e9, n16);
    }
    for (const s12 in t9.index) {
      const { data: i10 } = t9.index[s12], o19 = o7.createIndex(r10, 35044, i10);
      this.indexBuffers.set(s12, o19);
    }
    for (const e9 of t9.groups) this.groups.push({ ...e9, vertexArrays: /* @__PURE__ */ new Map() });
    this.parts = t9.parts;
  }
  bind(e9, s12, i10) {
    this._boundPart = i10;
    const { group: o19 } = this.parts[this._boundPart], n16 = this.groups[o19];
    if (!n16) throw new Error(`Missing group ${o19}.`);
    let f14 = n16.vertexArrays.get(s12.stringHash);
    if (!f14) {
      const i11 = r(new Set(s12.locations.keys())), o20 = n16.index ? this.indexBuffers.get(n16.index) : null, a8 = /* @__PURE__ */ new Map();
      for (const [r10, e10] of this.vertexBuffers) {
        e10.layout.filter((r11) => i11.has(r11.name)).length > 0 && a8.set(r10, e10);
      }
      f14 = new h3(e9, a8, o20), n16.vertexArrays.set(s12.stringHash, f14);
    }
    e9.bindVAO(f14);
  }
  draw(r10) {
    if (null == this._boundPart) throw new Error("Mesh.bind() has not been called.");
    const { start: e9, count: t9 } = this.parts[this._boundPart], { group: i10 } = this.parts[this._boundPart], { primitive: o19, index: n16 } = this.groups[i10];
    if (n16) {
      const i11 = this.indexBuffers.get(n16);
      if (!i11) throw new Error(`Missing index buffer "${n16}".`);
      const { indexType: f14 } = i11;
      if (!f14) throw new Error("Buffer type error.");
      r10.drawElements(o19, t9, f14, e9 * T[f14]);
    } else r10.drawArrays(o19, e9, t9);
  }
  unbind(r10) {
    this._boundPart = null, r10.bindVAO(null);
  }
  destroy() {
    this.groups.forEach(({ vertexArrays: r10 }) => r10.forEach((r11) => r11.disposeVAOOnly())), this.vertexBuffers.forEach((r10) => r10.dispose()), this.indexBuffers.forEach((r10) => r10.dispose());
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/meshing/SimpleMesh.js
var o9 = { position: { type: R.SHORT, count: 2 } };
var s6 = class _s extends o8 {
  static create(e9, r10) {
    const i10 = [];
    let { stride: o19 } = r10;
    if (null == o19) {
      o19 = 0;
      for (const [e10, { count: i11, type: n16, offset: s12 }] of Object.entries(r10.layout)) {
        if (null != s12) throw new Error("Stride cannot be computed automatically when attribute offsets are supplied explicitly.");
        o19 += i11 * T[n16];
      }
    }
    let l10 = 0;
    for (const [s12, { count: d9, offset: f14, type: m12, normalized: x9 }] of Object.entries(r10.layout)) {
      null != f14 && (l10 = f14);
      const e10 = new t2(s12, d9, m12, l10, o19, null != x9 && x9, 0);
      i10.push(e10), l10 += d9 * T[m12];
    }
    const a8 = { primitive: r10.primitive };
    null != r10.index && (a8.index = "indexData");
    let { count: u18 } = r10;
    if (null == u18 && (u18 = r10.index ? r10.index.length : r10.vertex.byteLength / o19, Math.floor(u18) !== u18)) throw new Error(`The byte length of vertex data must be an exact multiple of the stride, which is ${o19}.`);
    const c8 = { start: 0, count: u18, group: 0, primitive: r10.primitive }, p9 = { vertex: { vertexData: { data: r10.vertex, layout: i10 } }, parts: [c8], groups: [a8] };
    return null != r10.index && (p9.index = { indexData: { data: r10.index } }), new _s(e9, p9, r10.layout);
  }
  static fromVertexStream(t9, e9) {
    return _s.create(t9, { primitive: _2.TRIANGLE_STRIP, vertex: new Uint16Array(e9), layout: o9 });
  }
  constructor(t9, e9, r10) {
    super(t9, e9), this._spec = r10;
  }
  bind(t9, e9, r10 = 0) {
    super.bind(t9, e9, r10);
  }
};

// node_modules/@arcgis/core/symbols/cim/animationDebugFlags.js
var e5 = class {
  get forceStaticPath() {
    return "disabled" === has("esri-cim-animations-enable-status");
  }
  get forceAnimatedPath() {
    return "forced" === has("esri-cim-animations-enable-status");
  }
  get freezeGlobalTime() {
    const e9 = has("esri-cim-animations-freeze-time");
    return e9 ?? false;
  }
  get spotlightAnimatedSymbols() {
    return !!has("esri-cim-animations-spotlight");
  }
  get forceGlobalTimeOrigin() {
    return false !== has("esri-cim-animations-freeze-time");
  }
};
var t4 = new e5();

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/animated/AnimationUniformInfo.js
var d3 = class extends w2 {
};
__decorate([m4(C2)], d3.prototype, "globalTime", void 0), __decorate([m4(X)], d3.prototype, "animationTextureSize", void 0), __decorate([m4(U)], d3.prototype, "animationTexture", void 0), __decorate([m4(rt)], d3.prototype, "toScreen", void 0), __decorate([m4(rt)], d3.prototype, "toNdc", void 0), __decorate([m4(C2)], d3.prototype, "mapRotation", void 0), __decorate([m4(C2)], d3.prototype, "pixelRatio", void 0);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/EntityStorage.js
var p2 = class extends w2 {
  getVisualVariableData(t9) {
    if (!this._vvData) {
      const a8 = this.getAttributeDataCoords(t9);
      this._vvData = wn(this.visualVariableData, a8).setDebugName("storage2");
    }
    return this._vvData;
  }
  getAttributeDataCoords(t9) {
    if (!this._uv) {
      const a8 = B3(t9), e9 = this.size, i10 = ut(a8.x), r10 = ut(a8.y).multiply(ut(256)), s12 = ut(a8.z).multiply(ut(256)).multiply(ut(256)), n16 = st2(i10.add(r10).add(s12)), p9 = Ge(n16, e9), d9 = n16.subtract(p9).divide(e9);
      this._uv = new X(p9, d9).add(0.5).divide(e9);
    }
    return this._uv;
  }
  getFilterData(t9) {
    const a8 = this.getAttributeDataCoords(t9);
    return wn(this.filterFlags, a8).setDebugName("storage0");
  }
  getAnimationData(t9) {
    const a8 = this.getAttributeDataCoords(t9);
    return wn(this.animation, a8).setDebugName("storage1");
  }
  getVVData(t9) {
    return this.getVisualVariableData(t9);
  }
  getDataDrivenData0(t9) {
    const a8 = this.getAttributeDataCoords(t9);
    return wn(this.dataDriven0, a8).setDebugName("storage30");
  }
  getDataDrivenData1(t9) {
    const a8 = this.getAttributeDataCoords(t9);
    return wn(this.dataDriven1, a8).setDebugName("storage31");
  }
  getDataDrivenData2(t9) {
    const a8 = this.getAttributeDataCoords(t9);
    return wn(this.dataDriven2, a8).setDebugName("storage32");
  }
  getGPGPUData(t9) {
    const a8 = this.getAttributeDataCoords(t9);
    return wn(this.gpgpu, a8).setDebugName("storage4");
  }
  getLocalTimeOrigin(t9) {
    const a8 = this.getAttributeDataCoords(t9);
    return wn(this.localTimeOrigin, a8).x.setDebugName("storage5");
  }
  getFilterFlags(t9) {
    return has("webgl-ignores-sampler-precision") ? ue(this.getFilterData(t9).x.multiply(st2(255))) : this.getFilterData(t9).x.multiply(st2(255));
  }
  getLabelVisibility(t9) {
    const a8 = this.getFilterData(t9).y.multiply(255);
    return new C2(1).subtract(a8);
  }
  getAnimationValue(t9) {
    return this.getAnimationData(t9).x;
  }
  getSizeValue(t9) {
    return this.getVisualVariableData(t9).x;
  }
  getColorValue(t9) {
    return this.getVisualVariableData(t9).y;
  }
  getOpacityValue(t9) {
    return this.getVisualVariableData(t9).z;
  }
  getRotationValue(t9) {
    return this.getVisualVariableData(t9).w;
  }
};
__decorate([m4(U)], p2.prototype, "filterFlags", void 0), __decorate([m4(U)], p2.prototype, "animation", void 0), __decorate([m4(U)], p2.prototype, "gpgpu", void 0), __decorate([m4(U)], p2.prototype, "localTimeOrigin", void 0), __decorate([m4(U)], p2.prototype, "visualVariableData", void 0), __decorate([m4(U)], p2.prototype, "dataDriven0", void 0), __decorate([m4(U)], p2.prototype, "dataDriven1", void 0), __decorate([m4(U)], p2.prototype, "dataDriven2", void 0), __decorate([m4(C2)], p2.prototype, "size", void 0);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/ShaderHighlight.js
var e6 = class extends w2 {
};
__decorate([m4(C2)], e6.prototype, "activeReasons", void 0), __decorate([m4(C2)], e6.prototype, "highlightAll", void 0);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/ShaderHittest.js
var i6 = class extends w2 {
};
__decorate([m4(X)], i6.prototype, "position", void 0), __decorate([m4(C2)], i6.prototype, "distance", void 0), __decorate([m4(C2)], i6.prototype, "smallSymbolDistance", void 0), __decorate([m4(C2)], i6.prototype, "smallSymbolSizeThreshold", void 0);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/ViewInfo.js
var d4 = class extends w2 {
};
__decorate([m4(rt)], d4.prototype, "displayViewScreenMat3", void 0), __decorate([m4(rt)], d4.prototype, "displayViewMat3", void 0), __decorate([m4(rt)], d4.prototype, "displayMat3", void 0), __decorate([m4(rt)], d4.prototype, "viewMat3", void 0), __decorate([m4(rt)], d4.prototype, "tileMat3", void 0), __decorate([m4(C2)], d4.prototype, "displayZoomFactor", void 0), __decorate([m4(C2)], d4.prototype, "requiredZoomFactor", void 0), __decorate([m4(X)], d4.prototype, "tileOffset", void 0), __decorate([m4(C2)], d4.prototype, "currentScale", void 0), __decorate([m4(C2)], d4.prototype, "currentZoom", void 0), __decorate([m4(C2)], d4.prototype, "metersPerSRUnit", void 0), __decorate([m4(C2)], d4.prototype, "rotation", void 0), __decorate([m4(C2)], d4.prototype, "pixelRatio", void 0);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/AFeatureShader.js
var S = class extends C3 {
};
__decorate([f4(0, Y2)], S.prototype, "id", void 0), __decorate([f4(1, C2)], S.prototype, "bitset", void 0), __decorate([f4(2, X)], S.prototype, "pos", void 0);
var q2 = class extends x {
};
__decorate([f4(14, X)], q2.prototype, "nextPos1", void 0), __decorate([f4(15, X)], q2.prototype, "nextPos2", void 0);
var P3 = class extends I {
};
var B4 = class extends P2 {
  clip(t9, i10) {
    let e9 = new C2(0);
    const o19 = this.storage.getFilterFlags(t9);
    if (e9 = e9.add(st2(2).multiply(st2(1).subtract(q(o19, 0)))), this.inside ? e9 = e9.add(st2(2).multiply(st2(1).subtract(q(o19, 1)))) : this.outside ? e9 = e9.add(st2(2).multiply(q(o19, 1))) : this.highlight && (e9 = e9.add(st2(2).multiply(st2(1).subtract(this._checkHighlight(o19))))), null != i10) {
      const t10 = new C2(1).subtract(ln(i10.x, this.view.currentZoom)), o20 = ln(i10.y, this.view.currentZoom);
      e9 = e9.add(new C2(2).multiply(t10.add(o20)));
    }
    return e9;
  }
  getFragmentOutput(t9, i10, e9 = new C2(1 / 255)) {
    const s12 = new v();
    return s12.fragColor = this._maybeWriteHittest(i10) ?? this._maybeHighlight(t9, e9) ?? t9, s12;
  }
  _maybeHighlight(t9, i10) {
    return this.highlight ? new _3(t9.rgb, ln(i10, t9.a)) : null;
  }
  _checkHighlight(t9) {
    let e9 = this._checkHighlightBit(t9, 0);
    for (let o19 = 1; o19 < P; o19++) e9 = e9.add(this._checkHighlightBit(t9, o19));
    return ln(new C2(0.1), e9.add(this.highlight.highlightAll));
  }
  _checkHighlightBit(t9, i10) {
    return A2(t9, i10).multiply(h5(this.highlight.activeReasons, i10));
  }
  maybeRunHittest(t9, i10, e9) {
    if (null == this.hittestRequest) return null;
    const o19 = this.hittest(t9, i10, e9);
    let s12 = zt(Gt(o19, this.hittestRequest.distance), new C2(2), new C2(0));
    const r10 = this.storage.getAttributeDataCoords(t9.id), h12 = g3(r10);
    s12 = s12.add(this.clip(t9.id, t9.zoomRange));
    const l10 = new _3(new C2(1 / 255), 0, 0, 0);
    return { glPointSize: new C2(1), glPosition: new _3(h12, s12, 1), color: l10 };
  }
  _maybeWriteHittest(t9) {
    return null != this.hittestRequest ? t9.color : null;
  }
};
__decorate([_4], B4.prototype, "inside", void 0), __decorate([_4], B4.prototype, "outside", void 0), __decorate([g2(e6)], B4.prototype, "highlight", void 0), __decorate([m4(p2)], B4.prototype, "storage", void 0), __decorate([m4(d4)], B4.prototype, "view", void 0), __decorate([g2(i6)], B4.prototype, "hittestRequest", void 0);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/LocalTileOffset.js
var n3 = class extends w2 {
  getPatternOffsetAtTileOrigin(t9, i10 = new C2(0), l10 = new C2(1)) {
    const n16 = new X(H).divide(t9);
    let p9 = t9.multiply(Te(this.maxIntsToLocalOrigin.multiply(n16))).add(this.tileOffsetFromLocalOrigin).subtract(new C2(0.5).multiply(t9));
    return p9 = new X(p9.x.multiply(l10).subtract(p9.y.multiply(i10)), p9.x.multiply(i10).add(p9.y.multiply(l10))), Ge(p9, t9);
  }
};
__decorate([m4(X)], n3.prototype, "tileOffsetFromLocalOrigin", void 0), __decorate([m4(X)], n3.prototype, "maxIntsToLocalOrigin", void 0);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/MosaicInfo.js
var s7 = class extends w2 {
};
__decorate([m4(X)], s7.prototype, "size", void 0), __decorate([m4(U)], s7.prototype, "texture", void 0);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/VisualVariableColor.js
var f5 = class extends w2 {
  getColor(t9, s12, o19) {
    return Tt([At(x2(t9), o19), s12], [_t(t9, this.values.first()), this.colors.first()], [Ht(t9, this.values.last()), this.colors.last()], [true, () => {
      const s13 = this.values.findIndex((s14) => Gt(s14, t9)), o20 = this.values.get(s13), r10 = s13.subtract(1), e9 = this.values.get(r10), i10 = t9.subtract(e9).divide(o20.subtract(e9));
      return _e(this.colors.get(r10), this.colors.get(s13), i10);
    }]);
  }
};
__decorate([m4(B2.ofType(_3, 8))], f5.prototype, "colors", void 0), __decorate([m4(B2.ofType(C2, 8))], f5.prototype, "values", void 0);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/VisualVariableOpacity.js
var h6 = class extends w2 {
  getOpacity(t9) {
    return Tt([x2(t9), new C2(1)], [_t(t9, this.opacityValues.first()), this.opacities.first()], [Ht(t9, this.opacityValues.last()), this.opacities.last()], [true, () => {
      const i10 = this.opacityValues.findIndex((i11) => Gt(i11, t9)), s12 = this.opacityValues.get(i10), e9 = i10.subtract(1), o19 = this.opacityValues.get(e9), a8 = t9.subtract(o19).divide(s12.subtract(o19));
      return _e(this.opacities.get(e9), this.opacities.get(i10), a8);
    }]);
  }
};
__decorate([m4(B2.ofType(C2, 8))], h6.prototype, "opacities", void 0), __decorate([m4(B2.ofType(C2, 8))], h6.prototype, "opacityValues", void 0);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/VisualVariableRotation.js
var g4 = class extends w2 {
  getVVRotationMat4(t9) {
    return zt(x2(t9), it.identity(), () => {
      const e9 = this.getNormalizedAngle(t9).multiply(e), r10 = un(e9), i10 = oe(e9);
      return new it(i10, r10, 0, 0, r10.multiply(new C2(-1)), i10, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
    });
  }
  getVVRotationMat3(t9) {
    return zt(x2(t9), rt.identity(), () => {
      const e9 = this.getNormalizedAngle(t9).multiply(e), r10 = un(e9), i10 = oe(e9);
      return new rt(i10, r10, 0, r10.multiply(new C2(-1)), i10, 0, 0, 0, 1);
    });
  }
  getNormalizedAngle(t9) {
    const e9 = Ct(this.rotationType, new C2(1));
    return zt(e9, new C2(90).subtract(t9), t9);
  }
};
__decorate([m4(C2)], g4.prototype, "rotationType", void 0);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/VisualVariableSizeMinMaxValue.js
var m5 = class extends w2 {
  getSize(t9, r10) {
    const e9 = this.minMaxValueAndSize.xy, i10 = this.minMaxValueAndSize.zw;
    return zt(x2(t9), r10, () => {
      const r11 = t9.subtract(e9.x).divide(e9.y.subtract(e9.x)), s12 = se(r11, new C2(0), new C2(1));
      return i10.x.add(s12.multiply(i10.y.subtract(i10.x)));
    });
  }
};
__decorate([m4(_3)], m5.prototype, "minMaxValueAndSize", void 0);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/VisualVariableSizeScaleStops.js
var u4 = class extends w2 {
  getSizeForViewScale(s12) {
    return Tt([_t(s12, this.values.first()), this.sizes.first()], [Ht(s12, this.values.last()), this.sizes.last()], [true, () => {
      const t9 = this.values.findIndex((t10) => Gt(t10, s12)), e9 = this.values.get(t9), i10 = t9.subtract(1), r10 = this.values.get(i10), o19 = s12.subtract(r10).divide(e9.subtract(r10));
      return _e(this.sizes.get(i10), this.sizes.get(t9), o19);
    }]);
  }
};
__decorate([m4(B2.ofType(C2, 8))], u4.prototype, "sizes", void 0), __decorate([m4(B2.ofType(C2, 8))], u4.prototype, "values", void 0);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/VisualVariableSizeStops.js
var f6 = class extends w2 {
  getSize(s12, t9) {
    const e9 = Tt([x2(s12), t9], [_t(s12, this.values.first()), this.sizes.first()], [Ht(s12, this.values.last()), this.sizes.last()], [true, () => {
      const t10 = this.values.findIndex((t11) => Gt(t11, s12)), e10 = this.values.get(t10), i10 = t10.subtract(1), r10 = this.values.get(i10), o19 = s12.subtract(r10).divide(e10.subtract(r10));
      return _e(this.sizes.get(i10), this.sizes.get(t10), o19);
    }]);
    return zt(x2(e9), t9, e9);
  }
};
__decorate([m4(B2.ofType(C2, 8))], f6.prototype, "sizes", void 0), __decorate([m4(B2.ofType(C2, 8))], f6.prototype, "values", void 0);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/VisualVariableSizeUnitValue.js
var s8 = class extends w2 {
  getSize(t9, o19) {
    return zt(x2(t9), o19, t9.multiply(this.unitValueToPixelsRatio));
  }
};
__decorate([m4(C2)], s8.prototype, "unitValueToPixelsRatio", void 0);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/vvUtils.js
function t5(a8) {
  return null != a8.visualVariableSizeMinMaxValue || null != a8.visualVariableSizeScaleStops || null != a8.visualVariableSizeStops || null != a8.visualVariableSizeUnitValue;
}
function l3(a8, e9, i10) {
  if (t5(a8)) {
    const t9 = a8.storage.getSizeValue(e9);
    return a8.visualVariableSizeMinMaxValue?.getSize(t9, i10) ?? a8.visualVariableSizeScaleStops?.getSizeForViewScale(a8.view.currentScale) ?? a8.visualVariableSizeStops?.getSize(t9, i10) ?? a8.visualVariableSizeUnitValue?.getSize(t9, i10);
  }
  return i10;
}
function r8(e9, i10, t9, l10 = new J2(false)) {
  if (null == e9.visualVariableColor) return t9;
  const r10 = e9.storage.getColorValue(i10);
  return e9.visualVariableColor.getColor(r10, t9, l10);
}
function n4(a8, i10) {
  if (null == a8.visualVariableOpacity) return new C2(1);
  const t9 = a8.storage.getOpacityValue(i10);
  return a8.visualVariableOpacity.getOpacity(t9);
}
function u5(a8, e9) {
  if (null == a8.visualVariableRotation) return rt.identity();
  const t9 = a8.storage.getRotationValue(e9);
  return a8.visualVariableRotation.getVVRotationMat3(t9);
}
function o10(a8, i10) {
  if (null == a8.visualVariableRotation) return new C2(0);
  const t9 = a8.storage.getRotationValue(i10);
  return a8.visualVariableRotation.getNormalizedAngle(t9);
}

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/animated/AAnimatedShader.js
var W2 = class extends S {
};
__decorate([f4(3, X)], W2.prototype, "offset", void 0), __decorate([f4(4, _3)], W2.prototype, "sizing", void 0), __decorate([f4(5, _3)], W2.prototype, "value1Position2Value2", void 0), __decorate([f4(6, _3)], W2.prototype, "animationPointerAndBaseSizeAndReferenceSize", void 0), __decorate([f4(7, X)], W2.prototype, "zoomRange", void 0), __decorate([f4(8, C2)], W2.prototype, "lineLength", void 0);
var q3 = class extends P3 {
};
var H2 = class extends B4 {
  _vertexPreamble(i10, t9, e9) {
    const { id: o19, offset: a8, animationPointerAndBaseSizeAndReferenceSize: r10, sizing: s12 } = i10, l10 = r10.xy, n16 = r10.z, b8 = r10.w, S7 = s12.xy, h12 = this._getEvalParams(i10, S7, e9);
    let w7, g13;
    if (i10.value1Position2Value2) {
      const t10 = J3(l10, 6, h12).a, e10 = i10.pos, o20 = i10.value1Position2Value2.yz, a9 = i10.value1Position2Value2.x, r11 = i10.value1Position2Value2.w, s13 = t10.subtract(a9).divide(r11.subtract(a9));
      g13 = e10.add(o20.subtract(e10).multiply(s13)), w7 = ln(new C2(1), s13).add(ln(new C2(0), gt(s13)));
    } else g13 = i10.pos, w7 = new C2(0);
    const V4 = s12.z, x9 = h5(i10.bitset, o5.bitset.isStroke), z6 = s12.w, j6 = h5(i10.bitset, o5.bitset.scaleSymbolsProportionally), T6 = J3(l10, 0, h12), _5 = Tt([Ct(h5(i10.bitset, o5.bitset.isMapAligned), new C2(1)), this.view.rotation.divide(180).multiply(Math.PI)], [true, new C2(0)]), O4 = new nt(oe(_5), un(_5.multiply(-1)), un(_5), oe(_5)).multiply(T6.xy), C8 = T6.z.subtract(_5).subtract(t9.multiply(o6)), M3 = T6.w, A8 = h5(i10.bitset, o5.bitset.isSDF), F10 = l3(this, o19, new C2(b8)).divide(new C2(b8));
    return { baseSize: n16, animationPointer: l10, strokeWidth: V4, isOutline: x9, unscaledDistanceToPx: z6, scaleSymbolsProportionally: j6, isSDF: A8, position: this._getScreenPosition({ id: o19, pos: g13, offset: a8, referenceSize: b8, translation: O4, rotation: C8, scale: M3, vvScale: F10 }), evalParams: h12, vvScale: F10, scale: M3, clip: w7 };
  }
  _getScreenPosition(i10) {
    const { pos: t9, translation: e9, rotation: o19, scale: a8, offset: r10, id: s12, vvScale: l10 } = i10, n16 = o10(this, s12).multiply(Math.PI / 180), p9 = e9.x.multiply(4 / 3), d9 = e9.y.multiply(-1).multiply(4 / 3), c8 = un(n16), y6 = oe(n16), h12 = y6.multiply(p9).add(gt(c8).multiply(d9)), w7 = c8.multiply(p9).add(y6.multiply(d9)), g13 = un(o19.subtract(n16)), V4 = oe(o19.subtract(n16)), x9 = new C2(0), z6 = new C2(1), { pixelRatio: P10 } = this.animationInfo, j6 = new rt(z6, x9, x9, x9, z6, x9, h12.multiply(P10), w7.multiply(P10), z6), T6 = new rt(V4, g13.multiply(-1), x9, g13, V4, x9, 0, 0, z6), _5 = a8.multiply(l10).multiply(P10).multiply(4 / 3), I3 = T6.multiply(_5), O4 = this.animationInfo.toScreen.multiply(new Y2(t9, 1)), C8 = j6.multiply(O4).xy, M3 = I3.multiply(new Y2(r10, 0)).xy;
    return C8.add(M3);
  }
  _clip(i10, e9) {
    let o19 = super.clip(i10, e9);
    const a8 = _t(this._getLocalTimeOrigin(i10), new C2(0));
    return t4.forceGlobalTimeOrigin || (o19 = o19.add(Tt([a8, () => new C2(2)], [true, () => new C2(0)]))), o19;
  }
  _getLocalTimeOrigin(i10) {
    return this.storage.getLocalTimeOrigin(i10);
  }
  _toNdc(i10) {
    return this.animationInfo.toNdc.multiply(new Y2(i10, 1)).xy;
  }
  _getEvalParams(i10, t9, e9) {
    const { globalTime: o19, animationTextureSize: a8, animationTexture: r10 } = this.animationInfo;
    return { globalTime: o19, localTimeOrigin: this._getLocalTimeOrigin(i10.id), animationTextureSize: a8, animationTexture: r10, pixelDimensions: t9, lineLength: e9 };
  }
  _getColor(i10, t9) {
    return zt(Ct(t9.isSDF, new C2(1)), this._getSDFColor(i10, t9), this._getSpriteColor(i10, t9));
  }
  _getSpriteColor(i10, t9) {
    return wn(this.mosaicInfo.texture, i10).multiply(t9.color);
  }
  _getSDFColor(i10, t9) {
    const e9 = wn(this.mosaicInfo.texture, i10), o19 = new C2(0.5).subtract(C4(e9)).multiply(t9.distanceToPx).multiply(p), a8 = se(new C2(0.5).subtract(o19), new C2(0), new C2(1)), r10 = t9.color.multiply(a8), s12 = t9.outlineSize.multiply(0.5), n16 = Qt(o19).subtract(s12), p9 = se(new C2(0.5).subtract(n16), new C2(0), new C2(1)), u18 = t9.outlineColor.multiply(p9);
    return new C2(1).subtract(u18.a).multiply(r10).add(u18);
  }
};
function J3(i10, t9, o19) {
  const a8 = i10.add(new X(t9, 0)), r10 = wn(o19.animationTexture, a8.add(0.5).divide(o19.animationTextureSize)).xy;
  return i10 = i10.add(r10), xt({ animationPointer: i10, ...o19 }, _3, null, (i11) => {
    const { out: t10 } = i11;
    if (!t10) throw new Error("out is null");
    return g({ ...i11, out: t10 });
  });
}
__decorate([m4(s7)], H2.prototype, "mosaicInfo", void 0), __decorate([m4(d3)], H2.prototype, "animationInfo", void 0), __decorate([m4(n3)], H2.prototype, "localTileOffset", void 0), __decorate([g2(f5)], H2.prototype, "visualVariableColor", void 0), __decorate([g2(h6)], H2.prototype, "visualVariableOpacity", void 0), __decorate([g2(m5)], H2.prototype, "visualVariableSizeMinMaxValue", void 0), __decorate([g2(u4)], H2.prototype, "visualVariableSizeScaleStops", void 0), __decorate([g2(f6)], H2.prototype, "visualVariableSizeStops", void 0), __decorate([g2(s8)], H2.prototype, "visualVariableSizeUnitValue", void 0), __decorate([g2(g4)], H2.prototype, "visualVariableRotation", void 0);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/animated/AAnimatedPolyShader.js
var b = class extends W2 {
};
__decorate([f4(9, _3)], b.prototype, "tlbr", void 0);
var v2 = class extends x {
};
__decorate([f4(13, X)], v2.prototype, "nextPos1", void 0), __decorate([f4(14, X)], v2.prototype, "nextPos2", void 0);
var S2 = class extends q3 {
};
var g5 = class extends H2 {
  constructor() {
    super(...arguments), this.computeAttributes = { pos: ["nextPos1", "nextPos2"] };
  }
  _fragmentPoly(t9) {
    const e9 = Ge(t9.uv, new C2(1)), o19 = _e(t9.tlbr.xy, t9.tlbr.zw, e9);
    return this._getColor(o19, { color: t9.color, distanceToPx: t9.distanceToPx, isSDF: t9.isSDF, outlineColor: t9.outlineColor, outlineSize: t9.strokeWidth });
  }
  _vertexPoly(t9) {
    const { position: e9, animationPointer: o19, evalParams: s12, isOutline: c8, unscaledDistanceToPx: m12, vvScale: d9, strokeWidth: u18, scaleSymbolsProportionally: b8, scale: v7, isSDF: S7, baseSize: g13, clip: f14 } = this._vertexPreamble(t9, new C2(0), t9.lineLength || new C2(0)), w7 = this._toNdc(e9);
    let j6 = J3(o19, 1, s12);
    j6 = new _3(j6.rgb.multiply(j6.a), j6.a);
    let k7 = J3(o19, 2, s12);
    k7 = new _3(k7.rgb.multiply(k7.a), k7.a);
    let z6 = J3(o19, 3, s12);
    z6 = new _3(z6.rgb.multiply(z6.a), z6.a);
    const D6 = J3(o19, 4, s12).a, T6 = J3(o19, 5, s12).a, _5 = r8(this, t9.id, j6, At(k(t9.bitset, o5.bitset.colorLocked), new J2(c8))), C8 = _e(_5, k7, z6), F10 = n4(this, t9.id), A8 = _e(F10, D6, T6), W4 = C8.multiply(A8), L5 = this.clip(t9.id, t9.zoomRange).add(f14.multiply(2)), O4 = m12.multiply(d9);
    return { unscaledDistanceToPx: m12, vvScale: d9, strokeWidth: u18, scaleSymbolsProportionally: b8, scale: v7, isSDF: S7, baseSize: g13, ndc: w7, color: W4, z: L5, isOutline: c8, evalParams: s12, distanceToPx: O4 };
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/hittestUtils.js
function v3(t9, u18) {
  return we(t9, Ae(u18));
}
function j(i10, y6, s12) {
  const l10 = s12.subtract(y6), c8 = v3(i10.subtract(y6), l10), e9 = se(c8.divide(je(l10)), new C2(0), new C2(1));
  return ye(i10, y6.add(e9.multiply(s12.subtract(y6))));
}
function g6(t9) {
  const n16 = Qt(t9);
  return ln(n16.x.add(n16.y).add(n16.z), new C2(1.05));
}
function h7(t9, n16, r10, y6) {
  const s12 = new rt(r10.x.multiply(y6.y).subtract(y6.x.multiply(r10.y)), y6.x.multiply(n16.y).subtract(n16.x.multiply(y6.y)), n16.x.multiply(r10.y).subtract(r10.x.multiply(n16.y)), r10.y.subtract(y6.y), y6.y.subtract(n16.y), n16.y.subtract(r10.y), y6.x.subtract(r10.x), n16.x.subtract(y6.x), r10.x.subtract(n16.x)), l10 = n16.x.multiply(r10.y.subtract(y6.y)), c8 = r10.x.multiply(y6.y.subtract(n16.y)), e9 = y6.x.multiply(n16.y.subtract(r10.y)), o19 = l10.add(c8).add(e9);
  return new C2(1).divide(o19).multiply(s12.multiply(new Y2(1, t9)));
}
function M(t9, n16, r10, i10) {
  return Ct(g6(h7(t9, n16, r10, i10)), new C2(1));
}
function P4(t9, n16, r10, i10) {
  const a8 = r10.subtract(n16), o19 = i10.subtract(n16), p9 = z(a8, o19), x9 = Lt(Yt(p9, new C2(i4)), Gt(p9, new C2(-i4)));
  return Tt([Lt(Ve(x9), M(t9.xy, n16, r10, i10)), new C2(-1)], [true, () => {
    const u18 = j(t9, n16, r10), y6 = j(t9, r10, i10), s12 = j(t9, i10, n16);
    return Ye(Ye(u18, y6), s12);
  }]);
}
function q4(t9) {
  return t9.distance.add(1);
}
function z2(t9, u18, n16) {
  const { viewMat3: r10, tileMat3: y6 } = t9.view, s12 = r10.multiply(y6), l10 = s12.multiply(new Y2(u18.pos, 1)), c8 = s12.multiply(new Y2(n16.nextPos1, 1)), e9 = s12.multiply(new Y2(n16.nextPos2, 1));
  return P4(t9.hittestRequest.position, l10.xy, c8.xy, e9.xy);
}
function R2(t9, u18, n16) {
  return ye(t9, n16).subtract(u18);
}

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/FillShader.js
var g7 = class extends S {
};
__decorate([f4(3, _3)], g7.prototype, "color", void 0), __decorate([f4(4, X)], g7.prototype, "zoomRange", void 0);
var x3 = class extends B4 {
  constructor() {
    super(...arguments), this.type = "FillShader", this.computeAttributes = { pos: ["nextPos1", "nextPos2"] };
  }
  vertex(t9, o19) {
    const r10 = n4(this, t9.id), e9 = r8(this, t9.id, t9.color).multiply(r10), i10 = this.view.displayViewScreenMat3.multiply(new Y2(t9.pos.xy, 1)), p9 = this.clip(t9.id, t9.zoomRange);
    return { glPosition: new _3(i10.xy, p9, 1), color: e9, ...this.maybeRunHittest(t9, o19, null) };
  }
  fragment(t9) {
    return this.getFragmentOutput(t9.color, t9, new C2(0));
  }
  hittest(t9, o19) {
    return z2(this, t9, o19);
  }
};
__decorate([g2(f5)], x3.prototype, "visualVariableColor", void 0), __decorate([g2(h6)], x3.prototype, "visualVariableOpacity", void 0), __decorate([__param(0, l2(g7)), __param(1, l2(q2))], x3.prototype, "vertex", null), __decorate([__param(0, l2(P3))], x3.prototype, "fragment", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/ComplexFillShader.js
var G3 = class extends g7 {
};
__decorate([f4(5, _3)], G3.prototype, "tlbr", void 0), __decorate([f4(6, C2)], G3.prototype, "width", void 0), __decorate([f4(7, C2)], G3.prototype, "height", void 0), __decorate([f4(8, X)], G3.prototype, "offset", void 0), __decorate([f4(9, X)], G3.prototype, "scale", void 0), __decorate([f4(10, C2)], G3.prototype, "angle", void 0);
var L2 = class extends P3 {
};
function P5(t9, e9, o19, i10, r10) {
  const l10 = Ct(h5(r10, C), st2(1)), f14 = C4(new _3(t9, 0));
  return zt(l10, ft(i10.divide(e9.x), o19.divide(e9.y), 0, gt(o19.divide(e9.x)), i10.divide(e9.y), 0, w3(ot(f14, 0)), w3(ot(0, f14)), 1), ft(i10.divide(e9.x), o19.divide(e9.y), 0, gt(o19.divide(e9.x)), i10.divide(e9.y), 0, 0, 0, 1));
}
function Z(t9, e9) {
  const o19 = t9.view.requiredZoomFactor, i10 = new X(e9.width, e9.height), r10 = i10.multiply(e9.scale).multiply(o19), s12 = e9.angle.multiply(o6), p9 = un(s12), n16 = oe(s12), d9 = P5(e9.id, r10, p9, n16, e9.bitset), m12 = t9.localTileOffset.getPatternOffsetAtTileOrigin(i10, p9, n16), u18 = o19.multiply(e9.scale).multiply(e9.offset.subtract(m12)).divide(r10), x9 = new Y2(e9.pos, 1), h12 = d9.multiply(x9).xy.subtract(u18), g13 = e9.tlbr.divide(t9.mosaicInfo.size.xyxy);
  let b8 = h5(e9.bitset, w);
  return null != t9.visualVariableColor && (b8 = zt(x2(t9.storage.getColorValue(e9.id)), new C2(0), b8)), { tileTextureCoord: h12, tlbr: g13, sampleAlphaOnly: b8 };
}
function k2(t9, e9) {
  const o19 = Ge(e9.tileTextureCoord, new C2(1)), i10 = _e(e9.tlbr.xy, e9.tlbr.zw, o19);
  let r10 = wn(t9.mosaicInfo.texture, i10);
  return r10 = zt(Gt(e9.sampleAlphaOnly, new C2(0.5)), r10.aaaa, r10), e9.color.multiply(r10);
}
var B5 = class extends x3 {
  constructor() {
    super(...arguments), this.type = "ComplexFillShader";
  }
  vertex(t9, e9) {
    return { ...super.vertex(t9, e9), ...Z(this, t9) };
  }
  fragment(t9) {
    const e9 = k2(this, t9);
    return this.getFragmentOutput(e9, t9, new C2(0));
  }
};
__decorate([m4(s7)], B5.prototype, "mosaicInfo", void 0), __decorate([m4(n3)], B5.prototype, "localTileOffset", void 0), __decorate([__param(0, l2(G3)), __param(1, l2(q2))], B5.prototype, "vertex", null), __decorate([__param(0, l2(L2))], B5.prototype, "fragment", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/animated/AnimatedFillShader.js
var c2 = class extends g5 {
  constructor() {
    super(...arguments), this.type = "AnimatedFillShader";
  }
  vertex(t9, e9) {
    const { distanceToPx: i10, ndc: a8, z: p9, color: u18, isOutline: d9, strokeWidth: y6, isSDF: c8, scale: f14, scaleSymbolsProportionally: x9 } = this._vertexPoly(t9), g13 = this.view.requiredZoomFactor, b8 = t9.sizing.xy, P10 = b8.multiply(g13), v7 = new C2(0), S7 = un(v7), w7 = oe(v7), F10 = P5(t9.id, P10, S7, w7, t9.bitset), O4 = this.localTileOffset.getPatternOffsetAtTileOrigin(b8, S7, w7), j6 = g13.multiply(t9.offset.subtract(O4)).divide(P10), A8 = new Y2(t9.pos, 1), T6 = F10.multiply(A8).xy.subtract(j6), z6 = t9.tlbr.divide(this.mosaicInfo.size.xyxy);
    return { glPosition: new _3(a8, p9, 1), tlbr: z6, uv: T6, color: u18.multiply(new C2(1).subtract(d9)), outlineColor: u18.multiply(d9), distanceToPx: i10, strokeWidth: y6.multiply(_e(new C2(1), f14, x9)), isOutline: d9, isSDF: c8, ...this.maybeRunHittest(t9, e9, {}) };
  }
  fragment(t9) {
    const e9 = this._fragmentPoly(t9);
    return this.getFragmentOutput(e9, t9);
  }
  hittest(t9, e9, i10) {
    return z2(this, t9, e9);
  }
};
__decorate([__param(0, l2(b)), __param(1, l2(v2))], c2.prototype, "vertex", null), __decorate([__param(0, l2(S2))], c2.prototype, "fragment", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/LineShader.js
var q5 = class extends S {
};
__decorate([f4(3, _3)], q5.prototype, "color", void 0), __decorate([f4(4, X)], q5.prototype, "offset", void 0), __decorate([f4(5, X)], q5.prototype, "normal", void 0), __decorate([f4(6, C2)], q5.prototype, "halfWidth", void 0), __decorate([f4(7, C2)], q5.prototype, "referenceHalfWidth", void 0), __decorate([f4(8, X)], q5.prototype, "zoomRange", void 0);
var A3 = class extends P3 {
};
var F2 = class extends w2 {
};
function D3(t9) {
  return Xe(new C2(r4).multiply(ln(t9, new C2(s3))), new C2(1));
}
function G4(t9, i10) {
  const { halfWidth: e9, normal: o19 } = t9, l10 = D3(e9), a8 = je(o19).multiply(e9);
  return se(l10.multiply(e9.subtract(a8)).divide(i10.add(l10).subtract(new C2(1))), new C2(0), new C2(1));
}
function L3(t9, i10) {
  const { id: e9, halfWidth: o19, referenceHalfWidth: l10 } = i10;
  if (t5(t9)) {
    const i11 = new C2(2).multiply(l10), a8 = l3(t9, e9, i11);
    return new C2(0.5).multiply(o19.divide(Xe(l10, new C2(h)))).multiply(a8);
  }
  return o19;
}
function T2(t9, i10) {
  const { id: e9, offset: o19, pos: l10, normal: a8, zoomRange: r10 } = i10, { displayViewScreenMat3: p9, displayViewMat3: u18 } = t9.view, m12 = r8(t9, e9, i10.color), f14 = n4(t9, e9), h12 = L3(t9, i10), v7 = new C2(0.5).multiply(t9.antialiasingControls.antialiasing), w7 = Xe(h12.add(v7), new C2(0.45)).add(new C2(0.1).multiply(v7)), V4 = D3(w7).multiply(w7).multiply(o19), b8 = u18.multiply(new Y2(V4, new C2(0))), S7 = p9.multiply(new Y2(l10, new C2(1))).add(b8), x9 = new C2(2).multiply(ln(h12, new C2(0))).add(t9.clip(e9, r10)), g13 = new _3(S7.xy, x9, 1);
  return { color: m12, opacity: f14, halfWidth: w7, normal: a8, scaledOffset: V4, scaledHalfWidth: h12, glPosition: new _3(g13.xy, x9, 1) };
}
function k3(t9, i10) {
  const { opacity: e9, color: o19 } = t9, l10 = G4(t9, i10);
  return e9.multiply(o19).multiply(l10);
}
__decorate([m4(C2)], F2.prototype, "antialiasing", void 0), __decorate([m4(C2)], F2.prototype, "blur", void 0);
var B6 = class extends B4 {
  constructor() {
    super(...arguments), this.type = "LineShader", this.computeAttributes = { pos: ["nextPos1", "nextPos2"] };
  }
  vertex(t9, i10) {
    const e9 = T2(this, t9);
    return { ...e9, ...this.maybeRunHittest(t9, i10, e9.halfWidth) };
  }
  fragment(t9) {
    const i10 = k3(t9, this.antialiasingControls.blur);
    return this.getFragmentOutput(i10, t9);
  }
  hittest(t9, i10, e9) {
    const { viewMat3: o19, tileMat3: l10 } = this.view, a8 = o19.multiply(l10), r10 = a8.multiply(new Y2(t9.pos, 1)), u18 = a8.multiply(new Y2(i10.nextPos1, 1)), m12 = a8.multiply(new Y2(i10.nextPos2, 1)), { distance: d9, smallSymbolDistance: y6, smallSymbolSizeThreshold: c8 } = this.hittestRequest, f14 = ln(e9, c8.multiply(0.5)).multiply(d9.subtract(y6)), h12 = this.hittestRequest.position;
    return Ye(j(h12, r10.xy, u18.xy), j(h12, r10.xy, m12.xy)).subtract(e9).add(f14);
  }
};
__decorate([m4(F2)], B6.prototype, "antialiasingControls", void 0), __decorate([g2(f5)], B6.prototype, "visualVariableColor", void 0), __decorate([g2(h6)], B6.prototype, "visualVariableOpacity", void 0), __decorate([g2(m5)], B6.prototype, "visualVariableSizeMinMaxValue", void 0), __decorate([g2(u4)], B6.prototype, "visualVariableSizeScaleStops", void 0), __decorate([g2(f6)], B6.prototype, "visualVariableSizeStops", void 0), __decorate([g2(s8)], B6.prototype, "visualVariableSizeUnitValue", void 0), __decorate([__param(0, l2(q5)), __param(1, l2(q2))], B6.prototype, "vertex", null), __decorate([__param(0, l2(A3))], B6.prototype, "fragment", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/animated/AnimatedLineShader.js
var A4 = class extends b {
};
__decorate([f4(10, C2)], A4.prototype, "accumulatedDistance", void 0), __decorate([f4(11, X)], A4.prototype, "normal", void 0), __decorate([f4(12, X)], A4.prototype, "segmentDirection", void 0);
var D4 = class extends S2 {
};
var j2 = class extends g5 {
  constructor() {
    super(...arguments), this.type = "AnimatedLineShader";
  }
  vertex(t9, i10) {
    const { animationPointerAndBaseSizeAndReferenceSize: e9 } = t9, s12 = e9.xy, { distanceToPx: l10, ndc: p9, z: u18, color: y6, isOutline: c8, strokeWidth: h12, isSDF: x9, baseSize: v7, scale: f14, scaleSymbolsProportionally: w7, evalParams: g13 } = this._vertexPoly(t9), S7 = t9.sizing.xy, P10 = S7.x.multiply(v7).divide(S7.y), z6 = J3(s12, 6, g13).a, A8 = t9.accumulatedDistance.subtract(z6), { normal: D6 } = t9, j6 = t9.normal.y, C8 = A8.divide(this.view.displayZoomFactor).add(we(t9.segmentDirection, t9.offset)).divide(P10), F10 = j6.add(1).divide(2), R8 = new X(C8, F10), W4 = t9.tlbr.divide(this.mosaicInfo.size.xyxy), M3 = v7.divide(2), O4 = new C2(0.5).multiply(this.antialiasingControls.antialiasing), T6 = Xe(M3.add(O4), new C2(0.45)).add(new C2(0.1).multiply(O4));
    return { glPosition: new _3(p9, u18, 1), tlbr: W4, uv: R8, color: y6.multiply(new C2(1).subtract(c8)), outlineColor: y6.multiply(c8), distanceToPx: l10, strokeWidth: h12.multiply(_e(new C2(1), f14, w7)), isOutline: c8, isSDF: x9, halfWidth: T6, normal: D6, ...this.maybeRunHittest(t9, i10, T6) };
  }
  fragment(t9) {
    const i10 = this._fragmentPoly(t9), e9 = G4(t9, this.antialiasingControls.blur), { halfWidth: s12, normal: l10 } = t9, o19 = D3(s12), a8 = je(l10).multiply(s12), r10 = se(o19.multiply(s12.subtract(a8)).divide(o19.subtract(new C2(1))), new C2(0), new C2(1));
    return this.getFragmentOutput(i10.multiply(r10).multiply(e9), t9);
  }
  hittest(t9, i10, e9) {
    const { viewMat3: s12, tileMat3: l10 } = this.view, o19 = s12.multiply(l10), a8 = o19.multiply(new Y2(t9.pos, 1)), n16 = o19.multiply(new Y2(i10.nextPos1, 1)), r10 = o19.multiply(new Y2(i10.nextPos2, 1)), { distance: d9, smallSymbolDistance: m12, smallSymbolSizeThreshold: p9 } = this.hittestRequest, u18 = ln(e9, p9.multiply(0.5)).multiply(d9.subtract(m12)), x9 = this.hittestRequest.position;
    return Ye(j(x9, a8.xy, n16.xy), j(x9, a8.xy, r10.xy)).subtract(e9).add(u18);
  }
};
__decorate([m4(F2)], j2.prototype, "antialiasingControls", void 0), __decorate([__param(0, l2(A4)), __param(1, l2(v2))], j2.prototype, "vertex", null), __decorate([__param(0, l2(D4))], j2.prototype, "fragment", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/animated/AnimatedMarkerShader.js
var R3 = class extends W2 {
};
__decorate([f4(9, X)], R3.prototype, "uv", void 0), __decorate([f4(10, C2)], R3.prototype, "angle", void 0);
var F3 = class extends x {
};
__decorate([f4(11, X)], F3.prototype, "offsetNextVertex1", void 0), __decorate([f4(12, X)], F3.prototype, "offsetNextVertex2", void 0), __decorate([f4(13, X)], F3.prototype, "textureUVNextVertex1", void 0), __decorate([f4(14, X)], F3.prototype, "textureUVNextVertex2", void 0);
var j3 = class extends q3 {
};
function T3(t9, e9, i10, s12) {
  return e9.multiply(t9.x).add(i10.multiply(t9.y)).add(s12.multiply(t9.z));
}
var U2 = class extends H2 {
  constructor() {
    super(...arguments), this.type = "AnimatedMarkerShader", this.computeAttributes = { offset: ["offsetNextVertex1", "offsetNextVertex2"], uv: ["textureUVNextVertex1", "textureUVNextVertex2"] };
  }
  vertex(t9, e9) {
    const i10 = t9.uv.divide(this.mosaicInfo.size), { position: s12, animationPointer: o19, evalParams: l10, isOutline: p9, unscaledDistanceToPx: h12, vvScale: x9, strokeWidth: c8, scaleSymbolsProportionally: y6, scale: f14, isSDF: w7, baseSize: g13, clip: v7 } = this._vertexPreamble(t9, t9.angle, t9.lineLength || new C2(0)), b8 = this._toNdc(s12);
    let _5 = J3(o19, 1, l10);
    _5 = new _3(_5.rgb.multiply(_5.a), _5.a);
    let z6 = J3(o19, 2, l10);
    z6 = new _3(z6.rgb.multiply(z6.a), z6.a);
    let C8 = J3(o19, 3, l10);
    C8 = new _3(C8.rgb.multiply(C8.a), C8.a);
    const P10 = J3(o19, 4, l10).a, N4 = J3(o19, 5, l10).a, R8 = r8(this, t9.id, _5, At(k(t9.bitset, o5.bitset.colorLocked), new J2(p9))), F10 = _e(R8, z6, C8), j6 = n4(this, t9.id), T6 = _e(j6, P10, N4), U3 = F10.multiply(T6), q7 = this.clip(t9.id, t9.zoomRange).add(v7.multiply(2)), A8 = h12.multiply(x9);
    return { glPosition: new _3(b8, q7, 1), uv: i10, color: U3.multiply(new C2(1).subtract(p9)), outlineColor: U3.multiply(p9), distanceToPx: A8, strokeWidth: c8.multiply(_e(new C2(1), f14, y6)), isOutline: p9, isSDF: w7, ...this.maybeRunHittest(t9, e9, { pos: t9.pos, size: g13, sizeCorrection: new C2(1), isMapAligned: new C2(1), vvRotationMat3: new rt(1, 0, 0, 0, 1, 0, 0, 0, 1), placementMat3: new rt(1, 0, 0, 0, 1, 0, 0, 0, 1), outlineSize: new C2(1), distanceToPx: A8, isSDF: w7 }) };
  }
  fragment(t9) {
    let e9 = this._getColor(t9.uv, { color: t9.color, distanceToPx: t9.distanceToPx, isSDF: t9.isSDF, outlineColor: t9.outlineColor, outlineSize: t9.strokeWidth });
    return t4.spotlightAnimatedSymbols && (e9 = e9.add(new _3(0, 0.3, 0, 0.3))), this.getFragmentOutput(e9, t9);
  }
  hittest(t9, e9, i10) {
    return zt(Yt(i10.size, this.hittestRequest.smallSymbolSizeThreshold), this._hittestSmallMarker(t9, e9, i10), this._hittestMarker(t9, e9, i10));
  }
  _hittestSmallMarker(t9, e9, i10) {
    const { position: s12, distance: o19, smallSymbolDistance: l10 } = this.hittestRequest, r10 = o19.subtract(l10), { viewMat3: a8, tileMat3: n16 } = this.view, d9 = a8.multiply(n16).multiply(new Y2(i10.pos, 1)).xy, m12 = i10.size.multiply(0.5);
    return ye(d9, s12).subtract(m12).add(r10);
  }
  _hittestMarker(t9, e9, i10) {
    const s12 = this._vertexPreamble({ ...t9 }, t9.angle, new C2(0)).position, o19 = this._vertexPreamble({ ...t9, offset: e9.offsetNextVertex1 }, t9.angle, new C2(0)).position, l10 = this._vertexPreamble({ ...t9, offset: e9.offsetNextVertex2 }, t9.angle, new C2(0)).position, a8 = this.hittestRequest.position, n16 = this.hittestRequest.distance, d9 = P4(a8, s12, o19, l10);
    return zt(Gt(d9, n16), d9, this._hittestSamples(s12, o19, l10, t9, e9, i10));
  }
  _hittestSamples(t9, e9, i10, s12, o19, l10) {
    const { outlineSize: n16, isSDF: d9, distanceToPx: m12 } = l10, u18 = this.hittestRequest.position, p9 = this.hittestRequest.distance, h12 = h7(u18.add(new X(gt(p9), gt(p9))), t9, e9, i10), x9 = h7(u18.add(new X(0, gt(p9))), t9, e9, i10), c8 = h7(u18.add(new X(p9, gt(p9))), t9, e9, i10), y6 = h7(u18.add(new X(gt(p9), 0)), t9, e9, i10), v7 = h7(u18, t9, e9, i10), S7 = h7(u18.add(new X(p9, 0)), t9, e9, i10), b8 = h7(u18.add(new X(gt(p9), p9)), t9, e9, i10), _5 = h7(u18.add(new X(0, p9)), t9, e9, i10), V4 = h7(u18.add(new X(p9, p9)), t9, e9, i10), z6 = s12.uv.divide(this.mosaicInfo.size), k7 = o19.textureUVNextVertex1.divide(this.mosaicInfo.size), M3 = o19.textureUVNextVertex2.divide(this.mosaicInfo.size), D6 = { color: new _3(1, 1, 1, 1), outlineSize: n16, outlineColor: new _3(1, 1, 1, 1), isSDF: d9, distanceToPx: m12 };
    let R8 = new C2(0);
    return R8 = R8.add(g6(h12).multiply(this._getColor(T3(h12, z6, k7, M3), D6).a)), R8 = R8.add(g6(x9).multiply(this._getColor(T3(x9, z6, k7, M3), D6).a)), R8 = R8.add(g6(c8).multiply(this._getColor(T3(c8, z6, k7, M3), D6).a)), R8 = R8.add(g6(y6).multiply(this._getColor(T3(y6, z6, k7, M3), D6).a)), R8 = R8.add(g6(v7).multiply(this._getColor(T3(v7, z6, k7, M3), D6).a)), R8 = R8.add(g6(S7).multiply(this._getColor(T3(S7, z6, k7, M3), D6).a)), R8 = R8.add(g6(b8).multiply(this._getColor(T3(b8, z6, k7, M3), D6).a)), R8 = R8.add(g6(_5).multiply(this._getColor(T3(_5, z6, k7, M3), D6).a)), R8 = R8.add(g6(V4).multiply(this._getColor(T3(V4, z6, k7, M3), D6).a)), ln(R8, new C2(0.05)).multiply(q4(this.hittestRequest));
  }
};
__decorate([__param(0, l2(R3)), __param(1, l2(F3))], U2.prototype, "vertex", null), __decorate([__param(0, l2(j3))], U2.prototype, "fragment", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/FeatureTechnique.js
var t6 = class extends s5 {
  constructor() {
    super(...arguments), this.symbologyPlane = 0, this._input = null;
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/line/utils.js
function n5(n16) {
  const t9 = 1 / n16;
  return { antialiasing: t9, blur: 0 + t9 };
}

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/animated/AnimatedTechnique.js
var f7 = class extends t6 {
  render(o19, f14) {
    const { context: g13, painter: p9, pixelRatio: d9 } = o19, { target: x9 } = f14, { freezeGlobalTime: b8 } = t4, h12 = 0, D6 = p9.textureManager.animationStore.getTexture(g13, h12), T6 = [2 / o19.state.size[0], 0, 0, 0, -2 / o19.state.size[1], 0, -1, 1, 1], R8 = Array.from(s2(e4(), T6)), j6 = Array.from(i2(e4(), R8, x9.transforms.displayViewScreenMat3)), y6 = f14.instance.getInput(), z6 = p9.textureManager.getMosaicInfo(o19, f14.textureKey, false), { optionalAttributes: S7 } = y6, A8 = S7.zoomRange, I3 = S7.value1Position2Value2, M3 = "accumulatedDistance" in S7 && S7.accumulatedDistance, q7 = "segmentDirection" in S7 && S7.segmentDirection, w7 = "normal" in S7 && S7.normal;
    p9.setShader({ shader: this.shaders.geometry, uniforms: { ...u3(o19, f14.target, y6.uniforms), ...f2(o19, f14.target), antialiasingControls: n5(d9), mosaicInfo: z6, animationInfo: { globalTime: o19.animationsEnabled ? false === b8 ? o19.time / 1e3 : b8 : 0, animationTextureSize: [D6.descriptor.width, D6.descriptor.height], animationTexture: { unit: 6, texture: D6 }, toScreen: j6, toNdc: T6, mapRotation: o19.state.rotation, pixelRatio: o19.state.pixelRatio }, localTileOffset: h4(f14.target) }, defines: { ...d2(o19) }, optionalAttributes: { zoomRange: A8, value1Position2Value2: I3, accumulatedDistance: M3, segmentDirection: q7, normal: w7 }, useComputeBuffer: a(o19) }), p9.setPipelineState({ ...m3(o19) }), p9.submitDraw(o19, f14), false === b8 && o19.animationsEnabled && x9.requestRender();
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/animated/AnimatedTechniques.js
var o11 = class extends f7 {
  constructor() {
    super(...arguments), this.type = 2, this.symbologyPlane = 2, this.shaders = { geometry: new U2() };
  }
};
var i7 = class extends f7 {
  constructor() {
    super(...arguments), this.type = 3, this.symbologyPlane = 2, this.shaders = { geometry: new U2() };
  }
};
var n6 = class extends f7 {
  constructor() {
    super(...arguments), this.type = 0, this.symbologyPlane = 0, this.shaders = { geometry: new c2() };
  }
};
var a2 = class extends f7 {
  constructor() {
    super(...arguments), this.type = 1, this.symbologyPlane = 1, this.shaders = { geometry: new j2() };
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/dotDensity/DotDensityPointShader.js
var z3 = class extends C3 {
};
__decorate([f4(0, X)], z3.prototype, "pos", void 0);
var P6 = class extends P3 {
};
var R4 = class extends w2 {
};
__decorate([m4(C2)], R4.prototype, "dotSize", void 0);
var b2 = class extends w2 {
};
__decorate([m4(U)], b2.prototype, "locations", void 0), __decorate([m4(C2)], b2.prototype, "pixelRatio", void 0), __decorate([m4(C2)], b2.prototype, "tileZoomFactor", void 0);
var F4 = 1e-6;
var C5 = class extends P2 {
  constructor() {
    super(...arguments), this.type = "DotDensityPointShader";
  }
  vertex(t9) {
    const o19 = new rt(1, 0, 0, 0, -1, 0, 0, 1, 1).multiply(new Y2(t9.pos.xy.divide(o2), 1)), i10 = wn(this.draw.locations, o19.xy), r10 = Xe(this.instance.dotSize.divide(2), new C2(1));
    let s12 = new C2(0);
    s12 = s12.add(ln(i10.a, new C2(F4)).multiply(2));
    let d9 = r10.add(this.instance.dotSize);
    const n16 = this.view.displayViewScreenMat3.multiply(new Y2(t9.pos.add(0.5), 1)), p9 = new _3(n16.xy, s12, 1), l10 = this.instance.dotSize.divide(d9), h12 = new C2(-1).divide(r10.divide(d9));
    return d9 = d9.multiply(this.draw.pixelRatio.multiply(this.draw.tileZoomFactor)), { glPosition: p9, glPointSize: d9, color: i10, ratio: l10, invEdgeRatio: h12 };
  }
  fragment(t9) {
    const o19 = je(t9.glPointCoord.subtract(0.5)).multiply(2), e9 = on(new C2(0), new C2(1), t9.invEdgeRatio.multiply(o19.subtract(t9.ratio)).add(1)), i10 = new v();
    return i10.fragColor = t9.color.multiply(e9), i10;
  }
};
__decorate([m4(R4)], C5.prototype, "instance", void 0), __decorate([m4(b2)], C5.prototype, "draw", void 0), __decorate([m4(d4)], C5.prototype, "view", void 0), __decorate([__param(0, l2(z3))], C5.prototype, "vertex", null), __decorate([__param(0, l2(P6))], C5.prototype, "fragment", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/dotDensity/DotDensityPolygonShader.js
var j4 = class extends S {
};
__decorate([f4(3, C2)], j4.prototype, "inverseArea", void 0);
var V = class extends w2 {
};
__decorate([m4(B2.ofType(_3, 2))], V.prototype, "isActive", void 0), __decorate([m4(B2.ofType(_3, 8))], V.prototype, "colors", void 0), __decorate([m4(C2)], V.prototype, "dotValue", void 0);
var F5 = class extends w2 {
};
__decorate([m4(U)], F5.prototype, "dotTexture0", void 0), __decorate([m4(U)], F5.prototype, "dotTexture1", void 0), __decorate([m4(C2)], F5.prototype, "tileZoomFactor", void 0), __decorate([m4(C2)], F5.prototype, "pixelRatio", void 0), __decorate([m4(C2)], F5.prototype, "tileDotsOverArea", void 0);
var O2 = class extends B4 {
  constructor() {
    super(...arguments), this.type = "DotDensityPolygonShader";
  }
  _dotThreshold(t9, e9, o19) {
    return t9.divide(e9).divide(o19);
  }
  vertex(t9) {
    const e9 = new rt(2 / o2, 0, 0, 0, -2 / o2, 0, -1, 1, 1).multiply(new Y2(t9.pos, 1)), s12 = this.clip(t9.id), i10 = new _3(e9.xy, s12, 1), r10 = this.storage.getVVData(t9.id).multiply(this.instance.isActive.get(0)).multiply(t9.inverseArea), l10 = this.storage.getDataDrivenData0(t9.id).multiply(this.instance.isActive.get(1)).multiply(t9.inverseArea), d9 = this.draw.tileZoomFactor.multiply(o2).divide(this.draw.pixelRatio), n16 = this._dotThreshold(r10, this.instance.dotValue, this.draw.tileDotsOverArea), c8 = this._dotThreshold(l10, this.instance.dotValue, this.draw.tileDotsOverArea), u18 = t9.pos.add(0.5).divide(d9);
    return { glPosition: i10, color: new _3(0, 0, 0, 0), textureCoords: u18, thresholds0: n16, thresholds1: c8 };
  }
  fragment(t9) {
    const e9 = new v(), o19 = wn(this.draw.dotTexture0, t9.textureCoords), i10 = wn(this.draw.dotTexture1, t9.textureCoords), r10 = t9.thresholds0.subtract(o19), l10 = t9.thresholds1.subtract(i10);
    let d9;
    const n16 = it.fromColumns(this.instance.colors[0], this.instance.colors[1], this.instance.colors[2], this.instance.colors[3]), a8 = it.fromColumns(this.instance.colors[4], this.instance.colors[5], this.instance.colors[6], this.instance.colors[7]);
    if (this.blending) {
      const t10 = ln(new C2(0), r10), e10 = ln(new C2(0), l10), o20 = we(t10, r10).add(we(e10, l10)), s12 = ln(o20, new C2(0)), i11 = new C2(1).subtract(s12), p9 = o20.add(s12), h12 = r10.multiply(t10).divide(p9), c8 = l10.multiply(e10).divide(p9), u18 = n16.multiply(h12).add(a8.multiply(c8));
      d9 = i11.multiply(u18);
    } else {
      const t10 = Xe(D2(r10), D2(l10)), e10 = ln(t10, new C2(0)), o20 = new C2(1).subtract(e10), s12 = ln(t10, r10), i11 = ln(t10, l10), p9 = n16.multiply(s12).add(a8.multiply(i11));
      d9 = o20.multiply(p9);
    }
    return e9.fragColor = d9, e9;
  }
  hittest(t9) {
    return q4(this.hittestRequest);
  }
};
__decorate([_4], O2.prototype, "blending", void 0), __decorate([m4(V)], O2.prototype, "instance", void 0), __decorate([m4(F5)], O2.prototype, "draw", void 0), __decorate([__param(0, l2(j4))], O2.prototype, "vertex", null), __decorate([__param(0, l2(P3))], O2.prototype, "fragment", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/dotDensity/DotDensityResources.js
var T4 = { pos: { count: 2, type: R.UNSIGNED_SHORT } };
var m6 = class {
  constructor() {
    this._dotTextureSize = 0, this._dotTextures = null, this._dotMesh = null;
  }
  destroy() {
    this._disposeTextures(), this._dotFBO && this._dotFBO.dispose(), this._dotMesh && this._dotMesh.destroy();
  }
  getFBO(t9) {
    if (null == this._dotFBO) {
      const s12 = o2, r10 = o2, i10 = new h2(s12, r10);
      i10.samplingMode = 9728, i10.wrapMode = 33071;
      const n16 = new s4(t9, new i5(G.DEPTH24_STENCIL8, s12, r10));
      this._dotFBO = new m2(t9, i10, n16);
    }
    return this._dotFBO;
  }
  getDotDensityMesh(t9) {
    if (null == this._dotMesh) {
      const o19 = o2, r10 = o19 * o19, n16 = 2, d9 = new Int16Array(r10 * n16);
      for (let t10 = 0; t10 < o19; t10++) for (let e9 = 0; e9 < o19; e9++) d9[n16 * (e9 + t10 * o19)] = e9, d9[n16 * (e9 + t10 * o19) + 1] = t10;
      this._dotMesh = s6.create(t9, { primitive: _2.POINTS, vertex: d9, count: r10, layout: T4 });
    }
    return this._dotMesh;
  }
  getDotDensityTextures(e9, s12, o19) {
    if (this._dotTextureSize === s12 && this._seed === o19 || (this._disposeTextures(), this._dotTextureSize = s12, this._seed = o19), null === this._dotTextures) {
      const r10 = new t(o19);
      this._dotTextures = [this._allocDotDensityTexture(e9, s12, r10), this._allocDotDensityTexture(e9, s12, r10)];
    }
    return this._dotTextures;
  }
  _disposeTextures() {
    if (this._dotTextures) {
      for (let t9 = 0; t9 < this._dotTextures.length; t9++) this._dotTextures[t9].dispose();
      this._dotTextures = null;
    }
  }
  _allocDotDensityTexture(t9, e9, s12) {
    const o19 = new Float32Array(e9 * e9 * 4);
    for (let i10 = 0; i10 < o19.length; i10++) o19[i10] = s12.getFloat();
    const r10 = new h2(e9);
    return r10.dataType = N2.FLOAT, r10.samplingMode = 9728, new A(t9, r10, o19);
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/dotDensity/DotDensityTechnique.js
var f8 = class extends t6 {
  constructor() {
    super(...arguments), this.type = 11, this.shaders = { polygon: new O2(), point: new C5(), fill: new x3() }, this._resources = /* @__PURE__ */ new Map();
  }
  render(e9, t9) {
    l(e9) || a(e9) ? this._renderPolygons(e9, t9) : this._renderDotDensity(e9, t9);
  }
  _renderPolygons(e9, t9) {
    const { painter: i10 } = e9;
    i10.setShader({ shader: this.shaders.fill, uniforms: { ...f2(e9, t9.target), visualVariableColor: null, visualVariableOpacity: null }, defines: { ...d2(e9) }, optionalAttributes: { zoomRange: false }, useComputeBuffer: a(e9) }), i10.setPipelineState(m3(e9)), i10.submitDraw(e9, t9);
  }
  _renderDotDensity(o19, r10) {
    const { context: s12, painter: u18, requiredLevel: c8 } = o19, p9 = r10.instance.getInput().uniforms, h12 = this._getOrCreateResourcesRecord(s12), f14 = h12.getDotDensityTextures(s12, o2, p9.seed), m12 = 1 / 2 ** (c8 - r10.target.key.level), w7 = o2, g13 = w7 * window.devicePixelRatio * w7 * window.devicePixelRatio, x9 = 1 / m12 * (1 / m12), D6 = p9.dotScale ? o19.state.scale / p9.dotScale : 1, b8 = p9.dotValue * D6 * x9;
    u18.setShader({ shader: this.shaders.polygon, uniforms: { ...f2(o19, r10.target), instance: { isActive: p9.isActive, colors: p9.colors, dotValue: Math.max(1, b8) }, draw: { dotTexture0: { unit: N3, texture: f14[0] }, dotTexture1: { unit: O, texture: f14[1] }, tileZoomFactor: m12, pixelRatio: window.devicePixelRatio, tileDotsOverArea: g13 / (o2 * window.devicePixelRatio * o2 * window.devicePixelRatio) } }, defines: { ...d2(o19), blending: p9.blending }, optionalAttributes: {}, useComputeBuffer: false });
    const y6 = s12.getViewport();
    s12.setViewport(0, 0, o2, o2);
    const R8 = s12.getBoundFramebufferObject(), v7 = h12.getFBO(s12);
    s12.bindFramebuffer(v7), s12.setClearColor(0, 0, 0, 0), s12.clear(16384), u18.setPipelineState({ color: { write: [true, true, true, true], blendMode: "composite" }, depth: false, stencil: false }), u18.updatePipelineState(s12), u18.submitDraw(o19, r10), s12.bindFramebuffer(R8), s12.setViewport(y6.x, y6.y, y6.width, y6.height);
    const P10 = h12.getFBO(s12).colorTexture, S7 = { shader: this.shaders.point, uniforms: { view: r7(o19, r10.target), instance: { dotSize: p9.dotSize }, draw: { locations: { unit: N3, texture: P10 }, tileZoomFactor: 1, pixelRatio: window.devicePixelRatio } }, defines: { ...d2(o19) }, optionalAttributes: {}, useComputeBuffer: false };
    u18.setPipelineState(m3(o19)), u18.submitDrawMesh(s12, S7, h12.getDotDensityMesh(s12), { stencilRef: r10.getStencilReference() });
  }
  shutdown(e9) {
    super.shutdown(e9), this._resources.get(e9)?.destroy(), this._resources.delete(e9);
  }
  _getOrCreateResourcesRecord(e9) {
    let t9 = this._resources.get(e9);
    return null == t9 && (t9 = new m6(), this._resources.set(e9, t9)), t9;
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/fill/ComplexFillTechnique.js
var u6 = class extends t6 {
  constructor() {
    super(...arguments), this.type = 9, this.shaders = { geometry: new B5() };
  }
  render(e9, n16) {
    const { painter: u18 } = e9, m12 = n16.instance.getInput();
    u18.setShader({ shader: this.shaders.geometry, uniforms: { ...u3(e9, n16.target, m12.uniforms), ...f2(e9, n16.target), mosaicInfo: u18.textureManager.getMosaicInfo(e9, n16.textureKey), localTileOffset: h4(n16.target) }, defines: { ...d2(e9) }, optionalAttributes: m12.optionalAttributes, useComputeBuffer: a(e9) }), u18.setPipelineState(m3(e9)), u18.submitDraw(e9, n16);
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/OutlineFillShader.js
var R5 = class extends S {
};
__decorate([f4(3, X)], R5.prototype, "offset", void 0), __decorate([f4(4, _3)], R5.prototype, "color", void 0), __decorate([f4(5, X)], R5.prototype, "normal", void 0), __decorate([f4(6, C2)], R5.prototype, "halfWidth", void 0), __decorate([f4(7, C2)], R5.prototype, "referenceHalfWidth", void 0), __decorate([f4(8, X)], R5.prototype, "zoomRange", void 0);
var A5 = class extends A3 {
};
function H3(t9, o19, i10) {
  const { id: e9, bitset: r10 } = o19, s12 = h5(r10, B), m12 = Gt(s12, new C2(0.5)), d9 = T2(t9, o19), c8 = zt(m12, d9.halfWidth, new C2(0)), f14 = n4(t9, e9), h12 = r8(t9, e9, o19.color), V4 = zt(m12, zt(k(r10, L), h12, o19.color), h12.multiply(f14)), S7 = t9.view.displayViewScreenMat3.multiply(new Y2(o19.pos.xy, 1)), j6 = t9.clip(o19.id), x9 = new _3(S7.xy, j6, 1), z6 = zt(m12, d9.glPosition, x9), M3 = i10 && t9.maybeRunHittest(o19, i10, m12);
  return { isOutline: s12, color: V4, opacity: new C2(1), halfWidth: c8, normal: d9.normal, glPosition: z6, ...M3 };
}
var q6 = class extends B4 {
  constructor() {
    super(...arguments), this.computeAttributes = { pos: ["nextPos1", "nextPos2"] };
  }
};
__decorate([m4(F2)], q6.prototype, "antialiasingControls", void 0), __decorate([g2(f5)], q6.prototype, "visualVariableColor", void 0), __decorate([g2(h6)], q6.prototype, "visualVariableOpacity", void 0), __decorate([g2(m5)], q6.prototype, "visualVariableSizeMinMaxValue", void 0), __decorate([g2(u4)], q6.prototype, "visualVariableSizeScaleStops", void 0), __decorate([g2(f6)], q6.prototype, "visualVariableSizeStops", void 0), __decorate([g2(s8)], q6.prototype, "visualVariableSizeUnitValue", void 0);
var G5 = class extends q6 {
  constructor() {
    super(...arguments), this.type = "OutlineFillShader";
  }
  vertex(t9, o19) {
    return H3(this, t9, o19);
  }
  fragment(t9) {
    const { color: o19, isOutline: i10 } = t9, e9 = Gt(i10, new C2(0.5)), r10 = k3(t9, this.antialiasingControls.blur), s12 = zt(e9, r10, o19), n16 = zt(e9, new C2(1 / 255), new C2(0));
    return this.getFragmentOutput(s12, t9, n16);
  }
  hittest(t9, o19, i10) {
    return zt(i10, q4(this.hittestRequest), z2(this, t9, o19));
  }
};
__decorate([__param(0, l2(R5)), __param(1, l2(q2))], G5.prototype, "vertex", null), __decorate([__param(0, l2(A5))], G5.prototype, "fragment", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/PatternFillShader.js
var w4 = class extends g7 {
};
__decorate([f4(5, _3)], w4.prototype, "tlbr", void 0), __decorate([f4(6, C2)], w4.prototype, "inverseRasterizationScale", void 0);
var g8 = class extends P3 {
};
function j5(t9) {
  const e9 = new C2(1), r10 = new C2(0);
  return new rt(e9.divide(t9.x), r10.divide(t9.y), 0, gt(r10.divide(t9.x)), e9.divide(t9.y), 0, 0, 0, 1);
}
function O3(t9, e9) {
  const r10 = e9.tlbr.xy, o19 = e9.tlbr.zw, i10 = o19.x.subtract(r10.x), s12 = r10.y.subtract(o19.y), a8 = new X(i10, s12).multiply(e9.inverseRasterizationScale), p9 = a8.multiply(t9.view.requiredZoomFactor), u18 = j5(p9), d9 = t9.localTileOffset.getPatternOffsetAtTileOrigin(a8).divide(p9), c8 = new Y2(e9.pos, 1);
  return { tileTextureCoord: u18.multiply(c8).xy.subtract(d9), tlbr: e9.tlbr.divide(t9.mosaicInfo.size.xyxy) };
}
function S3(t9, e9) {
  const r10 = Ge(t9.tileTextureCoord, new C2(1)), o19 = _e(t9.tlbr.xy, t9.tlbr.zw, r10), i10 = wn(e9.texture, o19);
  return t9.color.multiply(i10);
}
var T5 = class extends x3 {
  constructor() {
    super(...arguments), this.type = "PatternFillShader";
  }
  vertex(t9, e9) {
    return { ...super.vertex(t9, e9), ...O3(this, t9) };
  }
  fragment(t9) {
    const e9 = S3(t9, this.mosaicInfo);
    return this.getFragmentOutput(e9, t9, new C2(0));
  }
};
__decorate([m4(s7)], T5.prototype, "mosaicInfo", void 0), __decorate([m4(n3)], T5.prototype, "localTileOffset", void 0), __decorate([__param(0, l2(w4)), __param(1, l2(q2))], T5.prototype, "vertex", null), __decorate([__param(0, l2(g8))], T5.prototype, "fragment", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/PatternOutlineFillShader.js
var y2 = class extends R5 {
};
__decorate([f4(9, _3)], y2.prototype, "tlbr", void 0), __decorate([f4(10, C2)], y2.prototype, "inverseRasterizationScale", void 0);
var S4 = class extends A5 {
};
var x4 = class extends G5 {
  constructor() {
    super(...arguments), this.type = "PatternOutlineFillShader";
  }
  vertex(t9, r10) {
    return { ...H3(this, t9, r10), ...O3(this, t9) };
  }
  fragment(t9) {
    const { isOutline: r10 } = t9, e9 = Gt(r10, new C2(0.5)), o19 = k3(t9, this.antialiasingControls.blur), i10 = S3(t9, this.mosaicInfo), a8 = zt(e9, o19, i10), p9 = zt(e9, new C2(1 / 255), new C2(0));
    return this.getFragmentOutput(a8, t9, p9);
  }
};
__decorate([m4(s7)], x4.prototype, "mosaicInfo", void 0), __decorate([m4(n3)], x4.prototype, "localTileOffset", void 0), __decorate([__param(0, l2(y2)), __param(1, l2(q2))], x4.prototype, "vertex", null), __decorate([__param(0, l2(S4))], x4.prototype, "fragment", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/ComplexOutlineFillShader.js
var F6 = 1 / J;
var w5 = class extends S {
};
__decorate([f4(3, _3)], w5.prototype, "color", void 0), __decorate([f4(4, _3)], w5.prototype, "tlbr", void 0), __decorate([f4(5, C2)], w5.prototype, "angle", void 0), __decorate([f4(6, C2)], w5.prototype, "aux1", void 0), __decorate([f4(7, C2)], w5.prototype, "aux2", void 0), __decorate([f4(8, X)], w5.prototype, "aux3", void 0), __decorate([f4(9, X)], w5.prototype, "aux4", void 0), __decorate([f4(10, X)], w5.prototype, "zoomRange", void 0);
var C6 = class extends S4 {
};
var R6 = class extends q6 {
  constructor() {
    super(...arguments), this.type = "ComplexOutlineFillShader";
  }
  vertex(t9, o19) {
    const { aux1: e9, aux2: r10, aux3: i10, aux4: p9 } = t9, a8 = { ...t9, width: e9, height: r10, offset: i10, scale: p9.multiply(F6) }, n16 = { ...t9, halfWidth: e9, referenceHalfWidth: r10, offset: i10, normal: p9.subtract(K).multiply(F6) }, m12 = H3(this, n16), u18 = Z(this, a8), h12 = Gt(m12.isOutline, new C2(0.5));
    return { ...m12, ...u18, ...Object.assign({}, this.maybeRunHittest(t9, o19, h12)) };
  }
  fragment(t9) {
    const { isOutline: o19 } = t9, e9 = Gt(o19, new C2(0.5)), r10 = k3(t9, this.antialiasingControls.blur), i10 = k2(this, t9), a8 = zt(e9, r10, i10), n16 = zt(e9, new C2(1 / 255), new C2(0));
    return this.getFragmentOutput(a8, t9, n16);
  }
  hittest(t9, o19, e9) {
    return zt(e9, q4(this.hittestRequest), z2(this, t9, o19));
  }
};
__decorate([m4(s7)], R6.prototype, "mosaicInfo", void 0), __decorate([m4(n3)], R6.prototype, "localTileOffset", void 0), __decorate([__param(0, l2(w5)), __param(1, l2(q2))], R6.prototype, "vertex", null), __decorate([__param(0, l2(C6))], R6.prototype, "fragment", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/fill/ComplexOutlineFillTechnique.js
var l4 = class extends t6 {
  constructor() {
    super(...arguments), this.type = 10, this.shaders = { geometry: new R6() };
  }
  render(e9, u18) {
    const { painter: l10, pixelRatio: m12 } = e9, p9 = u18.instance.getInput();
    l10.setShader({ shader: this.shaders.geometry, uniforms: { ...u3(e9, u18.target, p9.uniforms), ...f2(e9, u18.target), antialiasingControls: n5(m12), mosaicInfo: l10.textureManager.getMosaicInfo(e9, u18.textureKey), localTileOffset: h4(u18.target) }, defines: { ...d2(e9) }, optionalAttributes: p9.optionalAttributes, useComputeBuffer: a(e9) }), l10.setPipelineState(m3(e9)), l10.submitDraw(e9, u18);
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/fill/FillTechnique.js
var n7 = class extends t6 {
  constructor() {
    super(...arguments), this.type = 13, this.shaders = { geometry: new x3() };
  }
  render(e9, a8) {
    const { painter: n16 } = e9, u18 = a8.instance.getInput();
    n16.setShader({ shader: this.shaders.geometry, uniforms: { ...u3(e9, a8.target, u18.uniforms), ...f2(e9, a8.target) }, defines: d2(e9), optionalAttributes: u18.optionalAttributes, useComputeBuffer: a(e9) }), n16.setPipelineState(m3(e9)), n16.submitDraw(e9, a8);
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/GradientFillShader.js
var P7 = class extends g7 {
};
__decorate([f4(5, _3)], P7.prototype, "tlbr", void 0), __decorate([f4(6, X)], P7.prototype, "relativePosition", void 0), __decorate([f4(7, C2)], P7.prototype, "gradientMethod", void 0), __decorate([f4(8, X)], P7.prototype, "relativeGradientSize", void 0);
var D5 = class extends P3 {
};
var A6 = class extends x3 {
  constructor() {
    super(...arguments), this.type = "GradientFillShader";
  }
  vertex(t9, e9) {
    const { tlbr: i10, relativePosition: r10, gradientMethod: o19, relativeGradientSize: a8 } = t9, d9 = zt(k(t9.bitset, e2.isAbsolute), this.view.displayZoomFactor, new C2(1));
    return { ...super.vertex(t9, e9), tlbr: i10, relativePosition: r10, gradientMethod: o19, gradientSize: a8.multiply(d9), isDiscrete: h5(t9.bitset, e2.isDiscrete) };
  }
  fragment(t9) {
    const { tlbr: e9, relativePosition: i10, gradientMethod: r10, gradientSize: o19, isDiscrete: g13 } = t9, w7 = zt(Gt(g13, new C2(0.5)), o19.subtract(1), new X(0)), b8 = Tt([Ct(r10, new C2(r5.rectangular)), () => {
      const t10 = Qt(i10).add(w7).divide(o19);
      return E3(Xe(t10.x, t10.y));
    }], [Ct(r10, new C2(r5.circular)), E3(hn(we(i10, i10)).add(w7.x).divide(o19.x))], [true, E3(i10.x.add(w7.x).divide(o19.x))]), S7 = new X(se(b8, new C2(0), new C2(1)), 0.5), j6 = _e(e9.xy, e9.zw, S7).divide(this.mosaicInfo.size), z6 = wn(this.mosaicInfo.texture, j6), F10 = t9.color.a;
    return this.getFragmentOutput(z6.multiply(F10), t9, new C2(0));
  }
};
__decorate([m4(s7)], A6.prototype, "mosaicInfo", void 0), __decorate([__param(0, l2(P7)), __param(1, l2(q2))], A6.prototype, "vertex", null), __decorate([__param(0, l2(D5))], A6.prototype, "fragment", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/fill/GradientFillTechnique.js
var n8 = class extends t6 {
  constructor() {
    super(...arguments), this.type = 14, this.shaders = { geometry: new A6() }, this.symbologyPlane = 0;
  }
  render(e9, a8) {
    const { painter: n16 } = e9, u18 = a8.instance.getInput();
    n16.setShader({ shader: this.shaders.geometry, uniforms: { ...u3(e9, a8.target, u18.uniforms), ...f2(e9, a8.target), mosaicInfo: n16.textureManager.getMosaicInfo(e9, a8.textureKey) }, defines: { ...d2(e9) }, optionalAttributes: u18.optionalAttributes, useComputeBuffer: a(e9) }), n16.setPipelineState(m3(e9)), n16.submitDraw(e9, a8);
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/fill/OutlineFillTechnique.js
var u7 = class extends t6 {
  constructor() {
    super(...arguments), this.type = 24, this.shaders = { geometry: new G5() };
  }
  render(e9, a8) {
    const { painter: u18, pixelRatio: m12 } = e9, p9 = a8.instance.getInput();
    u18.setShader({ shader: this.shaders.geometry, uniforms: { ...u3(e9, a8.target, p9.uniforms), ...f2(e9, a8.target), antialiasingControls: n5(m12) }, defines: { ...d2(e9) }, optionalAttributes: p9.optionalAttributes, useComputeBuffer: a(e9) }), u18.setPipelineState(m3(e9)), u18.submitDraw(e9, a8);
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/fill/PatternFillTechnique.js
var u8 = class extends t6 {
  constructor() {
    super(...arguments), this.type = 26, this.shaders = { geometry: new T5() };
  }
  render(e9, n16) {
    const { painter: u18 } = e9, f14 = n16.instance.getInput();
    u18.setShader({ shader: this.shaders.geometry, uniforms: { ...u3(e9, n16.target, f14.uniforms), ...f2(e9, n16.target), mosaicInfo: u18.textureManager.getMosaicInfo(e9, n16.textureKey), localTileOffset: h4(n16.target) }, defines: { ...d2(e9) }, optionalAttributes: f14.optionalAttributes, useComputeBuffer: a(e9) }), u18.setPipelineState(m3(e9)), u18.submitDraw(e9, n16);
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/fill/PatternOutlineFillTechnique.js
var l5 = class extends t6 {
  constructor() {
    super(...arguments), this.type = 27, this.shaders = { geometry: new x4() };
  }
  render(e9, u18) {
    const { painter: l10, pixelRatio: m12 } = e9, f14 = u18.instance.getInput();
    l10.setShader({ shader: this.shaders.geometry, uniforms: { ...u3(e9, u18.target, f14.uniforms), ...f2(e9, u18.target), antialiasingControls: n5(m12), mosaicInfo: l10.textureManager.getMosaicInfo(e9, u18.textureKey), localTileOffset: h4(u18.target) }, defines: { ...d2(e9) }, optionalAttributes: f14.optionalAttributes, useComputeBuffer: a(e9) }), l10.setPipelineState(m3(e9)), l10.submitDraw(e9, u18);
  }
};

// node_modules/@arcgis/core/views/webgl/heatmapTextureUtils.js
var o12 = class {
  constructor(e9, t9, r10, o19) {
    this.dataType = e9, this.samplingMode = t9, this.pixelFormat = r10, this.internalFormat = o19;
  }
};
function a3(a8, l10) {
  const { textureFloatLinear: n16, colorBufferFloat: i10 } = a8.capabilities, s12 = i10?.textureFloat, f14 = i10?.textureHalfFloat, u18 = i10?.floatBlend, _5 = a8.driverTest.floatBufferBlend.result;
  if (!s12 && !f14) throw new s("heatmap:missing-color-buffer-float", "HeatmapRenderer requires the WebGL extension EXT_color_buffer_float or EXT_color_buffer_half_float or WEBGL_color_buffer_float.");
  if (!(u18 && _5 || f14)) throw new s("heatmap:missing-float-blend", "HeatmapRenderer requires the WebGL extension EXT_float_blend or EXT_color_buffer_half_float." + (_5 ? "" : " This device claims support for EXT_float_blend, but does not actually support it."));
  const c8 = s12 && u18 && _5, m12 = f14, p9 = n16, d9 = !!i10?.R32F, h12 = !!i10?.R16F;
  if (c8 && p9) return p9 || l10.warnOnce("Missing WebGL extension OES_texture_float_linear. Heatmap quality may be reduced."), new o12(N2.FLOAT, p9 ? 9729 : 9728, d9 ? 6403 : 6408, d9 ? E.R32F : 6408);
  if (m12) return new o12(N2.HALF_FLOAT, 9729, h12 ? 6403 : 6408, h12 ? E.R16F : 6408);
  throw new s("heatmap:missing-hardware-support", "HeatmapRenderer requires WebGL extensions that allow it to render and blend to float or half float textures.");
}
var l6 = new o12(N2.HALF_FLOAT, 9728, 6408, 6408);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/heatmap/HeatmapResources.js
var n9 = () => i.getLogger("esri.views.2d.engine.webgl.shaderGraph.techniques.heatmap.HeatmapResources");
var m7 = class {
  destroy() {
    this._accumulateFramebuffer = r2(this._accumulateFramebuffer), this._resolveGradientTexture = r2(this._resolveGradientTexture), this._prevGradientHash = null, this._qualityProfile = null;
  }
  get initialized() {
    return null != this._accumulateFramebuffer && null != this._resolveGradientTexture;
  }
  get accumulateFramebuffer() {
    return this._accumulateFramebuffer;
  }
  get resolveGradientTexture() {
    return this._resolveGradientTexture;
  }
  loadQualityProfile(e9) {
    if (null == this._qualityProfile) {
      const r10 = a3(e9, n9());
      this._qualityProfile = { ...r10, defines: { usesHalfFloatPrecision: r10.dataType !== N2.FLOAT } };
    }
    return this._qualityProfile;
  }
  ensureAccumulateFBO(e9, r10, t9) {
    if (null == this._accumulateFramebuffer) {
      const { dataType: s12, samplingMode: l10, pixelFormat: n16, internalFormat: m12 } = this.loadQualityProfile(e9), f14 = new h2(r10, t9);
      f14.pixelFormat = n16, f14.internalFormat = m12, f14.dataType = s12, f14.samplingMode = l10, f14.wrapMode = 33071;
      const h12 = new i5(G.DEPTH24_STENCIL8, r10, t9);
      this._accumulateFramebuffer = new m2(e9, f14, h12);
    } else {
      const { width: e10, height: a8 } = this._accumulateFramebuffer;
      e10 === r10 && a8 === t9 || this._accumulateFramebuffer.resize(r10, t9);
    }
    return this._accumulateFramebuffer;
  }
  ensureResolveGradientTexture(e9, r10, t9) {
    if (null == this._resolveGradientTexture) {
      const r11 = new h2();
      r11.wrapMode = 33071, this._resolveGradientTexture = new A(e9, r11), this._prevGradientHash = null;
    }
    return this._prevGradientHash !== r10 && (this._resolveGradientTexture.resize(t9.length / 4, 1), this._resolveGradientTexture.setData(t9), this._prevGradientHash = r10), this._resolveGradientTexture;
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/heatmapUtils.js
function n10(n16) {
  return n16 ? 0.25 : 1;
}

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/HeatmapAccumulateShader.js
var v4 = class extends S {
};
__decorate([f4(5, X)], v4.prototype, "offset", void 0);
var x5 = class extends P3 {
};
var g9 = class extends w2 {
};
__decorate([m4(C2)], g9.prototype, "radius", void 0), __decorate([m4(C2)], g9.prototype, "isFieldActive", void 0);
var F7 = class extends B4 {
  constructor() {
    super(...arguments), this.type = "HeatmapAccumulateShader", this.usesHalfFloatPrecision = false;
  }
  vertex(t9) {
    const { radius: e9, isFieldActive: i10 } = this.kernelControls, s12 = t9.offset, l10 = i10.multiply(this.storage.getVVData(t9.id).x).add(new C2(1).subtract(i10)), o19 = this.view.displayViewScreenMat3.multiply(new Y2(t9.pos, 1)).add(this.view.displayViewMat3.multiply(new Y2(s12, 0)).multiply(e9)), r10 = this.clip(t9.id);
    return { glPosition: new _3(o19.xy, r10, 1), offset: s12, fieldValue: l10, color: new _3(0), ...this.maybeRunHittest(t9, {}, null) };
  }
  fragment(t9) {
    const { offset: e9, fieldValue: i10 } = t9, s12 = je(e9), l10 = ln(s12, new C2(1)), o19 = new C2(1).subtract(s12.multiply(s12)), r10 = o19.multiply(o19), a8 = l10.multiply(r10).multiply(i10).multiply(new C2(n10(this.usesHalfFloatPrecision)));
    return this.getFragmentOutput(new _3(a8), t9);
  }
  hittest(t9) {
    const { viewMat3: e9, tileMat3: i10 } = this.view, s12 = e9.multiply(i10).multiply(new Y2(t9.pos, 1));
    return R2(s12.xy, this.kernelControls.radius, this.hittestRequest.position);
  }
};
__decorate([_4], F7.prototype, "usesHalfFloatPrecision", void 0), __decorate([m4(g9)], F7.prototype, "kernelControls", void 0), __decorate([__param(0, l2(v4))], F7.prototype, "vertex", null), __decorate([__param(0, l2(x5))], F7.prototype, "fragment", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/HeatmapResolveShader.js
var g10 = class extends C3 {
};
__decorate([f4(0, X)], g10.prototype, "position", void 0);
var f9 = class extends I {
};
var h8 = class extends w2 {
};
__decorate([m4(U)], h8.prototype, "texture", void 0), __decorate([m4(X)], h8.prototype, "minAndInvRange", void 0), __decorate([m4(C2)], h8.prototype, "normalization", void 0);
var w6 = class extends w2 {
};
__decorate([m4(U)], w6.prototype, "texture", void 0);
var b3 = class extends P2 {
  constructor() {
    super(...arguments), this.type = "HeatmapResolveShader", this.usesHalfFloatPrecision = false;
  }
  vertex(t9) {
    return { glPosition: new _3(t9.position.multiply(2).subtract(1), 1, 1), uv: t9.position };
  }
  fragment(t9) {
    const { accumulatedDensity: e9, gradient: o19 } = this;
    let i10 = wn(e9.texture, t9.uv).r.divide(new C2(n10(this.usesHalfFloatPrecision)));
    i10 = i10.multiply(e9.normalization), i10 = i10.subtract(e9.minAndInvRange.x).multiply(e9.minAndInvRange.y);
    const s12 = wn(o19.texture, new X(i10, 0.5)), n16 = new v();
    return n16.fragColor = new _3(s12.rgb.multiply(s12.a), s12.a), n16;
  }
};
__decorate([_4], b3.prototype, "usesHalfFloatPrecision", void 0), __decorate([m4(h8)], b3.prototype, "accumulatedDensity", void 0), __decorate([m4(w6)], b3.prototype, "gradient", void 0), __decorate([__param(0, l2(g10))], b3.prototype, "vertex", null), __decorate([__param(0, l2(f9))], b3.prototype, "fragment", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/heatmap/HeatmapTechnique.js
var u9 = class extends t6 {
  constructor() {
    super(...arguments), this.type = 17, this.drawPhase = 73, this.shaders = { accumulate: new F7(), resolve: new b3() }, this._isBound = false, this._resources = /* @__PURE__ */ new Map();
  }
  shutdown(e9) {
    super.shutdown(e9), this._resources.get(e9)?.destroy(), this._resources.delete(e9), this._prevFBO = null, this._unbind();
  }
  render(e9, i10) {
    const { context: n16, painter: o19, state: u18 } = e9, a8 = i10.instance.getInput(), { isFieldActive: l10 } = a8.uniforms, h12 = this._getOrCreateResourcesRecord(n16), f14 = h12.loadQualityProfile(n16);
    a(e9) || this._bind(e9, h12, a8), o19.setShader({ shader: this.shaders.accumulate, uniforms: { ...f2(e9, i10.target), kernelControls: { radius: p3(a8, u18), isFieldActive: l10 ? 1 : 0 } }, defines: { ...d2(e9), ...f14.defines }, optionalAttributes: {}, useComputeBuffer: a(e9) });
    const m12 = a(e9) ? c3 : d5;
    o19.setPipelineState(m12), o19.submitDraw(e9, i10);
  }
  getStencilReference(e9) {
    return l7(e9);
  }
  renderResolvePass(e9, r10) {
    if (a(e9)) return;
    const { context: s12, painter: i10 } = e9, n16 = this._resources.get(s12);
    if (null == this._prevFBO || null == this._prevViewport || !n16?.initialized) return;
    const { defines: o19 } = n16.loadQualityProfile(s12), { minDensity: u18, maxDensity: a8, radius: l10 } = r10.getInput().uniforms, d9 = 8, c8 = 9, p9 = n16.accumulateFramebuffer, f14 = n16.resolveGradientTexture, m12 = { shader: this.shaders.resolve, uniforms: { accumulatedDensity: { texture: { unit: d9, texture: p9.colorTexture }, minAndInvRange: [u18, 1 / (a8 - u18)], normalization: 3 / (l10 * l10 * Math.PI) }, gradient: { texture: { unit: c8, texture: f14 } } }, defines: o19, optionalAttributes: {}, useComputeBuffer: false };
    s12.bindFramebuffer(this._prevFBO), s12.setViewport(0, 0, this._prevViewport.width, this._prevViewport.height), s12.bindTexture(p9.colorTexture, d9), s12.bindTexture(f14, c8), i10.setPipelineState(h9), i10.submitDrawMesh(s12, m12, i10.quadMesh), this._unbind();
  }
  _getOrCreateResourcesRecord(e9) {
    let t9 = this._resources.get(e9);
    return null == t9 && (t9 = new m7(), this._resources.set(e9, t9)), t9;
  }
  _unbind() {
    this._prevFBO = null, this._prevViewport = null, this._isBound = false;
  }
  _bind(e9, t9, r10) {
    if (this._isBound) return;
    const { context: s12, state: i10, pixelRatio: n16 } = e9, o19 = s12.getBoundFramebufferObject(), u18 = s12.getViewport();
    this._prevFBO = o19, this._prevViewport = u18;
    const { gradient: l10, gradientHash: d9 } = r10.uniforms;
    t9.ensureResolveGradientTexture(s12, d9, l10);
    const { width: c8, height: h12 } = u18, f14 = a4(p3(r10, i10), n16), m12 = c8 * f14, _5 = h12 * f14, w7 = t9.ensureAccumulateFBO(s12, m12, _5);
    s12.blitFramebuffer(o19, w7, 1024), s12.bindFramebuffer(w7), s12.setViewport(0, 0, w7.width, w7.height), s12.setColorMask(true, true, true, true), s12.setClearColor(0, 0, 0, 0), s12.clear(16384), this._isBound = true;
  }
};
function a4(e9, t9) {
  const r10 = t9 > 1.5 ? 0.25 : 0.5;
  return e9 < 1 / (2 * r10) ? 1 : r10;
}
function l7(e9) {
  return e9.key.level + 1;
}
var d5 = { color: { write: [true, true, true, true], blendMode: "additive" }, depth: false, stencil: { write: false, test: { compare: 518, mask: 255, op: { fail: 7680, zFail: 7680, zPass: 7681 } } } };
var c3 = { ...d5, stencil: false };
var h9 = { color: { write: [true, true, true, true], blendMode: "composite" }, depth: false, stencil: false };
function p3(e9, t9) {
  const { referenceScale: r10, radius: s12 } = e9.uniforms;
  return s12 * (0 !== r10 ? r10 / t9.scale : 1);
}

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/text/TextShader.js
var J4 = 360 / 254;
var K2 = class extends S {
};
__decorate([f4(3, _3)], K2.prototype, "color", void 0), __decorate([f4(4, X)], K2.prototype, "offset", void 0), __decorate([f4(5, X)], K2.prototype, "textureUV", void 0), __decorate([f4(6, X)], K2.prototype, "fontAndReferenceSize", void 0), __decorate([f4(7, _3)], K2.prototype, "outlineColor", void 0), __decorate([f4(8, _3)], K2.prototype, "haloColor", void 0), __decorate([f4(9, X)], K2.prototype, "outlineAndHaloSize", void 0), __decorate([f4(10, X)], K2.prototype, "zoomRange", void 0), __decorate([f4(11, C2)], K2.prototype, "clipAngle", void 0), __decorate([f4(12, _3)], K2.prototype, "referenceSymbol", void 0), __decorate([f4(15, C2)], K2.prototype, "visibility", void 0);
var Q = class extends x {
};
__decorate([f4(13, X)], Q.prototype, "offsetNextVertex1", void 0), __decorate([f4(14, X)], Q.prototype, "offsetNextVertex2", void 0);
var X2 = class extends P3 {
};
var Y3 = class extends B4 {
  constructor() {
    super(...arguments), this.type = "TextShader", this.computeAttributes = { offset: ["offsetNextVertex1", "offsetNextVertex2"] }, this.textRenderPassType = 0, this.isBackgroundPass = false, this.isLabel = false;
  }
  clipLabel(t9, e9) {
    const { clipAngle: o19, zoomRange: s12, visibility: l10 } = t9, a8 = o19.multiply(J4), r10 = Qt(this.view.rotation.subtract(a8)), n16 = Ye(new C2(360).subtract(r10), r10);
    let d9 = new C2(0);
    const f14 = ze(this.view.currentZoom.multiply(st)).divide(st), h12 = s12.x, v7 = s12.y, w7 = new C2(1).subtract(ln(h12, f14)).multiply(2), x9 = ln(new C2(90), n16).multiply(2), b8 = new C2(2).multiply(new C2(1).subtract(ln(f14, v7)));
    return d9 = d9.add(e9.multiply(w7)), d9 = d9.add(e9.multiply(x9)), d9 = d9.add(b8), l10 && (d9 = d9.add(l10)), d9;
  }
  vertex(t9, e9) {
    const i10 = h5(t9.bitset, F), s12 = new C2(1).subtract(i10);
    let l10 = t9.fontAndReferenceSize[0];
    const a8 = t9.fontAndReferenceSize[1];
    let r10 = l10.divide(d);
    const n16 = 1 === this.textRenderPassType ? t9.outlineColor : 2 === this.textRenderPassType ? t9.haloColor : this._getVertexColor(t9), d9 = this.view.displayViewScreenMat3.multiply(new Y2(t9.pos, 1));
    let p9 = t9.offset, u18 = new C2(1), m12 = rt.identity(), c8 = new X(0);
    if (this.isLabel) {
      if (!t9.referenceSymbol) throw new Error("InternalError: Optional attribute 'referenceSymbol' expected for labels");
      const e10 = t9.referenceSymbol, i11 = e10.xy, s13 = e10.z, l11 = this._unpackDirection(e10.w), a9 = l3(this, t9.id, s13).divide(2), r11 = l11.multiply(a9.add(u2));
      c8 = i11.add(r11), p9 = p9.add(c8);
    } else {
      u18 = l3(this, t9.id, a8).divide(a8), l10 = l10.multiply(u18), r10 = r10.multiply(u18), p9 = p9.multiply(u18), m12 = u5(this, t9.id), p9 = m12.multiply(new Y2(p9, 0)).xy;
    }
    const g13 = h5(t9.bitset, G2), z6 = this._getViewRotationMatrix(g13).multiply(new Y2(p9, 0));
    let R8 = this.isLabel ? this.clipLabel(t9, g13) : this.clip(t9.id, t9.zoomRange);
    R8 = this.isBackgroundPass ? R8.add(s12.multiply(2)) : R8.add(i10.multiply(2));
    let j6 = new C2(0);
    if (1 === this.textRenderPassType) {
      R8 = R8.add(zt(Ct(t9.outlineAndHaloSize.x, new C2(0)), new C2(2), new C2(0)));
      j6 = new C2(t9.outlineAndHaloSize.x).divide(r10).divide(f);
    }
    if (2 === this.textRenderPassType) {
      const e10 = t9.outlineAndHaloSize.x, i11 = new C2(t9.outlineAndHaloSize.y);
      R8 = R8.add(zt(Ct(i11, new C2(0)), new C2(2), new C2(0)));
      j6 = i11.add(e10).divide(r10).divide(f);
    }
    const A8 = this.isLabel ? Gt(R8, new C2(1)) : new J2(false);
    return { glPosition: new _3(d9.xy.add(z6.xy), R8, 1), color: n16, size: r10, textureUV: t9.textureUV.divide(this.mosaicInfo.size), antialiasingWidth: new C2(0.105 * d).divide(l10).divide(this.view.pixelRatio), outlineDistanceOffset: j6, ...this.maybeRunHittest(t9, e9, { vvSizeAdjustment: u18, vvRotation: m12, labelOffset: c8, labelClipped: A8 }) };
  }
  _getViewRotationMatrix(t9) {
    const e9 = this.view.displayViewMat3, i10 = this.view.displayMat3, o19 = new C2(1).subtract(t9);
    return e9.multiply(t9).add(i10.multiply(o19));
  }
  fragment(t9) {
    const e9 = new C2(2 / 8), i10 = new C2(1).subtract(e9), o19 = wn(this.mosaicInfo.texture, t9.textureUV).a;
    let s12 = i10.subtract(t9.outlineDistanceOffset);
    this.highlight && (s12 = s12.divide(2));
    const l10 = t9.antialiasingWidth, a8 = on(s12.subtract(l10), s12.add(l10), o19);
    return this.getFragmentOutput(t9.color.multiply(a8), t9);
  }
  hittest(t9, e9, { vvSizeAdjustment: i10, vvRotation: o19, labelOffset: s12, labelClipped: l10 }) {
    let a8, r10, n16;
    this.isLabel ? (a8 = new Y2(t9.offset.add(s12), 0), r10 = new Y2(e9.offsetNextVertex1.add(s12), 0), n16 = new Y2(e9.offsetNextVertex2.add(s12), 0)) : (a8 = o19.multiply(new Y2(t9.offset.multiply(i10), 0)), r10 = o19.multiply(new Y2(e9.offsetNextVertex1.multiply(i10), 0)), n16 = o19.multiply(new Y2(e9.offsetNextVertex2.multiply(i10), 0)));
    const { viewMat3: d9, tileMat3: p9 } = this.view, u18 = d9.multiply(p9).multiply(new Y2(t9.pos, 1)), y6 = u18.add(p9.multiply(a8)).xy, m12 = u18.add(p9.multiply(r10)).xy, c8 = u18.add(p9.multiply(n16)).xy, h12 = P4(this.hittestRequest.position, y6.xy, m12.xy, c8.xy);
    return this.isLabel ? zt(l10, q4(this.hittestRequest), h12) : h12;
  }
  _unpackDirection(t9) {
    const e9 = new W(t9), i10 = jt(e9, new W(2)), o19 = Pt(e9, new W(3));
    return new X(new C2(i10).subtract(1), new C2(o19).subtract(1));
  }
  _getVertexColor(t9) {
    let e9 = t9.color;
    if (this.visualVariableColor) {
      const i10 = this.storage.getColorValue(t9.id);
      e9 = this.visualVariableColor.getColor(i10, t9.color, new J2(false));
    }
    if (this.visualVariableOpacity) {
      const i10 = this.storage.getOpacityValue(t9.id), o19 = this.visualVariableOpacity.getOpacity(i10);
      e9 = e9.multiply(o19);
    }
    return e9;
  }
};
__decorate([g2(f5)], Y3.prototype, "visualVariableColor", void 0), __decorate([g2(h6)], Y3.prototype, "visualVariableOpacity", void 0), __decorate([g2(g4)], Y3.prototype, "visualVariableRotation", void 0), __decorate([g2(m5)], Y3.prototype, "visualVariableSizeMinMaxValue", void 0), __decorate([g2(u4)], Y3.prototype, "visualVariableSizeScaleStops", void 0), __decorate([g2(f6)], Y3.prototype, "visualVariableSizeStops", void 0), __decorate([g2(s8)], Y3.prototype, "visualVariableSizeUnitValue", void 0), __decorate([m4(s7)], Y3.prototype, "mosaicInfo", void 0), __decorate([_4], Y3.prototype, "textRenderPassType", void 0), __decorate([_4], Y3.prototype, "isBackgroundPass", void 0), __decorate([_4], Y3.prototype, "isLabel", void 0), __decorate([__param(0, l2(K2)), __param(1, l2(Q))], Y3.prototype, "vertex", null), __decorate([__param(0, l2(X2))], Y3.prototype, "fragment", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/labels/LabelTechnique.js
var o13 = class extends t6 {
  constructor() {
    super(...arguments), this.type = 18, this.shaders = { geometry: new Y3() }, this.drawPhase = 14, this.symbologyPlane = 3;
  }
  render(e9, n16) {
    const { painter: o19 } = e9, u18 = d2(e9), d9 = { ...m3(e9), stencil: { write: false, test: { compare: 516, mask: 255, op: { fail: 7680, zFail: 7680, zPass: 7680 } } } }, m12 = n16.instance.getInput(), c8 = { shader: this.shaders.geometry, uniforms: { ...u3(e9, n16.target, m12.uniforms), ...f2(e9, n16.target), mosaicInfo: o19.textureManager.getMosaicInfo(e9, n16.textureKey) }, defines: { ...u18, textRenderPassType: 0, isBackgroundPass: true, isLabel: true }, optionalAttributes: m12.optionalAttributes, useComputeBuffer: a(e9) };
    o19.setPipelineState(d9), o19.setShader(c8), o19.submitDraw(e9, n16, { stencilRef: 255 }), o19.setShader({ ...c8, defines: { ...u18, textRenderPassType: 2, isBackgroundPass: false, isLabel: true } }), o19.submitDraw(e9, n16, { stencilRef: 255 }), o19.setShader({ ...c8, defines: { ...u18, textRenderPassType: 0, isBackgroundPass: false, isLabel: true } }), o19.submitDraw(e9, n16, { stencilRef: 255 });
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/GradientStrokeShader.js
function F8(t9) {
  return ln(new C2(0), t9).multiply(2).subtract(1);
}
var G6 = class extends q5 {
};
__decorate([f4(9, C2)], G6.prototype, "accumulatedDistance", void 0), __decorate([f4(10, C2)], G6.prototype, "totalLength", void 0), __decorate([f4(11, C2)], G6.prototype, "gradientSize", void 0), __decorate([f4(12, X)], G6.prototype, "segmentDirection", void 0), __decorate([f4(13, _3)], G6.prototype, "tlbr", void 0);
var P8 = class extends w2 {
};
__decorate([m4(C2)], P8.prototype, "isColorPass", void 0);
var k4 = class extends B6 {
  constructor() {
    super(...arguments), this.type = "GradientStrokeShader";
  }
  vertex(t9, e9) {
    const { totalLength: i10, gradientSize: o19, segmentDirection: r10, tlbr: s12 } = t9, p9 = T2(this, t9), m12 = h5(t9.bitset, e3.isAlongLine), c8 = i10.divide(this.view.displayZoomFactor), u18 = zt(k(t9.bitset, e3.isAbsoluteSize), () => {
      const t10 = zt(Gt(m12, new C2(0.5)), c8, p9.halfWidth);
      return o19.divide(t10);
    }, o19), h12 = t9.accumulatedDistance.add(we(r10, p9.scaledOffset).divide(c8)), y6 = s12.divide(this.mosaicInfo.size.xyxy);
    return { ...p9, tlbr: y6, relativePositionAlongLine: h12, relativeGradientSize: u18, isAlongLine: h5(t9.bitset, e3.isAlongLine), isDiscrete: h5(t9.bitset, e3.isDiscrete), ...this.maybeRunHittest(t9, e9, p9.halfWidth) };
  }
  fragment(t9) {
    const { isAlongLine: e9, isDiscrete: i10, relativePositionAlongLine: o19, relativeGradientSize: r10, normal: s12, tlbr: d9 } = t9, v7 = G4(t9, this.antialiasingControls.blur), f14 = F8(s12.y).multiply(Ye(je(s12), new C2(1))), w7 = new C2(0.5).multiply(f14).add(new C2(0.5)), b8 = zt(Gt(e9, new C2(0.5)), o19, w7), x9 = zt(Gt(i10, new C2(0.5)), r10.subtract(1), new C2(0));
    let L5 = b8.add(x9).divide(r10);
    L5 = zt(Gt(e9, new C2(0.5)), L5, E3(L5));
    const j6 = _e(d9.xy, d9.zw, new X(se(L5, new C2(0), new C2(1)), 0.5)), A8 = wn(this.mosaicInfo.texture, j6), D6 = t9.opacity.multiply(v7), z6 = this.getFragmentOutput(A8.multiply(D6), t9), G7 = ln(new C2(0.5), this.technique.isColorPass).multiply(has("gradient-depth-epsilon")), I3 = ln(new C2(0), s12.y).multiply(new C2(has("gradient-depth-bias")).subtract(G7));
    return z6.glFragDepth = se(je(s12).add(I3), new C2(0), new C2(1)), z6;
  }
};
__decorate([m4(s7)], k4.prototype, "mosaicInfo", void 0), __decorate([m4(P8)], k4.prototype, "technique", void 0), __decorate([__param(0, l2(G6)), __param(1, l2(q2))], k4.prototype, "vertex", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/line/GradientStrokeTechnique.js
var h10 = class extends t6 {
  constructor() {
    super(...arguments), this.type = 15, this.shaders = { geometry: new k4() }, this.symbologyPlane = 1;
  }
  _getShaderOptions(t9, o19, a8) {
    const { painter: p9, pixelRatio: h12 } = t9, l10 = o19.instance.getInput();
    return { shader: this.shaders.geometry, uniforms: { ...u3(t9, o19.target, l10.uniforms), ...f2(t9, o19.target), antialiasingControls: n5(h12), mosaicInfo: p9.textureManager.getMosaicInfo(t9, o19.textureKey), technique: { isColorPass: a8 } }, defines: { ...d2(t9) }, optionalAttributes: l10.optionalAttributes, useComputeBuffer: a(t9) };
  }
  render(t9, s12) {
    const { painter: r10 } = t9;
    if (a(t9) || l(t9)) {
      const e9 = m3(t9);
      return r10.setPipelineState(e9), r10.setShader(this._getShaderOptions(t9, s12, 1)), void r10.submitDraw(t9, s12);
    }
    t9.context.setClearDepth(1), t9.context.clear(256);
    const i10 = { color: false, depth: { write: { zNear: 0, zFar: 1 }, test: 513 }, stencil: { write: false, test: { compare: 514, mask: 255, op: { fail: 7680, zFail: 7680, zPass: 7680 } } } };
    r10.setShader(this._getShaderOptions(t9, s12, 0)), r10.setPipelineState(i10), r10.submitDraw(t9, s12);
    const n16 = { color: { write: [true, true, true, true], blendMode: "composite" }, depth: { write: false, test: 515 }, stencil: { write: false, test: { compare: 514, mask: 255, op: { fail: 7680, zFail: 7680, zPass: 7680 } } } };
    r10.setShader(this._getShaderOptions(t9, s12, 1)), r10.setPipelineState(n16), r10.submitDraw(t9, s12);
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/line/LineTechnique.js
var u10 = class extends t6 {
  constructor() {
    super(...arguments), this.type = 19, this.shaders = { geometry: new B6() }, this.symbologyPlane = 1;
  }
  render(e9, n16) {
    const { painter: u18, pixelRatio: m12 } = e9, p9 = n16.instance.getInput();
    u18.setShader({ shader: this.shaders.geometry, uniforms: { ...u3(e9, n16.target, p9.uniforms), ...f2(e9, n16.target), antialiasingControls: n5(m12) }, defines: { ...d2(e9) }, optionalAttributes: p9.optionalAttributes, useComputeBuffer: a(e9) }), u18.setPipelineState(m3(e9)), u18.submitDraw(e9, n16);
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/shaders/TexturedLineShader.js
var W3 = class extends q5 {
};
__decorate([f4(9, C2)], W3.prototype, "accumulatedDistance", void 0), __decorate([f4(10, X)], W3.prototype, "segmentDirection", void 0), __decorate([f4(11, C2)], W3.prototype, "offsetAlongLine", void 0), __decorate([f4(12, C2)], W3.prototype, "capType", void 0), __decorate([f4(13, _3)], W3.prototype, "tlbr", void 0);
var H4 = class extends B6 {
  constructor() {
    super(...arguments), this.type = "TexturedLineShader";
  }
  _getDistanceRatio(t9, e9) {
    const o19 = h5(t9.bitset, D);
    return o19.multiply(Xe(e9, new C2(0.25)).multiply(new C2(2))).add(new C2(1).subtract(o19).multiply(u(1)));
  }
  _getSDFAlpha(t9) {
    const { halfWidth: e9, normal: i10, tlbr: r10, patternSize: a8, accumulatedDistance: l10, offsetAlongLine: x9, dashToPx: v7, capType: D6 } = t9, S7 = a8.x.divide(i3).multiply(v7), j6 = Te(l10.add(x9).divide(S7)), A8 = _e(r10.xy, r10.zw, new X(j6, 0.5)), z6 = C4(wn(this.mosaicInfo.texture, A8)).multiply(2).subtract(1).multiply(o4).multiply(v7), F10 = i10.y.multiply(e9), T6 = Tt([Ct(D6, new C2(1)), z6.subtract(e9)], [Ct(D6, new C2(2)), hn(We(Xe(z6, new C2(0)), new C2(2)).add(F10.multiply(F10))).subtract(e9)], [true, z6]), L5 = se(new C2(0.25).subtract(T6), new C2(0), new C2(1));
    return new _3(L5);
  }
  _getPatternColor(t9) {
    const { halfWidth: e9, normal: i10, color: o19, accumulatedDistance: s12, patternSize: r10, sampleAlphaOnly: a8, tlbr: l10 } = t9, n16 = r10.y.multiply(new C2(2).multiply(e9).divide(r10.x)), y6 = Te(s12.divide(n16)), h12 = new C2(0.5).multiply(i10.y).add(new C2(0.5)), f14 = _e(l10.xy, l10.zw, new X(h12, y6));
    let w7 = wn(this.mosaicInfo.texture, f14);
    return null != this.visualVariableColor && (w7 = zt(Gt(a8, new C2(0.5)), new _3(o19.a), o19)), w7;
  }
  vertex(t9, e9) {
    const { segmentDirection: i10, tlbr: o19, bitset: s12 } = t9, r10 = T2(this, t9), a8 = t9.accumulatedDistance.divide(this.view.displayZoomFactor).add(we(i10, r10.scaledOffset)), l10 = new X(o19.z.subtract(o19.x), o19.w.subtract(o19.y)), n16 = o19.divide(this.mosaicInfo.size.xyxy), c8 = h5(s12, E2), m12 = h5(s12, w), d9 = zt(Gt(c8, new C2(0.5)), this._getDistanceRatio(t9, r10.scaledHalfWidth), new C2(1));
    return { ...r10, tlbr: n16, patternSize: l10, accumulatedDistance: a8, isSDF: c8, sampleAlphaOnly: m12, dashToPx: d9, offsetAlongLine: t9.offsetAlongLine, capType: t9.capType, ...this.maybeRunHittest(t9, e9, r10.halfWidth) };
  }
  fragment(t9) {
    const { color: e9, opacity: i10, isSDF: o19 } = t9, s12 = G4(t9, this.antialiasingControls.blur), r10 = zt(Gt(o19, new C2(0.5)), this._getSDFAlpha(t9), this._getPatternColor(t9)), a8 = e9.multiply(i10).multiply(s12).multiply(r10);
    return this.getFragmentOutput(a8, t9);
  }
};
__decorate([m4(s7)], H4.prototype, "mosaicInfo", void 0), __decorate([__param(0, l2(W3)), __param(1, l2(q2))], H4.prototype, "vertex", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/line/TexturedLineTechnique.js
var u11 = class extends t6 {
  constructor() {
    super(...arguments), this.type = 31, this.shaders = { geometry: new H4() }, this.symbologyPlane = 1;
  }
  render(e9, n16) {
    const { painter: u18, pixelRatio: m12 } = e9, p9 = n16.instance.getInput();
    u18.setShader({ shader: this.shaders.geometry, uniforms: { ...u3(e9, n16.target, p9.uniforms), ...f2(e9, n16.target), antialiasingControls: n5(m12), mosaicInfo: u18.textureManager.getMosaicInfo(e9, n16.textureKey) }, defines: { ...d2(e9) }, optionalAttributes: p9.optionalAttributes, useComputeBuffer: a(e9) }), u18.setPipelineState(m3(e9)), u18.submitDraw(e9, n16);
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/markers/MarkerShader.js
var X3 = class extends S {
};
__decorate([f4(3, _3)], X3.prototype, "color", void 0), __decorate([f4(4, _3)], X3.prototype, "outlineColor", void 0), __decorate([f4(5, X)], X3.prototype, "offset", void 0), __decorate([f4(6, X)], X3.prototype, "textureUV", void 0), __decorate([f4(7, _3)], X3.prototype, "sizing", void 0), __decorate([f4(8, C2)], X3.prototype, "placementAngle", void 0), __decorate([f4(9, C2)], X3.prototype, "sdfDecodeCoeff", void 0), __decorate([f4(10, X)], X3.prototype, "zoomRange", void 0);
var Y4 = class extends x {
};
__decorate([f4(11, X)], Y4.prototype, "offsetNextVertex1", void 0), __decorate([f4(12, X)], Y4.prototype, "offsetNextVertex2", void 0), __decorate([f4(13, X)], Y4.prototype, "textureUVNextVertex1", void 0), __decorate([f4(14, X)], Y4.prototype, "textureUVNextVertex2", void 0);
var Z2 = class extends P3 {
};
function $2(t9, e9, i10, o19) {
  return e9.multiply(t9.x).add(i10.multiply(t9.y)).add(o19.multiply(t9.z));
}
function tt(t9) {
  return t9.multiply(t9).divide(128);
}
var et = class extends B4 {
  constructor() {
    super(...arguments), this.type = "MarkerShader", this.computeAttributes = { offset: ["offsetNextVertex1", "offsetNextVertex2"], textureUV: ["textureUVNextVertex1", "textureUVNextVertex2"] };
  }
  vertex(t9, e9) {
    const i10 = tt(t9.sizing.x), o19 = tt(t9.sizing.y), s12 = tt(t9.sizing.z), l10 = t9.placementAngle, r10 = h5(t9.bitset, o5.bitset.isSDF), y6 = h5(t9.bitset, o5.bitset.isMapAligned), h12 = h5(t9.bitset, o5.bitset.scaleSymbolsProportionally), c8 = k(t9.bitset, o5.bitset.colorLocked), x9 = n4(this, t9.id), v7 = r8(this, t9.id, t9.color, c8).multiply(x9), f14 = this.view.displayViewScreenMat3.multiply(new Y2(t9.pos.xy, 1)), V4 = l3(this, t9.id, s12).divide(s12), w7 = i10.multiply(V4), S7 = t9.offset.xy.multiply(V4);
    let b8 = o19.multiply(h12.multiply(V4.subtract(1)).add(1));
    b8 = Ye(b8, Xe(w7.subtract(0.99), new C2(0)));
    const g13 = Xe(b8, new C2(1)), C8 = Ye(b8, new C2(1)), z6 = rt.fromRotation(l10.multiply(o6)), _5 = u5(this, t9.id), R8 = this._getViewRotationMatrix(y6).multiply(_5).multiply(z6).multiply(new Y2(S7.xy, 0)), U3 = this.clip(t9.id, t9.zoomRange), N4 = new _3(f14.xy.add(R8.xy), U3, 1), D6 = t9.textureUV.divide(this.mosaicInfo.size), F10 = t9.outlineColor.multiply(C8), I3 = h5(t9.bitset, o5.bitset.overrideOutlineColor), O4 = t9.sdfDecodeCoeff.multiply(w7);
    return { glPosition: N4, color: v7, textureUV: D6, outlineColor: F10, outlineSize: g13, distanceToPx: O4, isSDF: r10, overrideOutlineColor: I3, ...this.maybeRunHittest(t9, e9, { pos: t9.pos, size: w7, sizeCorrection: V4, isMapAligned: y6, vvRotationMat3: _5, placementMat3: z6, outlineSize: g13, distanceToPx: O4, isSDF: r10 }) };
  }
  fragment(t9) {
    const e9 = this._getColor(t9.textureUV, t9);
    return this.getFragmentOutput(e9, t9);
  }
  hittest(t9, e9, i10) {
    return zt(Yt(i10.size, this.hittestRequest.smallSymbolSizeThreshold), this._hittestSmallMarker(t9, e9, i10), this._hittestMarker(t9, e9, i10));
  }
  _getViewRotationMatrix(t9) {
    const e9 = this.view.displayViewMat3, i10 = this.view.displayMat3, o19 = new C2(1).subtract(t9);
    return e9.multiply(t9).add(i10.multiply(o19));
  }
  _getViewScreenMatrix(t9) {
    const e9 = this.view.viewMat3.multiply(this.view.tileMat3), i10 = this.view.tileMat3, o19 = new C2(1).subtract(t9);
    return e9.multiply(t9).add(i10.multiply(o19));
  }
  _getColor(t9, e9) {
    return zt(Ct(e9.isSDF, new C2(1)), this._getSDFColor(t9, e9), this._getSpriteColor(t9, e9));
  }
  _getSpriteColor(t9, e9) {
    return wn(this.mosaicInfo.texture, t9).multiply(e9.color);
  }
  _getSDFColor(t9, e9) {
    const i10 = wn(this.mosaicInfo.texture, t9), o19 = new C2(0.5).subtract(C4(i10)).multiply(e9.distanceToPx).multiply(p), s12 = se(new C2(0.5).subtract(o19), new C2(0), new C2(1)), l10 = e9.color.multiply(s12);
    let r10 = e9.outlineSize;
    this.highlight && (r10 = Xe(r10, e9.overrideOutlineColor.multiply(4)));
    const a8 = r10.multiply(0.5), p9 = Qt(o19).subtract(a8), d9 = se(new C2(0.5).subtract(p9), new C2(0), new C2(1)), m12 = _e(e9.outlineColor, e9.color, e9.overrideOutlineColor).multiply(d9);
    return new C2(1).subtract(m12.a).multiply(l10).add(m12);
  }
  _hittestSmallMarker(t9, e9, i10) {
    const { position: o19, distance: s12, smallSymbolDistance: l10 } = this.hittestRequest, r10 = s12.subtract(l10), { viewMat3: p9, tileMat3: n16 } = this.view, u18 = p9.multiply(n16).multiply(new Y2(i10.pos, 1)).xy, d9 = i10.size.multiply(0.5);
    return ye(u18, o19).subtract(d9).add(r10);
  }
  _hittestMarker(t9, e9, i10) {
    const { pos: o19, sizeCorrection: s12, isMapAligned: l10 } = i10, r10 = new Y2(t9.offset.multiply(s12), 0), p9 = new Y2(e9.offsetNextVertex1.multiply(s12), 0), n16 = new Y2(e9.offsetNextVertex2.multiply(s12), 0), { viewMat3: u18, tileMat3: d9 } = this.view, m12 = u18.multiply(d9).multiply(new Y2(o19, 1)), h12 = this._getViewScreenMatrix(l10).multiply(i10.vvRotationMat3).multiply(i10.placementMat3), c8 = m12.add(h12.multiply(r10)).xy, x9 = m12.add(h12.multiply(p9)).xy, v7 = m12.add(h12.multiply(n16)).xy, f14 = this.hittestRequest.position, V4 = this.hittestRequest.distance, w7 = P4(f14, c8, x9, v7);
    return zt(Gt(w7, V4), w7, this._hittestSamples(c8, x9, v7, t9, e9, i10));
  }
  _hittestSamples(t9, e9, i10, o19, s12, l10) {
    const { outlineSize: r10, isSDF: a8, distanceToPx: p9 } = l10, n16 = this.hittestRequest.position, d9 = this.hittestRequest.distance, y6 = h7(n16.add(new X(gt(d9), gt(d9))), t9, e9, i10), h12 = h7(n16.add(new X(0, gt(d9))), t9, e9, i10), c8 = h7(n16.add(new X(d9, gt(d9))), t9, e9, i10), x9 = h7(n16.add(new X(gt(d9), 0)), t9, e9, i10), v7 = h7(n16, t9, e9, i10), f14 = h7(n16.add(new X(d9, 0)), t9, e9, i10), V4 = h7(n16.add(new X(gt(d9), d9)), t9, e9, i10), w7 = h7(n16.add(new X(0, d9)), t9, e9, i10), S7 = h7(n16.add(new X(d9, d9)), t9, e9, i10), M3 = o19.textureUV.divide(this.mosaicInfo.size), z6 = s12.textureUVNextVertex1.divide(this.mosaicInfo.size), _5 = s12.textureUVNextVertex2.divide(this.mosaicInfo.size), R8 = { color: new _3(1), outlineColor: new _3(1), overrideOutlineColor: new C2(1), outlineSize: r10, distanceToPx: p9, isSDF: a8 };
    let j6 = new C2(0);
    return j6 = j6.add(g6(y6).multiply(this._getColor($2(y6, M3, z6, _5), R8).a)), j6 = j6.add(g6(h12).multiply(this._getColor($2(h12, M3, z6, _5), R8).a)), j6 = j6.add(g6(c8).multiply(this._getColor($2(c8, M3, z6, _5), R8).a)), j6 = j6.add(g6(x9).multiply(this._getColor($2(x9, M3, z6, _5), R8).a)), j6 = j6.add(g6(v7).multiply(this._getColor($2(v7, M3, z6, _5), R8).a)), j6 = j6.add(g6(f14).multiply(this._getColor($2(f14, M3, z6, _5), R8).a)), j6 = j6.add(g6(V4).multiply(this._getColor($2(V4, M3, z6, _5), R8).a)), j6 = j6.add(g6(w7).multiply(this._getColor($2(w7, M3, z6, _5), R8).a)), j6 = j6.add(g6(S7).multiply(this._getColor($2(S7, M3, z6, _5), R8).a)), ln(j6, new C2(0.05)).multiply(q4(this.hittestRequest));
  }
};
__decorate([g2(f5)], et.prototype, "visualVariableColor", void 0), __decorate([g2(h6)], et.prototype, "visualVariableOpacity", void 0), __decorate([g2(g4)], et.prototype, "visualVariableRotation", void 0), __decorate([g2(m5)], et.prototype, "visualVariableSizeMinMaxValue", void 0), __decorate([g2(u4)], et.prototype, "visualVariableSizeScaleStops", void 0), __decorate([g2(f6)], et.prototype, "visualVariableSizeStops", void 0), __decorate([g2(s8)], et.prototype, "visualVariableSizeUnitValue", void 0), __decorate([m4(s7)], et.prototype, "mosaicInfo", void 0), __decorate([__param(0, l2(X3)), __param(1, l2(Y4))], et.prototype, "vertex", null), __decorate([__param(0, l2(Z2))], et.prototype, "fragment", null);

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/markers/MarkerTechnique.js
var n11 = class extends t6 {
  constructor() {
    super(...arguments), this.type = 21, this.shaders = { geometry: new et() }, this.symbologyPlane = 2;
  }
  render(e9, a8) {
    const { painter: n16 } = e9, u18 = a8.instance.getInput();
    n16.setShader({ shader: this.shaders.geometry, uniforms: { ...u3(e9, a8.target, u18.uniforms), ...f2(e9, a8.target), mosaicInfo: n16.textureManager.getMosaicInfo(e9, a8.textureKey, true) }, defines: { ...d2(e9) }, optionalAttributes: u18.optionalAttributes, useComputeBuffer: a(e9) }), n16.setPipelineState(m3(e9)), n16.submitDraw(e9, a8);
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/GLSLShaderModule.js
var e7 = class {
  constructor() {
    this.computeAttributes = {};
  }
  get locationsMap() {
    const t9 = /* @__PURE__ */ new Map();
    for (const e9 in this.locations) t9.set(e9, this.locations[e9].index);
    return t9;
  }
  get optionPropertyKeys() {
    if (!this._optionPropertyKeys) {
      const t9 = new Set(Object.keys(this.options));
      this._optionPropertyKeys = t9;
    }
    return this._optionPropertyKeys;
  }
  get _transformFeedbackBindings() {
    return [];
  }
  get locationInfo() {
    if (!this._locationInfo) {
      const t9 = this.locationsMap, e9 = Array.from(t9.entries()).map(([t10, e10]) => `${t10}.${e10}`).join(".");
      this._locationInfo = { stringHash: e9, locations: t9, computeAttributeMap: this.computeAttributes };
    }
    return this._locationInfo;
  }
  get renamedLocationsMap() {
    const t9 = /* @__PURE__ */ new Map();
    for (const [e9, o19] of this.locationsMap.entries()) t9.set("a_" + e9, o19);
    return t9;
  }
  getShaderKey(t9, e9, o19) {
    return `${Object.keys(t9).map((e10) => `${e10}.${t9[e10]}`).join(".")}.${Object.keys(o19).filter((t10) => o19[t10]).map((t10) => `${t10}_${o19[t10].toString()}`).join(".")}.${Object.keys(e9).filter((t10) => this.optionPropertyKeys.has(t10)).join(".")}`;
  }
  getProgram(e9, o19, n16, r10) {
    let i10 = "", s12 = "";
    for (const t9 in n16) if (n16[t9]) {
      const e10 = "boolean" == typeof n16[t9] ? `#define ${t9}
` : `#define ${t9} ${n16[t9]}
`;
      i10 += e10, s12 += e10;
    }
    return i10 += this.vertexShader, s12 += this.fragmentShader, new f3(i10, s12, this.renamedLocationsMap, this._getUniformBindings(o19), this._transformFeedbackBindings);
  }
  _getUniformBindings(t9) {
    const e9 = [];
    for (const r10 in this.required) {
      const t10 = this.required[r10];
      e9.push({ uniformHydrated: null, shaderModulePath: r10, uniformName: r10, uniformType: t10.type, uniformArrayElementType: o14(t10), uniformArrayLength: n12(t10) });
    }
    for (const r10 in t9) {
      const i10 = this.options[r10];
      if (t9[r10]) for (const t10 in i10) {
        const s12 = i10[t10];
        e9.push({ uniformHydrated: null, shaderModulePath: `${r10}.${t10}`, uniformName: t10, uniformType: s12.type, uniformArrayElementType: o14(s12), uniformArrayLength: n12(s12) });
      }
    }
    return e9;
  }
};
var o14 = (t9) => "array" === t9.type ? t9.elementType?.type : void 0;
var n12 = (t9) => "array" === t9.type ? t9.size : void 0;

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/pieChart/PieChartShader.js
var p4 = { hittestDist: C2, hittestPos: X };
var d6 = { filterFlags: U, animation: U, visualVariableData: U, dataDriven0: U, dataDriven1: U, dataDriven2: U, gpgpu: U, size: C2 };
var y3 = { displayViewScreenMat3: rt, displayViewMat3: rt, displayMat3: rt, viewMat3: rt, tileMat3: rt, displayZoomFactor: C2, requiredZoomFactor: C2, tileOffset: X, currentScale: C2, currentZoom: C2, metersPerSRUnit: C2 };
var u12 = class extends e7 {
  constructor() {
    super(...arguments), this.vertexShader = n2("materials/pie/pie.vert"), this.fragmentShader = n2("materials/pie/pie.frag"), this.required = { ...d6, ...y3, outlineWidth: C2, colors: B2, defaultColor: _3, othersColor: _3, outlineColor: _3, donutRatio: C2, sectorThreshold: C2 }, this.options = { hittestUniforms: p4, visualVariableSizeMinMaxValue: { minMaxValueAndSize: _3 }, visualVariableSizeScaleStops: { sizes: { type: "array", elementType: C2, size: 8 }, values: { type: "array", elementType: C2, size: 8 } }, visualVariableSizeStops: { sizes: { type: "array", elementType: C2, size: 8 }, values: { type: "array", elementType: C2, size: 8 } }, visualVariableSizeUnitValue: { unitValueToPixelsRatio: C2 }, visualVariableOpacity: { opacities: { type: "array", elementType: C2, size: 8 }, opacityValues: { type: "array", elementType: C2, size: 8 } }, highlightUniforms: { highlightAll: C2, activeReasons: C2 } }, this.locations = { pos: { index: 0, type: X }, id: { index: 1, type: Y2 }, bitset: { index: 2, type: C2 }, offset: { index: 3, type: X }, texCoords: { index: 4, type: X }, size: { index: 5, type: X }, referenceSize: { index: 6, type: C2 }, zoomRange: { index: 7, type: X } }, this.defines = { VV_SIZE_MIN_MAX_VALUE: "boolean", VV_SIZE_SCALE_STOPS: "boolean", VV_SIZE_FIELD_STOPS: "boolean", VV_SIZE_UNIT_VALUE: "boolean", VV_OPACITY: "boolean", HITTEST: "boolean", numberOfFields: "number", highlight: "boolean", inside: "boolean", outside: "boolean" };
  }
  setNumberOfFields(e9) {
    this.required.colors = { type: "array", elementType: _3, size: e9 };
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/pieChart/PieChartTechnique.js
var u13 = class extends t6 {
  constructor() {
    super(...arguments), this.type = 28, this.shaders = { geometry: new u12() }, this.symbologyPlane = 2;
  }
  render(e9, h12) {
    const { painter: u18 } = e9, { instance: o19, target: n16 } = h12, l10 = this.shaders.geometry, m12 = o19.getInput(), f14 = m12.uniforms.numberOfFields, S7 = a(e9), V4 = f2(e9, n16), d9 = d2(e9);
    l10.setNumberOfFields(f14), u18.setShader({ shader: l10, uniforms: { ...u3(e9, h12.target, m12.uniforms.shader), ...V4.storage, ...V4.view, ...V4.highlight, highlightUniforms: V4.highlight, hittestUniforms: V4.hittestRequest ? { hittestDist: V4.hittestRequest?.distance, hittestPos: V4.hittestRequest?.position } : null }, defines: { VV_SIZE_MIN_MAX_VALUE: !!m12.uniforms.shader.visualVariableSizeMinMaxValue, VV_SIZE_SCALE_STOPS: !!m12.uniforms.shader.visualVariableSizeScaleStops, VV_SIZE_FIELD_STOPS: !!m12.uniforms.shader.visualVariableSizeStops, VV_SIZE_UNIT_VALUE: !!m12.uniforms.shader.visualVariableSizeUnitValue, VV_OPACITY: !!m12.uniforms.shader.visualVariableOpacity, HITTEST: S7, highlight: V4.highlight ? 1 : 0, ...d9, numberOfFields: f14 }, optionalAttributes: {}, useComputeBuffer: S7 }), u18.setPipelineState(m3(e9)), u18.submitDraw(e9, h12);
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/text/TextTechnique.js
var o15 = class extends t6 {
  constructor() {
    super(...arguments), this.type = 30, this.shaders = { geometry: new Y3() }, this.symbologyPlane = 3;
  }
  render(e9, n16) {
    const { painter: o19 } = e9, u18 = d2(e9), d9 = n16.instance.getInput(), m12 = { shader: this.shaders.geometry, uniforms: { ...u3(e9, n16.target, d9.uniforms), ...f2(e9, n16.target), mosaicInfo: o19.textureManager.getMosaicInfo(e9, n16.textureKey) }, defines: { ...u18, isBackgroundPass: true, isLabel: false, textRenderPassType: 0 }, optionalAttributes: d9.optionalAttributes, useComputeBuffer: a(e9) };
    o19.setShader(m12), o19.setPipelineState(m3(e9)), o19.submitDraw(e9, n16), o19.setShader({ ...m12, defines: { ...u18, isBackgroundPass: false, isLabel: false, textRenderPassType: 2 } }), o19.submitDraw(e9, n16), o19.setShader({ ...m12, defines: { ...u18, isBackgroundPass: false, isLabel: false, textRenderPassType: 1 } }), o19.submitDraw(e9, n16), o19.setShader({ ...m12, defines: { ...u18, isBackgroundPass: false, isLabel: false, textRenderPassType: 0 } }), o19.submitDraw(e9, n16);
  }
};

// node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/TechniqueRegistry.js
var F9 = { fill: new n7(), patternFill: new u8(), complexFill: new u6(), gradientFill: new n8(), outlineFill: new u7(), patternOutlineFill: new l5(), complexOutlineFill: new l4(), marker: new n11(), pieChart: new u13(), line: new u10(), texturedLine: new u11(), gradientStroke: new h10(), text: new o15(), label: new o13(), heatmap: new u9(), dotDensity: new f8(), animatedMarker: new o11(), animatedMarkerShift: new i7(), animatedFill: new n6(), animatedLine: new a2() };
function x6() {
  for (const e9 in F9) {
    F9[e9].startup();
  }
}
function k5(e9) {
  for (const i10 in F9) {
    F9[i10].shutdown(e9);
  }
}

// node_modules/@arcgis/core/views/2d/layers/features/schema/processor/schemaUtils.js
function n13(n16, t9) {
  const r10 = n16.slice(0, t9), e9 = t9 - r10.length;
  for (let o19 = 0; o19 < e9; o19++) {
    const n17 = r10[r10.length - 1];
    r10.push(n17);
  }
  return r10;
}
function t7(n16) {
  if (!n16) return [0, 0, 0, 0];
  const { r: t9, g: r10, b: e9, a: o19 } = n16;
  return [t9 * (o19 / 255), r10 * (o19 / 255), e9 * (o19 / 255), o19];
}

// node_modules/@arcgis/core/views/2d/layers/features/support/rendererUtils.js
var l8 = 8;
var s9 = l8 - 2;
var n14 = () => i.getLogger("esri.views.2d.layers.features.support.rendererUtils");
function u14(e9) {
  return e9.map((e10) => a5(e10) ? i8(e10.clone()) : e10);
}
function a5(e9) {
  return ("size" === e9.type || "color" === e9.type || "opacity" === e9.type) && null != e9.stops;
}
function i8(e9) {
  return e9.stops = b4(e9.type, e9.stops ?? []), e9;
}
function p5(e9, o19, r10) {
  return (1 - r10) * e9 + r10 * o19;
}
function c4(e9, o19) {
  const [t9, ...l10] = o19, n16 = l10.pop(), u18 = l10[0].value, a8 = l10[l10.length - 1].value, i10 = (a8 - u18) / s9, c8 = [];
  for (let s12 = u18; s12 < a8; s12 += i10) {
    let t10 = 0;
    for (; s12 >= l10[t10].value; ) t10++;
    const n17 = l10[t10], u19 = o19[t10 - 1], a9 = s12 - u19.value, i11 = n17.value === u19.value ? 1 : a9 / (n17.value - u19.value);
    if ("color" === e9) {
      const e10 = l10[t10], r10 = o19[t10 - 1], n18 = e10.color.clone();
      n18.r = p5(r10.color.r, n18.r, i11), n18.g = p5(r10.color.g, n18.g, i11), n18.b = p5(r10.color.b, n18.b, i11), n18.a = p5(r10.color.a, n18.a, i11), c8.push({ value: s12, color: n18, label: e10.label });
    } else if ("size" === e9) {
      const e10 = l10[t10], n18 = o19[t10 - 1], u20 = o(e10.size), a10 = p5(o(n18.size), u20, i11);
      c8.push({ value: s12, size: a10, label: e10.label });
    } else {
      const e10 = l10[t10], r10 = p5(o19[t10 - 1].opacity, e10.opacity, i11);
      c8.push({ value: s12, opacity: r10, label: e10.label });
    }
  }
  return [t9, ...c8, n16];
}
function f10(e9) {
  const [o19, ...r10] = e9, t9 = r10.pop();
  for (; r10.length > s9; ) {
    let e10 = 0, o20 = 0;
    for (let t10 = 1; t10 < r10.length; t10++) {
      const l10 = r10[t10 - 1], s12 = r10[t10], n16 = Math.abs(s12.value - l10.value);
      n16 > o20 && (o20 = n16, e10 = t10);
    }
    r10.splice(e10, 1);
  }
  return [o19, ...r10, t9];
}
function b4(e9, o19) {
  return o19.length <= l8 ? o19 : (n14().warn(`Found ${o19.length} Visual Variable stops, but MapView only supports ${l8}. Displayed stops will be simplified.`), o19.length > 2 * l8 ? c4(e9, o19) : f10(o19));
}
function g11() {
  const { supportsColorBufferFloat: e9, supportsColorBufferFloatBlend: o19, supportsColorBufferHalfFloat: r10 } = t3();
  return e9 && o19 || r10;
}
function m8(o19) {
  if (!o19) return true;
  switch (o19.type) {
    case "dot-density":
      break;
    case "heatmap":
      if (!g11()) {
        const o20 = t3(), r10 = ["supportsColorBufferFloat", "supportsColorBufferFloatBlend", "supportsColorBufferHalfFloat"].filter((e9) => !o20[e9]).join(", ");
        return n14().errorOnce(new s("webgl-missing-extension", `Missing WebGL2 requirements for Heatmap: ${r10}`)), false;
      }
  }
  return true;
}

// node_modules/@arcgis/core/views/2d/layers/features/schema/processor/VisualVariablesSchema.js
var u15 = 1.25;
var n15 = 128;
var o16 = 128;
function p6(e9) {
  if (!e9.stops?.length) return null;
  const a8 = e9.stops.sort((e10, a9) => e10.value - a9.value), i10 = n13(a8, 8), l10 = i10.map(({ value: e10 }) => e10), r10 = i10.map(({ color: e10 }) => t7(e10));
  return { values: l10, colors: r10 };
}
function c5(e9) {
  if (!e9.stops?.length) return null;
  const a8 = e9.stops.sort((e10, a9) => e10.value - a9.value), i10 = n13(a8, 8);
  return { opacityValues: i10.map(({ value: e10 }) => e10), opacities: i10.map(({ opacity: e10 }) => e10) };
}
function v5(e9) {
  return { rotationType: "geographic" === e9.rotationType ? 0 : 1 };
}
function V2(a8) {
  if (!a8.stops?.length) return null;
  if (a8.stops.some((e9) => e9.useMaxValue || e9.useMinValue)) return (i11, t10) => {
    const r10 = i11.statisticsByLevel.get(t10.key.level), u18 = a8.stops.map((i12) => ({ value: i12.useMaxValue ? r10?.get(a8.field)?.maxValue ?? 0 : i12.useMinValue ? r10?.get(a8.field)?.minValue ?? 0 : i12.value, size: i12.size ? u(i12.size) : c })).sort((e9, a9) => e9.value - a9.value), n16 = n13(u18, 8);
    return { values: n16.map(({ value: e9 }) => e9), sizes: n16.map(({ size: e9 }) => e9) };
  };
  const i10 = a8.stops.sort((e9, a9) => e9.value - a9.value), t9 = n13(i10, 8);
  return { values: t9.map(({ value: e9 }) => e9), sizes: t9.map(({ size: a9 }) => u(a9)) };
}
function f11(e9) {
  return (l10) => {
    const { state: s12 } = l10;
    return { unitValueToPixelsRatio: ae(s12.spatialReference) / m[e9.valueUnit ?? "meters"] / s12.resolution };
  };
}
function m9(e9, a8) {
  const i10 = a8.length;
  if (e9 < a8[0].value || 1 === i10) return a8[0].size;
  for (let l10 = 1; l10 < i10; l10++) if (e9 < a8[l10].value) {
    const i11 = (e9 - a8[l10 - 1].value) / (a8[l10].value - a8[l10 - 1].value);
    return a8[l10 - 1].size + i11 * (a8[l10].size - a8[l10 - 1].size);
  }
  return a8[i10 - 1].size;
}
function S5(a8) {
  const { minDataValue: i10, maxDataValue: l10, minSize: s12, maxSize: t9 } = a8;
  if ("object" == typeof s12 && "object" == typeof t9) return (a9, r10) => {
    const u18 = a9.state.scale, n16 = u(m9(u18, s12.stops)), o19 = u(m9(u18, t9.stops));
    return { minMaxValueAndSize: [i10, l10, n16, o19] };
  };
  if ("object" == typeof s12 || "object" == typeof t9) throw new Error("InternalError: Found a partial VisualVariableSizeMinMaxValue");
  return { minMaxValueAndSize: [i10, l10, u(s12), u(t9)] };
}
var b5 = { visualVariableColor: null, visualVariableOpacity: null, visualVariableRotation: null, visualVariableSizeStops: null, visualVariableSizeScaleStops: null, visualVariableSizeOutlineScaleStops: null, visualVariableSizeUnitValue: null, visualVariableSizeMinMaxValue: null };
function z4(e9, a8 = o16, i10 = u15) {
  if (e9.visualVariableSizeMinMaxValue) return "function" == typeof e9.visualVariableSizeMinMaxValue ? n15 : Math.max(e9.visualVariableSizeMinMaxValue.minMaxValueAndSize[3] * i10, a8);
  if (e9.visualVariableSizeScaleStops) {
    if ("function" == typeof e9.visualVariableSizeScaleStops) return n15;
    const l10 = e9.visualVariableSizeScaleStops.sizes;
    return Math.max(l10[l10.length - 1] * i10, a8);
  }
  if (e9.visualVariableSizeStops) {
    if ("function" == typeof e9.visualVariableSizeStops) return n15;
    const l10 = e9.visualVariableSizeStops.sizes;
    return Math.max(l10[l10.length - 1] * i10, a8);
  }
  return e9.visualVariableSizeUnitValue ? 2 * n15 : 0;
}
function x7(e9) {
  const a8 = { ...b5 };
  if (!e9 || !("visualVariables" in e9) || !e9.visualVariables) return a8;
  for (const i10 of u14(e9.visualVariables)) switch (i10.type) {
    case "color":
      a8.visualVariableColor = p6(i10);
      break;
    case "opacity":
      a8.visualVariableOpacity = c5(i10);
      break;
    case "rotation":
      a8.visualVariableRotation = v5(i10);
      break;
    case "size":
      switch (y4(i10)) {
        case "field-stops":
          a8.visualVariableSizeStops = V2(i10);
          break;
        case "scale-stops":
          "outline" === i10.target ? a8.visualVariableSizeOutlineScaleStops = V2(i10) : a8.visualVariableSizeScaleStops = V2(i10);
          break;
        case "min-max":
          a8.visualVariableSizeMinMaxValue = S5(i10);
          break;
        case "unit-value":
          a8.visualVariableSizeUnitValue = f11(i10);
      }
      break;
  }
  return a8;
}
function y4(e9) {
  return "number" == typeof e9.minDataValue && "number" == typeof e9.maxDataValue && null != e9.minSize && null != e9.maxSize ? "min-max" : "$view.scale" === e9?.valueExpression && Array.isArray(e9.stops) ? "scale-stops" : null == e9.field && "$view.scale" === e9?.valueExpression || !(Array.isArray(e9.stops) || "levels" in e9 && e9.levels) ? null != e9.field || "$view.scale" !== e9?.valueExpression ? "unit-value" : null : "field-stops";
}

// node_modules/@arcgis/core/views/2d/layers/features/schema/processor/symbols/utils.js
function A7(A8) {
  return !!(A8.visualVariableSizeMinMaxValue || A8.visualVariableSizeScaleStops || A8.visualVariableSizeStops || A8.visualVariableSizeUnitValue || A8.visualVariableSizeOutlineScaleStops);
}
function e8(A8) {
  return !!A8.visualVariableRotation;
}
function a6(A8) {
  return A8.spriteRasterizationParam ? A8.spriteRasterizationParam : { type: "sprite-rasterization-param", resource: { type: "CIMPictureMarker", url: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAJOgAACToAYJjBRwAAAAsSURBVEhL7c0xAQAwDASh+jf9lcCU7TDA27ECKqACKqACKqACKqACKqDjYPuLVfSmMPfafQAAAABJRU5ErkJggg==", size: 16, invertBackfaceTexture: false, scaleX: 1, textureFilter: "Picture" }, overrides: [] };
}

// node_modules/@arcgis/core/views/2d/layers/features/schema/processor/symbols/ComplexSymbolSchema.js
function r9(e9) {
  return e9.minScale || e9.maxScale ? { minScale: e9.minScale ?? 0, maxScale: e9.maxScale ?? 0 } : null;
}
function s10(e9) {
  if (null == e9) return null;
  if (Array.isArray(e9)) {
    const [a8, i10, l10, t9] = e9;
    return [a8, i10, l10, 255 * t9];
  }
  return "string" == typeof e9 ? e9 : { ...e9, defaultValue: s10(e9?.defaultValue) };
}
async function c6(a8, i10) {
  const { cimResourceManager: l10, cimAnalyzer: t9, scaleExpression: n16 } = i10.schemaOptions;
  await Promise.all(Y.fetchResources(a8.symbol, l10, []));
  const o19 = t9.analyzeSymbolReference(a8, false), s12 = { scaleInfo: r9(a8), scaleExpression: n16 }, c8 = [];
  for (const e9 of o19) switch (e9.type) {
    case "marker":
      c8.push(...u16(e9, i10, s12));
      break;
    case "fill":
      c8.push(...h11(e9, i10, s12));
      break;
    case "outlineFill":
      c8.push(...b6(e9, i10, s12));
      break;
    case "gradientFill":
      c8.push(...v6(e9, i10, s12));
      break;
    case "line":
      c8.push(...g12(e9, i10, s12));
      break;
    case "gradientStroke":
      c8.push(...R7(e9, i10, s12));
      break;
    case "text":
      c8.push(...C7(e9, i10, s12));
  }
  return c8;
}
function u16(e9, a8, l10) {
  const { uniforms: n16, schemaOptions: o19 } = a8, { store: r10 } = o19, s12 = e9.isOutline ? { ...b5, visualVariableSizeScaleStops: n16.visualVariableSizeOutlineScaleStops } : { visualVariableColor: n16.visualVariableColor, visualVariableOpacity: n16.visualVariableOpacity, visualVariableSizeMinMaxValue: n16.visualVariableSizeMinMaxValue, visualVariableSizeScaleStops: n16.visualVariableSizeScaleStops, visualVariableSizeStops: n16.visualVariableSizeStops, visualVariableSizeUnitValue: n16.visualVariableSizeUnitValue, visualVariableRotation: n16.visualVariableRotation };
  if (e9.animationParams) {
    const { hasShiftAnimation: a9 } = e9.animationParams.params, n17 = a9 ? F9.animatedMarkerShift : F9.animatedMarker;
    return f12(r10.ensureInstance(n17, { uniforms: s12, optionalAttributes: { zoomRange: true, value1Position2Value2: e9.animationParams.params.hasShiftAnimation, lineLength: a9 } }), e9, b5, l10);
  }
  return p7(r10.ensureInstance(F9.marker, { uniforms: s12, optionalAttributes: { zoomRange: !!l10.scaleInfo } }), e9, n16, l10);
}
function f12(e9, a8, i10, l10) {
  if (!a8.animationParams) return [];
  return [e9.createMeshInfo({ pixelDimensions: a8.pixelDimensions, texelDimensions: a8.texelDimensions, effects: a8.effects ? { type: "cim-effect-infos", effectInfos: a8.effects } : null, sprite: a6(a8), animations: a8.animationParams, scaleInfo: l10.scaleInfo, scaleSymbolsProportionally: a8.scaleSymbolsProportionally, strokeWidth: a8.outlineWidth, isMapAligned: 1 === a8.alignment, colorLocked: a8.colorLocked, isStroke: a8.isStroke, baseSize: a8.baseSize, placement: a8.markerPlacement, referenceSize: a8.referenceSize, angleToLine: !!a8.markerPlacement && (a8.markerPlacement.placement && "angleToLine" in a8.markerPlacement.placement && a8.markerPlacement.placement.angleToLine), sizeRatio: a8.sizeRatio, patternHeight: null })];
}
function m10(e9, a8, i10, l10) {
  if (!a8.animationParams) return [];
  return [e9.createMeshInfo({ effects: a8.effects ? { type: "cim-effect-infos", effectInfos: a8.effects } : null, sprite: a6(a8), animations: a8.animationParams, scaleInfo: l10.scaleInfo, scaleSymbolsProportionally: false, strokeWidth: 1, isMapAligned: true, colorLocked: a8.colorLocked || false, isStroke: false, baseSize: "width" in a8 ? a8.width : -1, placement: null, referenceSize: 2, angleToLine: false, sizeRatio: 1, patternHeight: "fill" === a8.type && a8.spriteRasterizationParam ? a8.height : null, joinType: "join" in a8 ? a8.join : "round", capType: "cap" in a8 ? a8.cap : "round", miterLimit: "miterLimit" in a8 && a8.miterLimit || 2 })];
}
function p7(e9, i10, t9, { scaleInfo: n16, scaleExpression: r10 }) {
  const c8 = A7(t9);
  return [e9.createMeshInfo({ size: i10.size, scaleX: i10.scaleX, anchorX: i10.anchorPoint.x, anchorY: i10.anchorPoint.y, angle: i10.rotation, color: s10(i10.color) ?? [0, 0, 0, 0], colorLocked: i10.colorLocked, frameHeight: i10.frameHeight, widthRatio: i10.widthRatio, scaleInfo: n16, offsetX: i10.offsetX, offsetY: i10.offsetY, outlineColor: s10(i10.outlineColor) ?? [0, 0, 0, 0], outlineSize: i10.outlineWidth, referenceSize: i10.referenceSize || o3.CIMVectorMarker.size, rotateClockwise: i10.rotateClockwise, scaleFactor: r10 ?? 1, sizeRatio: i10.sizeRatio, alignment: i10.alignment, isAbsoluteAnchorPoint: i10.isAbsoluteAnchorPoint, scaleSymbolsProportionally: i10.scaleSymbolsProportionally, sprite: i10.spriteRasterizationParam, hasSizeVV: c8, placement: i10.markerPlacement, effects: i10.effects ? { type: "cim-effect-infos", effectInfos: i10.effects } : null, transforms: i10.transform, minPixelBuffer: z4(t9) })];
}
function S6(e9, a8, l10) {
  const { uniforms: n16, schemaOptions: o19 } = a8, { store: r10 } = o19, s12 = { visualVariableColor: e9.colorLocked ? null : n16.visualVariableColor, visualVariableOpacity: n16.visualVariableOpacity };
  if (e9.animationParams) {
    const a9 = F9.animatedFill;
    return m10(r10.ensureInstance(a9, { uniforms: { ...s12, visualVariableSizeMinMaxValue: null, visualVariableSizeStops: null, visualVariableSizeUnitValue: null, visualVariableSizeScaleStops: null, visualVariableRotation: null }, optionalAttributes: { zoomRange: true, value1Position2Value2: false, lineLength: false } }), e9, b5, l10);
  }
  return z5(r10.ensureInstance(F9.fill, { uniforms: s12, optionalAttributes: { zoomRange: !!l10.scaleInfo } }), e9, l10);
}
function b6(e9, a8, l10) {
  const { uniforms: t9, schemaOptions: n16 } = a8, { store: o19 } = n16;
  return V3(o19.ensureInstance(F9.outlineFill, { uniforms: { visualVariableColor: e9.colorLocked ? null : t9.visualVariableColor, visualVariableOpacity: t9.visualVariableOpacity, visualVariableSizeMinMaxValue: null, visualVariableSizeScaleStops: null, visualVariableSizeStops: null, visualVariableSizeUnitValue: null }, optionalAttributes: { zoomRange: !!l10.scaleInfo } }), e9, l10);
}
function V3(e9, a8, i10) {
  const l10 = s10(a8.color) ?? [0, 0, 0, 0], t9 = s10(a8.outlineColor) ?? [0, 0, 0, 0];
  return [e9.createMeshInfo({ color: l10, outlineColor: t9, width: a8.outlineWidth, referenceWidth: a8.referenceWidth, capType: a8.cap, joinType: a8.join, miterLimit: a8.miterLimit, outlineUsesColorVV: !a8.outlineColorLocked, hasSizeVV: false, scaleInfo: i10.scaleInfo, effects: a8.effects ? { type: "cim-effect-infos", effectInfos: a8.effects } : null, outlineEffects: a8.outlineEffects ? { type: "cim-effect-infos", effectInfos: a8.outlineEffects } : null })];
}
function z5(e9, a8, { scaleInfo: i10 }) {
  return [e9.createMeshInfo({ color: s10(a8.color) ?? [0, 0, 0, 0], scaleInfo: i10, effects: a8.effects ? { type: "cim-effect-infos", effectInfos: a8.effects } : null })];
}
function h11(e9, a8, l10) {
  if (!e9.spriteRasterizationParam) return S6(e9, a8, l10);
  const { uniforms: n16, schemaOptions: o19 } = a8, { store: r10 } = o19, s12 = { visualVariableColor: e9.colorLocked ? null : n16.visualVariableColor, visualVariableOpacity: n16.visualVariableOpacity };
  if (e9.animationParams) {
    const a9 = F9.animatedFill;
    return m10(r10.ensureInstance(a9, { uniforms: { ...s12, visualVariableSizeMinMaxValue: null, visualVariableSizeStops: null, visualVariableSizeUnitValue: null, visualVariableSizeScaleStops: null, visualVariableRotation: null }, optionalAttributes: { zoomRange: true, value1Position2Value2: false, lineLength: false } }), e9, b5, l10);
  }
  return d7(r10.ensureInstance(F9.complexFill, { uniforms: s12, optionalAttributes: { zoomRange: !!l10.scaleInfo } }), e9, null != n16.visualVariableColor, l10);
}
function d7(e9, a8, i10, { scaleInfo: l10 }) {
  if (!a8.spriteRasterizationParam) throw new Error("InternalError: Sprite should always be defined");
  const t9 = !!a8.hasUnresolvedReplacementColor && (!i10 || a8.colorLocked), n16 = a8.sampleAlphaOnly && !t9, o19 = a8.spriteRasterizationParam;
  return [e9.createMeshInfo({ color: s10(a8.color) ?? [0, 0, 0, 0], height: a8.height, aspectRatio: a8.scaleX, offsetX: a8.offsetX, offsetY: a8.offsetY, scaleX: 1, scaleY: 1, angle: a8.angle, applyRandomOffset: a8.applyRandomOffset, sampleAlphaOnly: n16, scaleProportionally: "CIMHatchFill" === o19.resource.type, sprite: o19, scaleInfo: l10, effects: a8.effects ? { type: "cim-effect-infos", effectInfos: a8.effects } : null })];
}
function v6(e9, a8, l10) {
  const { uniforms: t9, schemaOptions: n16 } = a8, { store: o19 } = n16;
  return y5(o19.ensureInstance(F9.gradientFill, { uniforms: { visualVariableColor: null, visualVariableOpacity: t9.visualVariableOpacity }, optionalAttributes: { zoomRange: !!l10.scaleInfo } }), e9, l10);
}
function y5(e9, a8, { scaleInfo: i10 }) {
  if (!a8.spriteRasterizationParam) throw new Error("InternalError: Sprite should always be defined");
  const l10 = a8.spriteRasterizationParam;
  return [e9.createMeshInfo({ color: s10(a8.color) ?? [0, 0, 0, 0], angle: a8.angle, gradientMethod: a8.gradientMethod, gradientSize: a8.gradientSize, gradientSizeUnits: a8.gradientSizeUnits, gradientType: a8.gradientType, sprite: l10, scaleInfo: i10, effects: a8.effects ? { type: "cim-effect-infos", effectInfos: a8.effects } : null })];
}
function g12(e9, a8, l10) {
  const { uniforms: n16, schemaOptions: o19 } = a8, { store: r10 } = o19, s12 = e9.isOutline ? { ...b5, visualVariableSizeScaleStops: n16.visualVariableSizeOutlineScaleStops } : { visualVariableColor: e9.colorLocked ? null : n16.visualVariableColor, visualVariableOpacity: n16.visualVariableOpacity, visualVariableSizeMinMaxValue: n16.visualVariableSizeMinMaxValue, visualVariableSizeScaleStops: n16.visualVariableSizeScaleStops, visualVariableSizeStops: n16.visualVariableSizeStops, visualVariableSizeUnitValue: n16.visualVariableSizeUnitValue };
  if (e9.animationParams) {
    const { hasShiftAnimation: a9 } = e9.animationParams.params, n17 = F9.animatedLine;
    return m10(r10.ensureInstance(n17, { uniforms: { ...s12, visualVariableRotation: null }, optionalAttributes: { zoomRange: true, value1Position2Value2: false, accumulatedDistance: true, segmentDirection: true, normal: true, lineLength: a9 } }), e9, b5, l10);
  }
  const c8 = { uniforms: s12, optionalAttributes: { zoomRange: !!l10.scaleInfo } }, u18 = !!(s12.visualVariableSizeMinMaxValue || s12.visualVariableSizeScaleStops || s12.visualVariableSizeStops || s12.visualVariableSizeUnitValue);
  if (!e9.spriteRasterizationParam) {
    return M2(r10.ensureInstance(F9.line, c8), e9, u18, l10);
  }
  return P9(r10.ensureInstance(F9.texturedLine, c8), e9, u18, l10);
}
function I2(e9, a8, { scaleInfo: i10 }) {
  return { color: s10(e9.color) ?? [0, 0, 0, 0], width: e9.width, referenceWidth: e9.referenceWidth, capType: e9.cap, joinType: e9.join, miterLimit: e9.miterLimit, scaleInfo: i10, hasSizeVV: a8, effects: e9.effects ? { type: "cim-effect-infos", effectInfos: e9.effects } : null };
}
function M2(e9, a8, i10, l10) {
  if (a8.spriteRasterizationParam) throw new Error("InternalError: Sprite should not be defined");
  const t9 = I2(a8, i10, l10);
  return [e9.createMeshInfo(t9)];
}
function P9(e9, a8, i10, l10) {
  const { spriteRasterizationParam: t9, scaleDash: n16, sampleAlphaOnly: o19 } = a8;
  if (!t9) throw new Error("InternalError: Sprite should be defined");
  return [e9.createMeshInfo({ ...I2(a8, i10, l10), offsetAlongLine: a8.offsetAlongLine ?? 0, shouldScaleDash: n16 ?? false, shouldSampleAlphaOnly: o19, isSDF: "CIMPictureStroke" !== t9.resource.type && "CIMGradientStroke" !== t9.resource.type, sprite: t9 })];
}
function R7(e9, a8, l10) {
  const { uniforms: n16, schemaOptions: o19 } = a8, { store: r10 } = o19;
  return k6(r10.ensureInstance(F9.gradientStroke, { uniforms: e9.isOutline ? { ...b5, visualVariableSizeScaleStops: n16.visualVariableSizeOutlineScaleStops } : { visualVariableColor: null, visualVariableOpacity: n16.visualVariableOpacity, visualVariableSizeMinMaxValue: n16.visualVariableSizeMinMaxValue, visualVariableSizeScaleStops: n16.visualVariableSizeScaleStops, visualVariableSizeStops: n16.visualVariableSizeStops, visualVariableSizeUnitValue: n16.visualVariableSizeUnitValue }, optionalAttributes: { zoomRange: !!l10.scaleInfo } }), e9, l10);
}
function k6(e9, a8, i10) {
  if (!a8.spriteRasterizationParam) throw new Error("InternalError: Sprite should always be defined");
  const l10 = a8.spriteRasterizationParam;
  return [e9.createMeshInfo({ ...I2(a8, false, i10), gradientMethod: a8.gradientMethod, gradientSize: a8.gradientSize, gradientSizeUnits: a8.gradientSizeUnits, gradientType: a8.gradientType, sprite: l10, effects: a8.effects ? { type: "cim-effect-infos", effectInfos: a8.effects } : null })];
}
function C7(e9, a8, l10) {
  const { uniforms: t9, schemaOptions: n16 } = a8, { store: o19 } = n16;
  return L4(o19.ensureInstance(F9.text, { uniforms: { visualVariableColor: e9.colorLocked ? null : t9.visualVariableColor, visualVariableOpacity: t9.visualVariableOpacity, visualVariableRotation: t9.visualVariableRotation, visualVariableSizeMinMaxValue: t9.visualVariableSizeMinMaxValue, visualVariableSizeScaleStops: t9.visualVariableSizeScaleStops, visualVariableSizeStops: t9.visualVariableSizeStops, visualVariableSizeUnitValue: t9.visualVariableSizeUnitValue }, optionalAttributes: { zoomRange: !!l10.scaleInfo, referenceSymbol: false, clipAngle: false, visibility: false } }), e9, t9, l10);
}
function L4(e9, a8, i10, { scaleInfo: t9, scaleExpression: n16 }) {
  return [e9.createMeshInfo({ boxBackgroundColor: s10(a8.backgroundColor), boxBorderLineColor: s10(a8.borderLineColor), boxBorderLineSize: a8.borderLineWidth ?? 0, color: s10(a8.color) ?? [0, 0, 0, 0], offsetX: a8.offsetX, offsetY: a8.offsetY, postAngle: a8.angle, fontSize: a8.size, referenceSize: a8.referenceSize, decoration: a8.decoration, haloColor: s10(a8.haloColor) ?? [0, 0, 0, 0], haloSize: a8.haloSize ?? 0, outlineColor: s10(a8.outlineColor) ?? [0, 0, 0, 0], outlineSize: a8.outlineSize, lineWidth: a8.lineWidth || 512, lineHeightRatio: 1, horizontalAlignment: a8.horizontalAlignment ?? "center", verticalAlignment: a8.verticalAlignment ?? "baseline", useCIMAngleBehavior: false, glyphs: a8.textRasterizationParam, scaleInfo: t9, effects: a8.effects ? { type: "cim-effect-infos", effectInfos: a8.effects } : null, placement: a8.markerPlacement, transforms: a8.transform, scaleFactor: n16 ?? 1, minPixelBuffer: z4(i10), repeatLabel: null, repeatLabelDistance: null, allowOverrun: null, labelPosition: null, layerId: null, labelClassId: null })];
}

// node_modules/@arcgis/core/views/2d/layers/support/FeatureCommandQueue.js
var i9 = class {
  constructor() {
    this.type = "override-batch", this.messages = [], this._resovler = $();
  }
  get promise() {
    return this._resovler.promise;
  }
  resolve() {
    this._resovler.resolve();
  }
  add(e9) {
    this.messages.push(e9);
  }
};
var o17 = class {
  constructor(e9) {
    this.updateTracking = new n({ debugName: "FeatureCommandQueue" }), this.process = e9.process, this._queueProcessor = new _({ concurrency: 1, process: async (e10) => {
      if ("override-batch" === e10.type) {
        const e11 = this._nextOverrideBatch;
        if (null == e11) throw new Error("InternalError: Override should be defined");
        return this._nextOverrideBatch = null, await this.process(e11), void e11.resolve();
      }
      return this.process(e10);
    } });
  }
  destroy() {
    this.updateTracking.destroy(), this._queueProcessor.destroy(), this.clear();
  }
  clear() {
    this._queueProcessor.clear();
  }
  async push(r10) {
    return y(this.updateTracking.addPromise(this._doPush(r10)));
  }
  async _doPush(e9) {
    const r10 = this._queueProcessor, s12 = r10.last();
    switch (e9.type) {
      case "update":
      case "highlight":
        if (s12?.type === e9.type) return;
        return r10.push(e9);
      case "override":
      case "edit":
        return this._pushOverride(e9);
    }
  }
  _pushOverride(e9) {
    return null == this._nextOverrideBatch && (this._nextOverrideBatch = new i9(), this._queueProcessor.push(this._nextOverrideBatch)), this._nextOverrideBatch.add(e9), this._nextOverrideBatch.promise;
  }
};

// node_modules/@arcgis/core/views/2d/layers/features/schema/processor/StorageSchema.js
function t8(e9, i10) {
  return { type: "simple", filters: i10, capabilities: { maxTextureSize: t3().maxTextureSize }, bindings: o18(e9) };
}
function s11(e9, r10) {
  const t9 = t3();
  return { type: "multi", target: "feature", keyField: r3, filters: r10, capabilities: { maxTextureSize: t9.maxTextureSize }, bindings: { 0: o18(e9.trackLines.renderer), 1: o18(e9.latestObservations.renderer), 2: o18(e9.previousObservations.renderer) } };
}
function a7(e9) {
  switch (e9) {
    case "opacity":
      return 2;
    case "color":
      return 1;
    case "rotation":
      return 3;
    case "size":
      return 0;
    default:
      return null;
  }
}
function o18(e9) {
  if (!e9) return [];
  switch (e9.type) {
    case "simple":
    case "class-breaks":
    case "unique-value":
    case "dictionary":
      return p8(e9);
    case "dot-density":
      return l9(e9);
    case "pie-chart":
      return u17(e9);
    case "heatmap":
      return c7(e9);
  }
}
function l9(e9) {
  const i10 = [];
  for (const r10 of e9.attributes) i10.push({ binding: i10.length, expression: r10.valueExpression, field: r10.field });
  return i10;
}
function u17(e9) {
  const i10 = p8(e9);
  let r10 = 4;
  for (const n16 of e9.attributes) i10.push({ binding: r10++, expression: n16.valueExpression, field: n16.field });
  return i10;
}
function c7({ valueExpression: e9, field: i10 }) {
  return e9 || i10 ? [{ binding: 0, expression: e9, field: i10 }] : [];
}
function p8(i10) {
  if (!("visualVariables" in i10) || !i10.visualVariables?.length) return [];
  return u14(i10.visualVariables).map((e9) => b7(e9)).filter(N);
}
function f13(e9) {
  return "$view.scale" === e9.valueExpression ? null : { binding: a7(e9.type), field: e9.field, normalizationField: e9.normalizationField, expression: e9.valueExpression, valueRepresentation: e9.valueRepresentation };
}
function d8(e9) {
  return { binding: a7(e9.type), field: e9.field, normalizationField: e9.normalizationField, expression: e9.valueExpression };
}
function m11(e9) {
  return { binding: a7(e9.type), field: e9.field, normalizationField: e9.normalizationField, expression: e9.valueExpression };
}
function x8(e9) {
  return { binding: a7(e9.type), expression: e9.valueExpression, field: e9.field };
}
function b7(e9) {
  switch (e9.type) {
    case "size":
      return f13(e9);
    case "color":
      return d8(e9);
    case "opacity":
      return m11(e9);
    case "rotation":
      return x8(e9);
  }
}

export {
  t4 as t,
  o8 as o,
  s6 as s,
  F9 as F,
  x6 as x,
  k5 as k,
  t7 as t2,
  m8 as m,
  b5 as b,
  z4 as z,
  x7 as x2,
  A7 as A,
  e8 as e,
  r9 as r,
  c6 as c,
  f12 as f,
  m10 as m2,
  p7 as p,
  V3 as V,
  z5 as z2,
  d7 as d,
  y5 as y,
  M2 as M,
  P9 as P,
  k6 as k2,
  L4 as L,
  t8 as t3,
  s11 as s2,
  p8 as p2,
  o17 as o2
};
//# sourceMappingURL=chunk-N3OIGAM3.js.map
