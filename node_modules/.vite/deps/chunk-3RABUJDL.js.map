{
  "version": 3,
  "sources": ["../../@arcgis/core/views/webgl/BufferObject.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{isArrayLike as t}from\"../../core/arrayUtils.js\";import has from\"../../core/has.js\";import e from\"../../core/Logger.js\";import{isUint8Array as s,isUint16Array as i,isUint32Array as r}from\"../../core/typedArrayUtil.js\";import{checkWebGLError as n}from\"./checkWebGLError.js\";import{ResourceType as u,DataType as a}from\"./enums.js\";const f=()=>e.getLogger(\"esri.views.webgl.BufferObject\"),h=null,c=!!has(\"esri-tests-disable-gpu-memory-measurements\");class o{static createIndex(t,e,s){return new o(t,34963,e,s)}static createUniform(t,e,s){return new o(t,35345,e,s)}static createPixelPack(t,e=35041,s){const i=new o(t,35051,e);return s&&i.setSize(s),i}static createPixelUnpack(t,e=35040,s){return new o(t,35052,e,s)}static createTransformFeedback(t,e=35044,s){const i=new o(t,35982,e);return i.setSize(s),i}constructor(t,e,s,i){this._context=t,this.bufferType=e,this.usage=s,this._glName=null,this._size=-1,this._indexType=void 0,t.instanceCounter.increment(u.BufferObject,this),this._glName=this._context.gl.createBuffer(),n(this._context.gl),i&&this.setData(i)}get glName(){return this._glName}get size(){return this._size}get indexType(){return this._indexType}get sizeBytes(){if(34963===this.bufferType){if(this._indexType===a.UNSIGNED_INT)return 4*this._size;if(this._indexType===a.UNSIGNED_SHORT)return 2*this._size}return this._size}get usedMemory(){return c?0:this.sizeBytes}get _isVAOAware(){return 34963===this.bufferType||34962===this.bufferType}dispose(){if(this._context?.gl){if(this._glName){this._context.gl.deleteBuffer(this._glName),this._glName=null}this._context.instanceCounter.decrement(u.BufferObject,this),this._context=null}else this._glName&&f().warn(\"Leaked WebGL buffer object\")}setSize(t,e=null){if(34963===this.bufferType&&null!=e)switch(this._indexType=e,e){case a.UNSIGNED_SHORT:t*=2;break;case a.UNSIGNED_INT:t*=4}this._setBufferData(t)}setData(t){if(!t)return;let e=t.byteLength;34963===this.bufferType&&(s(t)?this._indexType=a.UNSIGNED_BYTE:i(t)?(e/=2,this._indexType=a.UNSIGNED_SHORT):r(t)&&(e/=4,this._indexType=a.UNSIGNED_INT)),this._setBufferData(e,t)}_setBufferData(t,e=null){this._size=t;const s=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const i=this._context.gl;null!=e?i.bufferData(this.bufferType,e,this.usage):i.bufferData(this.bufferType,t,this.usage),n(i),this._isVAOAware&&this._context.bindVAO(s)}setSubData(t,e,s,i){if(!t)return;const r=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const{gl:u}=this._context;u.bufferSubData(this.bufferType,e*t.BYTES_PER_ELEMENT,t,s,i-s),n(u),this._isVAOAware&&this._context.bindVAO(r)}getSubData(t,e=0,s,i){if(s<0||i<0)return;const r=_(t)?t.BYTES_PER_ELEMENT:1;if(r*((s??0)+(i??0))>t.byteLength)return;e+r*(i??0)>this.usedMemory&&f().warn(\"Potential problem getting subdata: requested data exceeds buffer size!\");const n=this._context.gl;35982===this.bufferType?(this._context.bindBuffer(this,35982),n.getBufferSubData(35982,e,t,s,i),this._context.unbindBuffer(35982)):(this._context.bindBuffer(this,36662),n.getBufferSubData(36662,e,t,s,i),this._context.unbindBuffer(36662))}async getSubDataAsync(t,e=0,s,i){await this._context.clientWaitAsync(),this.getSubData(t,e,s,i)}}function _(e){return t(e)}export{o as BufferObject,h as tracer};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;AAI+U,IAAM,IAAE,MAAI,EAAE,UAAU,+BAA+B;AAAvD,IAAgEA,KAAE,CAAC,CAAC,IAAI,4CAA4C;AAAE,IAAM,IAAN,MAAM,GAAC;AAAA,EAAC,OAAO,YAAYC,IAAE,GAAE,GAAE;AAAC,WAAO,IAAI,GAAEA,IAAE,OAAM,GAAE,CAAC;AAAA,EAAC;AAAA,EAAC,OAAO,cAAcA,IAAE,GAAE,GAAE;AAAC,WAAO,IAAI,GAAEA,IAAE,OAAM,GAAE,CAAC;AAAA,EAAC;AAAA,EAAC,OAAO,gBAAgBA,IAAE,IAAE,OAAM,GAAE;AAAC,UAAMC,KAAE,IAAI,GAAED,IAAE,OAAM,CAAC;AAAE,WAAO,KAAGC,GAAE,QAAQ,CAAC,GAAEA;AAAA,EAAC;AAAA,EAAC,OAAO,kBAAkBD,IAAE,IAAE,OAAM,GAAE;AAAC,WAAO,IAAI,GAAEA,IAAE,OAAM,GAAE,CAAC;AAAA,EAAC;AAAA,EAAC,OAAO,wBAAwBA,IAAE,IAAE,OAAM,GAAE;AAAC,UAAMC,KAAE,IAAI,GAAED,IAAE,OAAM,CAAC;AAAE,WAAOC,GAAE,QAAQ,CAAC,GAAEA;AAAA,EAAC;AAAA,EAAC,YAAYD,IAAE,GAAE,GAAEC,IAAE;AAAC,SAAK,WAASD,IAAE,KAAK,aAAW,GAAE,KAAK,QAAM,GAAE,KAAK,UAAQ,MAAK,KAAK,QAAM,IAAG,KAAK,aAAW,QAAOA,GAAE,gBAAgB,UAAU,EAAE,cAAa,IAAI,GAAE,KAAK,UAAQ,KAAK,SAAS,GAAG,aAAa,GAAE,EAAE,KAAK,SAAS,EAAE,GAAEC,MAAG,KAAK,QAAQA,EAAC;AAAA,EAAC;AAAA,EAAC,IAAI,SAAQ;AAAC,WAAO,KAAK;AAAA,EAAO;AAAA,EAAC,IAAI,OAAM;AAAC,WAAO,KAAK;AAAA,EAAK;AAAA,EAAC,IAAI,YAAW;AAAC,WAAO,KAAK;AAAA,EAAU;AAAA,EAAC,IAAI,YAAW;AAAC,QAAG,UAAQ,KAAK,YAAW;AAAC,UAAG,KAAK,eAAa,EAAE,aAAa,QAAO,IAAE,KAAK;AAAM,UAAG,KAAK,eAAa,EAAE,eAAe,QAAO,IAAE,KAAK;AAAA,IAAK;AAAC,WAAO,KAAK;AAAA,EAAK;AAAA,EAAC,IAAI,aAAY;AAAC,WAAOF,KAAE,IAAE,KAAK;AAAA,EAAS;AAAA,EAAC,IAAI,cAAa;AAAC,WAAO,UAAQ,KAAK,cAAY,UAAQ,KAAK;AAAA,EAAU;AAAA,EAAC,UAAS;AAAC,QAAG,KAAK,UAAU,IAAG;AAAC,UAAG,KAAK,SAAQ;AAAC,aAAK,SAAS,GAAG,aAAa,KAAK,OAAO,GAAE,KAAK,UAAQ;AAAA,MAAI;AAAC,WAAK,SAAS,gBAAgB,UAAU,EAAE,cAAa,IAAI,GAAE,KAAK,WAAS;AAAA,IAAI,MAAM,MAAK,WAAS,EAAE,EAAE,KAAK,4BAA4B;AAAA,EAAC;AAAA,EAAC,QAAQC,IAAE,IAAE,MAAK;AAAC,QAAG,UAAQ,KAAK,cAAY,QAAM,EAAE,SAAO,KAAK,aAAW,GAAE,GAAE;AAAA,MAAC,KAAK,EAAE;AAAe,QAAAA,MAAG;AAAE;AAAA,MAAM,KAAK,EAAE;AAAa,QAAAA,MAAG;AAAA,IAAC;AAAC,SAAK,eAAeA,EAAC;AAAA,EAAC;AAAA,EAAC,QAAQA,IAAE;AAAC,QAAG,CAACA,GAAE;AAAO,QAAI,IAAEA,GAAE;AAAW,cAAQ,KAAK,eAAa,EAAEA,EAAC,IAAE,KAAK,aAAW,EAAE,gBAAc,EAAEA,EAAC,KAAG,KAAG,GAAE,KAAK,aAAW,EAAE,kBAAgB,EAAEA,EAAC,MAAI,KAAG,GAAE,KAAK,aAAW,EAAE,gBAAe,KAAK,eAAe,GAAEA,EAAC;AAAA,EAAC;AAAA,EAAC,eAAeA,IAAE,IAAE,MAAK;AAAC,SAAK,QAAMA;AAAE,UAAM,IAAE,KAAK,SAAS,YAAY;AAAE,SAAK,eAAa,KAAK,SAAS,QAAQ,IAAI,GAAE,KAAK,SAAS,WAAW,IAAI;AAAE,UAAMC,KAAE,KAAK,SAAS;AAAG,YAAM,IAAEA,GAAE,WAAW,KAAK,YAAW,GAAE,KAAK,KAAK,IAAEA,GAAE,WAAW,KAAK,YAAWD,IAAE,KAAK,KAAK,GAAE,EAAEC,EAAC,GAAE,KAAK,eAAa,KAAK,SAAS,QAAQ,CAAC;AAAA,EAAC;AAAA,EAAC,WAAWD,IAAE,GAAE,GAAEC,IAAE;AAAC,QAAG,CAACD,GAAE;AAAO,UAAM,IAAE,KAAK,SAAS,YAAY;AAAE,SAAK,eAAa,KAAK,SAAS,QAAQ,IAAI,GAAE,KAAK,SAAS,WAAW,IAAI;AAAE,UAAK,EAAC,IAAGE,GAAC,IAAE,KAAK;AAAS,IAAAA,GAAE,cAAc,KAAK,YAAW,IAAEF,GAAE,mBAAkBA,IAAE,GAAEC,KAAE,CAAC,GAAE,EAAEC,EAAC,GAAE,KAAK,eAAa,KAAK,SAAS,QAAQ,CAAC;AAAA,EAAC;AAAA,EAAC,WAAWF,IAAE,IAAE,GAAE,GAAEC,IAAE;AAAC,QAAG,IAAE,KAAGA,KAAE,EAAE;AAAO,UAAM,IAAE,EAAED,EAAC,IAAEA,GAAE,oBAAkB;AAAE,QAAG,MAAI,KAAG,MAAIC,MAAG,MAAID,GAAE,WAAW;AAAO,QAAE,KAAGC,MAAG,KAAG,KAAK,cAAY,EAAE,EAAE,KAAK,wEAAwE;AAAE,UAAM,IAAE,KAAK,SAAS;AAAG,cAAQ,KAAK,cAAY,KAAK,SAAS,WAAW,MAAK,KAAK,GAAE,EAAE,iBAAiB,OAAM,GAAED,IAAE,GAAEC,EAAC,GAAE,KAAK,SAAS,aAAa,KAAK,MAAI,KAAK,SAAS,WAAW,MAAK,KAAK,GAAE,EAAE,iBAAiB,OAAM,GAAED,IAAE,GAAEC,EAAC,GAAE,KAAK,SAAS,aAAa,KAAK;AAAA,EAAE;AAAA,EAAC,MAAM,gBAAgBD,IAAE,IAAE,GAAE,GAAEC,IAAE;AAAC,UAAM,KAAK,SAAS,gBAAgB,GAAE,KAAK,WAAWD,IAAE,GAAE,GAAEC,EAAC;AAAA,EAAC;AAAC;AAAC,SAAS,EAAE,GAAE;AAAC,SAAO,EAAE,CAAC;AAAC;",
  "names": ["c", "t", "i", "u"]
}
