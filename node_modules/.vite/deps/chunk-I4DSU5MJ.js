import {
  e as e4
} from "./chunk-MCWHCMX6.js";
import {
  e
} from "./chunk-D7KJNSAT.js";
import {
  c
} from "./chunk-BZV32YR7.js";
import {
  e as e2
} from "./chunk-IT62DCG6.js";
import {
  r
} from "./chunk-YOYO2XMY.js";
import {
  e as e3
} from "./chunk-SZTZNZQW.js";
import {
  i
} from "./chunk-AJG2ZYEA.js";
import {
  n as n2,
  t as t2
} from "./chunk-CFXCM2NO.js";
import {
  p
} from "./chunk-GY6YF4EN.js";
import {
  C,
  t2 as t
} from "./chunk-GNMPGHLQ.js";
import {
  n
} from "./chunk-AL6YUTZM.js";

// node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js
function n3(n4) {
  return 4 === n4 || 5 === n4 || 6 === n4 || 7 === n4 || 8 === n4;
}
function r2(n4) {
  return a(n4) || 3 === n4;
}
function t3(n4) {
  return 9 === n4 || 10 === n4;
}
function u(n4) {
  return e5(n4) || t3(n4);
}
function e5(n4) {
  return 0 === n4;
}
function o(n4) {
  return e5(n4) || d(n4);
}
function f(n4) {
  return o(n4) || 10 === n4;
}
function x(n4) {
  return o(n4) || t3(n4);
}
function a(n4) {
  return x(n4) || b(n4);
}
function b(n4) {
  return 2 === n4;
}
function d(n4) {
  return 1 === n4;
}
function g(r6) {
  return b(r6) || n3(r6);
}

// node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl.js
function d2(d3, v) {
  switch (v.textureCoordinateType) {
    case 1:
      return d3.attributes.add("uv0", "vec2"), d3.varyings.add("vuv0", "vec2"), void d3.vertex.code.add(t2`void forwardTextureCoordinates() { vuv0 = uv0; }`);
    case 2:
      return d3.attributes.add("uv0", "vec2"), d3.attributes.add("uvRegion", "vec4"), d3.varyings.add("vuv0", "vec2"), d3.varyings.add("vuvRegion", "vec4"), void d3.vertex.code.add(t2`void forwardTextureCoordinates() {
vuv0 = uv0;
vuvRegion = uvRegion;
}`);
    default:
      n(v.textureCoordinateType);
    case 0:
      return void d3.vertex.code.add(t2`void forwardTextureCoordinates() {}`);
    case 3:
      return;
  }
}

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/GLMaterial.js
var t4 = class {
  constructor(t5) {
    this._material = t5.material, this._techniques = t5.techniques, this._output = t5.output;
  }
  dispose() {
  }
  get _stippleTextures() {
    return this._techniques.context?.stippleTextures;
  }
  get _markerTextures() {
    return this._techniques.context?.markerTextures;
  }
  getTechnique(t5, e8) {
    return this._techniques.get(t5, this._material.getConfiguration(this._output, e8));
  }
  ensureResources(t5) {
    return 2;
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/GLTextureMaterial.js
var r3 = class extends t4 {
  constructor(t5) {
    super(t5), this._numLoading = 0, this._disposed = false, this._textures = t5.textures, this.updateTexture(t5.textureId), this._acquire(t5.normalTextureId, (t6) => this._textureNormal = t6), this._acquire(t5.emissiveTextureId, (t6) => this._textureEmissive = t6), this._acquire(t5.occlusionTextureId, (t6) => this._textureOcclusion = t6), this._acquire(t5.metallicRoughnessTextureId, (t6) => this._textureMetallicRoughness = t6);
  }
  dispose() {
    super.dispose(), this._texture = t(this._texture), this._textureNormal = t(this._textureNormal), this._textureEmissive = t(this._textureEmissive), this._textureOcclusion = t(this._textureOcclusion), this._textureMetallicRoughness = t(this._textureMetallicRoughness), this._disposed = true;
  }
  ensureResources(t5) {
    return 0 === this._numLoading ? 2 : 1;
  }
  get textureBindParameters() {
    return new l(this._texture?.glTexture ?? null, this._textureNormal?.glTexture ?? null, this._textureEmissive?.glTexture ?? null, this._textureOcclusion?.glTexture ?? null, this._textureMetallicRoughness?.glTexture ?? null);
  }
  updateTexture(e8) {
    null != this._texture && e8 === this._texture.id || (this._texture = t(this._texture), this._acquire(e8, (t5) => this._texture = t5));
  }
  _acquire(s, i2) {
    if (null == s) return void i2(null);
    const r6 = this._textures.acquire(s);
    if (C(r6)) return ++this._numLoading, void r6.then((e8) => {
      if (this._disposed) return t(e8), void i2(null);
      i2(e8);
    }).finally(() => --this._numLoading);
    i2(r6);
  }
};
var u2 = class extends c {
  constructor(t5 = null) {
    super(), this.textureEmissive = t5;
  }
};
var l = class extends u2 {
  constructor(t5, e8, s, i2, r6, u3, l2) {
    super(s), this.texture = t5, this.textureNormal = e8, this.textureOcclusion = i2, this.textureMetallicRoughness = r6, this.scale = u3, this.normalTextureTransformMatrix = l2;
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatDrawUniform.js
var r4 = class extends i {
  constructor(o2, r6, s) {
    super(o2, "float", 2, (t5, e8, f3) => t5.setUniform1f(o2, r6(e8, f3), s));
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/TextureAtlasLookup.glsl.js
function e6(e8) {
  e8.fragment.code.add(t2`vec4 textureAtlasLookup(sampler2D tex, vec2 textureCoordinates, vec4 atlasRegion) {
vec2 atlasScale = atlasRegion.zw - atlasRegion.xy;
vec2 uvAtlas = fract(textureCoordinates) * atlasScale + atlasRegion.xy;
float maxdUV = 0.125;
vec2 dUVdx = clamp(dFdx(textureCoordinates), -maxdUV, maxdUV) * atlasScale;
vec2 dUVdy = clamp(dFdy(textureCoordinates), -maxdUV, maxdUV) * atlasScale;
return textureGrad(tex, uvAtlas, dUVdx, dUVdy);
}`);
}

// node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexTextureCoordinates.glsl.js
function r5(r6, u3) {
  const { textureCoordinateType: l2 } = u3;
  if (0 === l2 || 3 === l2) return;
  r6.include(d2, u3);
  const s = 2 === l2;
  s && r6.include(e6), r6.fragment.code.add(t2`
    vec4 textureLookup(sampler2D tex, vec2 uv) {
      return ${s ? "textureAtlasLookup(tex, uv, vuvRegion)" : "texture(tex, uv)"};
    }
  `);
}

// node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/Gamma.glsl.js
function e7(e8) {
  e8.code.add(t2`
    const float GAMMA = ${t2.float(p)};
    const float INV_GAMMA = ${t2.float(1 / p)};

    vec4 delinearizeGamma(vec4 color) {
      return vec4(pow(color.rgb, vec3(INV_GAMMA)), color.a);
    }

    vec3 linearizeGamma(vec3 color) {
      return pow(color, vec3(GAMMA));
    }
  `);
}

// node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/output/Emissions.glsl.js
var f2 = 1;
function x2(u3, d3) {
  if (!o(d3.output)) return;
  u3.fragment.include(e7);
  const { emissionSource: c2, hasEmissiveTextureTransform: x3, bindType: g2 } = d3, p2 = 3 === c2 || 4 === c2 || 5 === c2;
  p2 && (u3.include(r5, d3), u3.fragment.uniforms.add(1 === g2 ? new e3("texEmission", (e8) => e8.textureEmissive) : new e4("texEmission", (e8) => e8.textureEmissive)));
  const h = 2 === c2 || p2;
  h && u3.fragment.uniforms.add(1 === g2 ? new e2("emissiveBaseColor", (e8) => e8.emissiveBaseColor) : new e("emissiveBaseColor", (e8) => e8.emissiveBaseColor));
  const T = 0 !== c2;
  T && !(7 === c2 || 6 === c2 || 4 === c2 || 5 === c2) && u3.fragment.uniforms.add(1 === g2 ? new r("emissiveStrength", (e8) => e8.emissiveStrength) : new r4("emissiveStrength", (e8) => e8.emissiveStrength));
  const b2 = 7 === c2, j = 5 === c2, w = 1 === c2 || 6 === c2 || b2;
  u3.fragment.code.add(t2`
    vec4 getEmissions(vec3 symbolColor) {
      vec4 emissions = ${h ? j ? "emissiveSource == 0 ? vec4(emissiveBaseColor, 1.0): vec4(linearizeGamma(symbolColor), 1.0)" : "vec4(emissiveBaseColor, 1.0)" : w ? b2 ? "emissiveSource == 0 ? vec4(0.0): vec4(linearizeGamma(symbolColor), 1.0)" : "vec4(linearizeGamma(symbolColor), 1.0)" : "vec4(0.0)"};
      ${n2(p2, `${n2(j, `if(emissiveSource == 0) {
              vec4 emissiveFromTex = textureLookup(texEmission, ${x3 ? "emissiveUV" : "vuv0"});
              emissions *= vec4(linearizeGamma(emissiveFromTex.rgb), emissiveFromTex.a);
           }`, `vec4 emissiveFromTex = textureLookup(texEmission, ${x3 ? "emissiveUV" : "vuv0"});
           emissions *= vec4(linearizeGamma(emissiveFromTex.rgb), emissiveFromTex.a);`)}
        emissions.w = emissions.rgb == vec3(0.0) ? 0.0: emissions.w;`)}
      ${n2(T, `emissions.rgb *= emissiveStrength * ${t2.float(f2)};`)}
      return emissions;
    }
  `);
}

export {
  n3 as n,
  r2 as r,
  t3 as t,
  u,
  e5 as e,
  o,
  f,
  x,
  a,
  b,
  d,
  g,
  t4 as t2,
  r3 as r2,
  l,
  d2,
  r5 as r3,
  e7 as e2,
  x2
};
//# sourceMappingURL=chunk-I4DSU5MJ.js.map
