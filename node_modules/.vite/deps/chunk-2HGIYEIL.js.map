{
  "version": 3,
  "sources": ["../../@arcgis/core/layers/support/FieldsIndex.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import i from\"../../core/Logger.js\";import{getOrCreateMapValue as t}from\"../../core/MapUtils.js\";import{UnknownTimeZone as s}from\"../../core/sql/UnknownTimeZone.js\";import{isSerializable as n}from\"../../core/support/jsonUtils.js\";import{isDateField as r,isNumericField as l,isObjectIDField as o,isGlobalIDField as d,getFieldDefaultValue as a,isTimeOnlyField as m,normalizeFieldName as u}from\"./fieldUtils.js\";import{utc as f,unknown as F}from\"../../time/constants.js\";import{fromTimeReference as h}from\"../../time/timeZoneUtils.js\";import{FixedOffsetZone as c,IANAZone as p}from\"luxon\";function y(e){return\"timeZone\"in e}function _(e){return\"timeZone\"in e}function g(e){return\"dateFieldsTimeZone\"in e}const T=new Map;class Z{static fromJSON(e){return new Z(e.fields,e.timeZoneByFieldName)}static fromLayer(e){return new Z(e.fields??[],S(e))}static fromLayerJSON(e){return new Z(e.fields??[],S(e))}constructor(e=[],i){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=i?new Map(i):null;const t=[];for(const s of this.fields){const e=s?.name,i=M(e);if(e&&i){const n=w(e);this._fieldsMap.set(e,s),this._fieldsMap.set(n,s),this._normalizedFieldsMap.set(i,s),t.push(`${n}:${s.type}:${this._timeZoneByFieldName?.get(e)}`),r(s)?(this.dateFields.push(s),this._dateFieldsSet.add(s)):l(s)&&(this._numericFieldsSet.add(s),this.numericFields.push(s)),o(s)||d(s)||(s.editable=null==s.editable||!!s.editable,s.nullable=null==s.nullable||!!s.nullable)}}t.sort(),this.uid=t.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)o(e)||d(e)||e.nullable||void 0!==a(e)||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===e?.uid}has(e){return null!=this.get(e)}get(e){if(!e)return;let i=this._fieldsMap.get(e);return i||(i=this._fieldsMap.get(w(e))??this._normalizedFieldsMap.get(M(e)),i&&this._fieldsMap.set(e,i),i)}getTimeZone(t){const s=this.get(t&&\"string\"!=typeof t?t.name:t);return s?this._timeZoneByFieldName?this._timeZoneByFieldName.get(s.name):\"date\"===s.type||\"esriFieldTypeDate\"===s.type?(i.getLogger(\"esri.layers.support.FieldsIndex\").errorOnce(new e(\"getTimeZone:no-timezone-information\",`no time zone information for field '${s.name}'`)),f):N.has(s.type)?F:null:null}getLuxonTimeZone(e){const i=this.getTimeZone(e);return i?i===F?s.instance:i===f?c.utcInstance:t(T,i,()=>p.create(i)):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return m(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){return this.get(e)?.name??void 0}toJSON(){return{fields:this.fields.map(e=>n(e)?e.toJSON():e),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function w(e){return e.trim().toLowerCase()}function M(e){return u(e)?.toLowerCase()??\"\"}const N=new Set([\"time-only\",\"date-only\",\"timestamp-offset\",\"esriFieldTypeDateOnly\",\"esriFieldTypeTimeOnly\",\"esriFieldTypeTimestampOffset\"]);function S(e){const i=new Map;if(!e.fields)return i;const t=!0===e.datesInUnknownTimezone,{timeInfo:s,editFieldsInfo:n}=e,r=(s?\"startField\"in s?s.startField:s.startTimeField:\"\")??\"\",l=(s?\"endField\"in s?s.endField:s.endTimeField:\"\")??\"\",o=g(e)?e.dateFieldsTimeZone??null:e.dateFieldsTimeReference?h(e.dateFieldsTimeReference):null,d=n?y(n)?n.timeZone??o:n.dateFieldsTimeReference?h(n.dateFieldsTimeReference):o??f:null,a=s?_(s)?s.timeZone??o:s.timeReference?h(s.timeReference):o:null,m=new Map([[w(n?.creationDateField??\"\"),d],[w(n?.editDateField??\"\"),d],[w(r),a],[w(l),a]]);for(const{name:u,type:f}of e.fields)if(N.has(f))i.set(u,F);else if(\"date\"!==f&&\"esriFieldTypeDate\"!==f)i.set(u,null);else if(t)i.set(u,F);else{const e=m.get(w(u??\"\"))??o;i.set(u,e)}return i}export{Z as default};\n"],
  "mappings": "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",
  "names": ["e", "i", "t", "s", "n", "o", "f"]
}
