import {
  c as c2,
  d
} from "./chunk-FZGHWS2H.js";
import {
  c
} from "./chunk-SDWO6NEP.js";
import "./chunk-EC56NYYL.js";
import "./chunk-KDGDF37U.js";
import "./chunk-U6CJFTOF.js";
import {
  b2 as b
} from "./chunk-CZOYDK6P.js";
import {
  l as l2
} from "./chunk-NP2TBOXH.js";
import "./chunk-QYAMBIRP.js";
import "./chunk-JHV6OBEB.js";
import "./chunk-ZVTEFYZX.js";
import "./chunk-LPUPM55U.js";
import "./chunk-WDTGOP77.js";
import "./chunk-VYMBX5H5.js";
import {
  a as a4
} from "./chunk-5ONGWFJ3.js";
import "./chunk-7YH7T6CS.js";
import "./chunk-3T4IXPP4.js";
import "./chunk-XTZAIV4X.js";
import "./chunk-63LDVRFI.js";
import "./chunk-HWUOAPTX.js";
import "./chunk-QHCKOBU7.js";
import "./chunk-K2OZ6WVC.js";
import "./chunk-MC6NAKKX.js";
import "./chunk-TF6255HN.js";
import "./chunk-C5OQVQZF.js";
import {
  Y
} from "./chunk-2LC2762W.js";
import "./chunk-W6HOAVT4.js";
import "./chunk-DTZUXJMD.js";
import "./chunk-YLAGKT2D.js";
import "./chunk-6YRQYUCY.js";
import {
  b as b2
} from "./chunk-P6IKJIMO.js";
import "./chunk-MHV23XAQ.js";
import "./chunk-LPZUGJNG.js";
import "./chunk-XLOINTMG.js";
import {
  e,
  n
} from "./chunk-MA3QDRC3.js";
import "./chunk-W6J7XCPU.js";
import "./chunk-ONXWBTTM.js";
import {
  f
} from "./chunk-T7F6Q6JJ.js";
import {
  O
} from "./chunk-YDTPM7OQ.js";
import "./chunk-75XOUSSS.js";
import "./chunk-TH4EQWJJ.js";
import "./chunk-XCKT47LJ.js";
import "./chunk-3FUHCAX3.js";
import "./chunk-PZ5RULLK.js";
import "./chunk-OPJX4KXH.js";
import "./chunk-LTPHDYPK.js";
import "./chunk-3OVERDFX.js";
import "./chunk-FPMLKIDB.js";
import "./chunk-AZXJIEZ6.js";
import "./chunk-Q75WYS7K.js";
import {
  z
} from "./chunk-H74Q4SYB.js";
import {
  l,
  w
} from "./chunk-2OFHDVO5.js";
import "./chunk-TFJXG32O.js";
import "./chunk-DDOCCRD4.js";
import "./chunk-5UPBUJPC.js";
import "./chunk-THQO67BJ.js";
import "./chunk-4YDOPHTZ.js";
import "./chunk-YY5PITIH.js";
import {
  r as r2,
  s as s2
} from "./chunk-SMWUT52Z.js";
import {
  _
} from "./chunk-AXZMNHTN.js";
import "./chunk-5T3MJDSR.js";
import "./chunk-NMQNUPE4.js";
import "./chunk-6KIXN4DJ.js";
import "./chunk-7DGJB37R.js";
import "./chunk-234CIOHE.js";
import "./chunk-V2H77UEV.js";
import {
  s
} from "./chunk-WRA2WBYC.js";
import "./chunk-XWE6BM2U.js";
import {
  r
} from "./chunk-SOIZOFSB.js";
import {
  a as a3
} from "./chunk-XXLHAM2M.js";
import {
  m
} from "./chunk-5EI5H4QX.js";
import {
  a,
  a2
} from "./chunk-ZIE53VIV.js";
import {
  __decorate
} from "./chunk-SS5CLIUY.js";
import "./chunk-R54Q5TGA.js";
import "./chunk-6SSZNBOK.js";
import "./chunk-LZ2XTYP2.js";
import "./chunk-45CFSCQX.js";
import "./chunk-A5XN2VFT.js";
import "./chunk-65HD3WXL.js";
import "./chunk-4DGC7CBY.js";
import {
  o2 as o
} from "./chunk-GNMPGHLQ.js";
import "./chunk-QY7XKUIV.js";
import {
  h
} from "./chunk-AL6YUTZM.js";
import "./chunk-G26ADAPQ.js";

// node_modules/@arcgis/core/analysis/Viewshed.js
var u = class extends a3(f) {
  constructor(e2) {
    super(e2), this.observer = null, this.farDistance = 1e3, this.heading = 0, this.tilt = 90, this.horizontalFieldOfView = 45, this.verticalFieldOfView = 45, this.feature = null;
  }
  get valid() {
    return null != this.observer && this.farDistance > 0;
  }
  equals(e2) {
    return o(this.observer, e2.observer) && this.farDistance === e2.farDistance && this.heading === e2.heading && this.tilt === e2.tilt && this.horizontalFieldOfView === e2.horizontalFieldOfView && this.verticalFieldOfView === e2.verticalFieldOfView && c2(this.feature, e2.feature);
  }
};
__decorate([m({ type: _, json: { write: { isRequired: true } } })], u.prototype, "observer", void 0), __decorate([m({ type: Number, nonNullable: true, range: { min: 0 }, json: { write: { isRequired: true } } })], u.prototype, "farDistance", void 0), __decorate([m({ type: Number, nonNullable: true, json: { write: { isRequired: true } } }), s((e2) => a4.normalize(a(e2), void 0, true))], u.prototype, "heading", void 0), __decorate([m({ type: Number, nonNullable: true, range: { min: 0, max: 180 }, json: { write: { isRequired: true } } })], u.prototype, "tilt", void 0), __decorate([m({ type: Number, nonNullable: true, range: { min: 0, max: 360 }, json: { write: { isRequired: true } } })], u.prototype, "horizontalFieldOfView", void 0), __decorate([m({ type: Number, nonNullable: true, range: { min: 0, max: 180 }, json: { write: { isRequired: true } } })], u.prototype, "verticalFieldOfView", void 0), __decorate([m(d)], u.prototype, "feature", void 0), __decorate([m({ readOnly: true, json: { read: false } })], u.prototype, "valid", null), u = __decorate([a2("esri.analysis.Viewshed")], u);

// node_modules/@arcgis/core/analysis/ViewshedAnalysis.js
var v = O.ofType(u);
var y = class extends c {
  constructor(e2) {
    super(e2), this.type = "viewshed", this._extent = null;
  }
  initialize() {
    this.addHandles(l(() => this._computeExtent(), (e2) => {
      null == e2.pending && (this._extent = e2.extent);
    }, w));
  }
  get viewsheds() {
    return this._get("viewsheds") || new v();
  }
  set viewsheds(e2) {
    this._set("viewsheds", n(e2, this.viewsheds, v));
  }
  get spatialReference() {
    for (const e2 of this.viewsheds) if (null != e2.observer) return e2.observer.spatialReference;
    return null;
  }
  get extent() {
    return this._extent;
  }
  get valid() {
    return this.viewsheds.every((e2) => e2.valid);
  }
  async waitComputeExtent() {
    const e2 = this._computeExtent();
    null != e2.pending && await e2.pending;
  }
  _computeExtent() {
    const { spatialReference: e2 } = this;
    if (null == e2) return { pending: null, extent: null };
    const t = this.viewsheds.filter((e3) => null != e3.observer), r3 = t.map((e3) => e3.observer).toArray(), s3 = Y(r3, e2);
    if (null != s3.pending) return { pending: s3.pending, extent: null };
    return { pending: null, extent: s3.geometries.map((e3, r4) => {
      const s4 = t.at(r4);
      return null != e3 && null != s4 ? this._computeViewshedExtent(this.viewsheds.at(r4), e3) : null;
    }).filter((e3) => null != e3).reduce((e3, t2) => x(e3, t2), null) };
  }
  _computeViewshedExtent(e2, t) {
    const { farDistance: r3, heading: s3, tilt: n2, horizontalFieldOfView: i, verticalFieldOfView: o2 } = e2, { spatialReference: u3 } = t, c3 = i / 2, m2 = o2 / 2, h2 = r3 / u3.metersPerUnit, f2 = [a4.normalize(s3 - c3), s3, a4.normalize(s3 + c3)], v2 = z.fromPoint(t), y3 = (e3) => {
      const t2 = f2.map((t3) => a4.normalize(t3 - e3));
      if (t2[0] > t2[2] || 360 === i) return h2;
      const r4 = t2.map((e4) => Math.abs(e4 > 180 ? 360 - e4 : e4)).reduce((e4, t3) => e4 > t3 ? t3 : e4);
      return r4 > 90 ? 0 : h2 * Math.cos(s2(r4));
    };
    v2.xmax += y3(90), v2.xmin -= y3(-90), v2.ymax += y3(0), v2.ymin -= y3(180);
    const x2 = t.z;
    if (null != x2) {
      let e3 = x2, t2 = x2;
      const s4 = n2 - 90, i2 = r2(s4 + m2, -90, 90), o3 = r2(s4 - m2, -90, 90), l3 = u3?.isGeographic ? r3 : h2;
      e3 += l3 * g(i2), t2 += l3 * g(o3);
      const a5 = w2(m2) * l3, d2 = g(s4) * a5 * (1 - w2(c3));
      n2 < 90 && (e3 -= d2), n2 > 90 && (t2 -= d2), v2.zmax = Math.max(e3, x2), v2.zmin = Math.min(t2, x2);
    }
    return v2;
  }
  equals(e2) {
    return this === e2 || super.equals(e2) && h(this.viewsheds.toArray(), e2.viewsheds.toArray(), (e3, t) => e3.equals(t));
  }
  clear() {
    this.viewsheds.removeAll();
  }
};
function x(e2, t) {
  return null == e2 ? t : null == t ? e2 : e2.union(t);
}
function w2(e2) {
  return Math.cos(s2(e2));
}
function g(e2) {
  return Math.sin(s2(e2));
}
__decorate([m({ type: ["viewshed"] })], y.prototype, "type", void 0), __decorate([m({ cast: e, type: v, nonNullable: true })], y.prototype, "viewsheds", null), __decorate([m({ readOnly: true })], y.prototype, "spatialReference", null), __decorate([m()], y.prototype, "_extent", void 0), __decorate([m()], y.prototype, "extent", null), __decorate([m({ readOnly: true })], y.prototype, "valid", null), y = __decorate([a2("esri.analysis.ViewshedAnalysis")], y);

// node_modules/@arcgis/core/layers/ViewshedLayer.js
var y2 = class extends b(l2(b2)) {
  constructor(e2) {
    super(e2), this.type = "viewshed", this.operationalLayerType = "ViewshedLayer", this.source = new y(), this.opacity = 1;
  }
  initialize() {
    this.addHandles(l(() => this.source, (e2, r3) => {
      null != r3 && r3.parent === this && (r3.parent = null), null != e2 && (e2.parent = this);
    }, w));
  }
  async load() {
    return this.addResolvingPromise(this.source.waitComputeExtent()), this;
  }
  get spatialReference() {
    return this.source.spatialReference;
  }
  get fullExtent() {
    return this.source.extent;
  }
  releaseAnalysis(e2) {
    this.source === e2 && (this.source = new y());
  }
  get analysis() {
    return this.source;
  }
  set analysis(e2) {
    this.source = e2;
  }
  get viewsheds() {
    return this.source.viewsheds;
  }
  set viewsheds(e2) {
    this.source.viewsheds = e2;
  }
  writeViewsheds(e2, r3, s3, t) {
    r3.viewsheds = e2.filter((e3) => e3.valid).toJSON(t);
  }
};
__decorate([m({ json: { read: false }, readOnly: true })], y2.prototype, "type", void 0), __decorate([m({ type: ["ViewshedLayer"] })], y2.prototype, "operationalLayerType", void 0), __decorate([m({ type: y, nonNullable: true })], y2.prototype, "source", void 0), __decorate([m({ readOnly: true })], y2.prototype, "spatialReference", null), __decorate([m({ readOnly: true })], y2.prototype, "fullExtent", null), __decorate([m({ readOnly: true, json: { read: false, write: false, origins: { service: { read: false, write: false }, "portal-item": { read: false, write: false }, "web-document": { read: false, write: false } } } })], y2.prototype, "opacity", void 0), __decorate([m({ type: ["show", "hide"] })], y2.prototype, "listMode", void 0), __decorate([m({ type: O.ofType(u), json: { write: { ignoreOrigin: true }, origins: { "web-scene": { write: { ignoreOrigin: true } } } } })], y2.prototype, "viewsheds", null), __decorate([r("web-scene", "viewsheds")], y2.prototype, "writeViewsheds", null), y2 = __decorate([a2("esri.layers.ViewshedLayer")], y2);
var u2 = y2;
export {
  u2 as default
};
//# sourceMappingURL=ViewshedLayer-2FD6XB2W.js.map
