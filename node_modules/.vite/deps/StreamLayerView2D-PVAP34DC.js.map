{
  "version": 3,
  "sources": ["../../@arcgis/core/views/layers/StreamLayerView.js", "../../@arcgis/core/views/2d/layers/StreamLayerView2D.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as s}from\"tslib\";import{property as e}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import o from\"../../layers/support/FeatureFilter.js\";const r=r=>{const i=r;let n=class extends i{resume(){this._isUserPaused=!1,this.suspended||this._doResume()}pause(){this._isUserPaused=!0,this.suspended||this._doPause()}disconnect(){this._doDisconnect()}connect(){this._doConnect()}clear(){this._doClear()}constructor(...s){super(...s),this._isUserPaused=!1,this.filter=null}get connectionStatus(){return(this._isUserPaused||this.suspended)&&\"connected\"===this._streamConnectionStatus?\"paused\":this._streamConnectionStatus}_onSuspendedChange(s){s?this._doPause():this._isUserPaused||this._doResume()}};return s([e()],n.prototype,\"_isUserPaused\",void 0),s([e({readOnly:!0})],n.prototype,\"connectionStatus\",null),s([e({type:o})],n.prototype,\"filter\",void 0),n=s([t(\"esri.views.layers.StreamLayerView\")],n),n};export{r as StreamLayerView};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import r from\"../../../core/Error.js\";import{handlesGroup as t,makeHandle as s}from\"../../../core/handleUtils.js\";import{watch as n}from\"../../../core/reactiveUtils.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import a from\"../../../rest/support/FeatureSet.js\";import{isNumber as c}from\"../../../support/guards.js\";import l from\"./FeatureLayerView2D.js\";import{handleNoEngineError as h}from\"./support/handleNoEngineError.js\";import{StreamLayerView as p}from\"../../layers/StreamLayerView.js\";let u=class extends(p(l)){constructor(){super(...arguments),this.pipelineConnectionStatus=\"disconnected\",this.pipelineErrorString=null}initialize(){this.addHandles([n(()=>this.layer.customParameters,async e=>{(await this.getWorker()).streamMessenger.updateCustomParameters(e)}),this.layer.on(\"send-message-to-socket\",async e=>{(await this.getWorker()).streamMessenger.sendMessageToSocket(e)}),this.layer.on(\"send-message-to-client\",async e=>{(await this.getWorker()).streamMessenger.sendMessageToClient(e),this._isUserPaused&&\"type\"in e&&\"clear\"===e.type&&this.incrementSourceRefreshVersion()}),n(()=>this.layer.purgeOptions,()=>this._update()),n(()=>this.suspended,this._onSuspendedChange.bind(this))],\"constructor\"),this._doResume()}destroy(){this._doPause()}get connectionError(){return this.pipelineErrorString?new r(\"stream-controller\",this.pipelineErrorString):null}on(e,r){if(Array.isArray(e))return t(e.map(e=>this.on(e,r)));const n=[\"data-received\",\"message-received\"].includes(e);n&&this.getWorker().then(r=>r.streamMessenger.enableEvent(e,!0));const o=super.on(e,r),i=this;return s(()=>{o.remove(),n&&(i._workerProxy.closed||i.hasEventListener(e)||i.getWorker().then(r=>r.streamMessenger.enableEvent(e,!1)))})}async queryLatestObservations(e,t){if(!(this.layer.timeInfo?.endField||this.layer.timeInfo?.startField||this.layer.timeInfo?.trackIdField))throw new r(\"streamlayer-no-timeField\",\"queryLatestObservation can only be used with services that define a TrackIdField\");const s=await this.getWorker();return h(s.features.executeQueryForLatestObservations(this._cleanUpQuery(e),t).then(e=>{const r=a.fromJSON(e);return r.features.forEach(e=>{e.layer=this.layer,e.sourceLayer=this.layer,e.origin=this.layer.graphicOrigin}),r}),new a({features:[]}))}detach(){super.detach(),this.pipelineConnectionStatus=\"disconnected\"}async queryObjectIds(e,r){return(await super.queryObjectIds(e,r)).filter(c)}get _streamConnectionStatus(){return this.pipelineConnectionStatus}_doPause(){null!=this._refreshInterval&&(clearInterval(this._refreshInterval),this._refreshInterval=null)}_doResume(){null==this._refreshInterval&&(this._refreshInterval=setInterval(()=>this.incrementSourceRefreshVersion(),this.layer.updateInterval))}_doDisconnect(){this.getWorker().then(e=>e.streamMessenger.disconnect()),this._doPause()}_doConnect(){this.getWorker().then(e=>e.streamMessenger.connect()),this.resume()}_doClear(){this.getWorker().then(e=>e.streamMessenger.clear()),null==this._refreshInterval&&this.incrementSourceRefreshVersion()}_createClientOptions(){const e=super._createClientOptions(),r=this;return{...e,get container(){return r.featureContainer},setProperty:e=>{this.set(e.propertyName,e.value)}}}};e([o()],u.prototype,\"pipelineConnectionStatus\",void 0),e([o()],u.prototype,\"pipelineErrorString\",void 0),e([o({readOnly:!0})],u.prototype,\"connectionError\",null),e([o({readOnly:!0})],u.prototype,\"_streamConnectionStatus\",null),u=e([i(\"esri.views.2d.layers.StreamLayerView2D\")],u);const d=u;export{d as default};\n"],
  "mappings": "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",
  "names": ["r", "n", "s", "e", "r", "n", "t", "s", "d"]
}
