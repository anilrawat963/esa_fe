import {
  n
} from "./chunk-BCL23HLU.js";
import "./chunk-H6PLTW7B.js";
import {
  i as i2
} from "./chunk-ZG2JXORT.js";
import "./chunk-OL6EYE44.js";
import {
  d
} from "./chunk-36YQJD5W.js";
import "./chunk-BQ6DEXWK.js";
import {
  f,
  l as l2
} from "./chunk-3SCRAN3E.js";
import {
  l,
  t,
  u as u2
} from "./chunk-UNJMLSLI.js";
import "./chunk-NTNXXNRP.js";
import "./chunk-GD72EK2J.js";
import "./chunk-ALKEERWI.js";
import "./chunk-U6CJFTOF.js";
import {
  u
} from "./chunk-2U5X5TIX.js";
import "./chunk-2JMKFI2D.js";
import "./chunk-QYAMBIRP.js";
import "./chunk-JHV6OBEB.js";
import "./chunk-ZVTEFYZX.js";
import "./chunk-LPUPM55U.js";
import "./chunk-4VQDBNTM.js";
import "./chunk-3BNOOWTA.js";
import "./chunk-AIJLLSRB.js";
import "./chunk-VX2NEBRT.js";
import "./chunk-7HTU7ZUX.js";
import "./chunk-WDTGOP77.js";
import {
  w
} from "./chunk-VYMBX5H5.js";
import "./chunk-647DAMHU.js";
import "./chunk-O6G3PPOK.js";
import "./chunk-ZKNZTIAS.js";
import "./chunk-OJMISN3F.js";
import "./chunk-EFV6H5NA.js";
import {
  L
} from "./chunk-6VL5D5UP.js";
import "./chunk-6QHY54HZ.js";
import "./chunk-GXJJY3ND.js";
import "./chunk-5ONGWFJ3.js";
import "./chunk-PLNHHGHL.js";
import "./chunk-BBYMM7CM.js";
import "./chunk-EM7Y2JZC.js";
import "./chunk-QZQPB5XR.js";
import "./chunk-AQFRVV3U.js";
import "./chunk-XTZAIV4X.js";
import "./chunk-63LDVRFI.js";
import "./chunk-PMGS7UDU.js";
import "./chunk-K2OZ6WVC.js";
import "./chunk-TF6255HN.js";
import "./chunk-GD4FJL3C.js";
import {
  W,
  b as b2
} from "./chunk-2LC2762W.js";
import "./chunk-W6HOAVT4.js";
import "./chunk-DTZUXJMD.js";
import "./chunk-YLAGKT2D.js";
import "./chunk-6YRQYUCY.js";
import "./chunk-MHV23XAQ.js";
import "./chunk-LPZUGJNG.js";
import "./chunk-XLOINTMG.js";
import "./chunk-T7F6Q6JJ.js";
import "./chunk-75XOUSSS.js";
import "./chunk-TH4EQWJJ.js";
import "./chunk-3FUHCAX3.js";
import "./chunk-PZ5RULLK.js";
import "./chunk-OPJX4KXH.js";
import "./chunk-LTPHDYPK.js";
import "./chunk-3OVERDFX.js";
import "./chunk-FPMLKIDB.js";
import "./chunk-AZXJIEZ6.js";
import "./chunk-Q75WYS7K.js";
import "./chunk-H74Q4SYB.js";
import "./chunk-2OFHDVO5.js";
import "./chunk-DDOCCRD4.js";
import "./chunk-THQO67BJ.js";
import "./chunk-4YDOPHTZ.js";
import "./chunk-YY5PITIH.js";
import "./chunk-CSMCPN64.js";
import "./chunk-7H3U4IJR.js";
import {
  s
} from "./chunk-SMWUT52Z.js";
import "./chunk-AXZMNHTN.js";
import "./chunk-5T3MJDSR.js";
import {
  N2 as N
} from "./chunk-NMQNUPE4.js";
import "./chunk-6KIXN4DJ.js";
import "./chunk-7DGJB37R.js";
import "./chunk-234CIOHE.js";
import "./chunk-V2H77UEV.js";
import "./chunk-WRA2WBYC.js";
import "./chunk-XWE6BM2U.js";
import "./chunk-SOIZOFSB.js";
import "./chunk-XXLHAM2M.js";
import {
  b,
  m
} from "./chunk-5EI5H4QX.js";
import {
  a2 as a
} from "./chunk-ZIE53VIV.js";
import {
  __decorate
} from "./chunk-SS5CLIUY.js";
import "./chunk-R54Q5TGA.js";
import "./chunk-6SSZNBOK.js";
import "./chunk-LZ2XTYP2.js";
import "./chunk-45CFSCQX.js";
import "./chunk-A5XN2VFT.js";
import "./chunk-65HD3WXL.js";
import "./chunk-4DGC7CBY.js";
import "./chunk-GNMPGHLQ.js";
import {
  i3 as i
} from "./chunk-QY7XKUIV.js";
import "./chunk-AL6YUTZM.js";
import "./chunk-G26ADAPQ.js";

// node_modules/@arcgis/core/views/interactive/snapping/GridSnappingEngine.js
var w2 = class extends b {
  constructor(t2) {
    super(t2), this.options = null;
  }
  destroy() {
    this._set("options", null);
  }
  get grid() {
    return this.view.grid;
  }
  get effectiveViewRotation() {
    return this.grid?.rotateWithMap ? 0 : s(this.view.rotation ?? 0);
  }
  get gridRotation() {
    return s(this.grid?.rotation ?? 0);
  }
  get gridCenter() {
    const { spatialReference: t2, grid: e } = this;
    if (!e || !t2 || !b2(e.center.spatialReference, t2)) return null;
    try {
      const r = W(e.center, t2), i3 = t2.isWrappable && null != this.view?.center ? L(r.x, this.view.center.x, t2) : r.x;
      return l2(i3, r.y, r.z);
    } catch (i3) {
      return i.getLogger(this).errorOnce("Grid Snapping - Failed to project grid center.", i3), null;
    }
  }
  get offsetScaleFactor() {
    const { pixelsPerStride: t2, grid: e } = this;
    if (!e || !t2) return 1;
    const { majorLineInterval: r, dynamicScaling: i3 } = e;
    return r < 1 ? null : l(r, t2, i3);
  }
  get spatialReference() {
    return this.view.spatialReference;
  }
  get gridMetersPerStride() {
    const { grid: t2 } = this;
    return t2 ? N(t2.spacing, t2.units, "meters") : null;
  }
  get viewMetersPerPixel() {
    const { viewMetersPerSRUnit: t2 } = this;
    return null == t2 ? null : t2 * u(this.view.scale, this.view.spatialReference);
  }
  get viewMetersPerSRUnit() {
    const { spatialReference: t2 } = this.view;
    return this.gridCenter ? u2(this.gridCenter[0], this.gridCenter[1], t2) : null;
  }
  get pixelsPerStride() {
    const { gridMetersPerStride: t2, viewMetersPerPixel: e } = this;
    return e && t2 ? t2 / e : null;
  }
  get updating() {
    return null != this.grid && null != this.spatialReference && null == this.viewMetersPerSRUnit;
  }
  async fetchCandidates(t2, e, r) {
    const { options: i3, view: n2 } = this;
    if (!i3?.effectiveGridEnabled || !n2.grid || r.feature?.attributes && d in r.feature.attributes) return [];
    const o = r.coordinateHelper.arrayToPoint(t2), s2 = i3.distance * ("touch" === r.pointer ? i3.touchSensitivityMultiplier : 1);
    return this.fetchCandidatesSync(o, s2);
  }
  fetchCandidatesSync(t2, e) {
    const r = [], { grid: i3, effectiveViewRotation: n2, gridRotation: o, gridCenter: s2, viewMetersPerPixel: a2, viewMetersPerSRUnit: c, offsetScaleFactor: u3, spatialReference: g, gridMetersPerStride: f2, pixelsPerStride: m2 } = this;
    if (!(i3 && a2 && c && s2 && g && u3 && f2 && m2)) return r;
    if (!i3.dynamicScaling && m2 < t) return r;
    if (!b2(t2.spatialReference, g)) return r;
    const S = W(t2, g), w3 = l2(S.x, S.y, S.z), x = P(w3, -o, s2, -n2), C = f2 / c * u3, U = R(x, C, s2), { shouldSnapX: b3, shouldSnapY: L2 } = j(U, x, e, a2, c);
    if (!b3 && !L2) return [];
    const z = l2((b3 ? U : x)[0], (L2 ? U : x)[1]), E = P(z, o, s2, n2), F = P(U, o, s2, n2);
    if (L2) {
      const t3 = M(U, x, C, "y"), e2 = P(t3, o, s2, n2);
      r.push(new i2({ lineStart: F, lineEnd: e2, targetPoint: E, isDraped: false }));
    }
    if (b3) {
      const t3 = M(U, x, C, "x"), e2 = P(t3, o, s2, n2);
      r.push(new i2({ lineStart: F, lineEnd: e2, targetPoint: E, isDraped: false }));
    }
    return b3 && L2 && r.push(new n(E, r[0], r[1], false)), r;
  }
};
__decorate([m({ constructOnly: true })], w2.prototype, "view", void 0), __decorate([m()], w2.prototype, "options", void 0), __decorate([m()], w2.prototype, "grid", null), __decorate([m()], w2.prototype, "effectiveViewRotation", null), __decorate([m()], w2.prototype, "gridRotation", null), __decorate([m()], w2.prototype, "gridCenter", null), __decorate([m()], w2.prototype, "offsetScaleFactor", null), __decorate([m()], w2.prototype, "spatialReference", null), __decorate([m()], w2.prototype, "gridMetersPerStride", null), __decorate([m()], w2.prototype, "viewMetersPerPixel", null), __decorate([m()], w2.prototype, "viewMetersPerSRUnit", null), __decorate([m()], w2.prototype, "pixelsPerStride", null), __decorate([m()], w2.prototype, "updating", null), w2 = __decorate([a("esri.views.interactive.snapping.GridSnappingEngine")], w2);
var P = (t2, e, r, i3) => {
  const n2 = f(t2[0], t2[1], t2[2]);
  return w(n2, w(n2, n2, r, e), r, i3);
};
var R = (t2, e, r) => {
  const i3 = (t2[0] - r[0]) / e, n2 = (t2[1] - r[1]) / e, o = Math.trunc(i3), s2 = Math.trunc(n2), a2 = Math.round(i3 % 1), p = Math.round(n2 % 1), l3 = r[0] + (o + a2) * e, c = r[1] + (s2 + p) * e;
  return l2(l3, c);
};
var j = (t2, e, r, i3, n2) => {
  if (i3 <= 0) return { shouldSnapX: false, shouldSnapY: false };
  const o = (t2[0] - e[0]) / i3, s2 = (t2[1] - e[1]) / i3;
  return { shouldSnapX: Math.abs(o * n2) < r, shouldSnapY: Math.abs(s2 * n2) < r };
};
var M = (t2, e, r, i3) => {
  if ("y" === i3) {
    const i4 = e[0] > t2[0] ? 1 : -1;
    return l2(t2[0] + r * i4, t2[1]);
  }
  const n2 = e[1] > t2[1] ? 1 : -1;
  return l2(t2[0], t2[1] + r * n2);
};
export {
  w2 as GridSnappingEngine
};
//# sourceMappingURL=GridSnappingEngine-QLMSZ377.js.map
