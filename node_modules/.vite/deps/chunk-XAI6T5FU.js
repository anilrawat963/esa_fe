import {
  v
} from "./chunk-GD4FJL3C.js";
import {
  A
} from "./chunk-NMQNUPE4.js";

// node_modules/@arcgis/core/rest/query/operations/queryUtils.js
function i(e, t) {
  if (t && "extent" === e.type) return `${e.xmin},${e.ymin},${e.xmax},${e.ymax}`;
  if (t && "point" === e.type) return `${e.x},${e.y}`;
  const i2 = e.toJSON();
  return delete i2.spatialReference, JSON.stringify(i2);
}
function r(r2, n, a) {
  const { geometry: l } = r2, s = r2.compactGeometryEnabled ?? false, o = r2.toJSON();
  delete o.compactGeometryEnabled, delete o.defaultSpatialReferenceEnabled;
  const u = o;
  let d, c, y;
  if (l && (c = l.spatialReference, y = A(c), u.geometryType = v(l), u.geometry = i(l, s), u.inSR = y), o.groupByFieldsForStatistics && (u.groupByFieldsForStatistics = o.groupByFieldsForStatistics.join(",")), o.objectIds) switch (a?.uniqueIdFields?.length) {
    case void 0:
      u.objectIds = o.objectIds.join(",");
      break;
    case 1:
      u.uniqueIds = JSON.stringify(o.objectIds), delete u.objectIds;
      break;
    default:
      u.uniqueIds = JSON.stringify(o.objectIds.map((e) => JSON.parse(e))), delete u.objectIds;
  }
  if (o.orderByFields && (u.orderByFields = o.orderByFields.join(",")), !o.outFields || !o.returnDistinctValues && (n?.returnCountOnly || n?.returnExtentOnly || n?.returnIdsOnly) ? delete u.outFields : o.outFields.includes("*") ? u.outFields = "*" : u.outFields = o.outFields.join(","), o.outSR ? (u.outSR = A(o.outSR), d = r2.outSpatialReference) : l && (o.returnGeometry || o.returnCentroid) && (u.outSR = u.inSR, d = c), o.returnGeometry && delete o.returnGeometry, o.outStatistics && (u.outStatistics = JSON.stringify(o.outStatistics)), o.fullText && (u.fullText = JSON.stringify(o.fullText)), o.pixelSize && (u.pixelSize = JSON.stringify(o.pixelSize)), o.quantizationParameters && (r2.defaultSpatialReferenceEnabled && null != c && null != r2.quantizationParameters?.extent && c.equals(r2.quantizationParameters.extent.spatialReference) && delete o.quantizationParameters.extent.spatialReference, u.quantizationParameters = JSON.stringify(o.quantizationParameters)), o.parameterValues && (u.parameterValues = JSON.stringify(o.parameterValues)), o.rangeValues && (u.rangeValues = JSON.stringify(o.rangeValues)), o.dynamicDataSource && (u.layer = JSON.stringify({ source: o.dynamicDataSource }), delete o.dynamicDataSource), o.timeExtent) {
    const e = o.timeExtent, { start: t, end: i2 } = e;
    null == t && null == i2 || (u.time = t === i2 ? t : `${t ?? "null"},${i2 ?? "null"}`), delete o.timeExtent;
  }
  return r2.defaultSpatialReferenceEnabled && null != c && null != d && c.equals(d) && (u.defaultSR = u.inSR, delete u.inSR, delete u.outSR), u;
}

export {
  r
};
//# sourceMappingURL=chunk-XAI6T5FU.js.map
