{
  "version": 3,
  "sources": ["../../@arcgis/core/symbols/support/previewCIMSymbol.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{pt2px as e,px2pt as t}from\"../../core/screenUtils.js\";import{CIMSymbolHelper as i}from\"../cim/CIMSymbolHelper.js\";import{CIMSymbolRasterizer as o}from\"../cim/CIMSymbolRasterizer.js\";import{OverrideHelper as l}from\"../cim/OverrideHelper.js\";import{mapCIMSymbolToGeometryType as r}from\"../cim/utils.js\";import{renderSymbol as n}from\"./renderUtils.js\";const a=new o(null),s=t(22),m=t(120),h=t(50),c=1;async function y(e,t,i){const o=t?.size;let l=null!=o&&\"object\"==typeof o&&\"width\"in o?o.width:o,r=null!=o&&\"object\"==typeof o&&\"height\"in o?o.height:o;if(!l||!r)if(\"esriGeometryPolygon\"===i)l=r=t.maxSize?Math.min(t.maxSize,s):s;else{const o=await g(e,t,i);o&&(l=o.width,r=o.height),\"esriGeometryPolyline\"===i&&(l=t.maxSize?Math.min(t.maxSize,h):h),l=null!=l&&isFinite(l)?Math.min(l,m):s,r=null!=r&&isFinite(r)?Math.max(Math.min(r,m),c):s}return\"legend\"===t.style&&\"esriGeometryPolyline\"===i&&(l=h),{width:l,height:r}}async function g(e,t={},o){const n=t.cimOptions||t;o??=n.geometryType||r(e?.data?.symbol);const{feature:s,fieldMap:m,viewParams:h}=n,c=await l.resolveSymbolOverrides(e.data,s,null,m,o,null,h);if(!c)return null;(e=e.clone()).data={type:\"CIMSymbolReference\",symbol:c},e.data.primitiveOverrides=void 0;const y=[];return i.fetchResources(c,a.resourceManager,y),i.fetchFonts(c,a.resourceManager,y),y.length>0&&await Promise.all(y),i.getEnvelope(c,null,a.resourceManager)}async function u(i,o={}){const{node:l,opacity:s,symbolConfig:m}=o,h=null!=m&&\"object\"==typeof m&&\"isSquareFill\"in m&&m.isSquareFill,c=o.cimOptions||o,g=c.geometryType||r(i?.data?.symbol),u=await y(i,o,g),{feature:d,fieldMap:f}=c,p=o?.geometry||h||\"esriGeometryPolygon\"!==g?\"preview\":\"legend\";let w=u;const b=u;if(o?.geometry&&(\"esriGeometryPolygon\"===g||\"esriGeometryPolyline\"===g)){const i=200;if(e(u.width)<i||e(u.height)<i){const e=u.width>u.height?t(i)*u.height/u.width:t(i);w={width:u.width>u.height?t(i):t(i)*u.width/u.height,height:e}}}const M=await a.rasterizeCIMSymbolAsync(i,d,w,p,f,g,null,c.viewParams,c.allowScalingUp,o?.geometry?.toJSON());if(!M)return null;const{width:S,height:v}=M,j=document.createElement(\"canvas\");j.width=S,j.height=v;j.getContext(\"2d\").putImageData(M,0,0);const P=e(b.width),x=e(b.height),z=new Image(P,x);z.src=j.toDataURL(),z.ariaLabel=o.ariaLabel??null,z.alt=o.ariaLabel??\"\",null!=s&&(z.style.opacity=`${s}`);let C=z;if(o.cssEffectFilter){const e={shape:{type:\"image\",x:0,y:0,width:P,height:x,src:z.src},fill:null,stroke:null,offset:[0,0]};C=n([[e]],[P,x],o)}return l&&C&&l.appendChild(C),C}export{g as getCIMSymbolPreviewSize,u as previewCIMSymbol};\n"],
  "mappings": "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",
  "names": ["e", "l", "o", "g", "s", "m", "h", "c", "y", "u", "i", "v"]
}
