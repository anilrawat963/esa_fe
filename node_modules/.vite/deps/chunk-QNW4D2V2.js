import {
  r
} from "./chunk-XAI6T5FU.js";
import {
  t as t3
} from "./chunk-QNDHLVDC.js";
import {
  t
} from "./chunk-ZT4KW2M5.js";
import {
  t as t2
} from "./chunk-FHQNDU7E.js";
import {
  P
} from "./chunk-6VL5D5UP.js";
import {
  H2 as H,
  I,
  V
} from "./chunk-V2H77UEV.js";

// node_modules/@arcgis/core/rest/query/operations/query.js
var a = "Layer does not support extent calculation.";
function l(t4, r2, n) {
  return r(t4, r2, n);
}
async function y(t4, r2, n, e, o) {
  const u = r2.timeExtent?.isEmpty ? { data: { features: [] } } : await j(t4, r2, "json", e, void 0, o);
  return t3(r2, n, u.data), u;
}
async function f(t4, r2, n, e, o) {
  if (r2.timeExtent?.isEmpty) return { data: n.createFeatureResult() };
  const s = await c(t4, r2, e, o), i = s;
  return i.data = t2(s.data, n), i;
}
function c(t4, r2, n, e) {
  return j(t4, r2, "pbf", n, void 0, e);
}
function m(t4, r2, n, e) {
  return r2.timeExtent?.isEmpty ? Promise.resolve({ data: { objectIds: [] } }) : j(t4, r2, "json", n, { returnIdsOnly: true }, e);
}
function p(t4, r2, n, e) {
  return r2.timeExtent?.isEmpty ? Promise.resolve({ data: { count: 0 } }) : j(t4, r2, "json", n, { returnIdsOnly: true, returnCountOnly: true }, e);
}
async function d(t4, r2, n) {
  if (r2.timeExtent?.isEmpty) return { data: { count: 0, extent: null } };
  const e = await j(t4, r2, "json", n, { returnExtentOnly: true, returnCountOnly: true }), o = e.data;
  if (o.hasOwnProperty("extent")) return e;
  if (o.features) throw new Error(a);
  if (o.hasOwnProperty("count")) throw new Error(a);
  return e;
}
function O(t4, r2) {
  if (!t4.returnIdsOnly || !r2.uniqueIdFields) return t4;
  const n = { ...t4, returnUniqueIdsOnly: true };
  return delete n.returnIdsOnly, n;
}
async function j(u, s, i, a2 = {}, y2 = {}, f2 = {}) {
  const c2 = "string" == typeof u ? I(u) : u, m2 = s.geometry ? [s.geometry] : [], p2 = await P(m2, null, { signal: a2.signal }), d2 = p2?.[0];
  null != d2 && ((s = s.clone()).geometry = d2);
  const j2 = t({ ...c2.query, f: i, ...O(y2, f2), ...l(s, y2, f2) });
  return H(V(c2.path, E(s, y2) ? "query3d" : "query"), { ...a2, responseType: "pbf" === i ? "array-buffer" : "json", query: { ...j2, ...a2.query } });
}
function E(t4, r2) {
  return null != t4.formatOf3DObjects && !(r2.returnCountOnly || r2.returnExtentOnly || r2.returnIdsOnly);
}

export {
  y,
  f,
  c,
  m,
  p,
  d
};
//# sourceMappingURL=chunk-QNW4D2V2.js.map
