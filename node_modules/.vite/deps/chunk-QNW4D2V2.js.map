{
  "version": 3,
  "sources": ["../../@arcgis/core/rest/query/operations/query.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport t from\"../../../request.js\";import{urlToObject as r,join as n}from\"../../../core/urlUtils.js\";import{normalizeCentralMeridian as e}from\"../../../geometry/support/normalizeUtils.js\";import{mapParameters as o}from\"../../operations/urlUtils.js\";import{parsePBFFeatureQuery as u}from\"./pbfQueryUtils.js\";import{queryLikeToQueryStringParameters as s}from\"./queryUtils.js\";import{applyFeatureSetZUnitScaling as i}from\"./queryZScale.js\";const a=\"Layer does not support extent calculation.\";function l(t,r,n){return s(t,r,n)}async function y(t,r,n,e,o){const u=r.timeExtent?.isEmpty?{data:{features:[]}}:await j(t,r,\"json\",e,void 0,o);return i(r,n,u.data),u}async function f(t,r,n,e,o){if(r.timeExtent?.isEmpty)return{data:n.createFeatureResult()};const s=await c(t,r,e,o),i=s;return i.data=u(s.data,n),i}function c(t,r,n,e){return j(t,r,\"pbf\",n,void 0,e)}function m(t,r,n,e){return r.timeExtent?.isEmpty?Promise.resolve({data:{objectIds:[]}}):j(t,r,\"json\",n,{returnIdsOnly:!0},e)}function p(t,r,n,e){return r.timeExtent?.isEmpty?Promise.resolve({data:{count:0}}):j(t,r,\"json\",n,{returnIdsOnly:!0,returnCountOnly:!0},e)}async function d(t,r,n){if(r.timeExtent?.isEmpty)return{data:{count:0,extent:null}};const e=await j(t,r,\"json\",n,{returnExtentOnly:!0,returnCountOnly:!0}),o=e.data;if(o.hasOwnProperty(\"extent\"))return e;if(o.features)throw new Error(a);if(o.hasOwnProperty(\"count\"))throw new Error(a);return e}function O(t,r){if(!t.returnIdsOnly||!r.uniqueIdFields)return t;const n={...t,returnUniqueIdsOnly:!0};return delete n.returnIdsOnly,n}async function j(u,s,i,a={},y={},f={}){const c=\"string\"==typeof u?r(u):u,m=s.geometry?[s.geometry]:[],p=await e(m,null,{signal:a.signal}),d=p?.[0];null!=d&&((s=s.clone()).geometry=d);const j=o({...c.query,f:i,...O(y,f),...l(s,y,f)});return t(n(c.path,E(s,y)?\"query3d\":\"query\"),{...a,responseType:\"pbf\"===i?\"array-buffer\":\"json\",query:{...j,...a.query}})}function E(t,r){return null!=t.formatOf3DObjects&&!(r.returnCountOnly||r.returnExtentOnly||r.returnIdsOnly)}export{y as executeQuery,p as executeQueryForCount,d as executeQueryForExtent,m as executeQueryForIds,f as executeQueryPBF,c as executeQueryPBFBuffer,l as queryToQueryStringParameters,j as runQuery};\n"],
  "mappings": "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",
  "names": ["t", "r", "a", "y", "f", "c", "m", "p", "d", "j"]
}
