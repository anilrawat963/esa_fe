import {
  E as E2,
  I,
  S,
  _ as _2,
  o as o3,
  t as t4
} from "./chunk-BYU7VMB6.js";
import {
  L
} from "./chunk-BTFBYI67.js";
import {
  p as p8
} from "./chunk-URFJA5XM.js";
import {
  V,
  i as i5,
  ie,
  le,
  n as n7,
  r as r2
} from "./chunk-LH5BO2EF.js";
import {
  i as i4,
  p as p7
} from "./chunk-UOYGNM27.js";
import {
  a as a4,
  f as f5
} from "./chunk-QPBITBUR.js";
import {
  t as t3
} from "./chunk-7VJQTJLO.js";
import {
  F,
  l as l3
} from "./chunk-VVMIB6RA.js";
import {
  c,
  p as p4
} from "./chunk-SQ4OSZIG.js";
import {
  a as a3,
  l as l4,
  p as p3
} from "./chunk-ZEI5DZXH.js";
import {
  s as s5
} from "./chunk-RGWH5UES.js";
import {
  c as c2,
  p as p6
} from "./chunk-5D65KWSM.js";
import {
  a as a5
} from "./chunk-4FQUAV7M.js";
import {
  A,
  l as l6,
  n as n6
} from "./chunk-EVZ7KLPS.js";
import {
  f as f6,
  l as l5
} from "./chunk-JSH3APTG.js";
import {
  u as u5
} from "./chunk-WQT2KLDB.js";
import {
  d
} from "./chunk-UVDECGZC.js";
import {
  o as o2,
  s as s4
} from "./chunk-VKFTCFFM.js";
import {
  f as f2
} from "./chunk-TCDV4P3G.js";
import {
  d as d2,
  j,
  l as l7,
  v,
  w
} from "./chunk-CZOYDK6P.js";
import {
  m as m3
} from "./chunk-RS755KXS.js";
import {
  p as p5
} from "./chunk-UOYGMZIS.js";
import {
  l
} from "./chunk-NP2TBOXH.js";
import {
  g as g2
} from "./chunk-HCTBVF3W.js";
import {
  u as u3
} from "./chunk-DUZAVZR4.js";
import {
  f as f4
} from "./chunk-5DFXT3PU.js";
import {
  W as W2
} from "./chunk-3VXANCFN.js";
import {
  s as s3,
  t as t2
} from "./chunk-G5IXTUNN.js";
import {
  ut
} from "./chunk-XX3OKYJS.js";
import {
  s as s2
} from "./chunk-JGA5YJWL.js";
import {
  e as e2
} from "./chunk-GCI4MA3M.js";
import {
  E
} from "./chunk-2D47RURG.js";
import {
  b as b2
} from "./chunk-647DAMHU.js";
import {
  P as P2
} from "./chunk-6VL5D5UP.js";
import {
  m as m2
} from "./chunk-QZQPB5XR.js";
import {
  l as l2,
  n as n2,
  p as p2
} from "./chunk-PEL3D3ZN.js";
import {
  t
} from "./chunk-W5S3VUFT.js";
import {
  n as n3
} from "./chunk-C3FRY5U4.js";
import {
  n2 as n4,
  q
} from "./chunk-JNJX34GB.js";
import {
  n as n5
} from "./chunk-23NJHA5Q.js";
import {
  y as y2
} from "./chunk-PMGS7UDU.js";
import {
  F as F2,
  y2 as y3
} from "./chunk-MC6NAKKX.js";
import {
  u as u2
} from "./chunk-TF6255HN.js";
import {
  f as f3
} from "./chunk-GD4FJL3C.js";
import {
  i as i3
} from "./chunk-C5OQVQZF.js";
import {
  g
} from "./chunk-LTULADK2.js";
import {
  p
} from "./chunk-CNYNCKEV.js";
import {
  N as N2,
  W
} from "./chunk-2LC2762W.js";
import {
  b as b3
} from "./chunk-P6IKJIMO.js";
import {
  P,
  y3 as y
} from "./chunk-PZ5RULLK.js";
import {
  z
} from "./chunk-H74Q4SYB.js";
import {
  u as u4
} from "./chunk-CCQFL76O.js";
import {
  _
} from "./chunk-AXZMNHTN.js";
import {
  f
} from "./chunk-5T3MJDSR.js";
import {
  N
} from "./chunk-NMQNUPE4.js";
import {
  n
} from "./chunk-234CIOHE.js";
import {
  H2 as H
} from "./chunk-V2H77UEV.js";
import {
  r
} from "./chunk-SOIZOFSB.js";
import {
  b,
  m
} from "./chunk-5EI5H4QX.js";
import {
  a2
} from "./chunk-ZIE53VIV.js";
import {
  __decorate
} from "./chunk-SS5CLIUY.js";
import {
  i as i2
} from "./chunk-65HD3WXL.js";
import {
  e
} from "./chunk-4DGC7CBY.js";
import {
  u3 as u
} from "./chunk-GNMPGHLQ.js";
import {
  a,
  i3 as i,
  o,
  s2 as s
} from "./chunk-QY7XKUIV.js";

// node_modules/@arcgis/core/rest/knowledgeGraph/ProtoFeatureCollection.js
var t5 = class {
  constructor() {
    this.version = "", this.queryResult = new e3();
  }
};
var e3 = class {
  constructor() {
    this.featureResult = new i6();
  }
};
var i6 = class {
  constructor() {
    this.objectIdFieldName = "", this.uniqueIdField = new r3(), this.globalIdFieldName = "", this.geohashFieldName = "", this.geometryProperties = new a6(), this.geometryType = null, this.spatialReference = new f(), this.exceededTransferLimit = false, this.hasZ = false, this.hasM = false, this.transform = new h(), this.fields = [], this.fieldNameToAttributeIndexMap = {}, this.values = [], this.features = [], this.geometryFields = [];
  }
};
var r3 = class {
  constructor() {
    this.name = "", this.isSystemMaintained = false;
  }
};
var a6 = class {
  constructor() {
    this.shapeAreaFieldName = "", this.shapeLengthFieldName = "", this.units = "";
  }
};
var h = class {
  constructor() {
    this.quantizeOriginPosition = "upperLeft", this.scale = new n8(), this.translate = new o4();
  }
};
var n8 = class {
  constructor() {
    this.xScale = 0, this.yScale = 0, this.mScale = 0, this.zScale = 0;
  }
};
var o4 = class {
  constructor() {
    this.xTranslate = 0, this.yTranslate = 0, this.mTranslate = 0, this.zTranslate = 0;
  }
};
var c3 = class {
  constructor() {
    this.name = "", this.fieldType = "esriFieldTypeString", this.alias = "", this.sqlType = "sqlTypeVarchar", this.domain = "", this.defaultValue = "";
  }
};
var l8 = class {
  constructor() {
    this.attributes = [], this.compressedGeometry = new u6(), this.centroid = new u6(), this.aggregateGeometries = [];
  }
};
var u6 = class {
  constructor() {
    this.geometryType = null, this.lengths = [], this.coords = [];
  }
};
var E3 = ["ELEMENTUID", "TYPENAME"];

// node_modules/@arcgis/core/rest/knowledgeGraph/wasmInterface/WasmSerializedLayerData.js
var e4 = { upperLeft: 0, lowerLeft: 1 };
var l9 = { sqlTypeBigInt: 0, sqlTypeBinary: 1, sqlTypeBit: 2, sqlTypeChar: 3, sqlTypeDate: 4, sqlTypeDecimal: 5, sqlTypeDouble: 6, sqlTypeFloat: 7, sqlTypeGeometry: 8, sqlTypeGUID: 9, sqlTypeInteger: 10, sqlTypeLongNVarchar: 11, sqlTypeLongVarbinary: 12, sqlTypeLongVarchar: 13, sqlTypeNChar: 14, sqlTypeNVarChar: 15, sqlTypeOther: 16, sqlTypeReal: 17, sqlTypeSmallInt: 18, sqlTypeSqlXml: 19, sqlTypeTime: 20, sqlTypeTimestamp: 21, sqlTypeTimestamp2: 22, sqlTypeTinyInt: 23, sqlTypeVarbinary: 24, sqlTypeVarchar: 25 };

// node_modules/@arcgis/core/rest/knowledgeGraph/wasmInterface/wasmToFeatureFactories.js
function u7(r7) {
  const o9 = new t5();
  o9.version = r7.version;
  const n12 = r7.get_query_result();
  if (0 !== n12.results_type.value) throw new Error("Got a non-feature collection type");
  const i10 = n12.get_feature_result(), c6 = o9.queryResult.featureResult;
  c6.objectIdFieldName = i10.objectid_field_name, c6.exceededTransferLimit = i10.exceeded_transfer_limit, c6.hasM = i10.has_m, c6.hasZ = i10.has_z, c6.geometryType = o(i5, i10.geometry_type.value), c6.globalIdFieldName = i10.globalid_field_name, c6.geohashFieldName = i10.geohash_field_name;
  const d7 = c6.uniqueIdField, u9 = i10.unique_id_field;
  d7.name = u9.name, d7.isSystemMaintained = u9.isSystemMaintained;
  const _4 = c6.geometryProperties, y7 = i10.geometry_properties;
  _4.shapeAreaFieldName = y7.shapeAreaFieldName, _4.shapeLengthFieldName = y7.shapeLengthFieldName, _4.units = y7.units;
  const h3 = c6.spatialReference, v3 = i10.spatial_reference;
  h3.wkid = v3.wkid, h3.latestWkid = v3.latestWkid, h3.vcsWkid = v3.vcsWkid, h3.latestVcsWkid = v3.latestVcsWkid, h3.wkt = v3.wkt, c6.transform = p9(i10.transform);
  const T4 = c6.fields, w3 = c6.fieldNameToAttributeIndexMap, z2 = i10.fields, F5 = z2.size();
  for (let e7 = 0; e7 < F5; e7++) {
    const t7 = z2.get(e7), a9 = f7(t7);
    T4.push(a9), w3[a9.name] = e7, t7.delete();
  }
  z2.delete();
  const S4 = c6.values, b6 = i10.values_count();
  for (let e7 = 0; e7 < b6; e7++) S4.push(i10.get_value_at(e7));
  const k3 = c6.features, q2 = i10.features, W3 = q2.size();
  if (W3 > 0) {
    for (const e7 of E3) if (void 0 === w3[e7]) throw new Error(`Feature collection missing required attribute: ${e7}`);
  }
  for (let e7 = 0; e7 < W3; e7++) {
    const t7 = new l8(), a9 = q2.get(e7), r8 = t7.attributes, o10 = a9.attributes_count();
    for (let e8 = 0; e8 < o10; e8++) r8.push(a9.get_attribute_at(e8));
    const n13 = a9.get_compressed_geometry();
    n13 && (t7.compressedGeometry = m4(n13), t7.centroid = m4(a9.get_centroid()));
    const l12 = t7.aggregateGeometries, i11 = a9.aggregate_geometries, c7 = i11.size();
    for (let e8 = 0; e8 < c7; e8++) {
      const t8 = i11.get(e8), a10 = m4(t8);
      l12.push(a10), t8.delete();
    }
    i11.delete(), k3.push(t7), a9.delete();
  }
  q2.delete();
  const x2 = c6.geometryFields, N5 = i10.geometry_fields, j3 = N5.size();
  for (let e7 = 0; e7 < j3; e7++) {
    const t7 = N5.get(e7), a9 = g3(t7);
    x2.push(a9), t7.delete();
  }
  return N5.delete(), o9;
}
function m4(t7) {
  const a9 = new u6();
  a9.geometryType = o(i5, t7.geometry_type.value);
  const s8 = [], r7 = [];
  for (let e7 = 0; e7 < t7.lengths.length; e7++) s8.push(t7.lengths[e7]);
  for (let e7 = 0; e7 < t7.coords.length; e7++) r7.push(t7.coords[e7]);
  return a9.lengths = s8, a9.coords = r7, a9;
}
function f7(t7) {
  const a9 = new c3();
  return a9.name = t7.name, a9.alias = t7.alias, a9.fieldType = o(r2, t7.field_type.value), a9.sqlType = o(l9, t7.sql_type.value), a9.domain = t7.domain, a9.defaultValue = t7.default_value, a9;
}
function g3(t7) {
  const a9 = f7(t7);
  return a9.geometryType = o(i5, t7.geometry_type.value), a9;
}
function p9(t7) {
  const a9 = new h();
  a9.quantizeOriginPosition = o(e4, t7.quantizeOriginPosition.value);
  const s8 = a9.scale, o9 = t7.scale;
  s8.xScale = o9.xScale, s8.yScale = o9.yScale, s8.mScale = o9.mScale, s8.zScale = o9.zScale;
  const n12 = a9.translate, l12 = t7.translate;
  return n12.xTranslate = l12.xTranslate, n12.yTranslate = l12.yTranslate, n12.mTranslate = l12.mTranslate, n12.zTranslate = l12.zTranslate, a9;
}

// node_modules/@arcgis/core/applications/KnowledgeStudio/resourceSerializationUtils.js
async function y4(e7) {
  const t7 = [], r7 = { generateAllSublayers: false, namedTypeDefinitions: /* @__PURE__ */ new Map() };
  return e7.entitiesUrl && t7.push(b4(e7.entitiesUrl).then((e8) => {
    k(e8, r7);
  })), e7.relationshipsUrl && t7.push(b4(e7.relationshipsUrl).then((e8) => {
    k(e8, r7);
  })), await Promise.all(t7), r7;
}
async function f8(e7, t7) {
  t7 ??= false;
  const r7 = { generateAllSublayers: t7, namedTypeDefinitions: /* @__PURE__ */ new Map() };
  return await E4(e7).then((e8) => {
    M(e8, r7);
  }), r7;
}
async function w2(e7) {
  const r7 = await n7(), i10 = new r7.MapOfObjectIdentifierSets();
  h2(i10, r7, e7);
  const n12 = new r7.MapOfObjectIdentifierSetsEncoder();
  try {
    n12.set_map_of_identifier_sets(i10), n12.encode();
    const e8 = n12.get_encoding_result();
    if (0 !== e8.error.error_code) throw new s("knowledge-graph:layer-support-utils", e8.error.error_message);
    const r8 = structuredClone(e8.get_byte_buffer());
    return n12.delete(), r8;
  } finally {
    i10.delete();
  }
}
function h2(e7, t7, r7) {
  for (const [i10, n12] of r7.namedTypeDefinitions) {
    if (!n12.members || n12.useAllData) continue;
    const r8 = n12.members.keys();
    let s8 = false, a9 = true;
    const o9 = new t7.ObjectIdArray(), l12 = new t7.StringArray(), c6 = new t7.GlobalIdArray(), d7 = new t7.IdentifierArray(), u9 = new t7.ObjectIdentifierSet();
    for (const e8 of r8) a9 && (s8 = !isNaN(Number(e8)), a9 = false), s8 ? o9.add_objectid(Number(e8)) : (l12.add_string(e8), c6.add_globalid(e8)), d7.add_identifier(e8);
    u9.set_oid_array(o9), u9.set_string_array(l12), u9.set_globalid_array(c6), u9.set_identifier_array(d7), o9.delete(), l12.delete(), c6.delete(), d7.delete(), e7.put_identifier_set(i10, u9), u9.delete();
  }
  return e7;
}
async function b4(t7) {
  const r7 = await H(t7, { responseType: "array-buffer" });
  return T2(await r7.data);
}
async function T2(e7) {
  const r7 = new (await n7()).FeatureCollectionDecoder(), i10 = r7.decode(new Uint8Array(e7));
  if (0 !== i10.error_code) throw new s("knowledge-graph:layer-support-utils", i10.error_message);
  const n12 = r7.get_feature_collection(), s8 = u7(n12);
  return r7.delete(), s8;
}
async function E4(t7) {
  const r7 = await H(t7, { responseType: "array-buffer" }), i10 = await r7.data;
  return F3(new Uint8Array(i10));
}
async function F3(e7) {
  const r7 = new (await n7()).MapOfObjectIdentifierSetsDecoder(), i10 = r7.decode(new Uint8Array(e7)), n12 = /* @__PURE__ */ new Map();
  if (0 !== i10.error_code) throw new s("knowledge-graph:layer-support-utils", i10.error_message);
  const s8 = r7.get_map_of_identifier_sets(), a9 = s8.keys, l12 = a9.size();
  for (let o9 = 0; o9 < l12; o9++) {
    const e8 = a9.get(o9), r8 = s8.query_identifier_set(e8), i11 = [];
    if (1 === r8.id_array_type.value) {
      const e9 = r8.get_globalid_array(), t7 = e9.count();
      for (let r9 = 0; r9 < t7; r9++) i11.push(e9.get_globalid_at(r9));
    } else if (3 === r8.id_array_type.value) {
      const e9 = r8.get_identifier_array(), t7 = e9.count();
      for (let r9 = 0; r9 < t7; r9++) i11.push(e9.get_identifier_at(r9).toString());
    } else if (2 === r8.id_array_type.value) {
      const e9 = r8.get_string_array(), t7 = e9.count();
      for (let r9 = 0; r9 < t7; r9++) i11.push(e9.get_string_at(r9));
    } else {
      if (0 !== r8.id_array_type.value) throw new s("knowledge-graph:layer-support-utils", "Tried to encode an unexpected ID Array type.");
      {
        const e9 = r8.get_oid_array(), t7 = e9.count();
        for (let r9 = 0; r9 < t7; r9++) i11.push(e9.get_objectid_at(r9).toString());
      }
    }
    n12.set(e8, i11);
  }
  return r7.delete(), n12;
}
function k(e7, t7) {
  if (!e7?.queryResult?.featureResult) return t7;
  const i10 = e7.queryResult.featureResult.fieldNameToAttributeIndexMap;
  for (const s8 of e7.queryResult.featureResult.features) {
    const e8 = s8.attributes[i10.TYPENAME], a9 = e(t7.namedTypeDefinitions, e8, () => ({ useAllData: false, members: /* @__PURE__ */ new Map() })), o9 = s8.attributes[i10.ELEMENTUID];
    if (s8.compressedGeometry?.coords?.length > 0) {
      let e9 = s8.compressedGeometry.lengths;
      "esriGeometryPoint" === s8.compressedGeometry.geometryType && (e9 = []), a9.members.set(o9, { id: o9, linkChartLocation: new e2(e9, s8.compressedGeometry.coords) });
    } else a9.members.set(o9, { id: o9 });
  }
  return t7;
}
function M(e7, t7) {
  for (const [i10, n12] of e7) {
    const e8 = e(t7.namedTypeDefinitions, i10, () => ({ useAllData: false, members: /* @__PURE__ */ new Map() }));
    for (const t8 of n12) e8.members.has(t8) || e8.members.set(t8, { id: t8 });
  }
  return t7;
}
var I2 = { fetchAndConvertSerializedLinkChart: (e7) => y4(e7) };

// node_modules/@arcgis/core/layers/knowledgeGraph/SessionMemoryStorage.js
var o5 = class _o {
  constructor() {
    this._featureLookup = /* @__PURE__ */ new Map();
  }
  static getInstance() {
    return _o.instance || (_o.instance = new _o()), _o.instance;
  }
  static resetInstance() {
    _o.instance && (_o.instance = null);
  }
  deleteFromStore(e7) {
    e7.forEach((e8) => {
      this._featureLookup.delete(e8);
    });
  }
  readFromStoreByList(e7) {
    const t7 = [];
    return e7.forEach((e8) => {
      const r7 = this.readFromStoreById(e8);
      r7 && t7.push(r7);
    }), t7;
  }
  readFromStoreById(e7) {
    return this._featureLookup.get(e7) ?? null;
  }
  writeToStore(o9, n12, p13) {
    const a9 = [];
    return o9.forEach((o10) => {
      if (!o10?.id) return;
      o10.properties || (o10.properties = []);
      let u9, c6 = null;
      if (p13 && o10.properties[p13] && (c6 = ut(o10.properties[p13])), "originId" in o10 && "destinationId" in o10 && (o10.properties[I] = o10.originId, o10.properties[t4] = o10.destinationId), o10.properties[n12] = o10.id, o10.id && this._featureLookup.has(o10.id) && this._featureLookup.get(o10.id).attributes) {
        const t7 = this._featureLookup.get(o10.id), i10 = JSON.parse(JSON.stringify(Object.assign(t7.attributes, o10.properties)));
        p13 && o10.properties[p13] && (i10[p13] = f3(o10.properties[p13])), u9 = new s2(c6 ? JSON.parse(JSON.stringify(c6)) : t7?.geometry ? JSON.parse(JSON.stringify(t7.geometry)) : null, i10, null, o10.properties[n12]);
      } else u9 = new s2(c6 ? JSON.parse(JSON.stringify(c6)) : null, o10.properties, null, o10.properties[n12]);
      this._featureLookup.set(`${o10.typeName ? `${o10.typeName}__${o10.id}` : o10.id}`, u9), a9.push(u9);
    }), a9;
  }
};

// node_modules/@arcgis/core/libs/linkchartlayout/LinkChartLayout.js
var e5;
var n9 = null;
function r4() {
  return e5 || (e5 = import("./lclayout-PWWSIFO7.js").then((t7) => t7.l).then(({ default: e7 }) => e7({ locateFile: (e8) => n(`esri/libs/linkchartlayout/${e8}`) })).then((t7) => {
    s6(t7);
  }), e5);
}
function s6(t7) {
  n9 = t7;
}
var i7 = { right: 0, left: 1, top: 2, bottom: 3 };
var u8 = { none: 0, "start-only": 1, "start-and-end": 2 };
function o6(t7) {
  const e7 = { ...{ timeDirection: "right", timeBannerUTCOffsetInMinutes: 0, eventsTicksVisualization: "start-and-end", showDurationLineForNonZeroDurationEntityEvents: true, durationLineWidth: 5, entityPositionAtDurationRatio: 1, showNonZeroDurationIntervalBounds: false, separateTimeOverlaps: true, separateTimelineOverlaps: true, moveFirstBends: true, secondBendRatio: 0.3, lineSeparationMultiplier: 1, spaceSeparatedLinesEvenly: false, useBezierCurves: false, separatedLineShapeRatio: 0 }, ...t7?.toJSON(), eventsTicksVisualization: t7?.eventsTicksVisualization ?? "start-and-end" };
  return { ...e7, timeDirection: { value: i7[e7.timeDirection] ?? i7.right }, eventsTicksVisualization: { value: u8[e7.eventsTicksVisualization] ?? u8["start-and-end"] } };
}
function l10(t7, e7, a9, r7, s8, i10) {
  const u9 = a9.length, o9 = s8.length, l12 = Float64Array.BYTES_PER_ELEMENT, y7 = Uint32Array.BYTES_PER_ELEMENT, c6 = Uint8Array.BYTES_PER_ELEMENT, E7 = 16, p13 = E7 + u9 * (c6 + 2 * l12) + o9 * (2 * y7), f10 = n9._malloc(p13);
  try {
    const c7 = f10 + E7 - f10 % E7, p14 = c7 + u9 * l12, A4 = p14 + u9 * l12, P4 = A4 + o9 * y7, L4 = P4 + o9 * y7, d7 = () => [n9.HEAPF64.subarray(c7 >> 3, (c7 >> 3) + u9), n9.HEAPF64.subarray(p14 >> 3, (p14 >> 3) + u9), n9.HEAPU32.subarray(A4 >> 2, (A4 >> 2) + o9), n9.HEAPU32.subarray(P4 >> 2, (P4 >> 2) + o9), n9.HEAPU8.subarray(L4, L4 + u9)], [b6, h3, v3, H2, _4] = d7();
    b6.set(a9), h3.set(r7), v3.set(s8), H2.set(i10), _4.set(e7);
    const m7 = t7(u9, L4, c7, p14, o9, A4, P4);
    let F5 = null, T4 = null;
    if (0 === m7.value) {
      const t8 = n9.getLayoutLinksTypes(), e8 = n9.getLayoutLinksVerticesEndIndices(), a10 = n9.getLayoutLinksVertices(), r8 = n9.countLayoutLinksVertices();
      !o9 || t8 && e8 ? r8 && !a10 ? m7.value = 1 : (F5 = { types: new Uint8Array(n9.HEAPU8.subarray(t8, t8 + o9)), vertexEndIndex: new Uint32Array(n9.HEAPU32.subarray(e8 >> 2, (e8 >> 2) + o9)), vertices: new Float64Array(n9.HEAPF64.subarray(a10 >> 3, (a10 >> 3) + 2 * r8)) }, T4 = n9.getAuxiliaryGraphicElements()) : m7.value = 1;
    }
    const [g5, U2, k3, S4, B] = d7();
    return a9.set(g5), r7.set(U2), s8.set(k3), i10.set(S4), e7.set(B), { status: m7.value, links: F5, graphics: T4 };
  } finally {
    n9._free(f10), n9.cleanupLayout();
  }
}
var y5 = 2;
var c4 = 1;
var E5 = -1;
var p10;
var f9;
var A2;
var P3;
var L2;
var d4;
var b5;
!(function(t7) {
  function e7() {
    return n9.getMinIdealEdgeLength();
  }
  function a9(t8, e8, a10, r7, s8, i10, u9 = y5, o9 = c4, p13 = E5) {
    return l10((e9, a11, r8, s9, i11, l12, y7) => n9.applyForceDirectedLayout(t8, e9, a11, r8, s9, i11, l12, y7, u9, o9, p13), e8, a10, r7, s8, i10);
  }
  t7.getMinIdealEdgeLength = e7, t7.apply = a9;
})(p10 || (p10 = {})), (function(t7) {
  function e7(t8, e8, a9, r7, s8, i10, u9 = y5, o9 = c4, p13 = E5) {
    return l10((e9, a10, r8, s9, i11, l12, y7) => n9.applyCommunityLayout(t8, e9, a10, r8, s9, i11, l12, y7, u9, o9, p13), e8, a9, r7, s8, i10);
  }
  t7.apply = e7;
})(f9 || (f9 = {})), (function(t7) {
  function e7(t8, e8, a9, r7, s8, i10) {
    return l10((e9, a10, r8, s9, i11, u9, o9) => n9.applySimpleLayout(t8, e9, a10, r8, s9, i11, u9, o9), e8, a9, r7, s8, i10);
  }
  t7.apply = e7;
})(A2 || (A2 = {})), (function(t7) {
  function e7(t8, e8, a9, r7, s8, i10) {
    return l10((e9, a10, r8, s9, i11, u9, o9) => n9.applyHierarchicalLayout(t8, e9, a10, r8, s9, i11, u9, o9), e8, a9, r7, s8, i10);
  }
  t7.apply = e7;
})(P3 || (P3 = {})), (function(t7) {
  function e7(t8, e8, a9, r7, s8, i10) {
    return l10((e9, a10, r8, s9, i11, u9, o9) => n9.applyRadialTreeLayout(t8, e9, a10, r8, s9, i11, u9, o9), e8, a9, r7, s8, i10);
  }
  t7.apply = e7;
})(L2 || (L2 = {})), (function(t7) {
  function e7(t8, e8, a9, r7, s8, i10) {
    return l10((e9, a10, r8, s9, i11, u9, o9) => n9.applySmartTreeLayout(t8, e9, a10, r8, s9, i11, u9, o9), e8, a9, r7, s8, i10);
  }
  t7.apply = e7;
})(d4 || (d4 = {})), (function(t7) {
  function e7(t8, e8, a9, r7, s8, i10, u9, y7, c6, E7, p13, f10) {
    return l10((e9, a10, r8, u10, l12, y8, A4) => {
      if (s8.length !== e9) return { value: 1 };
      if (i10.length !== e9) return { value: 1 };
      if (c6.length !== l12) return { value: 1 };
      if (E7.length !== l12) return { value: 1 };
      const P4 = Float64Array.BYTES_PER_ELEMENT, L4 = 16, d7 = n9._malloc(L4 + e9 * P4), b6 = n9._malloc(L4 + e9 * P4), h3 = n9._malloc(L4 + l12 * P4), v3 = n9._malloc(L4 + l12 * P4), H2 = d7 + L4 - d7 % L4, _4 = b6 + L4 - b6 % L4, m7 = h3 + L4 - h3 % L4, F5 = v3 + L4 - v3 % L4;
      try {
        return n9.HEAPF64.subarray(H2 >> 3, (H2 >> 3) + e9).set(s8), n9.HEAPF64.subarray(_4 >> 3, (_4 >> 3) + e9).set(i10), n9.HEAPF64.subarray(m7 >> 3, (m7 >> 3) + l12).set(c6), n9.HEAPF64.subarray(F5 >> 3, (F5 >> 3) + l12).set(E7), n9.applyChronologicalLayout(t8, e9, a10, r8, u10, H2, _4, l12, y8, A4, m7, F5, p13, o6(f10));
      } finally {
        n9._free(d7), n9._free(b6), n9._free(h3), n9._free(v3);
      }
    }, e8, a9, r7, u9, y7);
  }
  t7.apply = e7;
})(b5 || (b5 = {}));

// node_modules/@arcgis/core/linkChart/enums.js
var o7 = i2()({ none: "none", startAndEnd: "start-and-end", startOnly: "start-only" });
var r5 = i2()({ absoluteValue: "absolute-value", multiplier: "multiplier" });
var a7 = /* @__PURE__ */ new Map([["basic-grid", "basic-grid"], ["geographic-organic-standard", "geographic-organic-standard"], ["hierarchical-bottom-to-top", "hierarchical-bottom-to-top"], ["hierarchical-top-to-bottom", "hierarchical-bottom-to-top"], ["organic-community", "organic-community"], ["organic-fusiform", "organic-standard"], ["organic-leaf-circle", "organic-standard"], ["organic-standard", "organic-standard"], ["radial-node-centric", "radial-root-centric"], ["radial-root-centric", "radial-root-centric"], ["tree-bottom-to-top", "tree-left-to-right"], ["tree-left-to-right", "tree-left-to-right"], ["tree-right-to-left", "tree-left-to-right"], ["tree-top-to-bottom", "tree-left-to-right"], ["chronological-mono-timeline", "chronological-mono-timeline"], ["chronological-multi-timeline", "chronological-multi-timeline"]]);

// node_modules/@arcgis/core/layers/knowledgeGraph/supportUtils.js
function d5(o9, e7) {
  const t7 = /* @__PURE__ */ new Map();
  if (e7.dataModel?.relationshipTypes) for (const r7 of e7.dataModel.relationshipTypes) r7.name && t7.set(r7.name, []);
  for (const r7 of o9) t7.has(r7.typeName) && t7.get(r7.typeName)?.push(r7.id);
  return t7;
}
async function g4(o9, e7, t7) {
  const r7 = [], n12 = d5(o9, e7), i10 = {}, s8 = [];
  for (const [c6, y7] of n12) {
    if (y7.length < 1) continue;
    const o10 = `${c6}_ids`;
    i10[o10] = y7, s8.push(`MATCH (n)-[r:${c6}]->(m) WHERE id(r) in $${o10} RETURN id(n), labels(n)[0], id(m), labels(m)[0]`);
  }
  if (0 === s8.length) return [];
  const a9 = s8.join(" UNION "), l12 = new p8({ openCypherQuery: a9, bindParameters: i10 }), m7 = (await ie(e7, l12, t7?.requestOptions)).resultRowsStream.getReader();
  for (; ; ) {
    const { done: o10, value: e8 } = await m7.read();
    if (o10) break;
    for (const t8 of e8) r7.push({ id: t8[0], typeName: t8[1] }), r7.push({ id: t8[2], typeName: t8[3] });
  }
  return r7;
}
var C = (o9) => a7.get(o9) ?? "radial-root-centric";
function S2(o9) {
  if (!o9.spatialReference.isWGS84) throw new s("knowledge-graph:layer-support-utils", "The utilsExtentToInBoundsRings function only supports WGS84 spatial references.");
  return o9.clone().normalize().map((o10) => [[o10.xmin, o10.ymin], [o10.xmin, o10.ymax], [o10.xmax, o10.ymax], [o10.xmax, o10.ymin], [o10.xmin, o10.ymin]]);
}

// node_modules/@arcgis/core/layers/knowledgeGraph/cypherUtils.js
var r6 = (e7, t7) => {
  if ("column-reference" === e7.type) return e7.column === t7.systemOidFieldName ? "ID(n)" : `n.${e7.column}`;
  if ("string" === e7.type) return `'${e7.value}'`;
  if ("number" === e7.type) return `${e7.value}`;
  if ("binary-expression" === e7.type && t7.supportedSqlTypes.has(e7.left.type) && t7.supportedSqlTypes.has(e7.right.type) && t7.supportedSqlOperators.has(e7.operator)) return `${r6(e7.left, t7)} ${e7.operator} ${r6(e7.right, t7)}`;
  if ("binary-expression" === e7.type && "LIKE" === e7.operator) {
    let r7 = "";
    if ("function" === e7.left.type && "column-reference" === e7.left.args.value[0].type) r7 += `lower(n.${e7.left.args.value[0].column})`;
    else {
      if ("column-reference" !== e7.left.type) return t7.unsupportedOperationFound = true, "";
      r7 += `lower(n.${e7.left.column})`;
    }
    if (r7 += " CONTAINS (", "string" !== e7.right.type) return t7.unsupportedOperationFound = true, "";
    {
      let t8 = e7.right.value;
      t8.startsWith("%") && (t8 = t8.slice(1)), t8.endsWith("%") && (t8 = t8.slice(0, -1)), r7 += `'${t8.toLowerCase()}')`;
    }
    return r7;
  }
  return t7.unsupportedOperationFound = true, "";
};

// node_modules/@arcgis/core/layers/knowledgeGraph/KnowledgeGraphLayerDataManager.js
var N3 = class extends b {
  constructor(e7) {
    super(e7), this._processingCacheUpdatesLookup = /* @__PURE__ */ new Map(), this.knowledgeGraph = null, this.inclusionModeDefinition = { generateAllSublayers: true, namedTypeDefinitions: /* @__PURE__ */ new Map() }, this.entityTypeNames = /* @__PURE__ */ new Set(), this.relationshipTypeNames = /* @__PURE__ */ new Set(), this.geographicLookup = /* @__PURE__ */ new Map(), this.sublayerCaches = /* @__PURE__ */ new Map(), this.nodeConnectionsLookup = /* @__PURE__ */ new Map(), this.relationshipConnectionsLookup = /* @__PURE__ */ new Map(), this.memberIdTypeLookup = /* @__PURE__ */ new Map();
    const t7 = /* @__PURE__ */ new Map();
    e7.knowledgeGraph.dataModel.entityTypes?.forEach((i10) => {
      i10.name && (t7.set(i10.name, "entity"), this._processingCacheUpdatesLookup.set(i10.name, []), e7.inclusionModeDefinition && !e7.inclusionModeDefinition?.generateAllSublayers || this.entityTypeNames.add(i10.name), i10.properties?.forEach((e8) => {
        e8.geometryType && "esriGeometryNull" !== e8.geometryType && this.geographicLookup.set(i10.name, { name: e8.name ?? "", geometryType: e8.geometryType });
      }));
    }), e7.knowledgeGraph.dataModel.relationshipTypes?.forEach((i10) => {
      i10.name && (t7.set(i10.name, "relationship"), this._processingCacheUpdatesLookup.set(i10.name, []), e7.inclusionModeDefinition && !e7.inclusionModeDefinition?.generateAllSublayers || this.relationshipTypeNames.add(i10.name), i10.properties?.forEach((e8) => {
        e8.geometryType && "esriGeometryNull" !== e8.geometryType && this.geographicLookup.set(i10.name, { name: e8.name ?? "", geometryType: e8.geometryType });
      }));
    }), e7.inclusionModeDefinition?.namedTypeDefinitions.forEach((i10, s8) => {
      if ("entity" === t7.get(s8)) this.entityTypeNames.add(s8);
      else {
        if ("relationship" !== t7.get(s8)) return i.getLogger(this).warn(`A named type, ${s8}, was in the inclusion list that wasn't in the data model and will be removed`), void e7.inclusionModeDefinition?.namedTypeDefinitions.delete(s8);
        this.relationshipTypeNames.add(s8);
      }
      const a9 = /* @__PURE__ */ new Map();
      i10.members?.forEach((e8) => {
        e(this.memberIdTypeLookup, e8.id, () => /* @__PURE__ */ new Set()).add(s8);
      }), this.sublayerCaches.set(s8, a9);
    });
  }
  addToLayer(e7) {
    e7.forEach(({ typeName: e8, id: t7 }) => {
      if (!this.inclusionModeDefinition) throw new s("knowledge-graph:layer-data-manager", "You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");
      if (this.inclusionModeDefinition.namedTypeDefinitions.has(e8)) {
        if (this.inclusionModeDefinition.namedTypeDefinitions.has(e8)) {
          const i10 = this.inclusionModeDefinition.namedTypeDefinitions.get(e8);
          i10.members || (i10.members = /* @__PURE__ */ new Map()), i10.members.set(t7, { id: t7 }), e(this.memberIdTypeLookup, t7, () => /* @__PURE__ */ new Set()).add(e8);
        }
      } else {
        const i10 = /* @__PURE__ */ new Map();
        i10.set(t7, { id: t7 }), this.inclusionModeDefinition.namedTypeDefinitions.set(e8, { useAllData: false, members: i10 }), e(this.memberIdTypeLookup, t7, () => /* @__PURE__ */ new Set()).add(e8);
      }
    });
  }
  getById(e7) {
    return o5.getInstance().readFromStoreById(e7);
  }
  async getData(e7, t7, i10) {
    if (t7.objectType.name && this.inclusionModeDefinition?.namedTypeDefinitions && this.inclusionModeDefinition.namedTypeDefinitions.size > 0 && !this.inclusionModeDefinition.namedTypeDefinitions.has(t7.objectType.name)) return [];
    let n12;
    if (n12 = e7 || new b2({ where: "1=1", outFields: ["*"] }), "link-chart" === t7.parentCompositeLayer.type) {
      const e8 = t7.parentCompositeLayer, i11 = this._processingCacheUpdatesLookup.get(t7.objectType.name ?? ""), o9 = n12.outFields;
      o9 && 1 === o9.length && o9[0] === _2 && "1=1" === n12.where || await Promise.all(i11 ?? []);
      const s8 = this.sublayerCaches.has(t7.objectType.name ?? "") ? Array.from(this.sublayerCaches.get(t7.objectType.name)?.values()) : [], a9 = [];
      return s8.forEach((i12) => {
        if (this.relationshipTypeNames.has(t7.objectType.name)) {
          i12.geometry = e8.relationshipLinkChartDiagramLookup.get(i12.attributes[t7.objectIdField]);
          const n13 = this.memberIdTypeLookup.get(i12.attributes[I]), o10 = this.memberIdTypeLookup.get(i12.attributes[t4]), s9 = this._isEndEntitySpatial(n13, i12, I), a10 = this._isEndEntitySpatial(o10, i12, t4);
          i12.attributes[E2] = Number(s9 && a10);
        } else {
          i12.geometry = e8.entityLinkChartDiagramLookup.get(i12.attributes[t7.objectIdField]);
          const n13 = this.geographicLookup.get(t7.objectType.name);
          n13 && i12.attributes[n13.name] ? i12.attributes[E2] = 1 : i12.attributes[E2] = 0;
        }
        i12.attributes[S] = i12.geometry, a9.push(i12);
      }), a9;
    }
    return this.retrieveDataFromService(n12, t7, i10);
  }
  async getConnectedRecordIds(e7, t7, i10) {
    const n12 = [];
    let o9 = "";
    const s8 = this._getNamedTypeIdMapFromNodeIds(e7);
    if (t7 && 0 !== t7?.length) {
      for (const e8 of t7) o9 = o9 + e8 + "|";
      o9 = o9.slice(0, -1);
    }
    const a9 = {}, r7 = [];
    for (const [m7, l12] of s8) {
      const e8 = `${m7}_ids`;
      a9[e8] = l12, t7 && 0 !== t7?.length ? r7.push(`MATCH (n:${m7}) WHERE id(n) IN $${e8} WITH n MATCH (n)-[r:${o9}]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`) : r7.push(`MATCH (n:${m7}) WHERE id(n) IN $${e8} WITH n MATCH (n)-[r]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`);
    }
    if (!r7.length) return n12;
    const p13 = r7.join(" UNION "), d7 = (await ie(this.knowledgeGraph, new p8({ openCypherQuery: p13, bindParameters: a9 }), { signal: i10?.signal })).resultRowsStream.getReader();
    for (; ; ) {
      const { done: e8, value: t8 } = await d7.read();
      if (e8) break;
      for (let i11 = 0; i11 < t8.length; i11++) {
        const e9 = t8[i11];
        n12.push({ id: e9[0], typeName: e9[1] }), n12.push({ id: e9[2], typeName: e9[3] });
      }
    }
    return n12;
  }
  async getRelationshipsBetweenNodes(e7, t7, i10) {
    const n12 = this._getNamedTypeIdMapFromNodeIds(e7);
    if (0 === n12.size) return [];
    const o9 = { relationshipExclusionIds: t7, possibleConnectionEntityIds: e7 }, s8 = [];
    for (const [d7, m7] of n12.entries()) {
      const e8 = `${d7}_ids`;
      o9[e8] = m7, s8.push(`MATCH (n:${d7}) WHERE id(n) IN $${e8} WITH n MATCH (n)-[r]->(m) WHERE id(m) IN $possibleConnectionEntityIds AND NOT id(r) IN $relationshipExclusionIds RETURN id(r), type(r)`);
    }
    const a9 = s8.join(" UNION "), r7 = [], p13 = (await ie(this.knowledgeGraph, new p8({ openCypherQuery: a9, bindParameters: o9 }), { signal: i10?.signal })).resultRowsStream.getReader();
    for (; ; ) {
      const { done: e8, value: t8 } = await p13.read();
      if (e8) break;
      for (let i11 = 0; i11 < t8.length; i11++) {
        const e9 = t8[i11];
        r7.push({ id: e9[0], typeName: e9[1] });
      }
    }
    return r7;
  }
  async getRelationshipsFromNodes(e7, t7, i10, n12) {
    const o9 = this._getNamedTypeIdMapFromNodeIds(e7);
    if (0 === o9.size || 0 === t7.length) return [];
    const s8 = { relationshipExclusionIds: i10, possibleConnectionEntityIds: t7 }, a9 = [];
    for (const [l12, h3] of o9.entries()) {
      const e8 = `${l12}_ids`;
      s8[e8] = h3, a9.push(`MATCH (n:${l12}) WHERE id(n) IN $${e8} WITH n MATCH (n)-[r]-(m) WHERE id(m) IN $possibleConnectionEntityIds AND NOT id(r) IN $relationshipExclusionIds RETURN id(r), type(r)`);
    }
    const r7 = a9.join(" UNION "), p13 = /* @__PURE__ */ new Map(), d7 = (await ie(this.knowledgeGraph, new p8({ openCypherQuery: r7, bindParameters: s8 }), { signal: n12?.signal })).resultRowsStream.getReader();
    for (; ; ) {
      const { done: e8, value: t8 } = await d7.read();
      if (e8) break;
      for (let i11 = 0; i11 < t8.length; i11++) {
        const e9 = t8[i11];
        let n13 = p13.get(e9[1]);
        n13 || (n13 = /* @__PURE__ */ new Set(), p13.set(e9[1], n13)), n13.add(e9[0]);
      }
    }
    const m7 = [];
    for (const [l12, h3] of p13) for (const e8 of h3) m7.push({ id: e8, typeName: l12 });
    return m7;
  }
  async refreshCacheContent(e7, t7, n12, a9 = true, r7) {
    const p13 = o5.getInstance(), d7 = [], m7 = /* @__PURE__ */ new Map(), l12 = /* @__PURE__ */ new Map();
    this.knowledgeGraph.dataModel.entityTypes?.forEach((e8) => {
      e8.name && l12.set(e8.name, e8);
    }), this.knowledgeGraph.dataModel.relationshipTypes?.forEach((e8) => {
      e8.name && l12.set(e8.name, e8);
    }), e7 || this.inclusionModeDefinition ? e7 ? e7.forEach((e8) => {
      if (this.memberIdTypeLookup.has(e8)) for (const t8 of this.memberIdTypeLookup.get(e8)) m7.has(t8) ? m7.get(t8)?.push(e8) : m7.set(t8, [e8]);
    }) : this.inclusionModeDefinition?.namedTypeDefinitions?.forEach((e8, t8) => {
      e8.useAllData ? m7.set(t8, null) : e8.members && e8.members.forEach((e9) => {
        m7.has(t8) && null !== m7.get(t8) ? m7.get(t8)?.push(e9.id) : m7.set(t8, [e9.id]);
      });
    }) : (this.knowledgeGraph.dataModel.entityTypes?.forEach((e8) => {
      e8.name && m7.set(e8.name, null);
    }), this.knowledgeGraph.dataModel.entityTypes?.forEach((e8) => {
      e8.name && m7.set(e8.name, null);
    }));
    for (const [s8, h3] of m7) {
      const e8 = new Set(h3), m8 = new Promise((d8, m9) => {
        const c6 = async () => {
          const d9 = /* @__PURE__ */ new Set(), m10 = [];
          let c7, u9 = "", f10 = false;
          if (t7 || l12.get(s8)?.properties?.forEach((e9) => {
            e9.name && d9.add(e9.name);
          }), n12 && this.geographicLookup.has(s8)) {
            const e9 = this.geographicLookup.get(s8)?.name;
            e9 && d9.add(e9);
          }
          if (this.entityTypeNames.has(s8)) u9 = `MATCH (n:${s8}) ${h3 ? "WHERE id(n) IN $ids " : ""}return ID(n)`, d9.forEach((e9) => {
            u9 += `, n.${e9}`, m10.push(e9);
          });
          else {
            if (!this.relationshipTypeNames.has(s8)) throw new s("knowledge-graph:layer-data-manager", `The graph type of ${s8} could not be determined. Was this type set in the KG data model and inclusion definition?`);
            f10 = true, u9 = `MATCH ()-[n:${s8}]->() ${h3 ? "WHERE id(n) IN $ids " : ""}return ID(n), id(startNode(n)), id(endNode(n))`, d9.forEach((e9) => {
              u9 += `, n.${e9}`, m10.push(e9);
            });
          }
          c7 = new p8(h3 ? { openCypherQuery: u9, bindParameters: { ids: h3 } } : { openCypherQuery: u9 });
          const g5 = (await ie(this.knowledgeGraph, c7, { signal: r7?.signal })).resultRowsStream.getReader();
          for (; ; ) {
            const { done: t8, value: i10 } = await g5.read();
            if (t8) break;
            const n13 = [];
            for (let s9 = 0; s9 < i10.length; s9++) {
              const t9 = i10[s9];
              let a10 = 0, r9 = 0;
              const p14 = { properties: {} };
              for (p14.id = t9[a10], a10++, r9++, f10 && (p14.originId = t9[a10], a10++, r9++, p14.destinationId = t9[a10], a10++, r9++, e(this.nodeConnectionsLookup, p14.originId, () => /* @__PURE__ */ new Set()).add(p14.id), e(this.nodeConnectionsLookup, p14.destinationId, () => /* @__PURE__ */ new Set()).add(p14.id), e(this.relationshipConnectionsLookup, p14.id, () => [p14.originId, p14.destinationId])); a10 < t9.length; a10++) p14.properties[m10[a10 - r9]] = t9[a10];
              e8.delete(p14.id), n13.push(p14);
            }
            const r8 = p13.writeToStore(n13, _2, this.geographicLookup.get(s8)?.name);
            this.sublayerCaches.has(s8) || this.sublayerCaches.set(s8, /* @__PURE__ */ new Map()), a9 && !this.inclusionModeDefinition?.namedTypeDefinitions.has(s8) && this.inclusionModeDefinition?.namedTypeDefinitions.set(s8, { useAllData: false, members: /* @__PURE__ */ new Map() }), a9 && !this.inclusionModeDefinition?.namedTypeDefinitions.get(s8).members && (this.inclusionModeDefinition.namedTypeDefinitions.get(s8).members = /* @__PURE__ */ new Map());
            const d10 = this.sublayerCaches.get(s8);
            r8.forEach((e9) => {
              d10?.set(e9.attributes[_2], e9), a9 && !this.inclusionModeDefinition?.namedTypeDefinitions.get(s8).members.has(e9.attributes[_2]) && (this.inclusionModeDefinition?.namedTypeDefinitions.get(s8).members.set(e9.attributes[_2], { id: e9.attributes[_2] }), e(this.memberIdTypeLookup, e9.attributes[_2], () => /* @__PURE__ */ new Set()).add(s8));
            });
          }
          const b6 = this.inclusionModeDefinition?.namedTypeDefinitions.get(s8);
          if (b6) for (const t8 of e8) b6.members?.delete(t8);
        };
        c6().then(() => {
          d8(null);
        }).catch((e9) => {
          "AbortError" === e9.name ? d8(null) : m9(e9);
        });
      });
      d7.push(m8), this._processingCacheUpdatesLookup.get(s8)?.push(m8);
    }
    if (await Promise.all(d7), r7?.signal?.aborted) throw u();
  }
  removeFromLayer(e7) {
    const t7 = /* @__PURE__ */ new Set(), i10 = new Set(e7.map((e8) => e8.id));
    for (const n12 of e7) t7.add(n12.typeName), 1 === this.memberIdTypeLookup.get(n12.id)?.size ? this.memberIdTypeLookup.delete(n12.id) : this.memberIdTypeLookup.get(n12.id)?.delete(n12.typeName), this.inclusionModeDefinition?.namedTypeDefinitions.forEach((e8, t8) => {
      t8 === n12.typeName && e8.members?.has(n12.id) && e8.members.delete(n12.id);
    });
    t7.forEach((e8) => {
      this.sublayerCaches.get(e8)?.forEach((t8, n12) => {
        i10.has(n12) && this.sublayerCaches.get(e8)?.delete(n12);
      });
    });
  }
  async retrieveDataFromService(e7, t7, n12) {
    const o9 = o5.getInstance(), s8 = /* @__PURE__ */ new Set(), r7 = [];
    let p13, u9 = "", f10 = [];
    const g5 = "relationship" === t7.graphType, b6 = this.inclusionModeDefinition?.namedTypeDefinitions?.get(t7.objectType.name)?.useAllData, E7 = t7.parentCompositeLayer.sublayerIdsCache.get(t7.objectType.name);
    let N5 = !b6 && E7 ? Array.from(E7).sort() : null;
    if (this.inclusionModeDefinition?.namedTypeDefinitions?.get(t7.objectType.name)?.useAllData) this.inclusionModeDefinition?.namedTypeDefinitions?.get(t7.objectType.name)?.useAllData && null != e7.objectIds && (N5 = e7.objectIds);
    else if (null != e7.objectIds && N5 && N5.length > 0) {
      const t8 = e7.objectIds;
      e7.objectIds = N5.filter((e8) => t8.includes(e8));
    } else if (null != e7.objectIds) N5 = e7.objectIds;
    else {
      if (this.inclusionModeDefinition?.namedTypeDefinitions.has(t7.objectType.name) && (!this.inclusionModeDefinition.namedTypeDefinitions.get(t7.objectType.name)?.members || this.inclusionModeDefinition.namedTypeDefinitions.get(t7.objectType.name)?.members?.size < 1)) return e7.objectIds = [], [];
      e7.objectIds = N5;
    }
    if (null != e7.outFields) {
      const i10 = e7.outFields;
      i10.includes("*") ? t7.fields.forEach((e8) => {
        s8.add(e8.name);
      }) : i10.forEach((e8) => {
        e8 !== _2 && e8 !== t7.geometryFieldName && s8.add(e8);
      });
    }
    if (null != e7.geometry) {
      const n13 = e7.geometry;
      let o10;
      const y7 = t7.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition, f11 = y7?.spatialReference, b7 = y7?.serviceCapabilities?.geometryCapabilities;
      let T4 = b7?.geometryMaxBoundingRectangleSizeX, w3 = b7?.geometryMaxBoundingRectangleSizeY;
      if ("point" === n13.type) {
        let e8 = n13;
        e8.spatialReference?.isWGS84 || (await N2(e8.spatialReference, N), e8 = W(e8, N)), o10 = new z({ spatialReference: N, xmin: e8.x - 1e-4, ymin: e8.y - 1e-4, xmax: e8.x + 1e-4, ymax: e8.y + 1e-4 });
      } else n13?.extent?.spatialReference && !n13.spatialReference?.isWGS84 ? (await N2(n13.extent.spatialReference, N), o10 = W(n13.extent, N)) : o10 = n13.extent;
      if (T4 && w3 && f11) {
        if (4326 !== f11.wkid) {
          const e8 = new z({ spatialReference: f11, xmax: T4, ymax: w3 }), t8 = W(e8, N);
          T4 = t8.xmax, w3 = t8.ymax;
        }
        if (o10.xmax - o10.xmin > T4) throw new s("knowledge-graph:layer-data-manager", `Extent x bounds should be within ${T4}° latitude, limit exceeded`);
        if (o10.ymax - o10.ymin > w3) throw new s("knowledge-graph:layer-data-manager", `Extent y bounds should be within ${w3}° longitude, limit exceeded`);
      }
      if (null != e7.where && "1=1" !== e7.where) {
        const i10 = await u2(e7.where.toUpperCase(), t7.fieldsIndex);
        t7.fields.forEach((e8) => {
          i10.fieldNames.includes(e8.name) && s8.add(e8.name);
        });
      }
      u9 = g5 ? `Match ()-[n:${t7.objectType.name}]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t7.geometryFieldName}) return ID(n), id(startNode(r)), id(endNode(r))` : `Match (n:${t7.objectType.name}) WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t7.geometryFieldName}) return ID(n)`, t7.geometryFieldName && s8.add(t7.geometryFieldName), s8.forEach((e8) => {
        u9 += `, n.${e8}`, r7.push(e8);
      }), p13 = new p8({ openCypherQuery: u9, bindParameters: { param_filter_geom: new P({ rings: S2(o10) }) } });
    } else {
      let i10 = "";
      if (null != e7.where && "1=1" !== e7.where) {
        const n14 = await u2(e7.where, t7.fieldsIndex);
        t7.fields.forEach((e8) => {
          n14.fieldNames.includes(e8.name) && s8.add(e8.name);
        });
        const o11 = { systemOidFieldName: _2, supportedSqlTypes: /* @__PURE__ */ new Set(["column-reference", "string", "number", "binary-expression"]), supportedSqlOperators: /* @__PURE__ */ new Set(["=", "<", "<=", "<>", ">", ">=", "AND", "OR", "LIKE"]), unsupportedOperationFound: false };
        i10 = r6(n14.parseTree, o11), o11.unsupportedOperationFound && (i10 = "");
      }
      let n13 = "";
      n13 = g5 ? `Match ()-[n:${t7.objectType.name}]->()` : `Match (n:${t7.objectType.name})`;
      let o10 = false;
      N5 && (o10 = true, n13 += " WHERE ID(n) IN $ids"), i10 && (n13 += o10 ? " AND" : " WHERE", n13 += ` ${i10}`), n13 += " return ID(n)", g5 && (n13 += ", id(startNode(n)), id(endNode(n))"), e7.returnGeometry && t7.geometryFieldName && s8.add(t7.geometryFieldName), s8.forEach((e8) => {
        n13 += `, n.${e8}`, r7.push(e8);
      }), p13 = new p8(N5 ? { openCypherQuery: n13, bindParameters: { ids: N5 } } : { openCypherQuery: n13 });
    }
    const k3 = (await ie(t7.parentCompositeLayer.dataManager.knowledgeGraph, p13, n12)).resultRowsStream.getReader();
    for (; ; ) {
      const { done: e8, value: i10 } = await k3.read();
      if (e8) break;
      const n13 = [];
      for (let t8 = 0; t8 < i10.length; t8++) {
        const e9 = i10[t8];
        let o10 = 0, s9 = 0;
        const a9 = { properties: {} };
        for (a9.id = e9[o10], o10++, s9++, g5 && (a9.originId = e9[o10], o10++, s9++, a9.destinationId = e9[o10], o10++, s9++); o10 < e9.length; o10++) a9.properties[r7[o10 - s9]] = e9[o10];
        n13.push(a9);
      }
      f10 = f10.concat(o9.writeToStore(n13, _2, t7.parentCompositeLayer.dataManager.geographicLookup.get(t7.objectType.name)?.name));
    }
    return f10;
  }
  _isEndEntitySpatial(e7, t7, i10) {
    for (const n12 of e7 ?? []) if (this.entityTypeNames.has(n12)) {
      const e8 = this.geographicLookup.get(n12), o9 = e8 && this.sublayerCaches.get(n12)?.get(t7.attributes[i10]);
      if (e8 && o9?.attributes[e8.name]) return true;
    }
    return false;
  }
  _getNamedTypeIdMapFromNodeIds(e7) {
    const t7 = /* @__PURE__ */ new Map();
    return e7.forEach((e8) => {
      if (this.memberIdTypeLookup.has(e8)) for (const i10 of this.memberIdTypeLookup.get(e8)) {
        if (!this.entityTypeNames.has(i10)) return;
        t7.has(i10) ? t7.get(i10)?.push(e8) : t7.set(i10, [e8]);
      }
    }), t7;
  }
};
__decorate([m()], N3.prototype, "knowledgeGraph", void 0), __decorate([m()], N3.prototype, "inclusionModeDefinition", void 0), __decorate([m()], N3.prototype, "entityTypeNames", void 0), __decorate([m()], N3.prototype, "relationshipTypeNames", void 0), __decorate([m()], N3.prototype, "geographicLookup", void 0), __decorate([m()], N3.prototype, "sublayerCaches", void 0), __decorate([m()], N3.prototype, "nodeConnectionsLookup", void 0), __decorate([m()], N3.prototype, "relationshipConnectionsLookup", void 0), __decorate([m()], N3.prototype, "memberIdTypeLookup", void 0), N3 = __decorate([a2("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")], N3);

// node_modules/@arcgis/core/form/elements.js
var l11 = l3;

// node_modules/@arcgis/core/rest/knowledgeGraph/GraphApplyEdits.js
var i8 = class extends b {
  constructor(o9) {
    super(o9), this.entityAdds = void 0, this.entityUpdates = void 0, this.entityDeletes = void 0, this.relationshipAdds = void 0, this.relationshipUpdates = void 0, this.relationshipDeletes = void 0, this.options = void 0;
  }
};
__decorate([m()], i8.prototype, "entityAdds", void 0), __decorate([m()], i8.prototype, "entityUpdates", void 0), __decorate([m()], i8.prototype, "entityDeletes", void 0), __decorate([m()], i8.prototype, "relationshipAdds", void 0), __decorate([m()], i8.prototype, "relationshipUpdates", void 0), __decorate([m()], i8.prototype, "relationshipDeletes", void 0), __decorate([m()], i8.prototype, "options", void 0), i8 = __decorate([a2("esri.rest.knowledgeGraph.GraphApplyEdits")], i8);

// node_modules/@arcgis/core/layers/knowledgeGraph/layerUtils.js
var j2 = { initializeLayersFromClientData: async (e7, t7, s8) => {
  if (t7 || (t7 = [...e7.layers, ...e7.tables].map((e8) => e8.graphTypeName)), 0 === t7?.length) return;
  const o9 = /* @__PURE__ */ new Map();
  for (const a9 of t7) o9.set(a9, S3(e7, a9));
  const r7 = await le(e7.dataManager.knowledgeGraph, Array.from(o9.values()), { requestOptions: { signal: s8?.signal } });
  for (const a9 of [...e7.layers, ...e7.tables]) {
    const t8 = a9.objectType.name;
    if (null == t8) continue;
    const s9 = r7.get(S3(e7, t8));
    if (s9) {
      const e8 = JSON.parse(s9);
      null === e8 || "object" != typeof e8 || e8.hasOwnProperty("showLabels") || (e8.showLabels = false), a9.read(e8, { origin: "service" });
    }
  }
} };
var S3 = (e7, t7) => "knowledge-graph" === e7.type ? `${t7}/Map` : `${t7}/LinkChart/LinkChartSubLayer`;
async function L3(e7, t7, s8) {
  return j2.initializeLayersFromClientData(e7, t7, s8);
}
var A3 = ["#4a0932", "#b31515", "#18382e", "#a64f1b", "#102432", "#8c213f", "#ed9310", "#2c6954", "#144d59", "#ffc730", "#75351e", "#454f4b", "#78b1c2", "#191921", "#8f8f82", "#9be0c0", "#dbb658", "#87b051", "#11495c", "#c43541", "#9c5596", "#44498b", "#ad9d63", "#86afb3", "#5c98ca", "#b0bfa2", "#73241f", "#b86b53", "#d9d78c", "#3e756d", "#f260a1", "#a0d17d", "#c27c30", "#eb82eb", "#ffdf3c", "#ffb259", "#ab52b3", "#3cccb4", "#0095ba", "#d92b30"];
var M2 = "#8f8f82";
function R(t7) {
  return t7 < 0 || t7 >= A3.length ? new u4(M2) : new u4(A3[t7]);
}
function T3(e7) {
  const t7 = e7.toArray();
  return new n5({ data: { type: "CIMSymbolReference", symbol: { type: "CIMLineSymbol", symbolLayers: [{ type: "CIMSolidStroke", enable: true, style: "solid", width: 0.75, color: t7 }, { type: "CIMVectorMarker", enable: true, size: 6, markerPlacement: { type: "CIMMarkerPlacementOnLine", angleToLine: true, relativeTo: "LineMiddle" }, frame: { xmin: -10, ymin: -5, xmax: 0, ymax: 5 }, markerGraphics: [{ type: "CIMMarkerGraphic", geometry: { rings: [[[-12, -3.47], [-12, 3.6], [1.96, -0.03], [-12, -3.47]]] }, symbol: { type: "CIMPolygonSymbol", symbolLayers: [{ type: "CIMSolidFill", enable: true, color: t7 }] } }] }] } } });
}
function k2(e7) {
  let t7 = "ESRI__ID", s8 = 4;
  for (const o9 of e7) if (o9.name) {
    if ("name" === o9.name.toLowerCase()) {
      t7 = o9.name;
      break;
    }
    o9.name.toLowerCase().includes("name") ? (t7 = o9.name, s8 = 2) : "esriFieldTypeString" === o9.fieldType && s8 > 3 && (t7 = o9.name, s8 = 3);
  }
  return t7;
}
function N4(e7, t7, s8) {
  const o9 = { color: [80, 80, 80], haloColor: [255, 255, 255], haloSize: 0.7, font: { size: 10, weight: "normal" } }, r7 = new A({ labelExpressionInfo: new n6({ expression: "ESRI__ID" === s8 ? `${t7}` : `$feature.${s8}` }), labelPlacement: "above-center", symbol: new g(o9) }), a9 = new A({ labelExpressionInfo: new n6({ expression: `'${t7}' + IIf($feature.ESRI__AggregationCount>1, ' (' + $feature.ESRI__AggregationCount + ')', '')` }), labelPlacement: "center-along", labelPosition: "parallel", repeatLabel: false, symbol: new g({ ...o9, yoffset: "12px" }) });
  return "entity" === e7 ? [r7] : [a9];
}
function E6(e7, t7, s8) {
  const o9 = { color: [255, 255, 255], haloColor: [0, 0, 0], haloSize: 0.7, font: { size: 10, weight: "bold" } }, r7 = "ESRI__ID" === s8 ? `${e7}` : `$feature.${s8}`;
  return "point" === t7 ? [new A({ labelExpressionInfo: new n6({ expression: r7 }), labelPlacement: "above-center", symbol: new g(o9) })] : "polyline" === t7 ? [new A({ labelExpressionInfo: new n6({ expression: r7 }), labelPlacement: "center-along", repeatLabel: true, symbol: new g(o9) })] : "polygon" === t7 ? [new A({ labelExpressionInfo: new n6({ expression: r7 }), labelPlacement: "always-horizontal", symbol: new g(o9) })] : null;
}
var x = { capabilities: [], allowGeometryUpdates: false, serviceCapabilities: { geometryCapabilities: { supportsZValues: false, supportsMValues: false } } };
function F4(e7) {
  const { capabilities: t7, allowGeometryUpdates: s8, serviceCapabilities: { geometryCapabilities: { supportsZValues: o9, supportsMValues: r7 } } } = e7?.serviceDefinition || x, a9 = e7?.dataModel.arcgisManaged ? t7 : t7.filter((e8) => "Query" === e8), n12 = new Set(a9);
  return { analytics: { supportsCacheHint: false }, attachment: null, data: { isVersioned: false, isBranchVersioned: false, supportsAttachment: false, supportsM: r7, supportsZ: o9 }, metadata: { supportsAdvancedFieldProperties: false }, operations: { supportsCalculate: false, supportsTruncate: false, supportsValidateSql: false, supportsAdd: n12.has("Create"), supportsDelete: n12.has("Delete"), supportsEditing: n12.has("Editing"), supportsChangeTracking: false, supportsQuery: n12.has("Query"), supportsQueryBins: false, supportsQueryPivot: false, supportsQueryAnalytics: false, supportsQueryAttachments: false, supportsQueryTopFeatures: false, supportsResizeAttachments: false, supportsSync: false, supportsUpdate: n12.has("Update"), supportsExceedsLimitStatistics: false, supportsAsyncConvert3D: false }, query: t2, queryRelated: { supportsCount: false, supportsOrderBy: false, supportsPagination: false, supportsCacheHint: false }, queryTopFeatures: { supportsCacheHint: false }, queryAttributeBins: s3, editing: { supportsGeometryUpdate: !!e7?.dataModel.arcgisManaged && s8, supportsGlobalId: false, supportsReturnServiceEditsInSourceSpatialReference: false, supportsRollbackOnFailure: false, supportsUpdateWithoutM: false, supportsUploadWithItemId: false, supportsDeleteByAnonymous: false, supportsDeleteByOthers: n12.has("Delete"), supportsUpdateByAnonymous: false, supportsUpdateByOthers: n12.has("Update"), supportsAsyncApplyEdits: false, zDefault: void 0 } };
}
async function U(e7, s8) {
  const o9 = new i8(), i10 = s8.graphTypeName, l12 = s8.graphType, c6 = "knowledge-graph" === s8.parentCompositeLayer.type ? s8.geometryFieldName : null, d7 = !!s8.fieldsIndex.get(c6)?.editable, y7 = (e8) => {
    const t7 = { ...e8 };
    for (const o10 of s8.fields) o10.editable || delete t7[o10.name];
    for (const s9 of Object.keys(e8)) s9.includes("ESRI__") && delete t7[s9];
    return t7;
  }, f10 = async (e8) => {
    await N2(e8.spatialReference, f.WGS84);
    const t7 = W(e8, f.WGS84);
    if ("point" === t7.type) return t7.normalize();
    return (await P2(t7))[0];
  };
  for (const t7 of e7.addFeatures ?? []) {
    const e8 = y7(t7.attributes);
    p(t7.sourceLayer) && t7.sourceLayer.graphTypeName === i10 && ("entity" === l12 ? (o9.entityAdds || (o9.entityAdds = []), c6 && t7.geometry && (e8[c6] = await f10(t7.geometry)), o9.entityAdds.push(new p7({ properties: e8, typeName: i10 }))) : (o9.relationshipAdds || (o9.relationshipAdds = []), o9.relationshipAdds.push(new i4({ properties: e8, typeName: i10 }))));
  }
  for (const t7 of e7.updateFeatures ?? []) {
    const e8 = t7.attributes[_2], s9 = y7(t7.attributes);
    p(t7.sourceLayer) && t7.sourceLayer.graphTypeName === i10 && ("entity" === l12 ? (o9.entityUpdates || (o9.entityUpdates = []), c6 && d7 && t7.geometry && (s9[c6] = await f10(t7.geometry)), o9.entityUpdates.push(new p7({ id: e8, properties: s9, typeName: i10 }))) : (o9.relationshipUpdates || (o9.relationshipUpdates = []), o9.relationshipUpdates.push(new i4({ id: e8, properties: s9, typeName: i10 }))));
  }
  const I3 = /* @__PURE__ */ new Map();
  for (const r7 of e7.deleteFeatures ?? []) if (i3(r7)) {
    const e8 = r7, s9 = e(I3, e8.sourceLayer.graphTypeName, () => ({ typeName: e8.sourceLayer.graphTypeName, ids: [] }));
    e8.sourceLayer.graphTypeName === i10 && s9.ids.push(e8.attributes[_2]);
  } else if (r7.objectId && "string" == typeof r7.objectId) {
    e(I3, i10, () => ({ typeName: i10, ids: [] })).ids.push(r7.objectId);
  }
  for (const t7 of I3.values()) t7.ids.length > 0 && ("entity" === l12 ? (o9.entityDeletes || (o9.entityDeletes = []), o9.entityDeletes.push({ typeName: t7.typeName, ids: t7.ids })) : (o9.relationshipDeletes || (o9.relationshipDeletes = []), o9.relationshipDeletes.push({ typeName: t7.typeName, ids: t7.ids })));
  return o9;
}
function D(e7, t7) {
  const s8 = { addFeatureResults: [], updateFeatureResults: [], deleteFeatureResults: [], addAttachmentResults: [], updateAttachmentResults: [], deleteAttachmentResults: [] };
  for (const o9 of e7.editResults) if (o9.typeName === t7) {
    for (const e8 of o9.adds) s8.addFeatureResults.push({ objectId: e8.id, globalId: e8.id });
    for (const e8 of o9.updates) s8.updateFeatureResults.push({ objectId: e8.id, globalId: e8.id });
    for (const e8 of o9.deletes) s8.deleteFeatureResults.push({ objectId: e8.id, globalId: e8.id });
  }
  return s8;
}
function v2(e7) {
  if (!e7.objectType) return null;
  const t7 = [];
  for (const o9 of e7.fields) !o9.name.includes("ESRI__") && o9.editable && "geometry" !== o9.type && t7.push(new l11({ fieldName: o9.name }));
  return new F({ elements: t7 });
}
function G(e7) {
  if (!e7.objectType) return null;
  let t7 = null;
  switch (e7.geometryType) {
    case "point":
    case "multipoint":
      t7 = "point";
      break;
    case "polyline":
      t7 = "line";
      break;
    case "polygon":
      t7 = "polygon";
      break;
    default:
      t7 = null;
  }
  return [new a5({ name: e7.graphTypeName, drawingTool: t7, prototype: {} })];
}

// node_modules/@arcgis/core/graphic/isKnowledgeGraphGraphicOrigin.js
var n11 = Symbol("isKnowledgeGraphGraphicOriginSymbol");

// node_modules/@arcgis/core/graphic/KnowledgeGraphGraphicOrigin.js
var o8;
var a8 = class extends s4 {
  get [(o8 = n11, n4)]() {
    return this.sublayer;
  }
  get [n3]() {
    return this.sublayer;
  }
  get [o2]() {
    return this.sublayer;
  }
  constructor(r7, e7) {
    super(), this[o8] = true, this.type = "knowledge-graph", this.layer = r7, this.sublayer = e7;
  }
  get id() {
    return this.layer.id;
  }
};

// node_modules/@arcgis/core/graphic/isLinkChartGraphicOrigin.js
var i9 = Symbol("isLinkChartGraphicOriginSymbol");

// node_modules/@arcgis/core/graphic/LinkChartGraphicOrigin.js
var e6;
var s7 = class extends s4 {
  get [(e6 = i9, o2)]() {
    return this.layer;
  }
  constructor(r7, i10) {
    super(), this[e6] = true, this.type = "link-chart", this.layer = r7, this.sublayer = i10;
  }
  get id() {
    return `${this.layer.id}:__${this.sublayer.id}__`;
  }
};

// node_modules/@arcgis/core/layers/knowledgeGraph/KnowledgeGraphSublayerBase.js
var t6 = s5();
var p12 = (s8) => {
  const p13 = s8;
  let i10 = class extends p13 {
    constructor() {
      super(...arguments), this.fields = [], this.fieldsIndex = null;
    }
  };
  return __decorate([m(t6.fields)], i10.prototype, "fields", void 0), __decorate([m(t6.fieldsIndex)], i10.prototype, "fieldsIndex", void 0), i10 = __decorate([a2("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")], i10), i10;
};

// node_modules/@arcgis/core/layers/knowledgeGraph/KnowledgeGraphSublayer.js
function Ie(e7) {
  if (!e7.json) return e7;
  e7.json.write = Oe(e7.json.write);
  const t7 = e7.json.origins;
  if (!t7) return e7;
  let r7;
  for (r7 in t7) {
    const e8 = t7[r7];
    e8 && (e8.write = Oe(e8.write));
  }
  return e7;
}
function Oe(e7) {
  return "object" == typeof e7 && e7 ? (false !== e7.enabled && (e7.overridePolicy = Ee(e7)), e7) : true === e7 ? Se() : e7;
}
function Ee(e7) {
  const { target: t7, writer: r7, overridePolicy: i10, ...o9 } = e7;
  return function(e8, t8) {
    const r8 = xe.call(this, e8, t8);
    return r8.enabled ? { ...o9, ...r8 } : r8;
  };
}
function Se() {
  return { overridePolicy: xe };
}
function xe(e7, t7) {
  const r7 = !!this.geometryType;
  let i10 = { enabled: r7 };
  return r7 && (i10 = { ...i10, ...Le.call(this, e7, t7) }), i10;
}
function Le(e7, t7) {
  return { ignoreOrigin: this.originIdOf(t7) > 0 };
}
var Ne = class extends p12(a3(f5(c(p2(p6(l5(t(f2(l(b3)))))))))) {
  constructor(e7) {
    super(e7), this.blendMode = "normal", this.charts = null, this.definitionExpression = null, this.displayFilterEnabled = true, this.displayFilterInfo = null, this.effect = null, this.elevationInfo = null, this.featureEffect = null, this.graphType = null, this.labelsVisible = true, this.layerType = null, this.legendEnabled = true, this.maxScale = 0, this.minScale = 0, this.objectIdField = _2, this.objectType = null, this.opacity = 1, this.orderBy = null, this.parent = null, this.parentCompositeLayer = null, this.persistenceEnabled = true, this.popupEnabled = true, this.popupTemplate = null, this.refreshInterval = 0, this.source = { openPorts: () => this.load().then(() => {
      const e8 = new MessageChannel();
      return new E(e8.port1, { channel: e8, client: { queryFeatures: (e9, t7 = {}) => {
        const r7 = b2.fromJSON(e9);
        return this.queryFeaturesJSON(r7, t7);
      } } }), [e8.port2];
    }) }, this.type = "knowledge-graph-sublayer", this.useViewTime = true, this.visible = true;
  }
  get capabilities() {
    return this.parent ? this.parent.sublayerCapabilities : F4(null);
  }
  get userHasUpdateItemPrivileges() {
    return !!this.parent?.userHasUpdateItemPrivileges;
  }
  get editingEnabled() {
    return this._isOverridden("editingEnabled") ? this._get("editingEnabled") : this.capabilities.operations.supportsEditing;
  }
  set editingEnabled(e7) {
    this._overrideIfSome("editingEnabled", e7);
  }
  get isTable() {
    return "link-chart" !== this.parentCompositeLayer.type && null == this.geometryFieldName;
  }
  get defaultPopupTemplate() {
    return this.createPopupTemplate();
  }
  set featureReduction(e7) {
    const t7 = this._normalizeFeatureReduction(e7);
    this._set("featureReduction", t7);
  }
  get fields() {
    const e7 = [];
    return this.objectType?.properties?.forEach((t7) => {
      const r7 = "esriFieldTypeOID" === t7.fieldType ? "esriFieldTypeInteger" : t7.fieldType;
      e7.push(m2.fromJSON({ name: t7.name, type: r7, alias: t7.alias, defaultValue: t7.defaultValue, editable: t7.editable, nullable: t7.nullable }));
    }), e7.push(m2.fromJSON({ name: this.objectIdField, type: "esriFieldTypeString", alias: this.objectIdField, editable: false }), m2.fromJSON({ name: o3, type: "esriFieldTypeInteger", alias: o3, editable: false }), m2.fromJSON({ name: E2, type: "esriFieldTypeInteger", alias: E2, editable: false })), e7;
  }
  get formTemplate() {
    return this._isOverridden("formTemplate") ? this._get("formTemplate") : v2(this);
  }
  set formTemplate(e7) {
    this._overrideIfSome("formTemplate", e7);
  }
  get geometryType() {
    if ("link-chart" === this.parentCompositeLayer?.type) return "relationship" === this.graphType ? "polyline" : "point";
    const e7 = this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name), t7 = e7?.geometryType;
    return t7 && "esriGeometryNull" !== t7 ? y2.fromJSON(t7) : null;
  }
  get geometryFieldName() {
    if ("link-chart" === this.parentCompositeLayer?.type) return S;
    const e7 = this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name);
    return e7?.name ?? null;
  }
  get graphicOrigin() {
    if (!this.parent) return null;
    switch (this.parent.type) {
      case "knowledge-graph":
        return new a8(this.parent, this);
      case "link-chart":
        return new s7(this.parent, this);
    }
  }
  get graphTypeName() {
    return this.objectType?.name;
  }
  set graphTypeName(e7) {
    this._set("graphTypeName", e7);
  }
  get hasM() {
    const e7 = this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name), t7 = e7?.name, r7 = t7 ? this.objectType?.properties?.[t7] : null;
    return r7?.hasM ?? false;
  }
  get hasZ() {
    const e7 = this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name), t7 = e7?.name, r7 = t7 ? this.objectType?.properties?.[t7] : null;
    return r7?.hasZ ?? false;
  }
  set labelingInfo(e7) {
    this._set("labelingInfo", e7);
  }
  get labelingInfo() {
    if (this._isOverridden("labelingInfo")) return this._get("labelingInfo");
    if (!this.objectType || !this.parentCompositeLayer || !this.graphTypeName) return null;
    const e7 = this.objectType.properties ? k2(this.objectType.properties) : "ESRI__ID";
    return "link-chart" === this.parentCompositeLayer.type ? N4(this.graphType, this.graphTypeName, e7) : E6(this.graphTypeName, this.geometryType, e7);
  }
  set renderer(e7) {
    y3(e7, this.fieldsIndex), this._set("renderer", e7);
  }
  get renderer() {
    if (this._isOverridden("renderer")) return this._get("renderer");
    const e7 = this.parentCompositeLayer?.dataManager?.knowledgeGraph?.dataModel, t7 = [...e7?.entityTypes ?? [], ...e7?.relationshipTypes ?? []].map((e8) => e8.name).indexOf(this.graphTypeName), r7 = R(t7);
    if ("link-chart" === this.parentCompositeLayer?.type) {
      if ("relationship" === this.graphType) return new p5({ type: "simple", symbol: T3(r7) });
      const e8 = t3(u3(y2.toJSON("point")).renderer);
      return L(e8.symbol, r7), e8;
    }
    const i10 = t3(u3(y2.toJSON(this.geometryType)).renderer);
    return L(i10.symbol, r7), i10;
  }
  get spatialReference() {
    return this.parentCompositeLayer?.dataManager?.knowledgeGraph?.dataModel?.spatialReference ?? f.WGS84;
  }
  get templates() {
    return this._isOverridden("templates") ? this._get("templates") : G(this);
  }
  set templates(e7) {
    this._overrideIfSome("templates", e7);
  }
  set timeInfo(e7) {
    this._set("timeInfo", e7);
  }
  get title() {
    return this._isOverridden("title") ? this._get("title") : this.graphTypeName;
  }
  set title(e7) {
    this._set("title", e7);
  }
  writeTitle(e7, t7) {
    t7.title = e7 ?? "Layer";
  }
  createPopupTemplate(e7) {
    return d(this, e7);
  }
  createQuery() {
    return new b2({ where: "1=1", outFields: ["*"] });
  }
  getField(e7) {
    return this.fieldsIndex.get(e7);
  }
  getFieldDomain(e7, t7) {
    return null;
  }
  async queryFeatures(e7, t7) {
    await this.load();
    const { resolvedQuery: r7, queryEngine: i10 } = await this._setupQueryObjects(e7), o9 = this.graphicOrigin, s8 = g2.fromJSON(await i10.executeQuery(r7.toJSON(), t7?.signal));
    return s8.features.forEach((e8) => {
      e8.sourceLayer = this, e8.origin = o9;
    }), s8;
  }
  async queryFeaturesJSON(e7, t7) {
    await this.load();
    const { resolvedQuery: r7, queryEngine: i10 } = await this._setupQueryObjects(e7);
    return await i10.executeQuery(r7.toJSON(), t7?.signal);
  }
  async queryFeatureCount(e7, t7) {
    await this.load();
    const { resolvedQuery: r7, queryEngine: i10 } = await this._setupQueryObjects(e7);
    return i10.executeQueryForCount(r7.toJSON(), t7?.signal);
  }
  async queryExtent(e7 = {}, t7) {
    await this.load();
    const r7 = { ...e7, returnGeometry: true }, { resolvedQuery: i10, queryEngine: o9 } = await this._setupQueryObjects(r7), s8 = await o9.executeQueryForExtent(i10.toJSON(), t7?.signal);
    let n12;
    return n12 = null != s8.extent?.xmin && null != s8.extent?.xmax && null != s8.extent?.ymin && null != s8.extent?.ymax ? new z(s8.extent) : new z(), { count: s8.count, extent: n12 };
  }
  async queryObjectIds(e7, t7) {
    await this.load();
    const r7 = b2.from(e7);
    let i10;
    if ("link-chart" === this.parentCompositeLayer.type && this._cachedQueryEngine) i10 = this._cachedQueryEngine;
    else {
      const e8 = await this.parentCompositeLayer.dataManager.getData(r7, this, t7);
      i10 = this.loadQueryEngine(e8);
    }
    return await i10.executeQueryForIds(r7.toJSON(), t7?.signal);
  }
  async applyEdits(e7) {
    if (!this.parentCompositeLayer.dataManager.knowledgeGraph) throw new s("knowledge-graph-sublayer:no-knowledge-graph", "ApplyEdits cannot be executed because the parent does not have a Knowledge Graph model.  This is usually caused by the layer not yet being loaded");
    const t7 = await U(e7, this);
    t7.options = { cascadeDelete: true, cascadeProvenanceDelete: !!this.parent?.knowledgeGraph.serviceDefinition.supportsProvenance || void 0 };
    const i10 = await V(this.parentCompositeLayer.dataManager.knowledgeGraph, t7), o9 = D(i10, this.graphTypeName), s8 = { addedFeatures: o9.addFeatureResults, updatedFeatures: o9.updateFeatureResults, deletedFeatures: o9.deleteFeatureResults, addedAttachments: o9.addAttachmentResults, deletedAttachments: o9.deleteAttachmentResults, updatedAttachments: o9.updateAttachmentResults, exceededTransferLimit: false, historicMoment: /* @__PURE__ */ new Date(), edits: void 0 };
    return this.emit("edits", s8), this.emit("apply-edits", { result: Promise.resolve(s8) }), "link-chart" === this.parentCompositeLayer.type && await this.parentCompositeLayer.refreshLinkChartCache([...s8.addedFeatures.map((e8) => e8.globalId), ...s8.updatedFeatures.map((e8) => e8.globalId), ...s8.deletedFeatures.map((e8) => e8.globalId)]), o9;
  }
  loadQueryEngine(e7) {
    const t7 = new f4({ geometryType: y2.toJSON(this.geometryType), hasM: this.hasM, hasZ: this.hasZ }), r7 = new W2({ fieldsIndex: this.fieldsIndex.toJSON(), geometryType: y2.toJSON(this.geometryType), hasM: this.hasM, hasZ: this.hasZ, featureIdInfo: { type: "object-id", fieldName: this.objectIdField }, spatialReference: this.spatialReference.toJSON(), timeInfo: this.timeInfo?.toJSON(), featureStore: t7 });
    return r7.featureStore.addMany(e7), r7;
  }
  async refreshCachedQueryEngine() {
    const e7 = await this.parentCompositeLayer.dataManager.getData(new b2({ where: "1=1", outFields: [_2] }), this);
    this._cachedQueryEngine = this.loadQueryEngine(e7);
  }
  load(e7) {
    return this.addResolvingPromise(this.parent.load(e7).then(() => F2(this.timeInfo, this.fieldsIndex))), Promise.resolve(this);
  }
  async _setupQueryObjects(e7, t7) {
    const r7 = b2.from(e7), i10 = r7.geometry;
    if (i10 && !i10.spatialReference?.isWGS84 && (await N2(i10.spatialReference, N), r7.geometry = W(i10 instanceof P || i10 instanceof y || i10 instanceof _ ? i10 : i10.extent, N)), "link-chart" === this.parentCompositeLayer.type && this._cachedQueryEngine) return { resolvedQuery: r7, queryEngine: this._cachedQueryEngine };
    const o9 = await this.parentCompositeLayer.dataManager.getData(r7, this, t7);
    return { resolvedQuery: r7, queryEngine: this.loadQueryEngine(o9) };
  }
};
function _e(e7, t7, r7) {
  const i10 = [["ESRI__AGGREGATION_COUNT", o3], ["ESRI__ORIGIN_ID", I], ["ESRI__DESTINATION_ID", t4], ["ESRI__LAYOUT_GEOMETRY", S]];
  try {
    for (const t8 of e7) for (const [e8, r8] of i10) t8.labelExpression = t8.labelExpression?.replaceAll(e8, r8), t8.labelExpressionInfo?.expression && (t8.labelExpressionInfo.expression = t8.labelExpressionInfo.expression.replaceAll(e8, r8));
  } catch (s8) {
    i.getLogger(this).warn("Error updating labelingInfo", s8);
  }
  return l6(e7, t7, r7);
}
__decorate([m(Ie(a(n2)))], Ne.prototype, "blendMode", void 0), __decorate([m({ readOnly: true })], Ne.prototype, "capabilities", null), __decorate([m({ readOnly: true })], Ne.prototype, "userHasUpdateItemPrivileges", null), __decorate([m({ type: Boolean })], Ne.prototype, "editingEnabled", null), __decorate([m()], Ne.prototype, "isTable", null), __decorate([m({ json: { origins: { "web-scene": { write: false } }, write: Se() } })], Ne.prototype, "charts", void 0), __decorate([m({ readOnly: true })], Ne.prototype, "defaultPopupTemplate", null), __decorate([m({ type: String, json: { origins: { service: { read: false } }, name: "layerDefinition.definitionExpression", write: { ignoreOrigin: true } } })], Ne.prototype, "definitionExpression", void 0), __decorate([m(Ie(a(p3)))], Ne.prototype, "displayFilterEnabled", void 0), __decorate([m(Ie(a(l4)))], Ne.prototype, "displayFilterInfo", void 0), __decorate([m(Ie(a(l2)))], Ne.prototype, "effect", void 0), __decorate([m()], Ne.prototype, "elevationInfo", void 0), __decorate([m(Ie(a(p4)))], Ne.prototype, "featureEffect", void 0), __decorate([m(Ie(a(a4)))], Ne.prototype, "featureReduction", null), __decorate([m()], Ne.prototype, "fields", null), __decorate([m()], Ne.prototype, "formTemplate", null), __decorate([m()], Ne.prototype, "geometryType", null), __decorate([m()], Ne.prototype, "geometryFieldName", null), __decorate([m({ readOnly: true })], Ne.prototype, "graphicOrigin", null), __decorate([m({ type: ["entity", "relationship"], nonNullable: true, json: { write: { isRequired: true, ignoreOrigin: true } } })], Ne.prototype, "graphType", void 0), __decorate([m({ type: String, nonNullable: true, json: { write: { isRequired: true, ignoreOrigin: true } } })], Ne.prototype, "graphTypeName", null), __decorate([m()], Ne.prototype, "hasM", null), __decorate([m()], Ne.prototype, "hasZ", null), __decorate([m({ type: String, json: { origins: { service: { read: false }, "portal-item": { read: false } }, write: { ignoreOrigin: true } } })], Ne.prototype, "id", void 0), __decorate([m({ type: Boolean, value: true, nonNullable: true, json: { name: "showLabels", default: false, write: { overridePolicy() {
  return { enabled: !!this.geometryType, alwaysWriteDefaults: true, ignoreOrigin: true };
} } } })], Ne.prototype, "labelsVisible", void 0), __decorate([m({ type: [A], json: { name: "layerDefinition.drawingInfo.labelingInfo", read: _e, write: Se() } })], Ne.prototype, "labelingInfo", null), __decorate([m({ readOnly: true, json: { read: false, write: { writer(e7, t7) {
  switch (this.parentCompositeLayer?.type) {
    case "link-chart":
      t7.layerType = "LinkChartSubLayer";
      break;
    case "knowledge-graph":
      t7.layerType = this.geometryType ? "KnowledgeGraphSubLayer" : "KnowledgeGraphSubTable";
  }
}, isRequired: true, ignoreOrigin: true, writerEnsuresNonNull: true } } })], Ne.prototype, "layerType", void 0), __decorate([m(Ie(a(d2)))], Ne.prototype, "legendEnabled", void 0), __decorate([m(Ie(a(v)))], Ne.prototype, "maxScale", void 0), __decorate([m(Ie(a(j)))], Ne.prototype, "minScale", void 0), __decorate([m()], Ne.prototype, "objectIdField", void 0), __decorate([m()], Ne.prototype, "objectType", void 0), __decorate([m(Ie(a(w)))], Ne.prototype, "opacity", void 0), __decorate([m(Ie(a(c2)))], Ne.prototype, "orderBy", void 0), __decorate([m({ clonable: false })], Ne.prototype, "parent", void 0), __decorate([m()], Ne.prototype, "parentCompositeLayer", void 0), __decorate([m(Ie(a(l7)))], Ne.prototype, "popupEnabled", void 0), __decorate([m({ type: q, json: { name: "popupInfo", write: { ignoreOrigin: true } } })], Ne.prototype, "popupTemplate", void 0), __decorate([m({ type: Number, json: { write: { overridePolicy: Le } } })], Ne.prototype, "refreshInterval", void 0), __decorate([m({ types: m3, json: { name: "layerDefinition.drawingInfo.renderer", write: Se() } })], Ne.prototype, "renderer", null), __decorate([m()], Ne.prototype, "source", void 0), __decorate([m()], Ne.prototype, "spatialReference", null), __decorate([m()], Ne.prototype, "templates", null), __decorate([m({ type: u5, json: { name: "layerDefinition.timeInfo", write: { overridePolicy: Le }, origins: { "web-document": { name: "layerDefinition.timeInfo", read: true, write: { overridePolicy: Le } }, "portal-item": { name: "layerDefinition.timeInfo", read: true, write: { overridePolicy: Le } } } } })], Ne.prototype, "timeInfo", null), __decorate([m({ type: String, json: { write: { isRequired: true, ignoreOrigin: true, writerEnsuresNonNull: true } } })], Ne.prototype, "title", null), __decorate([r("title")], Ne.prototype, "writeTitle", null), __decorate([m({ json: { read: false } })], Ne.prototype, "type", void 0), __decorate([m(Ie(a(f6)))], Ne.prototype, "useViewTime", void 0), __decorate([m({ type: Boolean, json: { name: "visibility", write: Se() } })], Ne.prototype, "visible", void 0), Ne = __decorate([a2("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")], Ne);

export {
  f8 as f,
  w2 as w,
  I2 as I,
  o5 as o,
  r4 as r,
  p10 as p,
  f9 as f2,
  A2 as A,
  P3 as P,
  L2 as L,
  d4 as d,
  b5 as b,
  g4 as g,
  C,
  N3 as N,
  L3 as L2,
  F4 as F,
  Ne
};
//# sourceMappingURL=chunk-6KSX5BD3.js.map
