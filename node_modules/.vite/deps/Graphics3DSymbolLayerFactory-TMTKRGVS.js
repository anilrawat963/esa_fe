import {
  I as I2,
  u as u21
} from "./chunk-72GWFJ3X.js";
import {
  x as x5
} from "./chunk-HBX3TMAJ.js";
import {
  C as C4
} from "./chunk-A4SBCIY6.js";
import "./chunk-4FWFNZMT.js";
import {
  C as C3,
  O as O2,
  O2 as O3,
  a as a19,
  c as c14,
  d2 as d8,
  d3 as d9,
  e as e24,
  e2 as e25,
  f as f11,
  f2 as f12,
  g as g5,
  g2 as g6,
  m2 as m13,
  o as o19,
  p as p8,
  s as s18,
  t as t21,
  t2 as t22,
  t3 as t23,
  u as u18,
  u2 as u19,
  u3 as u20,
  w as w5
} from "./chunk-OOMAOGYV.js";
import {
  B as B3,
  c as c13,
  h as h8,
  i as i16,
  m as m12,
  n as n19,
  o as o18,
  p as p7,
  r as r15,
  r2 as r17,
  s as s17,
  u as u16,
  v as v4
} from "./chunk-Z4LDNBNJ.js";
import "./chunk-EXLKWVG4.js";
import {
  J as J3,
  W,
  c as c12,
  d2 as d7,
  f2 as f10,
  l as l13,
  l2 as l14,
  m as m11,
  n2 as n18,
  r as r16,
  u as u17,
  x as x4
} from "./chunk-Q4G6BRR7.js";
import "./chunk-RGS3EXFB.js";
import {
  j as j7
} from "./chunk-TENXU33S.js";
import {
  d as d10
} from "./chunk-EYXTXCXP.js";
import "./chunk-2NWCGDTW.js";
import "./chunk-XT4FPCQ7.js";
import "./chunk-MGOPGTLA.js";
import "./chunk-RA5BGY5F.js";
import "./chunk-FCCU7SSP.js";
import "./chunk-ZP5CSWYG.js";
import "./chunk-BLCKE43G.js";
import "./chunk-TCP5RDVE.js";
import "./chunk-4R2LU43U.js";
import "./chunk-7LPDSYJP.js";
import {
  d as d6
} from "./chunk-BTFBYI67.js";
import "./chunk-D3G5WIRR.js";
import {
  f as f9
} from "./chunk-Q3JOE7TC.js";
import {
  s as s16,
  z as z3
} from "./chunk-RD6XCD2X.js";
import "./chunk-O53GWXXZ.js";
import {
  e as e23,
  l as l12,
  s as s15
} from "./chunk-D6KKUGCT.js";
import {
  a as a10,
  e as e19,
  i as i12,
  l as l8,
  m as m6,
  n as n12,
  r as r10,
  s as s11,
  u as u12
} from "./chunk-KGQOTLJQ.js";
import {
  S as S2,
  a as a12,
  c as c8,
  l as l9,
  m as m8,
  o as o12
} from "./chunk-LBWWJ76V.js";
import {
  A as A4,
  D as D2,
  E as E4,
  G as G2,
  Z as Z2,
  at,
  dt,
  f as f7,
  ie,
  k as k5,
  n as n13,
  w as w4
} from "./chunk-KDOWKZ3H.js";
import {
  a as a11,
  c as c6,
  o as o11,
  s as s12,
  u as u13
} from "./chunk-NH6F2I5R.js";
import "./chunk-6WSJV2UJ.js";
import "./chunk-EC56NYYL.js";
import {
  A as A6,
  F as F4,
  P as P5,
  o as o15,
  u as u15
} from "./chunk-3RNQTFH6.js";
import {
  M as M4,
  U as U3,
  a2 as a14,
  a3 as a15,
  a4 as a16,
  a5 as a17,
  b as b6,
  c as c7,
  c2 as c10,
  d as d5,
  e2 as e20,
  e3 as e22,
  f as f8,
  h3 as h7,
  i2 as i13,
  i3 as i14,
  i4 as i15,
  j as j6,
  l as l11,
  m as m7,
  m2 as m9,
  n as n16,
  p as p6,
  s as s13,
  s2 as s14,
  t as t17,
  u as u14,
  x as x3
} from "./chunk-VIIQX37N.js";
import "./chunk-BRGWF4BT.js";
import {
  M as M3,
  r as r11
} from "./chunk-UR6CZJPX.js";
import "./chunk-JS3I6GIR.js";
import {
  r as r14
} from "./chunk-QTS3W27E.js";
import "./chunk-3RABUJDL.js";
import "./chunk-IFKJBQCK.js";
import "./chunk-V5R3CDPU.js";
import "./chunk-6GZZL5MR.js";
import "./chunk-HZVRMY4D.js";
import "./chunk-YTJAN3CY.js";
import {
  n as n17,
  o as o16,
  t as t18
} from "./chunk-T6CRNJ3D.js";
import "./chunk-Z4KE5G4E.js";
import {
  l as l10,
  n as n15
} from "./chunk-KEMYAF6M.js";
import {
  g as g4,
  m as m10,
  t as t16,
  t2 as t20,
  tt as tt2
} from "./chunk-CYVJEU2B.js";
import "./chunk-7YJLACUB.js";
import "./chunk-HETHJJO6.js";
import "./chunk-KOVWXXQR.js";
import "./chunk-ECKVUXN3.js";
import "./chunk-CHC4AAHW.js";
import "./chunk-S2SKSSUG.js";
import {
  T as T3,
  _ as _5,
  c as c9,
  d as d4,
  o as o14,
  r as r13
} from "./chunk-FDSAQJ3R.js";
import "./chunk-KDGDF37U.js";
import {
  a as a13,
  b as b5,
  n as n14,
  o as o13,
  r as r12,
  t as t14,
  t2 as t15,
  x as x2
} from "./chunk-I4DSU5MJ.js";
import "./chunk-66AADZ63.js";
import "./chunk-6HNBANDZ.js";
import "./chunk-MCWHCMX6.js";
import "./chunk-SESXYKK5.js";
import "./chunk-HAR63DI2.js";
import "./chunk-A3JORY5L.js";
import "./chunk-JNASI2YX.js";
import "./chunk-P355ISZZ.js";
import {
  a as a18
} from "./chunk-FCDWKXLA.js";
import "./chunk-AUP2E2QB.js";
import "./chunk-NDWECAKM.js";
import "./chunk-KTMKDXZP.js";
import {
  G as G3,
  K as K3,
  Q as Q2,
  Z as Z3,
  e as e21,
  ot as ot2,
  t as t13,
  t2 as t19,
  tt
} from "./chunk-F43BIMML.js";
import "./chunk-CT7HOWYG.js";
import "./chunk-CW4AXF3Q.js";
import {
  o2 as o17
} from "./chunk-BZBDEPRV.js";
import "./chunk-MXP2VO3L.js";
import "./chunk-OWSUTT7E.js";
import "./chunk-WNQORCSA.js";
import "./chunk-CIIRREHX.js";
import "./chunk-COMSADUT.js";
import "./chunk-66Y6I5GR.js";
import "./chunk-U5J3MCMX.js";
import "./chunk-D7KJNSAT.js";
import "./chunk-BZV32YR7.js";
import "./chunk-IT62DCG6.js";
import "./chunk-SZ5DGQ75.js";
import "./chunk-3PAAA3FK.js";
import "./chunk-EGPAQBOO.js";
import "./chunk-W6L6ZQPE.js";
import "./chunk-6GHQTYW5.js";
import "./chunk-WJ3E33GQ.js";
import "./chunk-YOYO2XMY.js";
import "./chunk-SZTZNZQW.js";
import "./chunk-AJG2ZYEA.js";
import "./chunk-CFXCM2NO.js";
import {
  n as n11
} from "./chunk-66YWWCGN.js";
import {
  n as n10
} from "./chunk-B3BLJNSM.js";
import "./chunk-ALKEERWI.js";
import "./chunk-F75XORHS.js";
import {
  s as s10,
  t as t12
} from "./chunk-ME5HHRVQ.js";
import {
  S
} from "./chunk-ZP6KSK4N.js";
import "./chunk-6KSMNSLR.js";
import {
  B as B2,
  M as M2,
  b as b4,
  v as v3
} from "./chunk-JBTWCDRR.js";
import {
  D,
  H,
  P as P4,
  R as R3,
  k as k4
} from "./chunk-U6CJFTOF.js";
import {
  Y
} from "./chunk-DRHU543D.js";
import "./chunk-F7RQDGE7.js";
import "./chunk-GG4AQJJO.js";
import {
  c as c4,
  i as i9
} from "./chunk-OGWYK5MD.js";
import "./chunk-U5TTP5E5.js";
import "./chunk-QENBEP2X.js";
import "./chunk-VZQ643XD.js";
import "./chunk-SMJWJAIA.js";
import {
  h as h5,
  i as i11
} from "./chunk-C7T2CCN3.js";
import {
  e as e18
} from "./chunk-M5JMVUW2.js";
import {
  K as K2,
  U as U2,
  X,
  j2 as j5,
  k as k3,
  m as m5,
  w as w3,
  z as z2
} from "./chunk-2JMKFI2D.js";
import "./chunk-QYAMBIRP.js";
import "./chunk-WBXDB33U.js";
import {
  h as h3
} from "./chunk-NH6FXYCM.js";
import {
  n as n9
} from "./chunk-YE4E5JCT.js";
import "./chunk-SXZO7ULH.js";
import "./chunk-Q5ATDQWC.js";
import {
  h as h4
} from "./chunk-QL52LNOM.js";
import "./chunk-NAJIRKWY.js";
import {
  p as p5,
  u as u11
} from "./chunk-7EFQIJSP.js";
import "./chunk-YJPRACXY.js";
import {
  t as t11
} from "./chunk-KBVQCWWY.js";
import "./chunk-GVMCGYZ6.js";
import "./chunk-JHV6OBEB.js";
import {
  g as g3,
  j as j4
} from "./chunk-IR5QDMME.js";
import "./chunk-O5UBEIJA.js";
import "./chunk-FNMK6NUG.js";
import {
  i as i10,
  y as y3
} from "./chunk-QTRET3PG.js";
import "./chunk-FMOL5XMB.js";
import "./chunk-VNSHGTPN.js";
import "./chunk-OEBAFVQK.js";
import {
  c as c3,
  e as e17,
  t as t8,
  u as u9
} from "./chunk-XPA3C4DZ.js";
import {
  Q,
  e as e16,
  n as n8,
  t as t7
} from "./chunk-2AOVWXAQ.js";
import {
  n as n7
} from "./chunk-ALR6N4CF.js";
import "./chunk-4X4BOGIG.js";
import "./chunk-Y4O7HJXV.js";
import "./chunk-7QPS6ATI.js";
import {
  A as A3,
  U,
  a as a9,
  e as e15,
  f as f5
} from "./chunk-YYXR3KOD.js";
import {
  $,
  B,
  F as F3,
  R as R2,
  v as v2,
  w as w2
} from "./chunk-274P3DJ3.js";
import "./chunk-2WMZLC2C.js";
import {
  r as r9
} from "./chunk-HHDWMGJ3.js";
import {
  i as i8
} from "./chunk-WHHIH5YU.js";
import {
  f as f6
} from "./chunk-MEDXVTKR.js";
import "./chunk-5LMH6D7V.js";
import {
  o as o9,
  t as t9
} from "./chunk-BZLHV37L.js";
import "./chunk-V6V3WWJF.js";
import {
  T as T2,
  d as d2,
  t as t5
} from "./chunk-NDFIZYZY.js";
import {
  m as m4,
  s as s9
} from "./chunk-TLTSPUO7.js";
import "./chunk-EK7HOTRR.js";
import {
  e as e13,
  t as t4
} from "./chunk-MBQEPUQX.js";
import {
  a as a7,
  e as e12,
  i as i7,
  n as n5,
  r as r6,
  s as s6,
  t as t3
} from "./chunk-ZVTEFYZX.js";
import {
  E as E2,
  a as a6,
  m as m3,
  s as s5
} from "./chunk-LPUPM55U.js";
import "./chunk-EKZRA6TO.js";
import "./chunk-M5SP6ZBM.js";
import {
  Z
} from "./chunk-2HGIYEIL.js";
import "./chunk-GCI4MA3M.js";
import {
  i as i6
} from "./chunk-SJ2OBYX2.js";
import "./chunk-MDJNYPVI.js";
import "./chunk-Z6VKIQV2.js";
import "./chunk-4PXNA4MD.js";
import {
  c as c11
} from "./chunk-T3SYSTKO.js";
import {
  A as A5,
  R as R4,
  h as h6
} from "./chunk-U55FA2EK.js";
import "./chunk-GBN36VHC.js";
import "./chunk-B5A4L35M.js";
import "./chunk-52SEOH5H.js";
import "./chunk-UYMV6HXW.js";
import "./chunk-JE2NJSBU.js";
import "./chunk-WCWUUHUV.js";
import "./chunk-7HTU7ZUX.js";
import {
  _ as _4
} from "./chunk-QNVJVDYZ.js";
import {
  a as a8,
  l as l5,
  n as n6,
  o as o8,
  r as r8,
  s as s8,
  t as t6
} from "./chunk-WDTGOP77.js";
import {
  A as A2,
  E as E3,
  J as J2,
  N as N2,
  P as P3,
  R,
  _ as _3,
  c as c2,
  e as e14,
  g as g2,
  o as o7,
  p as p3,
  q as q4,
  r as r7,
  s as s7,
  u as u8,
  y as y2
} from "./chunk-VYMBX5H5.js";
import {
  F as F2,
  f as f4,
  o as o6
} from "./chunk-XDLV73DB.js";
import "./chunk-ARTU4L55.js";
import "./chunk-6VL5D5UP.js";
import "./chunk-6QHY54HZ.js";
import "./chunk-GXJJY3ND.js";
import "./chunk-5ONGWFJ3.js";
import "./chunk-PLNHHGHL.js";
import "./chunk-EM7Y2JZC.js";
import "./chunk-Q5KWD3VQ.js";
import "./chunk-BUQC3CLV.js";
import "./chunk-XTZAIV4X.js";
import "./chunk-63LDVRFI.js";
import "./chunk-C3FRY5U4.js";
import "./chunk-JNJX34GB.js";
import "./chunk-3STJRSDT.js";
import "./chunk-67Q6KVC6.js";
import {
  d3,
  j as j3,
  l as l6,
  l3 as l7,
  o as o10,
  p2 as p4
} from "./chunk-23NJHA5Q.js";
import {
  c as c5,
  t as t10
} from "./chunk-4LA6K4VI.js";
import "./chunk-KEZCWFAR.js";
import "./chunk-JZUJ34RR.js";
import "./chunk-PMGS7UDU.js";
import "./chunk-3GHCGAH2.js";
import {
  A,
  C as C2,
  F,
  G,
  M,
  V,
  a as a5,
  b as b3,
  k as k2,
  l as l4,
  m as m2,
  o as o4,
  p as p2,
  q as q3,
  s as s4,
  u as u7,
  w,
  x
} from "./chunk-HWUOAPTX.js";
import {
  e as e11,
  i as i5,
  o as o3
} from "./chunk-QHCKOBU7.js";
import {
  e as e10,
  r as r5,
  t as t2
} from "./chunk-K2OZ6WVC.js";
import "./chunk-MC6NAKKX.js";
import "./chunk-TF6255HN.js";
import "./chunk-GD4FJL3C.js";
import "./chunk-C5OQVQZF.js";
import "./chunk-F7DKSAOI.js";
import "./chunk-4SOQWNPG.js";
import "./chunk-LTULADK2.js";
import "./chunk-35ST7YRB.js";
import "./chunk-EDA5QFHZ.js";
import "./chunk-CNYNCKEV.js";
import {
  _,
  d
} from "./chunk-XL5QPCXN.js";
import {
  J
} from "./chunk-2LC2762W.js";
import "./chunk-W6HOAVT4.js";
import {
  g,
  o as o5
} from "./chunk-DTZUXJMD.js";
import "./chunk-YLAGKT2D.js";
import "./chunk-6YRQYUCY.js";
import "./chunk-P6IKJIMO.js";
import "./chunk-MHV23XAQ.js";
import "./chunk-V2X4OKYI.js";
import "./chunk-LPZUGJNG.js";
import {
  I,
  c,
  e as e7,
  f as f3,
  h as h2,
  i as i4,
  n as n3,
  o,
  p,
  q
} from "./chunk-XLOINTMG.js";
import "./chunk-MA3QDRC3.js";
import "./chunk-W6J7XCPU.js";
import "./chunk-ONXWBTTM.js";
import "./chunk-T7F6Q6JJ.js";
import "./chunk-YDTPM7OQ.js";
import {
  _ as _2,
  a as a4,
  e as e5,
  n as n2,
  r as r3,
  u as u4
} from "./chunk-75XOUSSS.js";
import "./chunk-TH4EQWJJ.js";
import "./chunk-7P2ANHQ3.js";
import "./chunk-XCKT47LJ.js";
import "./chunk-3FUHCAX3.js";
import {
  P as P2
} from "./chunk-PZ5RULLK.js";
import "./chunk-OPJX4KXH.js";
import {
  j as j2,
  n as n4
} from "./chunk-LTPHDYPK.js";
import {
  e as e9
} from "./chunk-3OVERDFX.js";
import {
  K,
  f as f2,
  i as i3
} from "./chunk-FPMLKIDB.js";
import {
  P,
  e as e8,
  j,
  l as l3,
  o as o2,
  q as q2,
  r as r4,
  u as u6,
  v
} from "./chunk-AZXJIEZ6.js";
import {
  e as e6,
  u as u5
} from "./chunk-Q75WYS7K.js";
import {
  z
} from "./chunk-H74Q4SYB.js";
import "./chunk-2OFHDVO5.js";
import {
  i as i2
} from "./chunk-TFJXG32O.js";
import "./chunk-DDOCCRD4.js";
import "./chunk-5UPBUJPC.js";
import "./chunk-THQO67BJ.js";
import "./chunk-4YDOPHTZ.js";
import "./chunk-YY5PITIH.js";
import {
  u as u10
} from "./chunk-CCQFL76O.js";
import {
  e as e4,
  u as u3,
  y
} from "./chunk-CSMCPN64.js";
import {
  k
} from "./chunk-GY6YF4EN.js";
import "./chunk-7H3U4IJR.js";
import {
  b as b2,
  h,
  r as r2,
  s as s3
} from "./chunk-SMWUT52Z.js";
import "./chunk-AXZMNHTN.js";
import "./chunk-5T3MJDSR.js";
import {
  E,
  O,
  T,
  ae,
  ne
} from "./chunk-NMQNUPE4.js";
import "./chunk-6KIXN4DJ.js";
import "./chunk-7DGJB37R.js";
import "./chunk-234CIOHE.js";
import {
  ot
} from "./chunk-V2H77UEV.js";
import "./chunk-WRA2WBYC.js";
import "./chunk-XWE6BM2U.js";
import "./chunk-SOIZOFSB.js";
import "./chunk-XXLHAM2M.js";
import {
  b,
  e4 as e3,
  m
} from "./chunk-5EI5H4QX.js";
import {
  a2
} from "./chunk-ZIE53VIV.js";
import {
  __decorate
} from "./chunk-SS5CLIUY.js";
import "./chunk-R54Q5TGA.js";
import "./chunk-6SSZNBOK.js";
import "./chunk-LZ2XTYP2.js";
import {
  u as u2
} from "./chunk-45CFSCQX.js";
import "./chunk-A5XN2VFT.js";
import "./chunk-65HD3WXL.js";
import {
  e,
  n
} from "./chunk-4DGC7CBY.js";
import {
  C,
  a as a3,
  e2,
  f2 as f,
  l2,
  r2 as r,
  s as s2,
  t2 as t,
  u2 as u
} from "./chunk-GNMPGHLQ.js";
import {
  a,
  i3 as i,
  l3 as l,
  s2 as s
} from "./chunk-QY7XKUIV.js";
import {
  N,
  has
} from "./chunk-AL6YUTZM.js";
import "./chunk-G26ADAPQ.js";

// node_modules/@arcgis/core/views/3d/layers/graphics/polygonUtils.js
function u22(e33, i24, r28) {
  const n24 = (i24.length > 0 ? i24[0] : e33.length / 3) - 1, a26 = i11(e33, n24, r28);
  if (2 !== a26) {
    e33 = e33.slice();
    for (let t30 = 0; t30 < e33.length; t30 += 3) e33[t30 + a26] = e33[t30 + 2];
  }
  return e18(e33, i24, 3);
}
function s19(t30) {
  const e33 = [["position", new t12(t30.attributeData.position, t30.indices, 3, true)]], i24 = U(t30.indices.length);
  return null != t30.attributeData.colorFeature ? e33.push(["colorFeatureAttribute", new t12([t30.attributeData.colorFeature], i24, 1, true)]) : t30.attributeData.color && e33.push(["color", new t12(t30.attributeData.color, i24, 4, true)]), t30.attributeData.uvMapSpace && e33.push(["uvMapSpace", new t12(t30.attributeData.uvMapSpace, t30.indices, 4, true)]), t30.attributeData.boundingRect && e33.push(["boundingRect", new t12(t30.attributeData.boundingRect, t30.indices, 9, true)]), new m7(t30.material, e33, t30.mapPositions, 0, t30.attributeData.olidColor);
}
function c15(t30, e33 = null) {
  const i24 = [["position", new t12(t30.attributeData.position, t30.indices, 3, true)], ["uv0", new t12(t30.attributeData.uv0, t30.indices, 2, true)]];
  return new m7(t30.material, i24, t30.mapPositions, 0, e33);
}
function l15(t30) {
  switch (t30.type) {
    case "extent":
      if (t30 instanceof z) return P2.fromExtent(t30);
      break;
    case "polygon":
      return t30;
  }
  return null;
}
var p9 = class {
  constructor(t30, e33, i24) {
    this.renderData = t30, this.layerViewUid = e33, this.graphicUid = i24, this.outGeometries = new Array();
  }
};

// node_modules/@arcgis/core/views/3d/support/renderInfoUtils/polygon.js
function r18(o25, n24, e33, r28) {
  const p14 = h5(o25.rings, !!o25.hasZ && "on-the-ground" !== r28.mode, 1, o25.spatialReference), u30 = e11(p14.position.length), a26 = l14(p14.position, o25.spatialReference, 0, u30, 0, p14.position, 0, p14.position.length / 3, n24, e33, r28), h19 = null != a26;
  return new f13(p14.position, u30, l16(p14.polygons, p14.position, u30), c16(p14.outlines, p14.position, u30), h19, a26);
}
function p10(t30, n24) {
  const i24 = h5(t30.rings, false, 1), r28 = o5(i24.position, t30.spatialReference, 0, i24.position, n24, 0);
  for (let o25 = 2; o25 < i24.position.length; o25 += 3) i24.position[o25] = B3;
  return { position: i24.position, polygons: l16(i24.polygons, i24.position), outlines: c16(i24.outlines, i24.position), projectionSuccess: r28 };
}
function c16(o25, t30, s27 = null) {
  return o25.filter(({ count: o26 }) => o26 > 1).map(({ index: o26, count: i24 }) => {
    const e33 = 3 * o26, r28 = 3 * i24;
    return null != s27 ? new a20(o26, i24, i5(t30, e33, r28), i5(s27, e33, r28)) : new u23(o26, i24, i5(t30, e33, r28));
  });
}
function l16(o25, t30, s27 = null) {
  const i24 = new Array();
  for (const { index: e33, count: r28, holeIndices: p14, pathLengths: c26 } of o25) {
    if (r28 <= 1) continue;
    const o26 = 3 * e33, l25 = 3 * r28, u30 = p14.map((o27) => o27 - e33), a26 = null != s27 ? new h9(e33, r28, i5(t30, 3 * e33, 3 * r28), i5(s27, o26, l25), u30, c26) : new m14(e33, r28, i5(t30, 3 * e33, 3 * r28), u30, c26);
    i24.push(a26);
  }
  return i24;
}
var u23 = class {
  constructor(o25, t30, n24) {
    this.index = o25, this.count = t30, this.position = n24;
  }
};
var a20 = class extends u23 {
  constructor(o25, t30, n24, s27) {
    super(o25, t30, n24), this.mapPositions = s27;
  }
};
var h9 = class extends a20 {
  constructor(o25, t30, n24, s27, i24, e33) {
    super(o25, t30, n24, s27), this.holeIndices = i24, this.pathLengths = e33;
  }
};
var m14 = class extends u23 {
  constructor(o25, t30, n24, s27, i24) {
    super(o25, t30, n24), this.holeIndices = s27, this.pathLengths = i24;
  }
};
var f13 = class {
  constructor(o25, t30, n24, s27, i24, e33) {
    this.position = o25, this.mapPositions = t30, this.polygons = n24, this.outlines = s27, this.projectionSuccess = i24, this.sampledElevation = e33;
  }
};

// node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DExtrudeSymbolLayer.js
var J4 = ["polygon", "extent"];
var K4 = class extends m13 {
  constructor(t30, e33, r28, s27) {
    super(t30, e33, r28, s27, mt(e33)), this.ensureDrapedStatus(false);
  }
  async doLoad() {
    const t30 = this.symbolLayer, e33 = t30?.material, r28 = this.symbolLayer.material?.color?.a, s27 = this.needsDrivenTransparentPass || null != r28 && 1 !== r28, o25 = e33?.emissive, i24 = !this._hasDrivenColorOrOpacity && (null == r28 || 0 === r28), n24 = { usePBR: this._context.physicalBasedRenderingEnabled, isSchematic: true, ambient: _2, diffuse: _2, opacity: i24 ? 0 : 1, layerOpacity: this._getLayerOpacity(), drivenOpacity: s27, hasSymbolColors: true, hasSlicePlane: this._context.slicePlaneEnabled, castShadows: t30.castShadows, emissiveStrength: o25?.strength ?? 0, emissiveSource: 1, offsetTransparentBackfaces: true, normalType: 1 }, a26 = new P5(n24, this._context), l25 = new P5({ ...n24, cullFace: 2 }, this._context);
    this._materials[0] = a26, this._materials[1] = l25, this._updateTransparentDepedentMaterialParameters();
  }
  destroy() {
    super.destroy(), this._materials.length = 0;
  }
  createGraphics3DGraphic(t30) {
    const e33 = t30.graphic;
    if (!this._validateGeometry(e33.geometry, J4, this.symbolLayer.type)) return null;
    const r28 = this._getDrivenUInt8ColorWithNaNSupport(t30.renderingInfo, this._materialColor, false);
    e23(r28, r28);
    const s27 = this.createElevationContextForGraphic(e33);
    return this._createAs3DShape(e33, t30.renderingInfo, r28, s27, e33.uid);
  }
  layerOpacityChanged(t30, e33) {
    const r28 = this._getLayerOpacity();
    this._materials[0]?.setParameters({ layerOpacity: r28 }), this._materials[1]?.setParameters({ layerOpacity: r28 }), this._updateTransparentDepedentMaterialParameters(), t30?.forEach((t31) => e33(t31)?.layerOpacityChanged(r28, this._context.isAsync));
  }
  layerScreenSizePerspectiveChanged() {
  }
  layerElevationInfoChanged(t30, e33) {
    return this.updateGraphics3DGraphicElevationInfo(t30, e33, m11);
  }
  slicePlaneEnabledChanged(t30, e33) {
    return this._materials[0]?.setParameters({ hasSlicePlane: this._context.slicePlaneEnabled }), this._materials[1]?.setParameters({ hasSlicePlane: this._context.slicePlaneEnabled }), t30?.forEach((t31) => {
      const r28 = e33(t31);
      null != r28 && r28.slicePlaneEnabledChanged(this._context.slicePlaneEnabled, this._context.isAsync);
    }), true;
  }
  physicalBasedRenderingChanged() {
    const t30 = { usePBR: this._context.physicalBasedRenderingEnabled, isSchematic: true };
    return this._materials[0]?.setParameters(t30), this._materials[1]?.setParameters(t30), true;
  }
  _getExtrusionSize(t30) {
    let e33;
    return e33 = t30.size && this._drivenProperties.size ? a19(t30.size, 2) ?? 0 : this._getSymbolSize(), e33 /= this._context.renderCoordsHelper.unitInMeters, e33;
  }
  applyRendererDiff(t30, e33) {
    return this._drivenPropertiesChanged(e33) ? 0 : 1;
  }
  async queryForSnapping(r28, s27, o25, i24) {
    const n24 = this._getExtrusionSize(o25) * this._context.renderCoordsHelper.unitInMeters / ne(s27), { objectId: a26, target: l25 } = r28, c26 = a(l25);
    switch (c26.z = (c26.z ?? 0) + n24, r28.type) {
      case "edge": {
        const { start: e33, end: s28 } = r28, o26 = a(e33), i25 = a(s28);
        return o26.z = (o26.z ?? 0) + n24, i25.z = (i25.z ?? 0) + n24, [e13(a26, c26, 1 / 0, o26, i25)];
      }
      case "vertex":
        return [t4(a26, c26, 1 / 0), e13(a26, l25, 1 / 0, l25, c26)];
      default:
        return [];
    }
  }
  _getSymbolSize() {
    return this.symbolLayer.size ?? 1;
  }
  _createAs3DShape(t30, e33, n24, l25, c26) {
    const p14 = l15(t30.geometry);
    if (null == p14) return null;
    if (0 === p14.rings.length || !p14.rings.some((t31) => t31.length > 0)) return this._logGeometryValidationWarnings(p14.rings, "rings", "ExtrudeSymbol3DLayer"), null;
    const m21 = r18(p14, this._context.elevationProvider, this._context.renderCoordsHelper, l25);
    this._logGeometryCreationWarnings(m21, p14.rings, "rings", "ExtrudeSymbol3DLayer");
    const h19 = w4(p14);
    if (null == h19) return null;
    const u30 = new Array(), d16 = new Array(), g13 = u7(), f19 = e10(), v12 = n2(), w11 = 1 === this._context.renderCoordsHelper.viewingMode;
    w11 || this._context.renderCoordsHelper.worldUpAtPosition(null, v12), f6(p14.spatialReference, [h19.x, h19.y, 0], f19, this._context.renderCoordsHelper.spatialReference);
    const E8 = e10();
    h2(E8, f19);
    const A9 = e9();
    j2(A9, E8);
    const { polygons: I9, mapPositions: z8, position: V8 } = m21, T10 = /* @__PURE__ */ new Map(), B8 = this._materials[0];
    for (const s27 of I9) {
      const t31 = s27.count;
      if (this._context.clippingExtent && (m2(s27.mapPositions, g13), !A(g13, this._context.clippingExtent))) continue;
      const o25 = e18(s27.mapPositions, s27.holeIndices, 3);
      if (0 === o25.length) continue;
      const i24 = o25.length, a26 = 6 * t31, l26 = f5(a26 + i24), p15 = f5(i24), m22 = e11(3 * a26), h20 = e11(3 * a26), y9 = e11(3 * a26), b14 = e11(a26);
      X2(V8, z8, o25, s27, m22, y9, h20, b14, l26, p15, this._getExtrusionSize(e33), v12, w11), r9(m22, m22, E8);
      const _13 = this._context.stage.renderView.getObjectAndLayerIdColor({ graphicUid: c26, layerViewUid: this._context.layerViewUid }), A10 = new jt(m22, y9, c3(h20), b14), D6 = Q3(B8, l26, l26.length - p15.length, A10, n24, _13), I10 = t31, U9 = t31, L2 = 2 * s27.count, O6 = new St(I10, U9, L2, i24 / 3);
      pt(D6, O6, f19), T10.set(D6, O6), u30.push(D6, Q3(this._materials[1], p15, 0, A10, n24, _13)), d16.push(A10.heights);
    }
    if (0 === u30.length) return null;
    const F10 = new W({ geometries: u30, layerViewUid: this._context.layerViewUid, graphicUid: c26, isElevationSource: true });
    F10.transformation = f19;
    const H7 = l12(this.symbolLayer, { opacity: this._getLayerOpacity() }), k14 = H7 ? new u19(this._materials[0], H7, this._context.slicePlaneEnabled) : null, W7 = new O2(this, F10, null, (t31, e34, r28, s27, o25) => ct(t31, e34, r28, s27, o25, d16, T10), l25, k14);
    return W7.alignedSampledElevation = m21.sampledElevation, W7.needsElevationUpdates = m11(l25.mode), W7;
  }
  get _materialColor() {
    return this.symbolLayer.material?.color;
  }
  _updateTransparentDepedentMaterialParameters() {
    const t30 = this._materials[0];
    t30 && t30.setParameters({ cullFace: t30.transparent ? 0 : 2 });
  }
};
function Q3(t30, e33, r28, s27, o25, i24) {
  const n24 = U(e33.length), a26 = [["position", new t12(s27.positions, e33, 3, true)], ["normalCompressed", new t12(s27.normals, e33, 2, true)], ["symbolColor", new t12(o25, n24, 4, true)]];
  return new m7(t30, a26, s27.elevation, 0, i24, r28);
}
function X2(t30, e33, r28, s27, o25, i24, n24, a26, l25, c26, p14, m21, h19) {
  const u30 = r28.length / 3;
  let d16 = 2 * s27.count;
  Y2(t30, e33, s27.index, s27.count, r28, 0, u30, o25, i24, n24, a26, l25, c26, d16, p14, m21, h19);
  let g13 = 0, f19 = 2 * s27.count;
  d16 = 0;
  const y9 = s27.pathLengths[0];
  et(o25, i24, a26, n24, g13, y9, s27.count, f19, l25, d16, p14), f19 += 4 * y9, d16 += 2 * y9, g13 += y9;
  for (let b14 = 1; b14 < s27.pathLengths.length; ++b14) {
    const t31 = s27.pathLengths[b14];
    et(o25, i24, a26, n24, g13, t31, s27.count, f19, l25, d16, p14), f19 += 4 * t31, d16 += 2 * t31, g13 += t31;
  }
}
function Y2(t30, e33, r28, s27, o25, i24, n24, a26, l25, c26, p14, m21, u30, g13, f19, y9, b14) {
  s7(ut, y9), l25 ??= [], c26 ??= [], p14 ??= [];
  const _13 = f19 > 0 ? 1 : -1;
  let x12 = 3 * r28, j15 = 0, S10 = 3 * j15, P11 = s27, v12 = 3 * P11;
  for (let d16 = 0; d16 < s27; ++d16) {
    const r29 = t30[x12], s28 = t30[x12 + 1], o26 = t30[x12 + 2];
    b14 && (ut[0] = r29, ut[1] = s28, ut[2] = o26, A2(ut, ut)), a26[S10 + 0] = r29, a26[S10 + 1] = s28, a26[S10 + 2] = o26;
    const i25 = e33[x12 + 0], n25 = e33[x12 + 1], m22 = e33[x12 + 2];
    l25[S10 + 0] = i25, l25[S10 + 1] = n25, l25[S10 + 2] = m22, c26[S10 + 0] = -_13 * ut[0], c26[S10 + 1] = -_13 * ut[1], c26[S10 + 2] = -_13 * ut[2], p14[j15] = 0, a26[v12 + 0] = r29 + f19 * ut[0], a26[v12 + 1] = s28 + f19 * ut[1], a26[v12 + 2] = o26 + f19 * ut[2], l25[v12 + 0] = i25, l25[v12 + 1] = n25, l25[v12 + 2] = m22, p14[P11] = f19, S10 += 3, v12 += 3, x12 += 3, j15 += 1, P11 += 1;
  }
  x12 = 3 * i24, S10 = 0, v12 = 3 * g13;
  const C7 = f19 < 0 ? ft : gt, w11 = f19 < 0 ? gt : ft;
  for (let h19 = 0; h19 < n24; ++h19) u30[S10] = o25[x12 + C7[0]], u30[S10 + 1] = o25[x12 + C7[1]], u30[S10 + 2] = o25[x12 + C7[2]], m21[v12] = o25[x12 + w11[0]] + s27, m21[v12 + 1] = o25[x12 + w11[1]] + s27, m21[v12 + 2] = o25[x12 + w11[2]] + s27, S10 += 3, v12 += 3, x12 += 3;
}
function $2(t30, e33, r28, s27, o25, i24, n24) {
  s27[i24] = s27[n24], n24 *= 3, t30[i24 *= 3] = t30[n24], t30[i24 + 1] = t30[n24 + 1], t30[i24 + 2] = t30[n24 + 2], e33[i24] = e33[n24], e33[i24 + 1] = e33[n24 + 1], e33[i24 + 2] = e33[n24 + 2], r28[i24] = o25[0], r28[i24 + 1] = o25[1], r28[i24 + 2] = o25[2];
}
var tt3 = n2();
function et(t30, e33, r28, s27, o25, i24, n24, a26, l25, c26, p14) {
  e33 ??= [], r28 ??= [], s27 ??= [];
  let m21 = o25, h19 = o25 + 1, u30 = o25 + n24, d16 = o25 + n24 + 1, g13 = a26, f19 = a26 + 1, y9 = a26 + 2 * i24, b14 = a26 + 2 * i24 + 1;
  p14 < 0 && (m21 = o25 + n24 + 1, d16 = o25);
  let _13 = 3 * c26;
  for (let x12 = 0; x12 < i24; ++x12) x12 === i24 - 1 && (h19 = o25, p14 > 0 ? d16 = o25 + n24 : m21 = o25 + n24), at2(t30, m21, h19, u30, tt3), $2(t30, e33, s27, r28, tt3, g13, m21), $2(t30, e33, s27, r28, tt3, f19, h19), $2(t30, e33, s27, r28, tt3, y9, u30), $2(t30, e33, s27, r28, tt3, b14, d16), l25[_13] = g13, l25[_13 + 1] = y9, l25[_13 + 2] = b14, l25[_13 + 3] = g13, l25[_13 + 4] = b14, l25[_13 + 5] = f19, _13 += 6, m21++, h19++, u30++, d16++, g13 += 2, f19 += 2, y9 += 2, b14 += 2;
}
var rt = n2();
var st = n2();
var ot3 = n2();
var it = n2();
var nt = n2();
function at2(t30, e33, r28, s27, o25) {
  e33 *= 3, r28 *= 3, s27 *= 3, o7(rt, t30[e33++], t30[e33++], t30[e33++]), o7(st, t30[r28++], t30[r28++], t30[r28++]), o7(ot3, t30[s27++], t30[s27++], t30[s27++]), c2(it, st, rt), c2(nt, ot3, rt), _3(o25, nt, it), A2(o25, o25);
}
var lt = n2();
function ct(t30, e33, r28, s27, o25, i24, c26) {
  const p14 = t30.stageObject, m21 = p14.geometries, h19 = m21.length, d16 = "absolute-height" !== e33.mode;
  let g13 = 0;
  const f19 = p14.transformation, y9 = e7(e10(), f19);
  for (let n24 = 0; n24 < h19; n24 += 2) {
    const t31 = m21[n24];
    if (!e25(t31)) continue;
    const e34 = t31.getMutableAttribute("position").data, a26 = i24[n24 / 2], h20 = new r16(t31.mapPositions), b14 = e34.length / 3;
    let _13 = false, x12 = 0;
    {
      let t32 = 0;
      for (let i25 = 0; i25 < b14; i25++) {
        lt[0] = e34[t32], lt[1] = e34[t32 + 1], lt[2] = e34[t32 + 2], s27(h20, dt2), d16 && (x12 += dt2.sampledElevation), t13.TESTS_DISABLE_OPTIMIZATIONS ? (o7(ht, h20.array[h20.offset], h20.array[h20.offset + 1], dt2.z + a26[t32 / 3]), null != r28 && o25.toRenderCoords(ht, r28, ht), E3(ht, ht, y9)) : (o7(ht, e34[t32], e34[t32 + 1], e34[t32 + 2]), E3(ht, ht, f19), o25.setAltitude(ht, dt2.z + a26[t32 / 3]), E3(ht, ht, y9)), e34[t32] = ht[0], e34[t32 + 1] = ht[1], e34[t32 + 2] = ht[2];
        const i26 = yt / o25.unitInMeters;
        (Math.abs(lt[0] - e34[t32]) >= i26 || Math.abs(lt[1] - e34[t32 + 1]) >= i26 || Math.abs(lt[2] - e34[t32 + 2]) >= i26) && (_13 = true), h20.offset += 3, t32 += 3;
      }
    }
    if (_13) {
      const e35 = c26.get(t31);
      e35 && pt(t31, e35, f19), p14.geometryVertexAttributeUpdated(m21[n24], "normalCompressed"), t31.invalidateBoundingInfo(), p14.geometryVertexAttributeUpdated(m21[n24], "position"), m21[n24 + 1].invalidateBoundingInfo(), p14.geometryVertexAttributeUpdated(m21[n24 + 1], "position");
    }
    g13 += x12 / b14;
  }
  return g13 / h19;
}
function pt(t30, e33, r28) {
  const s27 = t30.getMutableAttribute("position"), o25 = t30.getMutableAttribute("normalCompressed").data, i24 = s27.data, n24 = t30.attributes.get("position").indices, { topVertexStart: a26, topVertexCount: d16, topFaceStart: g13, topFaceCount: f19 } = e33, y9 = g13 + f19, b14 = a26 + d16, _13 = bt, x12 = _t, j15 = xt, S10 = ut, P11 = ht;
  o7(P11, 0, 0, 0);
  const v12 = (t31, e34) => {
    const s28 = 3 * t31;
    o7(e34, i24[s28 + 0], i24[s28 + 1], i24[s28 + 2]), E3(e34, e34, r28);
  };
  for (let l25 = g13; l25 < y9; ++l25) {
    const t31 = 3 * l25;
    v12(n24[t31 + 0], _13[0]), v12(n24[t31 + 1], _13[1]), v12(n24[t31 + 2], _13[2]), R(x12, _13[1], _13[0]), R(j15, _13[2], _13[0]), _3(S10, x12, j15), u8(P11, P11, S10);
  }
  A2(P11, P11);
  for (let l25 = a26; l25 < b14; ++l25) {
    const t31 = P11[0], e34 = P11[1], r29 = P11[2];
    e17(o25, l25, t31, e34, r29);
  }
}
function mt(t30) {
  return 1 === (t30.material?.color?.a ?? 0);
}
var ht = n2();
var ut = n2();
var dt2 = new x4();
var gt = [0, 2, 1];
var ft = [0, 1, 2];
var yt = 0.01;
var bt = [n2(), n2(), n2()];
var _t = n2();
var xt = n2();
var jt = class {
  constructor(t30, e33, r28, s27) {
    this.positions = t30, this.elevation = e33, this.normals = r28, this.heights = s27;
  }
};
var St = class {
  constructor(t30, e33, r28, s27) {
    this.topVertexStart = t30, this.topVertexCount = e33, this.topFaceStart = r28, this.topFaceCount = s27;
  }
};

// node_modules/@arcgis/core/views/3d/layers/graphics/focusAreaStyle.js
var t24 = 0.42;
var r19 = 0.32;
function c17(c26, n24) {
  if (c26) switch (n24) {
    case "bright": {
      const t30 = (c26[0] + c26[1] + c26[2]) / 3;
      return [t30 * r19 + (1 - r19), t30 * r19 + (1 - r19), t30 * r19 + (1 - r19), c26[3] * r19];
    }
    case "dark":
      return [c26[0] * t24, c26[1] * t24, c26[2] * t24, c26[3] * t24];
  }
}

// node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DDrapedGraphicLayer.js
var c18 = class {
  constructor(e33, t30, r28, i24) {
    this.graphics3DSymbolLayer = e33, this.renderGeometries = t30, this.boundingBox = r28, this._drapeSourceRenderer = i24, this.type = "draped", this._visible = false, this._addedToStage = false, this.isElevationSource = false;
  }
  initialize(e33) {
    this.stage = e33.stage;
  }
  get usedMemory() {
    return this.graphics3DSymbolLayer.usedMemory;
  }
  setVisibility(e33) {
    if (null != this.stage && this._visible !== e33) {
      if (this._visible = e33, e33 && !this._addedToStage) return this._addedToStage = true, void this._drapeSourceRenderer.addGeometries(this.renderGeometries, 0);
      if (e33 || this._addedToStage) {
        for (const e34 of this.renderGeometries) e34.visible = this._visible;
        this._drapeSourceRenderer.modifyGeometries(this.renderGeometries, 1);
      }
    }
  }
  destroy() {
    this.stage && this._addedToStage && this._drapeSourceRenderer.removeGeometries(this.renderGeometries, 2), this._addedToStage = false, this._visible = false, this.stage = null;
  }
  getCenterObjectSpace(r28 = n2()) {
    return o7(r28, 0, 0, 0);
  }
  getBoundingBoxObjectSpace(e33 = u7()) {
    return q3(e33);
  }
  addObjectState(e33) {
    0 === e33.stateType && (this.renderGeometries.forEach((t30) => {
      const r28 = t30.geometry.allocateIdAndHighlight(e33.highlightName);
      e33.addRenderGeometry(t30, r28, this);
    }), this._addedToStage && this._drapeSourceRenderer.modifyGeometries(this.renderGeometries, 8));
  }
  removeObjectState(e33) {
    this.renderGeometries.forEach((t30) => e33.removeByObject(t30));
  }
  updateHighlights(e33) {
  }
  removeRenderGeometryObjectState(e33, t30) {
    0 === t30.channel && (e33.geometry.removeHighlight(t30), this._addedToStage && this._drapeSourceRenderer.modifyGeometries([e33], 8));
  }
  computeAttachmentOrigin(e33) {
    for (const t30 of this.renderGeometries) t30.geometry.computeAttachmentOrigin(u24) && (e33.draped.origin[0] += u24[0], e33.draped.origin[1] += u24[1], e33.draped.num++);
  }
  async getProjectedBoundingBox(e33, t30, r28, d16, a26) {
    q3(a26);
    for (let i24 = 0; i24 < this.renderGeometries.length; i24++) {
      const t31 = this.renderGeometries[i24];
      this._getRenderGeometryProjectedBoundingRect(t31, e33, m15, r28), x(a26, m15);
    }
    if (t30) {
      let e34;
      b3(a26, u24);
      const r29 = G2(a26, t30.service.spatialReference, t30);
      try {
        e34 = await t30.service.queryElevation(u24[0], u24[1], d16, r29, "ground");
      } catch (n24) {
      }
      null != e34 && (a26[2] = Math.min(a26[2], e34), a26[5] = Math.max(a26[5], e34));
    }
    return a26;
  }
  _getRenderGeometryProjectedBoundingRect(e33, t30, r28, i24) {
    if (this.boundingBox) k2(g7, this.boundingBox);
    else {
      const t31 = e33.boundingSphere, r29 = t31[3];
      g7[0] = t31[0] - r29, g7[1] = t31[1] - r29, g7[2] = t31[2] - r29, g7[3] = t31[0] + r29, g7[4] = t31[1] + r29, g7[5] = t31[2] + r29;
    }
    return t30(g7, 0, 2), this.calculateRelativeScreenBounds && i24.push({ location: b3(g7), screenSpaceBoundingRect: this.calculateRelativeScreenBounds() }), w(g7, r28);
  }
};
var m15 = i3();
var g7 = u7();
var u24 = n2();

// node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DIconSymbolLayer.js
var ae2 = r3(0, 0, 1);
var ne2 = 16;
var le = 1.5;
var ce = [a11 * o11, a11 * o11];
var _he = class _he extends m13 {
  getCachedSize() {
    return { size: this._getIconSize() };
  }
  constructor(e33, t30, r28, i24) {
    super(e33, t30, r28, i24, ye(t30)), this._cimData = null, this._overrideHelperClass = null, this._arcadeInfo = null, this._cimSymbolMaterials = /* @__PURE__ */ new Map(), this._cimSymbolTextures = /* @__PURE__ */ new Map(), this._cimMaterialParametersInfo = null, this._cimScaleFactorOrFunction = null, this._size = null, this._symbolTextureRatio = 1, this._outlineSize = 0, this._textureHandle = null, this._patchTask = null, this._elevationOptions = { supportsOffsetAdjustment: true, supportsOnTheGround: true };
  }
  async doLoad(e33) {
    this._validateOrThrow();
    const t30 = this._prepareMaterialParameters(), r28 = this._getPrimitive();
    if (null != r28) this._prepareResourcesPrimitive(t30, r28);
    else {
      const r29 = d6(this.symbolLayer), i24 = pe(r29);
      null != i24 ? await this._prepareResourcesCIM(t30, JSON.parse(i24), e33) : await this._prepareResourcesHref(t30, r29, e33);
    }
  }
  _validateOrThrow() {
    if (this._drivenProperties.size) return;
    const e33 = Z2(this._getIconSize());
    if (e33) throw new s("graphics3diconsymbollayer:invalid-size", e33);
  }
  _getIconSize() {
    const e33 = this.symbolLayer, t30 = Math.round(null != e33.size ? u3(e33.size) : ne2);
    return this._drivenProperties.size ? Math.max(t30, 64) : t30;
  }
  _generateTextureCIM(e33, t30) {
    const r28 = this._overrideHelperClass;
    let i24 = this._cimData;
    if (r28 && i24 && i24.symbol || this.logger.error("Can't create texture, CIM data is undefined"), i24.primitiveOverrides) {
      i24 = a(i24);
      const o26 = i24.primitiveOverrides;
      r28.evaluateOverrides(o26, e33, this._arcadeInfo.geometryType, null, null, t30.layer.fieldsIndex), r28.applyOverrides(i24.symbol, o26);
    }
    const o25 = l(JSON.stringify(i24));
    let a26 = this._cimSymbolTextures.get(o25);
    if (a26) return a26;
    const n24 = this._context.sharedResources.cimSymbolRasterizer, l25 = this._context.renderer && "dictionary" === this._context.renderer.type ? this._context.renderer.fieldMap : null;
    l25 && r28.applyDictionaryTextOverrides(i24.symbol, e33, l25, null);
    const c26 = null != this._cimScaleFactorOrFunction ? n9(this._cimScaleFactorOrFunction, e33) : 1;
    1 !== c26 && i24.symbol && f9(i24.symbol, c26, true);
    const h19 = Y.getEnvelope(i24, null, n24.resourceManager);
    if (h19?.width && h19.height) {
      const e34 = h19.x + h19.width / 2, t31 = h19.y + h19.height / 2, r29 = n24.rasterize({ type: "cim", data: i24 }, h19.width, h19.height, e34, t31, 1, "esriGeometryPoint", 0, null, this._context.graphicsCoreOwner.view.state.rasterPixelRatio), s27 = new p4({ x: -h19.x / h19.width - 0.5, y: (h19.height + h19.y) / h19.height - 0.5 });
      this._cimMaterialParametersInfo.anchorPosition = de("relative", s27), a26 = new M3(r29, { width: r29?.width ?? 1, height: r29?.height ?? 1, reloadable: true });
    } else a26 = new M3(new ImageData(1, 1), { width: 1, height: 1, reloadable: true });
    return this._cimSymbolTextures.set(o25, a26), this._context.stage.addTexture(a26), a26;
  }
  _prepareMaterialParameters() {
    const e33 = { anchorPosition: de(this.symbolLayer.anchor, this.symbolLayer.anchorPosition), rotation: this.symbolLayer.angle }, t30 = this.symbol;
    ue(t30) && (e33.verticalOffset = new a18(t30.verticalOffset)), this._context.screenSizePerspectiveEnabled && (e33.screenSizePerspective = this.view.screenSizePerspective.parameters), (0 !== e33.rotation || this._drivenProperties.rotation) && (e33.hasRotation = true);
    const r28 = !!has("enable-feature:non-occluded-hud");
    return e33.occlusionTest = !r28, e33.occludedFragmentFade = r28, e33.horizonCullingEnabled = r28 && this._context.spherical, e33.hasSlicePlane = this._context.slicePlaneEnabled, e33;
  }
  _prepareResourcesPrimitive(e33, t30) {
    const r28 = this._getOutlineSize();
    if (me(t30) && 0 === r28) throw new Error("Nothing to render");
    if (this._outlineSize = r28, e33.color = this._getFillColor(), e33.outlineColor = this._getOutlineColor(), e33.outlineSize = this._outlineSize, null != this._context.sharedResources.textures) {
      const r29 = this._context.sharedResources.textures.fromData(`${t30}-icon`, () => c6(t30));
      this._textureHandle = r29, e33.textureId = r29.texture.id;
    }
    e33.textureIsSignedDistanceField = true, e33.sampleSignedDistanceFieldTexelCenter = s12(t30), e33.distanceFieldBoundingBox = u13;
    const i24 = this._getIconSize();
    this._size = [i24, i24], this._symbolTextureRatio = 1 / o11, this._createMaterial(e33);
  }
  async _prepareResourcesHref(e33, r28, s27) {
    this._outlineSize = this._getOutlineSize(), e33.color = this._getFillColor(), e33.outlineColor = this._getOutlineColor(), e33.outlineSize = this._outlineSize, e33.textureIsSignedDistanceField = false;
    const o25 = this._getIconSize(), a26 = o25 * this._context.graphicsCoreOwner.view.state.rasterPixelRatio;
    if (null != this._context.sharedResources.textures) {
      const l25 = await _(this._context.sharedResources.textures.fromUrl(r28, a26, { signal: s27 }));
      if (false === l25.ok) {
        f(l25.error);
        throw new s("graphics3diconsymbollayer:request-failed", `Failed to load (Request for icon resource failed: ${r28})`);
      }
      this._textureHandle = l25.value;
      const c26 = l25.value.texture;
      this._size = _e(c26, o25), e33.textureId = c26.id;
    }
    this._createMaterial(e33);
  }
  async _prepareResourcesCIM(e33, t30, r28) {
    const { OverrideHelper: i24 } = await import("./OverrideHelper-ZBSIK6VG.js");
    if (this._overrideHelperClass = i24, this._cimData = t30, !this._context.sharedResources.cimSymbolRasterizer) {
      const e34 = (await import("./CIMSymbolRasterizer-2OUAFOAA.js")).CIMSymbolRasterizer;
      s2(r28), this._context.sharedResources.cimSymbolRasterizer || (this._context.sharedResources.cimSymbolRasterizer = new e34(this._context.renderCoordsHelper.spatialReference));
    }
    const s27 = this._context.sharedResources.cimSymbolRasterizer, o25 = [], a26 = t30, n24 = a26?.symbol;
    Y.fetchResources(n24, s27.resourceManager, o25, r28), Y.fetchFonts(n24, s27.resourceManager, o25);
    const c26 = this._context.layer.fields ? this._context.layer.fields.map((e34) => e34.toJSON()) : [], h19 = this._context.renderCoordsHelper.spatialReference;
    if (this._arcadeInfo = { spatialReference: h19, fields: c26, geometryType: "esriGeometryPoint" }, a26?.primitiveOverrides && o25.push(i24.createRenderExpressions(a26.primitiveOverrides, this._arcadeInfo)), o25.length > 0 && (await Promise.all(o25), s2(r28)), this._context.renderer && "dictionary" === this._context.renderer.type && this._context.renderer.scaleExpression) {
      const e34 = this._context.renderer;
      if (e34.scaleExpression) {
        const t31 = e34.scaleExpression, r29 = await h3(t31, this._context.layer.spatialReference), { default: i25 } = await import("./callExpressionWithFeature-VYIEU2QE.js"), s28 = new Z(c26);
        this._cimScaleFactorOrFunction = (e35, t32, o26) => {
          const a27 = i25(r29, e35, { $view: o26 }, "esriGeometryPoint", s28, t32);
          return null !== a27 ? a27 : 1;
        };
      }
    }
    s2(r28), this._cimMaterialParametersInfo = e33, this._cimMaterialParametersInfo.color = this._getFillColor(), this._cimMaterialParametersInfo.outlineColor = [0, 0, 0, 0], this._cimMaterialParametersInfo.outlineSize = 0, this._cimMaterialParametersInfo.textureIsSignedDistanceField = false;
  }
  _getPrimitive() {
    return fe(this.symbolLayer);
  }
  _getOutlineSize() {
    let e33 = 0;
    const t30 = this.symbolLayer;
    if (null != t30.outline?.size) return Math.max(u3(t30.outline.size), 0);
    return e33 = me(this._getPrimitive()) ? le : 0, Math.max(e33, 0);
  }
  _getOutlineColor() {
    const t30 = this._getLayerOpacity(), r28 = this.symbolLayer, i24 = r28?.outline?.color;
    if (null != i24) {
      const r29 = u10.toUnitRGB(i24), s27 = i24.a * t30;
      return [r29[0], r29[1], r29[2], s27];
    }
    return [0, 0, 0, 0];
  }
  _getFillColor() {
    if (me(this._getPrimitive())) return t21;
    const e33 = null == this._getPrimitive(), t30 = this._materialColor;
    return this._getCombinedOpacityAndColor(t30, { hasIntrinsicColor: e33 });
  }
  get _materialColor() {
    return this.symbolLayer.material?.color;
  }
  get _fastVisualVariableFallbackColor() {
    const t30 = this._materialColor;
    if (null == t30) {
      return null == this._getPrimitive() ? s6 : a7;
    }
    return u10.toUnitRGBA(t30);
  }
  _getFallbackSize() {
    const e33 = this._getIconSize(), { symbolLayer: { size: t30 } } = this;
    return (null != t30 ? Math.round(u3(t30)) : ne2) / e33;
  }
  _createMaterial(e33) {
    const t30 = this._context.spherical;
    if (this._cimData) {
      this._fastUpdates = null;
      let r29 = e33.textureId ? this._cimSymbolMaterials.get(e33.textureId) : null;
      return r29 || (r29 = new ie(e33, t30), this._cimSymbolMaterials.set(e33.textureId ?? 0, r29)), r29;
    }
    this._fastUpdates = K3(this._context.renderer, this._fastVisualVariableConvertOptions()), this._fastUpdates && (e33 = { ...e33, ...this._fastUpdates.materialParameters }), this._materials[0] = new ie(e33, t30), e33.isFocused = false;
    const r28 = this.view.map?.focusAreas.style;
    return e33.color = c17(e33.color, r28), e33.outlineColor = c17(e33.outlineColor, r28), this._materials[1] = new ie(e33, t30), this._materials[0];
  }
  _setDrapingDependentMaterialParameters() {
    this.draped && (this._forEachMaterial((e33) => {
      e33.setParameters({ verticalOffset: null, screenSizePerspective: null, occlusionTest: false, hasSlicePlane: false, shaderPolygonOffset: 0, draped: this.draped });
    }), this.layerOpacityChanged());
  }
  destroy() {
    super.destroy(), this._patchTask = e2(this._patchTask), this._materials.length = 0, this._cimSymbolMaterials.clear(), this._cimSymbolTextures.forEach((e33) => this._context.stage.removeTexture(e33)), this._cimSymbolTextures.clear(), this._textureHandle = t(this._textureHandle);
  }
  _getScaleFactor({ size: e33 }, t30) {
    if (!this._drivenProperties.size) return 1;
    if (null == e33) return this._getFallbackSize();
    const [r28, i24, s27] = e33;
    return "symbol-value" === r28 ? 1 : "number" == typeof r28 && isFinite(r28) ? u3(r28) / t30 : "number" == typeof s27 && isFinite(s27) ? u3(s27) / t30 : 1;
  }
  _getDrivenRotation(e33) {
    return this._drivenProperties.rotation ? e33.heading ?? 0 : 0;
  }
  createGraphics3DGraphic(e33) {
    const t30 = e33.graphic;
    if (!this._validateGeometry(t30.geometry)) return null;
    const r28 = d9(t30.geometry);
    if (null == r28) return this.logger.warn(`unsupported geometry type for text symbol: ${t30.geometry.type}`), null;
    let i24, s27 = [0, 0];
    const o25 = this.view.focusAreasView?.containsGeometry(r28) ?? true;
    if (this._cimData) {
      if (!this._cimData.symbol) return null;
      const r29 = this._generateTextureCIM(t30, e33), a27 = { textureId: r29.id, isFocused: o25, ...this._cimMaterialParametersInfo };
      i24 = this._createMaterial(a27);
      const n25 = this._context.graphicsCoreOwner.view.state.rasterPixelRatio;
      s27 = [r29.parameters.width / n25, r29.parameters.height / n25];
    } else s27 = this._size, i24 = o25 ? this._materials[0] : this._materials[1];
    if (null == r28) return this.logger.warn(`unsupported geometry type for icon symbol: ${t30.geometry.type}`), null;
    const a26 = e33.renderingInfo, n24 = this._getDrivenUInt8Color(a26, this._materialColor, null == this._getPrimitive()), l25 = this._getDrivenRotation(a26);
    let c26 = 1;
    if (!this._fastUpdates?.visualVariables.size) {
      const e34 = s27[0] > s27[1] ? s27[0] : s27[1];
      c26 = this._getScaleFactor(a26, e34);
    }
    c26 *= this._symbolTextureRatio;
    const h19 = r8(s27[0] * c26, s27[1] * c26), u30 = this.createElevationContextForGraphic(t30);
    return this.ensureDrapedStatus("on-the-ground" === u30.mode) && this._setDrapingDependentMaterialParameters(), this.draped ? this._createAsOverlay(t30, r28, i24, n24, l25, h19) : this._createAs3DShape(t30, r28, i24, n24, l25, h19, u30, t30.uid);
  }
  layerOpacityChanged() {
    const e33 = this._getFillColor(), t30 = this._getOutlineColor();
    this._forEachMaterial((r28) => {
      r28.setParameters({ color: e33 }), r28.setParameters({ outlineColor: t30 });
    });
  }
  layerScreenSizePerspectiveChanged() {
    const e33 = this._context.screenSizePerspectiveEnabled && !this.draped ? this.view.screenSizePerspective.parameters : null;
    this._forEachMaterial((t30) => {
      t30.setParameters({ screenSizePerspective: e33 });
    });
  }
  updateGeometry(e33, t30) {
    const r28 = e33.geometry;
    if (this.draped || !r28 || !this._validateGeometry(r28)) return false;
    const { elevationContext: i24, stageObject: s27 } = t30;
    if (i24.mode !== this.getGeometryElevationMode(r28)) return false;
    const o25 = d9(r28);
    if (!o25) return false;
    i24.updateFeatureExpressionFeature(e33, this._context.layer);
    const a26 = u20(s27, this._context, o25, i24);
    if (null == a26) return false;
    const n24 = g6(this._context, o25);
    return s27.geometries[0].localOrigin === n24 && (t30.alignedSampledElevation = a26, f12(t30, o25, this._context.elevationProvider), true);
  }
  layerElevationInfoChanged(e33, t30, r28) {
    const i24 = this._elevationContext.mode, s27 = f10(_he.elevationModeChangeTypes, r28, i24);
    if (1 !== s27) return s27;
    const o25 = d7(i24) || "absolute-height" === i24;
    return this.updateGraphics3DGraphicElevationInfo(e33, t30, () => o25);
  }
  slicePlaneEnabledChanged() {
    return this.draped || this._forEachMaterial((e33) => {
      e33.setParameters({ hasSlicePlane: this._context.slicePlaneEnabled });
    }), true;
  }
  physicalBasedRenderingChanged() {
    return true;
  }
  get pixelRatioChanged() {
    return null != this._getPrimitive();
  }
  applyRendererDiff(e33, t30) {
    for (const r28 in e33.diff) {
      if ("visualVariables" !== r28) return 0;
      if (!Q2(this._fastUpdates, t30, this._fastVisualVariableConvertOptions())) return 0;
      this._materials[0]?.setParameters(this._fastUpdates.materialParameters);
    }
    return 2;
  }
  get needsUpdateFocus() {
    return true;
  }
  prepareSymbolLayerPatch(e33) {
    if (this._patchTask?.abort(), "partial" !== e33.diff.type) return;
    const t30 = e33.diff.diff;
    this._preparePatchResource(e33, t30), this._preparePatchRotation(e33, t30);
  }
  _preparePatchResource(e33, s27) {
    if (!s27.resource || "partial" !== s27.resource.type) return;
    const c26 = s27.resource.diff;
    if ("complete" !== c26?.href?.type) return;
    const h19 = c26.href.newValue, { textures: u30 } = this._context.sharedResources;
    if (null == h19 || null == u30 || null != pe(h19)) return;
    const m21 = this._getIconSize(), p14 = m21 * this._context.graphicsCoreOwner.view.state.pixelRatio;
    e33.symbolLayerStatePatches.push(() => {
      this._patchTask = e2(this._patchTask), this._patchTask = d((e34) => this._context.schedule(async (e35, r28) => {
        const s28 = await _(u30.fromUrl(h19, p14, { signal: r28 }));
        s2(r28);
        const o25 = !s28.ok;
        if (o25 && f(s28.error), this._textureHandle = t(this._textureHandle), this._patchTask = null, o25) {
          this._forEachMaterial((e37) => {
            e37.visible = false, e37.setParameters({ textureId: null });
          });
          const e36 = `Failed to load (Request for icon resource failed: ${h19})`;
          return void this.logger.error(new s("graphics3diconsymbollayer:request-failed", e36));
        }
        this._textureHandle = s28.value;
        const c27 = s28.value.texture;
        this._size = _e(c27, m21), this._forEachMaterial((e36) => {
          e36.setParameters({ textureId: c27.id }), e36.visible = true;
        });
      }, e34));
    }), delete c26.href;
  }
  _preparePatchRotation(e33, t30) {
    if (!t30.angle || "complete" !== t30.angle.type) return;
    const r28 = t30.angle.newValue ?? 0, i24 = 0 !== r28 || this._drivenProperties.rotation;
    e33.symbolLayerStatePatches.push(() => {
      this._forEachMaterial((e34) => e34.setParameters({ rotation: r28, hasRotation: i24 }));
    }), delete t30.angle;
  }
  _defaultElevationInfoNoZ() {
    return ge;
  }
  _createAs3DShape(e33, t30, r28, i24, s27, o25, a26, n24) {
    const l25 = this.getFastUpdateAttrValues(e33), c26 = this._context.layerViewUid, h19 = this._context.stage.renderView.getObjectAndLayerIdColor({ graphicUid: n24, layerViewUid: c26 }), u30 = at(r28, { normal: ae2, color: i24, rotation: s27, size: o25, centerOffsetAndDistance: xe, featureAttribute: l25, olidColor: h19 }), m21 = p8(this._context, t30, u30, a26, n24);
    if (null == m21) return null;
    const p14 = new O2(this, m21.object, null, u18, a26);
    return p14.alignedSampledElevation = m21.sampledElevation, p14.needsElevationUpdates = d7(a26.mode) || "absolute-height" === a26.mode, p14.getScreenSize = this._createScreenSizeGetter(o25, l25), p14.calculateRelativeScreenBounds = (e34) => r28.calculateRelativeScreenBounds(p14.getScreenSize(), 1, e34), f12(p14, t30, this._context.elevationProvider), p14;
  }
  _createAsOverlay(e33, t30, r28, i24, s27, o25) {
    r28.renderPriority = this._renderPriority;
    const a26 = n2();
    i8(t30, a26, this._context.overlaySR), a26[2] = B3;
    const n24 = this._context.clippingExtent;
    if (null != n24 && !V(n24, a26)) return null;
    const l25 = this.getFastUpdateAttrValues(e33), c26 = e33.uid, h19 = this._context.layerViewUid, u30 = this._context.stage.renderView.getObjectAndLayerIdColor({ graphicUid: c26, layerViewUid: h19 }), m21 = at(r28, { normal: ae2, position: a26, color: i24, rotation: s27, size: o25, featureAttribute: l25, olidColor: u30 }), p14 = new h8(m21, { layerViewUid: h19, graphicUid: c26 }), d16 = new c18(this, [p14], null, this._context.drapeSourceRenderer);
    return d16.getScreenSize = this._createScreenSizeGetter(o25, l25), d16.calculateRelativeScreenBounds = (e34) => r28.calculateRelativeScreenBounds(d16.getScreenSize(), 1, e34), d16;
  }
  _createScreenSizeGetter(e33, t30) {
    const r28 = this._outlineSize + 2;
    if (this._fastUpdates && t30) {
      const i25 = e33[0] / this._symbolTextureRatio, s28 = e33[1] / this._symbolTextureRatio;
      return (e34 = n6()) => {
        const [o25, a26] = tt(be, this._fastUpdates.materialParameters, t30);
        return e34[0] = o25 * i25 + r28, e34[1] = a26 * s28 + r28, e34;
      };
    }
    const i24 = e33[0] / this._symbolTextureRatio + r28, s27 = e33[1] / this._symbolTextureRatio + r28;
    return (e34 = n6()) => (e34[0] = i24, e34[1] = s27, e34);
  }
  _fastVisualVariableConvertOptions() {
    const e33 = Math.max(this._size[0], this._size[1]), t30 = r3(e33, e33, e33), r28 = e4(1), i24 = e33 * r28, s27 = r3(i24, i24, i24), o25 = this._getFallbackSize();
    return new G3({ supports: { size: true, color: true, rotation: true, opacity: false }, modelSize: t30, symbolSize: s27, unitInMeters: r28, fallbackColor: this._fastVisualVariableFallbackColor, fallbackSize: r3(o25, o25, o25) });
  }
  _forEachMaterial(e33) {
    this._materials.forEach(e33), this._cimSymbolMaterials.forEach(e33);
  }
  test() {
    return { ...super.test(), material: this._materials[0] };
  }
};
_he.PRIMITIVE_SIZE = ce;
_he.elevationModeChangeTypes = { definedChanged: 1, staysOnTheGround: 0, onTheGroundChanged: 2 };
var he = _he;
function ue(e33) {
  return e33 && "point-3d" === e33.type && e33.hasVisibleVerticalOffset();
}
function me(e33) {
  return null != e33 && ("cross" === e33 || "x" === e33);
}
function pe(e33) {
  const t30 = ot(e33);
  return "application/json" === t30?.mediaType ? t30.data : void 0;
}
function de(e33, t30) {
  return "relative" === e33 ? r8((t30.x || 0) + 0.5, 0.5 - (t30.y || 0)) : e33 in i12 ? i12[e33] : i12.center;
}
function _e({ parameters: e33 }, t30) {
  const r28 = (e33.width ?? 1) / (e33.height ?? 1);
  return r28 > 1 ? [t30, Math.round(t30 / r28)] : [Math.round(t30 * r28), t30];
}
function fe(e33) {
  return e33.resource?.href ? null : e33.resource?.primitive ?? j3;
}
function ye(e33) {
  return 1 === (e33.material?.color?.a ?? 0) && null != fe(e33);
}
var ge = { mode: "relative-to-ground", offset: 0 };
var xe = r6(0, 0, 0, 1);
var be = n2();

// node_modules/@arcgis/core/views/3d/layers/graphics/lineUtils.js
function r20(r28) {
  switch (r28) {
    case "butt":
      return 0;
    case "square":
      return 1;
    case "round":
      return 2;
    default:
      return null;
  }
}
function t25(r28) {
  return "diamond" === r28 ? "kite" : r28;
}

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/LineMarkerTechnique.js
var g8 = class extends m10 {
  constructor(e33, t30) {
    super(e33, t30, new t16(j7, () => import("./LineMarker.glsl-AVC2VYWZ.js")), S3(t30).locations);
  }
  _makePipelineState(e33, i24) {
    const { output: r28, oitPass: d16, space: h19, hasOccludees: f19 } = e33;
    return T3({ blending: o13(r28) ? a15(d16) : null, depthTest: 0 === h19 ? null : { func: p6(d16) }, depthWrite: i14(e33), drawBuffers: g4(r28, d5(d16, r28)), colorWrite: d4, stencilWrite: f19 ? f8 : null, stencilTest: f19 ? i24 ? t17 : c10 : null, polygonOffset: { factor: 0, units: -10 } });
  }
  initializePipeline(e33) {
    return e33.occluder ? (this._occluderPipelineTransparent = T3({ blending: r13, depthTest: n16, depthWrite: null, colorWrite: d4, stencilWrite: null, stencilTest: e22 }), this._occluderPipelineOpaque = T3({ blending: r13, depthTest: n16, depthWrite: null, colorWrite: d4, stencilWrite: i15, stencilTest: u14 }), this._occluderPipelineMaskWrite = T3({ blending: null, depthTest: a17, depthWrite: null, colorWrite: null, stencilWrite: f8, stencilTest: t17 })) : this._occluderPipelineTransparent = this._occluderPipelineOpaque = this._occluderPipelineMaskWrite = null, this._occludeePipelineState = this._makePipelineState(e33, true), this._makePipelineState(e33, false);
  }
  getPipeline(e33, t30) {
    return e33 ? this._occludeePipelineState : 11 === t30 ? this._occluderPipelineTransparent ?? super.getPipeline() : 10 === t30 ? this._occluderPipelineOpaque ?? super.getPipeline() : this._occluderPipelineMaskWrite ?? super.getPipeline();
  }
};
function S3(t30) {
  const i24 = Q().vec3f("position").vec4f16("previousDelta").vec2f16("uv0");
  return t30.hasVVColor ? i24.f32("colorFeatureAttribute") : i24.vec4u8("color", { glNormalized: true }), t30.hasVVOpacity && i24.f32("opacityFeatureAttribute"), t30.hasVVSize ? i24.f32("sizeFeatureAttribute") : i24.f16("size"), t30.worldSpace && i24.vec3f16("normal"), i24.freeze();
}

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/LineMarkerTechniqueConfiguration.js
var i17 = class extends e20 {
  constructor(t30) {
    super(), this.spherical = t30, this.space = 1, this.anchor = 0, this.occluder = false, this.writeDepth = false, this.hideOnShortSegments = false, this.hasCap = false, this.hasTip = false, this.hasVVSize = false, this.hasVVColor = false, this.hasVVOpacity = false, this.hasOccludees = false, this.terrainDepthTest = false, this.cullAboveTerrain = false, this.hasScreenSizePerspective = false, this.textureCoordinateType = 0, this.emissionSource = 0, this.discardInvisibleFragments = true, this.occlusionPass = false, this.hasVVInstancing = false, this.hasSliceTranslatedView = true, this.olidColorInstanced = false, this.overlayEnabled = false, this.snowCover = false;
  }
  get draped() {
    return 0 === this.space;
  }
  get worldSpace() {
    return 2 === this.space;
  }
};
__decorate([i13({ count: 3 })], i17.prototype, "space", void 0), __decorate([i13({ count: 2 })], i17.prototype, "anchor", void 0), __decorate([i13()], i17.prototype, "occluder", void 0), __decorate([i13()], i17.prototype, "writeDepth", void 0), __decorate([i13()], i17.prototype, "hideOnShortSegments", void 0), __decorate([i13()], i17.prototype, "hasCap", void 0), __decorate([i13()], i17.prototype, "hasTip", void 0), __decorate([i13()], i17.prototype, "hasVVSize", void 0), __decorate([i13()], i17.prototype, "hasVVColor", void 0), __decorate([i13()], i17.prototype, "hasVVOpacity", void 0), __decorate([i13()], i17.prototype, "hasOccludees", void 0), __decorate([i13()], i17.prototype, "terrainDepthTest", void 0), __decorate([i13()], i17.prototype, "cullAboveTerrain", void 0), __decorate([i13()], i17.prototype, "hasScreenSizePerspective", void 0);

// node_modules/@arcgis/core/views/3d/webgl-engine/materials/LineMarkerMaterial.js
var g9 = class extends s13 {
  constructor(e33, t30) {
    super(e33, v5), this.produces = /* @__PURE__ */ new Map([[2, (e34) => 9 === e34 || o13(e34) && 8 === this.parameters.renderOccluded], [3, (e34) => b5(e34)], [10, (e34) => a13(e34) && 8 === this.parameters.renderOccluded], [11, (e34) => a13(e34) && 8 === this.parameters.renderOccluded], [4, (e34) => o13(e34) && this.parameters.writeDepth], [8, (e34) => o13(e34) && !this.parameters.writeDepth], [18, (e34) => o13(e34) || 9 === e34]]), this.intersectDraped = void 0, this._configuration = new i17(t30);
  }
  getConfiguration(e33, t30) {
    return super.getConfiguration(e33, t30, this._configuration), this._configuration.space = 18 === t30.slot ? 0 : this.parameters.worldSpace ? 2 : 1, this._configuration.hideOnShortSegments = this.parameters.hideOnShortSegments, this._configuration.hasCap = 0 !== this.parameters.cap, this._configuration.anchor = this.parameters.anchor, this._configuration.hasTip = this.parameters.hasTip, this._configuration.hasSlicePlane = this.parameters.hasSlicePlane, this._configuration.hasOccludees = t30.hasOccludees, this._configuration.writeDepth = this.parameters.writeDepth, this._configuration.hasVVSize = this.parameters.hasVVSize, this._configuration.hasVVColor = this.parameters.hasVVColor, this._configuration.hasVVOpacity = this.parameters.hasVVOpacity, this._configuration.occluder = 8 === this.parameters.renderOccluded, this._configuration.oitPass = t30.oitPass, this._configuration.terrainDepthTest = t30.terrainDepthTest && o13(e33), this._configuration.cullAboveTerrain = t30.cullAboveTerrain, this._configuration.hasScreenSizePerspective = null != this.parameters.screenSizePerspective, this._configuration;
  }
  get visible() {
    return this.parameters.color[3] >= o17;
  }
  intersect() {
  }
  createBufferWriter() {
    return new S4(S3(this.parameters), this.parameters);
  }
  createGLMaterial(e33) {
    return new _6(e33);
  }
};
var _6 = class extends t15 {
  dispose() {
    super.dispose(), this._markerTextures?.release(this._markerPrimitive), this._markerPrimitive = null;
  }
  beginSlot(e33) {
    const t30 = this._material.parameters.markerPrimitive;
    return t30 !== this._markerPrimitive && (this._material.setParameters({ markerTexture: this._markerTextures.swap(t30, this._markerPrimitive) }), this._markerPrimitive = t30), this.getTechnique(g8, e33);
  }
};
var v5 = class extends t19 {
  constructor() {
    super(...arguments), this.width = 0, this.color = [1, 1, 1, 1], this.markerPrimitive = "arrow", this.placement = "end", this.cap = 0, this.anchor = 0, this.hasTip = false, this.worldSpace = false, this.hideOnShortSegments = false, this.writeDepth = true, this.hasSlicePlane = false, this.vvFastUpdate = false, this.stipplePattern = null, this.markerTexture = null;
  }
};
var S4 = class {
  constructor(e33, t30) {
    this.layout = e33, this._parameters = t30;
  }
  elementCount() {
    return "begin-end" === this._parameters.placement ? 12 : 6;
  }
  write(i24, a26, o25, n24, h19, c26) {
    const p14 = o25.get("position").data, m21 = p14.length / 3;
    let u30 = [1, 0, 0];
    const d16 = o25.get("normal");
    this._parameters.worldSpace && null != d16 && (u30 = d16.data);
    let f19 = 1, g13 = 0;
    this._parameters.vvSize ? g13 = o25.get("sizeFeatureAttribute").data[0] : o25.has("size") && (f19 = o25.get("size").data[0]);
    let _13 = [1, 1, 1, 1], v12 = 0;
    this._parameters.vvColor ? v12 = o25.get("colorFeatureAttribute").data[0] : o25.has("color") && (_13 = o25.get("color").data);
    let S10 = 0;
    this._parameters.vvOpacity && (S10 = o25.get("opacityFeatureAttribute").data[0]);
    const P11 = new Float32Array(h19.buffer), T10 = t5(h19.buffer), k14 = new Uint8Array(h19.buffer);
    let O6 = c26 * (this.layout.stride / 4);
    const V8 = P11.BYTES_PER_ELEMENT / T10.BYTES_PER_ELEMENT, j15 = 4 / V8, y9 = (e33, t30, r28, i25) => {
      P11[O6++] = e33[0], P11[O6++] = e33[1], P11[O6++] = e33[2], x3(t30, e33, T10, O6 * V8), O6 += j15;
      let s27 = O6 * V8;
      if (T10[s27++] = r28[0], T10[s27++] = r28[1], O6 = Math.ceil(s27 / V8), this._parameters.vvColor) P11[O6++] = v12;
      else {
        const e34 = Math.min(4 * i25, _13.length - 4), t31 = 4 * O6++;
        k14[t31] = 255 * _13[e34], k14[t31 + 1] = 255 * _13[e34 + 1], k14[t31 + 2] = 255 * _13[e34 + 2], k14[t31 + 3] = 255 * _13[e34 + 3];
      }
      this._parameters.vvOpacity && (P11[O6++] = S10), s27 = O6 * V8, this._parameters.vvSize ? (P11[O6++] = g13, s27 += 2) : T10[s27++] = f19, this._parameters.worldSpace && (T10[s27++] = u30[0], T10[s27++] = u30[1], T10[s27++] = u30[2]), O6 = Math.ceil(s27 / V8);
    }, M8 = (s27, a27) => {
      const o26 = o7(b7, p14[3 * s27], p14[3 * s27 + 1], p14[3 * s27 + 2]), n25 = w6;
      let h20 = s27 + a27;
      do {
        o7(n25, p14[3 * h20], p14[3 * h20 + 1], p14[3 * h20 + 2]), h20 += a27;
      } while (J2(o26, n25) && h20 >= 0 && h20 < m21);
      i24 && (E3(o26, o26, i24), E3(n25, n25, i24)), y9(o26, n25, [-1, -1], s27), y9(o26, n25, [1, -1], s27), y9(o26, n25, [1, 1], s27), y9(o26, n25, [-1, -1], s27), y9(o26, n25, [1, 1], s27), y9(o26, n25, [-1, 1], s27);
    }, C7 = this._parameters.placement;
    return "begin" !== C7 && "begin-end" !== C7 || M8(0, 1), "end" !== C7 && "begin-end" !== C7 || M8(m21 - 1, -1), null;
  }
};
var b7 = n2();
var w6 = n2();

// node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DLineSymbolLayer.js
var I3 = ["polyline", "polygon", "extent"];
var _W = class _W extends m13 {
  constructor(e33, t30, r28, i24) {
    super(e33, t30, r28, i24, T4(t30));
  }
  async doLoad() {
    this._fastUpdates = K3(this._context.renderer, this._fastVisualVariableConvertOptions());
    const e33 = true;
    if (this._fastMarkerUpdates = K3(this._context.renderer, this._fastVisualVariableConvertOptions(e33)), !this._drivenProperties.size) {
      if ((null != this.symbolLayer.size ? this.symbolLayer.size : e4(1)) < 0) throw new s("graphics3dlinesymbollayer:invalid-size", "Symbol sizes may not be negative values");
    }
  }
  _getMaterialParameters(e33, t30) {
    const r28 = this._screenSizePerspective, i24 = { ...this._getMaterialColorParameters(t30), width: this._computeMaterialWidth(this.symbolLayer?.size), hasPolygonOffset: true, join: this.symbolLayer.join || "miter", cap: r20(this.symbolLayer.cap || "butt"), hasSlicePlane: this._context.slicePlaneEnabled, isClosed: e33, stipplePattern: n19(this.symbolLayer.pattern), emissiveStrength: this._emissiveStrength ?? 0, screenSizePerspective: r28 };
    return 4 === t30 && this._fastMarkerUpdates?.visualVariables ? { ...i24, ...this._fastMarkerUpdates.materialParameters } : this._fastUpdates?.visualVariables ? { ...i24, ...this._fastUpdates.materialParameters } : i24;
  }
  _getMaterialColorParameters(e33) {
    const t30 = 4 === e33, r28 = this._getCombinedOpacityAndColor(t30 && this._markerColor || this._materialColor);
    return this._patternHidesLine && !t30 && (r28[3] = 0), { color: r28 };
  }
  get _materialColor() {
    return this.symbolLayer.material?.color;
  }
  get _emissiveStrength() {
    return this.symbolLayer.material?.emissive?.strength;
  }
  get _markerColor() {
    return this.symbolLayer.marker?.color;
  }
  get _lineMaterial() {
    return null == this._materials[0] && (this._materials[0] = new J3(this._getMaterialParameters(false, 0), this.view.state.isGlobal)), this._materials[0];
  }
  get _ringMaterial() {
    return null == this._materials[1] && (this._materials[1] = new J3(this._getMaterialParameters(true, 1), this.view.state.isGlobal)), this._materials[1];
  }
  get _wireframeLineMaterial() {
    return null == this._materials[2] && (this._materials[2] = new J3({ ...this._getMaterialParameters(false, 2), wireframe: true }, this.view.state.isGlobal)), this._materials[2];
  }
  get _wireframeRingMaterial() {
    return null == this._materials[3] && (this._materials[3] = new J3({ ...this._getMaterialParameters(true, 3), wireframe: true }, this.view.state.isGlobal)), this._materials[3];
  }
  get _markerMaterial() {
    return null == this._materials[4] && null != this.symbolLayer.marker && (this._materials[4] = new g9({ ...this._getMaterialParameters(false, 4), placement: this.symbolLayer.marker.placement, markerPrimitive: t25(this.symbolLayer.marker.style) }, this.view.state.isGlobal)), this._materials[4];
  }
  _getDrivenSize(e33) {
    if (this._drivenProperties.size) {
      const t30 = e33.size;
      return null != t30 ? u3(s18(t30)) : this._getFallbackSize();
    }
    return 1;
  }
  _getDrivenColor({ color: e33, opacity: t30 }) {
    const r28 = i7();
    return this._drivenProperties.color && (a6(r28, e33 ?? this._getFallbackOpacityAndColor(a7)), null == t30) || this._drivenProperties.opacity && (e33 || this._materialColor) && (r28[3] = t30 ?? this._getFallbackOpacity()), r28;
  }
  _getDrivenMarkerColor({ color: e33, opacity: t30 }) {
    const r28 = i7();
    return this._drivenProperties.color && (a6(r28, e33 ?? this._getFallbackMarkerOpacityAndColor(a7)), null == t30) || this._drivenProperties.opacity && (e33 || this._markerColor || this._materialColor) && (r28[3] = t30 ?? this._getFallbackMarkerOpacity()), r28;
  }
  createGraphics3DGraphic(e33) {
    const t30 = e33.graphic;
    if (!this._validateGeometry(t30.geometry, I3, this.symbolLayer.type)) return null;
    const r28 = this.createElevationContextForGraphic(t30);
    return this.ensureDrapedStatus("on-the-ground" === r28.mode), this.draped ? this._createAsOverlay(e33) : this._createAs3DShape(e33, r28, t30.uid);
  }
  applyRendererDiff(e33, t30) {
    for (const r28 in e33.diff) {
      if ("visualVariables" !== r28) return 0;
      {
        const e34 = this._fastUpdates;
        if (!Q2(e34, t30, this._fastVisualVariableConvertOptions())) return 0;
        for (const t31 of this._materials) t31 instanceof J3 && t31.setParameters(e34.materialParameters);
        const r29 = this._fastMarkerUpdates, i24 = true;
        if (!Q2(r29, t30, this._fastVisualVariableConvertOptions(i24))) return 0;
        for (const t31 of this._materials) t31 instanceof g9 && t31.setParameters(r29.materialParameters);
      }
    }
    return 2;
  }
  prepareSymbolLayerPatch(e33) {
    if ("partial" !== e33.diff.type) return;
    const t30 = e33.diff.diff, r28 = {};
    "complete" === t30.size?.type && (r28.width = this._computeMaterialWidth(t30.size.newValue), delete t30.size), "complete" === t30.cap?.type && (r28.cap = r20(t30.cap.newValue ?? "butt"), delete t30.cap);
    const i24 = this._prepareMarkerPatch(e33, t30);
    this._prepareMaterialPatch(e33, t30, i24), e33.symbolLayerStatePatches.push(() => {
      for (const e34 of this._materials) e34?.setParameters(r28);
    });
  }
  layerOpacityChanged() {
    for (let e33 = 0; e33 < 5; e33++) this._materials[e33]?.setParameters(this._getMaterialColorParameters(e33));
  }
  get _screenSizePerspective() {
    return !this.draped && this._context.screenSizePerspectiveEnabled ? this.view.screenSizePerspective.parameters : null;
  }
  layerScreenSizePerspectiveChanged() {
    const e33 = this._screenSizePerspective;
    for (const t30 of this._materials) t30?.setParameters({ screenSizePerspective: e33 });
  }
  layerElevationInfoChanged(e33, t30, r28) {
    const i24 = this._elevationContext.mode, a26 = f10(_W.elevationModeChangeTypes, r28, i24);
    if (1 !== a26) return a26;
    const s27 = d7(i24);
    return this.updateGraphics3DGraphicElevationInfo(e33, t30, () => s27);
  }
  slicePlaneEnabledChanged() {
    const e33 = { hasSlicePlane: this._context.slicePlaneEnabled };
    for (const t30 of this._materials) t30?.setParameters(e33);
    return true;
  }
  physicalBasedRenderingChanged() {
    return true;
  }
  _createAs3DShape(e33, t30, r28) {
    const i24 = H2(e33.graphic.geometry), a26 = "polygon" === i24.type ? i24.rings : i24.paths, s27 = new Array(), o25 = u7(), l25 = s17(i24, this._context.elevationProvider, this._context.renderCoordsHelper, t30), n24 = "polygon" === i24.type ? "rings" : "paths";
    this._logGeometryCreationWarnings(l25, a26, n24, "LineSymbol3DLayer");
    for (let p14 = 0; p14 < l25.lines.length; p14++) {
      const t31 = l25.lines[p14], a27 = t31.position, n25 = t31.mapPositions;
      if (null != this._context.clippingExtent && (m2(n25, o25), !A(o25, this._context.clippingExtent))) continue;
      const c27 = this._createGeometry("polygon" === i24.type ? this._ringMaterial : this._lineMaterial, e33, a27, n25, i24.type, 1, r28);
      if (s27.push(c27), t13.LINE_WIREFRAMES && s27.push(c27.instantiate({ material: "polygon" === i24.type ? this._wireframeRingMaterial : this._wireframeLineMaterial })), null != this._markerMaterial) {
        const t32 = c27.instantiate({ material: this._markerMaterial });
        t32.attributes.has("color") && t32.setAttributeData("color", this._getDrivenMarkerColor(e33.renderingInfo)), s27.push(t32);
      }
    }
    if (0 === s27.length) return null;
    const c26 = this._context.layerViewUid, h19 = new W({ geometries: s27, castShadow: false, layerViewUid: c26, graphicUid: r28 }), _13 = new O2(this, h19, null, d8, t30);
    return _13.alignedSampledElevation = l25.sampledElevation, _13.needsElevationUpdates = d7(t30.mode), _13;
  }
  _createGeometry(e33, t30, r28, i24, a26, s27, o25) {
    const l25 = 0 === s27 ? { spatialReference: this._context.overlaySR, renderCoordsHelper: this._context.renderCoordsHelper } : null, n24 = "polygon" === a26, c26 = this._fastUpdates?.visualVariables.color, h19 = this._fastUpdates?.visualVariables.size, p14 = this._fastUpdates?.visualVariables.opacity, m21 = this._context.layerViewUid, y9 = this._context.stage.renderView.getObjectAndLayerIdColor({ graphicUid: o25, layerViewUid: m21 }), _13 = { position: r28, size: h19 ? null : this._getDrivenSize(t30.renderingInfo), color: c26 ? null : this._getDrivenColor(t30.renderingInfo), sizeFeature: h19 ? ot2(h19.field, t30.graphic) : null, colorFeature: c26 ? ot2(c26.field, t30.graphic) : null, opacityFeature: p14 ? ot2(p14.field, t30.graphic) : null };
    return f7(e33, { overlayInfo: l25, removeDuplicateStartEnd: n24, mapPositions: i24, attributeData: _13 }, y9);
  }
  _createAsOverlay(e33) {
    const t30 = e33.graphic, r28 = H2(t30.geometry), i24 = "polygon" === r28.type ? r28.rings : r28.paths, a26 = "polygon" === r28.type ? this._ringMaterial : this._lineMaterial;
    a26.renderPriority = this._renderPriority;
    const s27 = t13.LINE_WIREFRAMES ? "polygon" === r28.type ? this._wireframeRingMaterial : this._wireframeLineMaterial : null, o25 = this._markerMaterial;
    null != s27 && (s27.renderPriority = this._renderPriority - 1e-3), null != o25 && (o25.renderPriority = this._renderPriority - 2e-3);
    const l25 = new Array(), n24 = u7(), c26 = q3(), h19 = p7(r28, this._context.overlaySR), g13 = "polygon" === r28.type ? "rings" : "paths";
    this._logGeometryCreationWarnings(h19, i24, g13, "LineSymbol3DLayer");
    for (const p14 of h19.lines) {
      if (m2(p14.position, n24), !A(n24, this._context.clippingExtent)) continue;
      M(c26, n24);
      const i25 = this._createGeometry(a26, e33, p14.position, void 0, r28.type, 0, t30.uid), h20 = (e34) => {
        const r29 = this._context.layerViewUid, i26 = new h8(e34, { layerViewUid: r29, graphicUid: t30.uid });
        l25.push(i26);
      };
      if (null != o25) {
        const t31 = i25.instantiate({ material: o25 });
        t31.attributes.has("color") && t31.setAttributeData("color", this._getDrivenMarkerColor(e33.renderingInfo)), h20(t31);
        const r29 = this.symbolLayer.marker.placement;
        "begin" !== r29 && "begin-end" !== r29 || s4(n24, p14.position, 0, 1), "end" !== r29 && "begin-end" !== r29 || s4(n24, p14.position, p14.position.length - 3, 1);
      }
      h20(i25), t13.LINE_WIREFRAMES && h20(i25.instantiate({ material: s27 }));
    }
    return new c18(this, l25, c26, this._context.drapeSourceRenderer);
  }
  get _patternHidesLine() {
    const e33 = this.symbolLayer.pattern;
    return null != e33 && "style" === e33.type && "none" === e33.style;
  }
  _computeMaterialWidth(e33) {
    return e33 = e33 ?? e4(1), this._drivenProperties.size ? this._fastUpdates?.visualVariables.size ? u3(1) : 1 : u3(e33);
  }
  _prepareMaterialPatch(e33, t30, r28) {
    const i24 = t30.material;
    if (null == i24) return void (r28.changed && r28.useMaterialColor && B4(this._getCombinedOpacityAndColor(this._materialColor), this._materials[4], e33));
    if ("collection" === i24.type) return;
    const a26 = "complete" === i24.type ? i24.newValue?.color : "complete" === i24.diff.color?.type ? i24.diff.color.newValue : null, s27 = this._getCombinedOpacityAndColor(a26);
    r28.useMaterialColor && B4(t3(s27), this._materials[4], e33), this._patternHidesLine && (s27[3] = 0), B4(s27, this._materials[0], e33), delete t30.material;
  }
  _prepareMarkerPatch(e33, t30) {
    const r28 = t30.marker, i24 = this._markerMaterial;
    if (null == r28 || "partial" !== r28.type || null == r28.diff || null != r28.diff.placement || null != r28.diff.style && "complete" !== r28.diff.style.type || null != r28.diff.color && "complete" !== r28.diff.color.type || null == i24) return { changed: false, useMaterialColor: null == this._markerColor };
    const a26 = r28.diff.color, s27 = null != a26, o25 = s27 ? a26.newValue : null, l25 = null == o25 && null == this._markerColor;
    o25 && B4(this._getCombinedOpacityAndColor(o25), i24, e33);
    const n24 = r28.diff.style?.newValue;
    return n24 && e33.symbolLayerStatePatches.push(() => i24.setParameters({ markerPrimitive: t25(n24) })), delete t30.marker, { changed: s27, useMaterialColor: l25 };
  }
  _fastVisualVariableConvertOptions(e33 = false) {
    const t30 = this._getFallbackSize();
    return new G3({ supports: { size: true, color: true, rotation: false, opacity: true }, fallbackColor: e33 ? this._getFallbackMarkerOpacityAndColor(O3) : this._getFallbackOpacityAndColor(O3), fallbackSize: r3(t30, t30, t30) });
  }
  _getFallbackOpacityAndColor(t30) {
    return u10.toUnitRGBA(this._materialColor) ?? t30;
  }
  _getFallbackOpacity() {
    return this._materialColor?.a ?? 0;
  }
  _getFallbackMarkerOpacityAndColor(t30) {
    const r28 = this.symbolLayer?.marker?.color;
    return u10.toUnitRGBA(r28) ?? this._getFallbackOpacityAndColor(t30);
  }
  _getFallbackMarkerOpacity() {
    return this.symbolLayer?.marker?.color?.a ?? this._getFallbackOpacity();
  }
  _getFallbackSize() {
    const e33 = this.symbolLayer?.size;
    return null != e33 ? u3(e33) : 1;
  }
};
_W.elevationModeChangeTypes = { definedChanged: 2, staysOnTheGround: 0, onTheGroundChanged: 2 };
var W2 = _W;
function H2(e33) {
  switch (e33.type) {
    case "extent":
      if (e33 instanceof z) return P2.fromExtent(e33);
      break;
    case "polygon":
    case "polyline":
      return e33;
  }
  return null;
}
function B4(e33, t30, r28) {
  null != t30 && r28.symbolLayerStatePatches.push(() => t30.setParameters({ color: e33 }));
}
function T4(e33) {
  const t30 = e33.material?.color, r28 = e33.marker?.color ?? t30;
  return 1 === (t30?.a ?? 0) && 1 === (r28?.a ?? 0);
}

// node_modules/@arcgis/core/views/3d/layers/graphics/meshAutoFastUpdateConstants.js
var e26 = { disableDelayMs: 2e3 };

// node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DMeshObject3DGraphicLayer.js
var h10 = class extends O2 {
  constructor() {
    super(...arguments), this.fastTransformUpdatesAllowed = false, this._originalGeometries = [], this._fastTransformUpdatesEnabled = false, this._autoDisableFastUpdatesTimeoutId = 0;
  }
  get fastTransformUpdatesEnabled() {
    return this._fastTransformUpdatesEnabled;
  }
  destroy() {
    super.destroy(), this._cancelAutoDisableFastUpdates();
  }
  enableFastTransformUpdates(e33, a26) {
    if (!this.fastTransformUpdatesAllowed || this._fastTransformUpdatesEnabled) return;
    this._cancelAutoDisableFastUpdates(), this._fastTransformUpdatesEnabled = true;
    const { stageObject: s27 } = this, r28 = s27.geometries.slice();
    s27.removeAllGeometries();
    const i24 = I(g10, s27.transformation), o25 = a26.getOrigin(i24);
    for (const t30 of r28) {
      const a27 = e33(t30.material), r29 = t30.instantiate({ material: a27 });
      r29.localOrigin = o25, s27.addGeometry(r29);
    }
    this._originalGeometries = r28;
  }
  autoDisableFastTransformUpdates(t30) {
    this._cancelAutoDisableFastUpdates(), this._autoDisableFastUpdatesTimeoutId = setTimeout(() => {
      this._autoDisableFastUpdatesTimeoutId = 0, t30();
    }, e26.disableDelayMs);
  }
  updateAutoDisableFastTransformUpdates(t30) {
    this._autoDisableFastUpdatesTimeoutId && this.autoDisableFastTransformUpdates(t30);
  }
  _cancelAutoDisableFastUpdates() {
    clearTimeout(this._autoDisableFastUpdatesTimeoutId), this._autoDisableFastUpdatesTimeoutId = 0;
  }
  disableFastTransformUpdates(t30) {
    if (!this._fastTransformUpdatesEnabled) return;
    this._cancelAutoDisableFastUpdates(), this._fastTransformUpdatesEnabled = false;
    const { stageObject: e33 } = this, a26 = e33.geometries.map((e34) => t30(e34.material));
    e33.removeAllGeometries();
    for (let s27 = 0; s27 < this._originalGeometries.length; s27++) {
      const t31 = this._originalGeometries[s27], r28 = a26[s27];
      r28.setParameters({ modelTransformation: null }), r28 === t31.material ? e33.addGeometry(t31) : e33.addGeometry(t31.instantiate({ material: r28 }));
    }
    this._originalGeometries.length = 0;
  }
  updateFastLocalOrigin(e33, a26, s27) {
    if (!this._fastTransformUpdatesEnabled) return;
    const { stageObject: r28 } = this;
    if (0 === r28.geometries.length) return;
    const o25 = r28.geometries[0].localOrigin, n24 = I(g10, e33), m21 = s27.getOrigin(n24);
    if (m21 === o25) return;
    const l25 = a26?.localMatrix ?? r5;
    r28.shaderTransformation = null, r28.transformation = e33, r28.geometries.forEach((t30) => {
      t30.transformation = l25, t30.localOrigin = m21;
    });
  }
  updateTransform(t30, s27, r28) {
    const { stageObject: o25 } = this, n24 = s27?.localMatrix ?? r5;
    if (!this._fastTransformUpdatesEnabled) return o25.shaderTransformation = null, o25.transformation = t30, o25.geometries.forEach((t31) => t31.transformation = n24), void this._updateEdgeTransform(r28);
    const m21 = o25.transformation, l25 = o25.geometries[0].transformation, f19 = t30, d16 = n24, c26 = c(p11, m21, l25), h19 = c(u25, f19, d16), g13 = c(b8, h19, h2(b8, l25));
    o25.shaderTransformation = g13, this._setFastMaterialTransformation({ matA: c26, matB: h19 }), this._updateEdgeTransform(r28);
  }
  alignWithElevation(t30, a26, r28) {
    if (!this._fastTransformUpdatesEnabled) return void super.alignWithElevation(t30, a26, r28);
    const i24 = (e33, s27) => c12(e33, t30, this.elevationContext, a26, s27), { stageObject: o25 } = this;
    if (!o25.geometries[0].material.parameters.modelTransformation) return;
    const n24 = o25.transformation, m21 = o25.geometries[0].transformation, d16 = c(p11, n24, m21), c26 = o25.effectiveTransformation, h19 = n3(T5, c26);
    this.alignedSampledElevation = u18(this, this.elevationContext, t30.spatialReference, i24, a26, h19), o25.shaderTransformation = h19;
    const g13 = o25.geometries[0].transformation, b14 = c(u25, h19, g13);
    this._setFastMaterialTransformation({ matA: d16, matB: b14 }), this._updateEdgeTransform(r28);
  }
  _setFastMaterialTransformation({ matA: t30, matB: s27 }) {
    const { stageObject: i24 } = this;
    if (0 === i24.geometries.length) return;
    const o25 = i24.geometries[0].localOrigin, m21 = q(E5, g2(g10, o25.vec3, -1)), l25 = c(_7, m21, t30), f19 = c(U4, m21, s27), d16 = h2(_7, l25), c26 = c(U4, f19, d16);
    for (const e33 of i24.geometries) e33.material.setParameters({ modelTransformation: c26 });
  }
  _updateEdgeTransform(t30) {
    const { stageObject: e33, _stageLayer: a26 } = this;
    a26.stage.renderer.withEdgeView((a27) => {
      a27.fastUpdateObject3DEdgesTransform(e33) || this.resetEdgeObject(t30);
    });
  }
};
var g10 = n2();
var p11 = e10();
var u25 = e10();
var T5 = e10();
var b8 = e10();
var _7 = e10();
var U4 = e10();
var E5 = e10();

// node_modules/@arcgis/core/views/3d/layers/graphics/MeshFastUpdateProcessor.js
var t26 = class {
  constructor() {
    this._fastTransformOriginalMaterials = /* @__PURE__ */ new Map(), this._fastTransformClonedMaterials = /* @__PURE__ */ new Map(), this._graphicReferenceCount = 0;
  }
  enable(t30, e33, r28) {
    t30.enableFastTransformUpdates((t31) => {
      if (this._graphicReferenceCount <= 1) {
        if (this._fastTransformOriginalMaterials.has(t31)) return t31;
        const a26 = e33.byMaterial(t31);
        return this._fastTransformOriginalMaterials.set(t31, a26), e33.delete(t31), t31;
      }
      const s27 = new P5(t31.parameters, r28);
      return this._fastTransformClonedMaterials.set(s27, t31), s27;
    }, r28.localOriginFactory);
  }
  disable(a26, t30) {
    const e33 = /* @__PURE__ */ new Set(), r28 = /* @__PURE__ */ new Set();
    a26.disableFastTransformUpdates((a27) => {
      if (!this._fastTransformClonedMaterials.has(a27)) {
        const s28 = a27, i25 = this._fastTransformOriginalMaterials.get(s28);
        return t30.has(i25.uid) ? (e33.add(s28), t30.byUid(i25.uid).material) : (r28.add(s28), i25.material);
      }
      const s27 = a27, i24 = this._fastTransformClonedMaterials.get(s27);
      return this._fastTransformClonedMaterials.delete(s27), i24;
    });
    for (const s27 of e33) this._fastTransformOriginalMaterials.delete(s27);
    for (const s27 of r28) {
      const a27 = this._fastTransformOriginalMaterials.get(s27);
      this._fastTransformOriginalMaterials.delete(s27), t30.set(a27.uid, a27);
    }
  }
  onAddGraphic() {
    this._graphicReferenceCount++;
  }
  onRemoveGraphic(a26, t30) {
    this._graphicReferenceCount--, this.disable(a26, t30);
  }
  forEachMaterialInfo(a26) {
    this._fastTransformOriginalMaterials.forEach(a26);
  }
  forEachClonedMaterial(a26) {
    this._fastTransformClonedMaterials.forEach(a26);
  }
  destroy() {
    this._fastTransformClonedMaterials.clear(), this._fastTransformOriginalMaterials.clear();
  }
};
var e27 = class {
  constructor() {
    this._byUid = /* @__PURE__ */ new Map(), this._byMaterial = /* @__PURE__ */ new Map();
  }
  get materials() {
    return Array.from(this._byUid.values(), (a26) => a26.material);
  }
  byUid(a26) {
    return this._byUid.get(a26);
  }
  byMaterial(a26) {
    return this._byMaterial.get(a26);
  }
  set(a26, t30) {
    this._byUid.set(a26, t30), this._byMaterial.set(t30.material, t30);
  }
  delete(a26) {
    const t30 = this._byMaterial.get(a26)?.uid;
    t30 && (this._byUid.delete(t30), this._byMaterial.delete(a26));
  }
  has(a26) {
    return this._byUid.has(a26);
  }
  forEachMaterialInfo(a26) {
    this._byUid.forEach(a26);
  }
  clear() {
    this._byUid.clear(), this._byMaterial.clear();
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/NativeLineTechnique.js
var j8 = class extends m10 {
  constructor(e33, t30) {
    super(e33, t30, new t16(d10, () => import("./NativeLine.glsl-RKDE3J3S.js")), t30.hasVertexColors ? v4.locations : o18.locations), this.primitiveType = _4.LINES;
  }
  initializePipeline(r28) {
    const { hasOccludees: t30, output: a26, transparent: p14, oitPass: u30 } = r28, c26 = (e33, r29 = null, p15 = null) => T3({ blending: r29, depthTest: a17, depthWrite: p15, colorWrite: d4, stencilWrite: t30 ? f8 : null, stencilTest: t30 ? e33 ? t17 : c10 : null, drawBuffers: d5(u30, a26) });
    return o13(a26) ? (this._occludeePipeline = c26(true, p14 ? r13 : null, c9), c26(false, p14 ? r13 : null, c9)) : c26(false);
  }
  getPipeline(e33) {
    return e33 ? this._occludeePipeline : super.getPipeline();
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/NativeLineTechniqueConfiguration.js
var s20 = class extends e20 {
  constructor() {
    super(...arguments), this.hasVertexColors = false, this.transparent = false, this.hasOccludees = false, this.writeDepth = true, this.draped = false, this.snowCover = false, this.emissionSource = 0, this.textureCoordinateType = 0;
  }
  get discardInvisibleFragments() {
    return this.transparent && this.writeDepth;
  }
};
__decorate([i13()], s20.prototype, "hasVertexColors", void 0), __decorate([i13()], s20.prototype, "transparent", void 0), __decorate([i13()], s20.prototype, "hasOccludees", void 0), __decorate([i13()], s20.prototype, "writeDepth", void 0);

// node_modules/@arcgis/core/views/3d/webgl-engine/materials/NativeLineMaterial.js
var U5 = class extends s13 {
  constructor(e33) {
    super(e33, P6), this._configuration = new s20(), this.produces = /* @__PURE__ */ new Map([[2, (e34) => x2(e34)]]);
  }
  getConfiguration(e33, t30) {
    return super.getConfiguration(e33, t30, this._configuration), this._configuration.hasSlicePlane = this.parameters.hasSlicePlane, this._configuration.hasVertexColors = this.parameters.hasVertexColors, this._configuration.transparent = this.parameters.color[3] < 1 || this.parameters.width < 1, this._configuration.hasOccludees = t30.hasOccludees, this._configuration;
  }
  get visible() {
    return this.parameters.color[3] >= o17;
  }
  intersect(t30, r28, f19, p14, d16, x12) {
    const { options: y9, camera: S10, rayBegin: M8, rayEnd: _13 } = f19;
    if (!y9.selectionMode || !t30.visible || !S10) return;
    if (!m4(r28)) return void i.getLogger("esri.views.3d.webgl-engine.materials.NativeLineMaterial").error("intersection assumes a translation-only matrix");
    const C7 = t30.attributes.get("position").data, T10 = H3;
    r4(T10, f19.point);
    const A9 = 2;
    o7(I4[0], T10[0] - A9, T10[1] + A9, 0), o7(I4[1], T10[0] + A9, T10[1] + A9, 0), o7(I4[2], T10[0] + A9, T10[1] - A9, 0), o7(I4[3], T10[0] - A9, T10[1] - A9, 0);
    for (let e33 = 0; e33 < 4; e33++) if (!S10.unprojectFromRenderScreen(I4[e33], J5[e33])) return;
    w3(S10.eye, J5[0], J5[1], K5), w3(S10.eye, J5[1], J5[2], Q4), w3(S10.eye, J5[2], J5[3], Y3), w3(S10.eye, J5[3], J5[0], Z4);
    let V8 = Number.MAX_VALUE, N4 = 0;
    for (let e33 = 0; e33 < C7.length - 5; e33 += 3) {
      if (q5[0] = C7[e33] + r28[12], q5[1] = C7[e33 + 1] + r28[13], q5[2] = C7[e33 + 2] + r28[14], B5[0] = C7[e33 + 3] + r28[12], B5[1] = C7[e33 + 4] + r28[13], B5[2] = C7[e33 + 5] + r28[14], X(K5, q5) < 0 && X(K5, B5) < 0 || X(Q4, q5) < 0 && X(Q4, B5) < 0 || X(Y3, q5) < 0 && X(Y3, B5) < 0 || X(Z4, q5) < 0 && X(Z4, B5) < 0) continue;
      const t31 = S10.projectToRenderScreen(q5, W3), o25 = S10.projectToRenderScreen(B5, X3);
      if (null == t31 || null == o25) continue;
      if (t31[2] < 0 && o25[2] > 0) {
        c2(D3, q5, B5);
        const e34 = S10.frustum, r29 = -X(e34[4], q5) / P3(D3, k3(e34[4]));
        if (g2(D3, D3, r29), u8(q5, q5, D3), !S10.projectToRenderScreen(q5, t31)) continue;
      } else if (t31[2] > 0 && o25[2] < 0) {
        c2(D3, B5, q5);
        const e34 = S10.frustum, t32 = -X(e34[4], B5) / P3(D3, k3(e34[4]));
        if (g2(D3, D3, t32), u8(B5, B5, D3), !S10.projectToRenderScreen(B5, o25)) continue;
      } else if (t31[2] < 0 && o25[2] < 0) continue;
      t31[2] = 0, o25[2] = 0;
      const s27 = M2(b4(t31, o25, z4), T10);
      s27 < V8 && (V8 = s27, s7(k6, q5), s7(G4, B5), N4 = e33 / 3);
    }
    if (V8 < A9 * A9) {
      let e33 = Number.MAX_VALUE;
      if (B2(b4(k6, G4, z4), b4(M8, _13, F5), O4)) {
        c2(O4, O4, M8);
        const t31 = r7(O4);
        g2(O4, O4, 1 / t31), e33 = t31 / p3(M8, _13);
      }
      x12(e33, O4, N4);
    }
  }
  intersectDraped(e33, r28, o25, s27, i24) {
    if (!r28.options.selectionMode) return;
    const n24 = e33.attributes.get("position").data, a26 = e33.attributes.get("size"), c26 = a26 ? a26.data[0] : 0, l25 = o25[0], m21 = o25[1], u30 = ((c26 + 1) / 2 + 4) * e33.screenToWorldRatio;
    let f19 = Number.MAX_VALUE, p14 = 0;
    for (let h19 = 0; h19 < n24.length - 5; h19 += 3) {
      const e34 = n24[h19], r29 = n24[h19 + 1], o26 = l25 - e34, s28 = m21 - r29, i25 = n24[h19 + 3] - e34, a27 = n24[h19 + 4] - r29, c27 = r2((i25 * o26 + a27 * s28) / (i25 * i25 + a27 * a27), 0, 1), u31 = i25 * c27 - o26, g13 = a27 * c27 - s28, d16 = u31 * u31 + g13 * g13;
      d16 < f19 && (f19 = d16, p14 = h19 / 3);
    }
    f19 < u30 * u30 && s27(i24.distance, i24.normal, p14);
  }
  createGLMaterial(e33) {
    return new E6(e33);
  }
  createBufferWriter() {
    const e33 = this.parameters.hasVertexColors ? v4 : o18;
    return new s14(e33);
  }
};
var E6 = class extends t15 {
  beginSlot(e33) {
    return this.getTechnique(j8, e33);
  }
};
var P6 = class extends a14 {
  constructor() {
    super(...arguments), this.color = s6, this.hasVertexColors = false, this.hasSlicePlane = false, this.width = 1;
  }
};
var q5 = n2();
var B5 = n2();
var D3 = n2();
var O4 = n2();
var W3 = y();
var X3 = y();
var k6 = n2();
var G4 = n2();
var z4 = v3();
var F5 = v3();
var H3 = n2();
var I4 = [y(), y(), y(), y()];
var J5 = [n2(), n2(), n2(), n2()];
var K5 = j5();
var Q4 = j5();
var Y3 = j5();
var Z4 = j5();

// node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DMeshFillSymbolLayer.js
var Re = ["mesh"];
var Pe = class extends m13 {
  constructor(e33, t30, r28, o25) {
    super(e33, t30, r28, o25, We(t30)), this._materialInfoCache = new e27(), this._fastUpdateProcessor = new t26(), this._textures = /* @__PURE__ */ new Map(), this.ensureDrapedStatus(false);
  }
  async doLoad() {
    t13.DRAW_MESH_GEOMETRY_NORMALS && (this._debugVertexNormalMaterial = new U5({ color: [1, 0, 1, 1] }), this._debugTangentNormalMaterial = new U5({ color: [1, 0.5, 0, 1] }), this._debugFaceNormalMaterial = new U5({ color: [0, 1, 1, 1] })), this.updateComplexity();
  }
  destroy() {
    super.destroy(), this._textures.forEach((e33) => e33.unload()), this._context.stage.removeTextures(Array.from(this._textures.values())), this._materialInfoCache.clear(), this._textures.clear(), this._fastUpdateProcessor.destroy();
  }
  get materials() {
    return this._materialInfoCache.materials;
  }
  createGraphics3DGraphic(e33) {
    const t30 = e33.graphic;
    if (!this._validateGeometry(t30.geometry, Re, "fill on mesh-3d")) return null;
    const r28 = this.createElevationContextForGraphic(t30), o25 = e33.renderingInfo;
    return this._createAs3DShape(t30, o25, r28, t30.uid);
  }
  onRemoveGraphic(e33) {
    this._fastUpdateProcessor.onRemoveGraphic(e33, this._materialInfoCache);
  }
  layerOpacityChanged(e33, t30) {
    const r28 = this._getLayerOpacity();
    this._updateMaterialParameters((e34) => {
      e34.material.setParameters({ layerOpacity: r28 });
      const t31 = e34.material.parameters;
      this._setMaterialTextureAlphaMode(t31, e34);
    }), e33?.forEach((e34) => t30(e34)?.layerOpacityChanged(r28, this._context.isAsync));
  }
  layerScreenSizePerspectiveChanged() {
  }
  layerElevationInfoChanged(e33, t30) {
    return this.updateGraphics3DGraphicElevationInfo(e33, t30, m11);
  }
  slicePlaneEnabledChanged(e33, t30) {
    return this._updateMaterialParameters(({ material: e34 }) => {
      e34.setParameters({ hasSlicePlane: this._context.slicePlaneEnabled });
    }), e33?.forEach((e34) => t30(e34)?.slicePlaneEnabledChanged(this._context.slicePlaneEnabled, this._context.isAsync)), true;
  }
  physicalBasedRenderingChanged() {
    const e33 = this._usePBR();
    return this._updateMaterialParameters(({ material: t30 }) => t30.setParameters({ usePBR: e33 })), true;
  }
  updateTransform(e33, t30, r28, o25) {
    if (!e33.fastTransformUpdatesAllowed) return false;
    const n24 = e33.fastTransformUpdatesEnabled;
    switch (o25) {
      case 0:
        if (n24) return true;
        break;
      case 1:
        if (!n24) return true;
        break;
      default:
        if (!n24) return !!this.updateTransform(e33, t30, r28, 0) && (e33.autoDisableFastTransformUpdates(() => this.updateTransform(e33, t30, r28, 1)), true);
    }
    const a26 = this._context.renderCoordsHelper.spatialReference, s27 = tt4, { origin: i24, transform: l25 } = r28;
    if (!f6(t30, o7(Ke, i24.x, i24.y, i24.z ?? 0), s27, a26)) return false;
    switch (o25) {
      case 0:
        this._fastUpdateProcessor.enable(e33, this._materialInfoCache, this._context);
        break;
      case 1:
        this._fastUpdateProcessor.disable(e33, this._materialInfoCache);
        break;
      case 2:
        e33.updateFastLocalOrigin(s27, l25, this._context.localOriginFactory);
    }
    const { elevationContext: c26 } = e33;
    c26.centerInElevationSR = this._getCenterInElevationSR(s27);
    const { elevationProvider: u30, renderCoordsHelper: m21 } = this._context, f19 = (e34, t31) => c12(e34, u30, c26, m21, t31);
    return e33.alignedSampledElevation = u18(e33, c26, u30.spatialReference, f19, m21, s27), e33.updateTransform(s27, l25, this._context.isAsync), e33.updateAutoDisableFastTransformUpdates(() => this.updateTransform(e33, t30, r28, 1)), true;
  }
  computeComplexity() {
    if (!this._textures || 0 === this._textures.size) return super.computeComplexity();
    let e33 = 0;
    for (const o25 of this._textures.values()) e33 += o25.usedMemory;
    const t30 = { ...C3(this.symbol, this.symbolLayer), resourceBytes: e33 }, r28 = s15(this.symbolLayer) ? 2 : 0;
    return new e24({ drawCallsPerFeature: r28, memory: t30 });
  }
  _requiresSymbolVertexColors() {
    return this._hasDrivenColorOrOpacity;
  }
  _materialPropertiesDefault(e33, t30) {
    const r28 = this._requiresSymbolVertexColors(), o25 = !!e33.vertexAttributes.color, n24 = !!e33.vertexAttributes.tangent;
    return { hasSymbolVertexColors: r28, hasVertexColors: o25, hasVertexTangents: n24, uid: `vc:${o25},vt:${n24},vct${t30},svc:${r28}` };
  }
  _materialProperties(e33, t30, r28) {
    const o25 = this._materialPropertiesDefault(e33, r28);
    if (!t30.material) return o25;
    const { color: n24, colorTexture: a26, colorTextureTransform: s27, normalTexture: i24, normalTextureTransform: l25, doubleSided: c26, alphaCutoff: u30, alphaMode: m21 } = t30.material, f19 = ke(n24), p14 = ke(a26), h19 = ze(s27), d16 = ke(i24), g13 = ze(l25);
    if (o25.color = n24, o25.colorTexture = a26, o25.normalTexture = i24, o25.uid = `${o25.uid},cmuid:${f19},ctmuid:${p14},cttuid:${h19},ntmuid:${d16},nttuid:${g13},ds:${c26},ac:${u30},am:${m21}`, t30.material instanceof u11) {
      const { metallic: e34, roughness: r29, metallicRoughnessTexture: n25, metallicRoughnessTextureTransform: a27, emissiveColor: i25, emissiveTexture: c27, emissiveTextureTransform: u31, occlusionTexture: m22, occlusionTextureTransform: f20 } = t30.material, p15 = ke(n25), h20 = ze(a27), d17 = ke(i25), g14 = ke(c27), x12 = ze(u31), _13 = ke(m22), y9 = ze(f20);
      o25.uid = `${o25.uid},mrm:${e34},mrr:${r29},mrt:${p15},mrtt:${h20},emuid:${d17},etmuid:${g14},ett:${x12},otmuid:${_13},ott:${y9}`, o25.metallic = e34, o25.roughness = r29, o25.metallicRoughnessTexture = n25, o25.emissiveColor = i25, o25.emissiveTexture = c27, o25.occlusionTexture = m22, o25.colorTextureTransform = $e(s27), o25.normalTextureTransform = $e(l25), o25.emissiveTextureTransform = $e(u31), o25.occlusionTextureTransform = $e(f20), o25.metallicRoughnessTextureTransform = $e(a27);
    }
    return o25;
  }
  _getInternalTexture(e33, t30 = false, r28 = 1) {
    const a26 = He(e33);
    if (!a26) return null;
    const s27 = `${e33.contentHash}/${r28}`;
    let i24 = this._textures.get(s27);
    if (i24) {
      const e34 = this._context.stage.renderView.textures;
      let t31 = null;
      const r29 = e34.acquire(i24.id);
      return null == r29 || C(r29) || (i24.events.on("unloaded", () => t31 = t(t31)), t31 = r29), i24;
    }
    let l25 = null;
    const c26 = this._context.stage.renderView.renderingContext.parameters.maxMaxAnisotropy, u30 = { wrap: Ge(e33.wrap), noUnpackFlip: true, maxAnisotropy: c26, mipmap: c26 > 1 };
    return t11(a26) ? (l25 = a26.data, u30.preMultiplyAlpha = false, u30.encoding = a26.encoding) : (l25 = a26, u30.preMultiplyAlpha = 1 !== r28, u30.compressionOptions = t30 ? { compressionTracker: this._context.compressionTracker, compressionCallback: () => this.updateComplexity() } : void 0), i24 = new M3(l25, u30), this._textures.set(s27, i24), i24.events.on("loaded", () => this.updateComplexity()), i24.load(this._context.stage.renderView.renderingContext), this._context.stage.addTexture(i24), i24.events.on("unloaded", () => {
      this._textures.delete(s27);
    }), i24;
  }
  _setInternalMaterialTextureParameters(r28, o25) {
    if (null != r28.colorTexture) {
      const e33 = 1 !== o25.textureAlphaMode, t30 = this._getInternalTexture(r28.colorTexture, e33, o25.textureAlphaMode);
      t30 ? (o25.textureId = t30.id, o25.textureAlphaPremultiplied = !!t30.parameters.preMultiplyAlpha) : o25.textureId = void 0;
    }
    if (r28.normalTexture && (o25.normalTextureId = this._getInternalTexture(r28.normalTexture)?.id), r28.emissiveColor) {
      const n24 = u10.toUnitRGB(r28.emissiveColor);
      o25.emissiveBaseColor = r3(k(n24[0]), k(n24[1]), k(n24[2]));
    }
    r28.emissiveTexture && (o25.emissiveTextureId = this._getInternalTexture(r28.emissiveTexture)?.id), r28.occlusionTexture && (o25.occlusionTextureId = this._getInternalTexture(r28.occlusionTexture, true)?.id), r28.metallicRoughnessTexture && (o25.metallicRoughnessTextureId = this._getInternalTexture(r28.metallicRoughnessTexture, true)?.id);
  }
  _setInternalMaterialParameters(e33, t30, r28) {
    null != e33.color && Ne(e33.color, t30, r28), this._setInternalMaterialTextureParameters(e33, t30), t30.colorTextureTransformMatrix = s16(e33.colorTextureTransform), t30.normalTextureTransformMatrix = s16(e33.normalTextureTransform);
    const o25 = null != e33.normalTextureTransform?.scale ? e33.normalTextureTransform?.scale : a8;
    t30.scale = [o25[0], o25[1]], t30.occlusionTextureTransformMatrix = s16(e33.occlusionTextureTransform), t30.emissiveTextureTransformMatrix = s16(e33.emissiveTextureTransform), t30.metallicRoughnessTextureTransformMatrix = s16(e33.metallicRoughnessTextureTransform);
  }
  _setExternalMaterialParameters(t30, r28 = this._materialColor) {
    const o25 = this._drivenProperties.color, n24 = this._drivenProperties.opacity;
    if (o25) t30.externalColor = s6;
    else {
      const o26 = r28 ?? null;
      if (o26) {
        const r29 = u10.toUnitRGBA(o26);
        n24 && (r29[3] = 1), t30.externalColor = r29;
      } else t30.externalColor = O3;
    }
    t30.colorMixMode = this.symbolLayer.material?.colorMixMode ?? "multiply", t30.castShadows = !!this.symbolLayer.castShadows, t30.emissiveStrength = this.symbolLayer?.material?.emissive?.strength ?? 1, t30.emissiveSource = l6(this.symbolLayer?.material?.emissive?.source ?? "emissive");
  }
  _getOrCreateMaterial(t30, r28) {
    const o25 = r28.material?.color, n24 = r28.material?.colorTexture, a26 = r28.material?.alphaMode, s27 = "blend" === a26, i24 = !("opaque" === a26) && (Le(t30) || null != o25 && o25.a < 1 || n24?.transparent || s27), l25 = this._materialProperties(t30, r28, i24), c26 = this._materialInfoCache.byUid(l25.uid);
    if (c26) return this._setInternalMaterialTextureParameters(l25, c26.material.parameters), c26.material;
    const u30 = { uid: l25.uid, material: null, isComponentTransparent: i24, alphaMode: r28.material ? r28.material.alphaMode : "opaque" }, m21 = n17({ normalTexture: l25.normalTexture, metallicRoughnessTexture: l25.metallicRoughnessTexture, metallicFactor: l25.metallic, roughnessFactor: l25.roughness, emissiveTexture: l25.emissiveTexture, emissiveFactor: u10.toUnitRGB(l25.emissiveColor), occlusionTexture: l25.occlusionTexture }), f19 = { usePBR: this._usePBR(), isSchematic: m21, hasVertexColors: l25.hasVertexColors, hasSymbolColors: l25.hasSymbolVertexColors, hasVertexTangents: l25.hasVertexTangents, ambient: a4, diffuse: _2, opacity: 1, doubleSided: true, doubleSidedType: "winding-order", cullFace: 0, layerOpacity: this._getLayerOpacity(), hasSlicePlane: this._context.slicePlaneEnabled, drivenOpacity: this.needsDrivenTransparentPass || u30.isComponentTransparent };
    f19.mrrFactors = m21 ? o16 : [l25.metallic, l25.roughness, t18[2]], r28.material && (f19.doubleSided = r28.material.doubleSided, f19.cullFace = r28.material.doubleSided ? 0 : 2, f19.textureAlphaCutoff = r28.material.alphaCutoff), this._setExternalMaterialParameters(f19), this._setMaterialTextureAlphaMode(f19, u30), this._setInternalMaterialParameters(l25, f19, u30);
    const p14 = new P5(f19, this._context);
    return u30.material = p14, this._materialInfoCache.set(l25.uid, u30), p14;
  }
  prepareSymbolLayerPatch(e33) {
    if ("partial" !== e33.diff.type) return;
    const t30 = e33.diff.diff;
    this._preparePatchColor(e33, t30);
  }
  _preparePatchColor(e33, t30) {
    if (!t30.material || "partial" !== t30.material.type) return;
    const r28 = t30.material.diff;
    if (!r28.color || "complete" !== r28.color.type || null == r28.color.newValue || null == r28.color.oldValue) return;
    const o25 = r28.color.newValue;
    delete r28.color, e33.symbolLayerStatePatches.push(() => {
      this._updateMaterialParameters((e34) => {
        const t31 = e34.material.parameters;
        this._setExternalMaterialParameters(t31, o25), this._setMaterialTextureAlphaMode(t31, e34), e34.material.setParameters({ externalColor: t31.externalColor });
      });
    });
  }
  _usePBR() {
    return this._context.physicalBasedRenderingEnabled;
  }
  _setMaterialTextureAlphaMode(e33, t30) {
    if ("auto" === t30.alphaMode) {
      const r28 = this.needsDrivenTransparentPass || t30.isComponentTransparent || (e33.layerOpacity ?? 1) < 1 || (e33.opacity ?? 1) < 1 || (e33.externalColor?.[3] ?? 1) < 1;
      e33.textureAlphaMode = r28 ? 3 : 1;
    } else e33.textureAlphaMode = "opaque" === t30.alphaMode ? 1 : "mask" === t30.alphaMode ? 2 : 0;
  }
  _createFaceDebugNormals(e33, t30) {
    const r28 = t30.length, o25 = e33.spatialReference.isGeographic ? 20015077 / 180 : 1, n24 = 0.1 * Math.max(e33.extent.width * o25, e33.extent.height * o25, e33.extent.zmax - e33.extent.zmin), s27 = [], l25 = [], c26 = t30[0].transformation, u30 = j2(e9(), c26);
    for (let a26 = 0; a26 < r28; a26++) {
      const e34 = t30[a26].attributes.get("position");
      if (!e34) continue;
      const r29 = e34.data, o26 = e34.indices;
      for (let t31 = 0; t31 < o26.length; t31 += 3) Ve(r29, o26, t31, Ze), Fe(r29, o26, t31, Ke, Qe, Xe), u8(Ke, Ke, Qe), u8(Ke, Ke, Xe), g2(Ke, Ke, 1 / 3), E3(Ke, Ke, c26), s27.push(...Ke), N2(Ze, Ze, u30), A2(Ze, Ze), q4(Ke, Ke, Ze, n24), s27.push(...Ke), l25.push(l25.length), l25.push(l25.length);
    }
    return s27.length ? new m7(this._debugFaceNormalMaterial, [["position", new t12(s27, l25, 3, true)]], null, 2) : null;
  }
  _createPerVertexDebugVectors(e33, t30, r28, o25, n24) {
    const l25 = t30.length, c26 = e33.spatialReference.isGeographic ? 20015077 / 180 : 1, u30 = 0.1 * n24 * Math.max(e33.extent.width * c26, e33.extent.height * c26, e33.extent.zmax - e33.extent.zmin), m21 = [], f19 = [], p14 = t30[0].transformation, h19 = j2(e9(), p14);
    "tangent" === r28 && n4(h19, p14);
    for (let a26 = 0; a26 < l25; a26++) {
      const e34 = t30[a26], o26 = e34.attributes.get("position"), n25 = e34.attributes.get(r28);
      if (!o26 || !n25) continue;
      const s27 = o26.data, i24 = o26.indices, l26 = n25.data, c27 = n25.indices;
      for (let t31 = 0; t31 < i24.length; t31++) {
        const e35 = 3 * i24[t31], r29 = c27[t31] * n25.stride;
        o7(Ke, s27[e35 + 0], s27[e35 + 1], s27[e35 + 2]), E3(Ke, Ke, p14), m21.push(...Ke), o7(Qe, l26[r29 + 0], l26[r29 + 1], l26[r29 + 2]), N2(Qe, Qe, h19), A2(Qe, Qe), q4(Ke, Ke, Qe, u30), m21.push(...Ke), f19.push(f19.length), f19.push(f19.length);
      }
    }
    return m21.length ? new m7(o25, [["position", new t12(m21, f19, 3, true)]], null, 2) : null;
  }
  _createAs3DShape(e33, t30, r28, o25) {
    const n24 = e33.geometry;
    if ("mesh" !== n24.type) return null;
    const a26 = this._createGeometryInfo(n24, t30, o25);
    if (null == a26) return null;
    const { geometries: s27, objectTransformation: i24 } = a26;
    if (t13.DRAW_MESH_GEOMETRY_NORMALS) {
      const e34 = this._createPerVertexDebugVectors(n24, s27, "normal", this._debugVertexNormalMaterial, 1), t31 = this._createPerVertexDebugVectors(n24, s27, "tangent", this._debugTangentNormalMaterial, 0.5), r29 = this._createFaceDebugNormals(n24, s27);
      e34 && s27.push(e34), t31 && s27.push(t31), r29 && s27.push(r29);
    }
    const l25 = this._context.layerViewUid, c26 = new W({ geometries: s27, layerViewUid: l25, graphicUid: o25, isElevationSource: true });
    c26.transformation = i24;
    const u30 = l12(this.symbolLayer, { opacity: this._getLayerOpacity() }), m21 = u30 ? new u19(s27[0].material, u30, this._context.slicePlaneEnabled) : null, f19 = new h10(this, c26, null, u18, r28, m21);
    this._fastUpdateProcessor.onAddGraphic(), f19.needsElevationUpdates = m11(r28.mode), f19.useObjectOriginAsAttachmentOrigin = true, f19.fastTransformUpdatesAllowed = this._fastTransformUpdatesAllowed(n24), r28.centerInElevationSR = this._getCenterInElevationSR(c26.transformation);
    const { elevationProvider: p14, renderCoordsHelper: h19 } = this._context, d16 = (e34, t31) => c12(e34, p14, r28, h19, t31);
    return f19.alignedSampledElevation = u18(f19, r28, p14.spatialReference, d16, h19), f19;
  }
  _fastTransformUpdatesAllowed(e33) {
    const { vertexSpace: t30, spatialReference: r28 } = e33;
    if (!t9(t30)) return false;
    const { type: o25 } = t30, { view: n24 } = this._context.graphicsCoreOwner, { viewingMode: a26 } = n24.state, s27 = n24.spatialReference;
    return 1 === a26 && "local" === o25 || 2 === a26 && T(s27, r28) && "georeferenced" === o25 && !r28.isGeographic;
  }
  _getElevationSR() {
    return this._context.elevationProvider.spatialReference ?? null;
  }
  _getCenterInElevationSR(e33) {
    const t30 = n2(), r28 = o7(nt2, e33[12], e33[13], e33[14]);
    return n10(r28, this._context.renderCoordsHelper.spatialReference, t30, this._getElevationSR()), t30;
  }
  _passthroughReprojectionInfo(e33) {
    return 0 === e33.reprojection && !!e33.objectTransformation;
  }
  _createPositionBuffer(e33, t30) {
    const r28 = e33.vertexAttributes.position;
    let o25, n24 = r28;
    if (0 === t30.reprojection) return { position: n24, georeferencedPositionBuffer: o25 };
    const a26 = 1 === t30.reprojection ? t30.transformBeforeProject : null;
    a26 && (n24 = r9(new Float64Array(n24.length), n24, a26));
    const { normal: s27, tangent: i24 } = e33.vertexAttributes;
    this._passthroughReprojectionInfo(t30) || !s27 && !i24 || (o25 = n24);
    const l25 = n24 === r28 || n24 === o25 ? new Float64Array(n24.length) : n24;
    return o5(n24, e33.spatialReference, 0, l25, this._context.renderCoordsHelper.spatialReference, 0), { position: l25, georeferencedPositionBuffer: o25 };
  }
  _createNormalBuffer(e33, t30, r28, o25) {
    const n24 = e33.vertexAttributes.normal;
    if (null == n24) return null;
    let a26 = n24;
    const s27 = 1 === o25.reprojection ? o25.transformBeforeProject : null;
    s27 && (a26 = v2(a26, new Float32Array(a26.length), s27));
    const i24 = this._context.graphicsCoreOwner.view.viewingMode;
    if (0 === o25.reprojection) return a26;
    if ("local" === i24) {
      if (!O(this._context.renderCoordsHelper.spatialReference)) return a26;
      if (null == r28) return null;
      if (e33.spatialReference.isGeographic) {
        const e34 = a26 === n24 ? new Float32Array(a26.length) : a26;
        return R2(a26, 0, r28, e34);
      }
      if (e33.spatialReference.isWebMercator) {
        const e34 = a26 === n24 ? new Float32Array(a26.length) : a26;
        return $(a26, 0, r28, e34);
      }
      return a26;
    }
    if (null == r28) return null;
    const l25 = a26 === n24 ? new Float32Array(a26.length) : a26, c26 = this._context.renderCoordsHelper.spatialReference;
    return w2(a26, r28, e33.spatialReference, t30, c26, l25);
  }
  _createTangentBuffer(e33, t30, r28, o25) {
    const n24 = e33.vertexAttributes.tangent;
    if (null == n24) return null;
    let a26 = n24;
    const s27 = 1 === o25.reprojection ? o25.transformBeforeProject : null;
    s27 && (a26 = B(a26, new Float32Array(a26.length), s27));
    const i24 = this._context.graphicsCoreOwner.view.viewingMode;
    if (0 === o25.reprojection) return a26;
    if ("local" === i24) {
      if (!O(this._context.renderCoordsHelper.spatialReference)) return a26;
      if (null == r28) return null;
      if (e33.spatialReference.isGeographic) {
        const e34 = a26 === n24 ? new Float32Array(a26.length) : a26;
        return R2(a26, 1, r28, e34);
      }
      if (e33.spatialReference.isWebMercator) {
        const e34 = a26 === n24 ? new Float32Array(a26.length) : a26;
        return $(a26, 1, r28, e34);
      }
      return a26;
    }
    if (null == r28) return null;
    const l25 = a26 === n24 ? new Float32Array(a26.length) : a26, c26 = this._context.renderCoordsHelper.spatialReference;
    return F3(a26, r28, e33.spatialReference, t30, c26, l25);
  }
  _createSymbolColorBuffer(e33) {
    return this._requiresSymbolVertexColors() ? new Uint8Array(this._getDrivenUInt8ColorWithNaNSupport(e33, this._materialColor, true)) : null;
  }
  _createBuffers(e33, t30) {
    const r28 = e33.vertexAttributes && e33.vertexAttributes.position;
    if (!r28) return this.logger.warn("Mesh geometry must contain position vertex attributes"), null;
    const o25 = e33.vertexAttributes.normal, n24 = e33.vertexAttributes.uv, a26 = e33.vertexAttributes.tangent;
    if (o25 && o25.length !== r28.length) return this.logger.warn("Mesh normal vertex buffer must contain the same number of elements as the position buffer"), null;
    if (a26 && a26.length / 4 != r28.length / 3) return this.logger.warn("Mesh tangent vertex buffer must contain the same number of elements as the position buffer"), null;
    if (n24 && n24.length / 2 != r28.length / 3) return this.logger.warn("Mesh uv vertex buffer must contain the same number of elements as the position buffer"), null;
    const s27 = this._computeReprojectionInfo(e33), { position: i24, georeferencedPositionBuffer: l25 } = this._createPositionBuffer(e33, s27), c26 = qe(e33), u30 = this._createSymbolColorBuffer(t30), m21 = this._createNormalBuffer(e33, i24, l25, s27), p14 = this._createTangentBuffer(e33, i24, l25, s27), h19 = n24, { transformation: d16, position: g13, normal: x12, tangent: _13 } = this._passthroughReprojectionInfo(s27) ? { transformation: s27.objectTransformation, position: i24, normal: m21, tangent: p14 } : this._transformOriginLocal(e33, i24, m21, p14);
    return { positionBuffer: g13, normalBuffer: x12, tangentBuffer: _13, uvBuffer: h19, colorBuffer: c26, symbolColorBuffer: u30, objectTransformation: d16, geometryTransformation: 0 === s27.reprojection && s27.geometryTransformation ? s27.geometryTransformation : e10() };
  }
  _computeReprojectionInfo(e33) {
    const { vertexSpace: t30 } = e33, r28 = "georeferenced" === t30.type ? T(this._context.renderCoordsHelper.spatialReference, e33.spatialReference) ? 0 : 1 : 0;
    if (o9(t30)) return { reprojection: r28 };
    const o25 = t30.origin, n24 = e10(), a26 = e33.transform?.localMatrix ?? r5;
    if (0 === r28) {
      f6(e33.spatialReference, o25, n24, this._context.renderCoordsHelper.spatialReference);
      return { reprojection: r28, objectTransformation: n24, geometryTransformation: t2(a26) };
    }
    const s27 = q(e10(), o25);
    return c(s27, s27, a26), { reprojection: r28, transformBeforeProject: s27 };
  }
  _transformOriginLocal(e33, t30, r28, o25) {
    const n24 = this._context.renderCoordsHelper.spatialReference, a26 = e33.origin;
    Je[0] = a26.x, Je[1] = a26.y, Je[2] = a26.z ?? 0;
    const s27 = e10();
    f6(e33.spatialReference, Je, s27, n24), h2(et2, s27);
    const { position: i24, normal: l25, tangent: c26 } = e33.vertexAttributes, m21 = t30 === i24 ? new Float64Array(t30.length) : t30;
    r9(m21, t30, et2);
    const p14 = r28 ? r28 === l25 ? new Float32Array(r28.length) : r28 : null, h19 = o25 ? o25 === c26 ? new Float32Array(o25.length) : o25 : null;
    return r28 && p14 && v2(r28, p14, et2), o25 && h19 && B(o25, h19, et2), { transformation: s27, position: m21, normal: p14, tangent: h19 };
  }
  _validateFaces(e33, t30) {
    const r28 = e33.vertexAttributes.position.length / 3, o25 = t30.faces;
    if (o25) {
      let e34 = -1;
      for (let t31 = 0; t31 < o25.length; t31++) {
        const r29 = o25[t31];
        r29 > e34 && (e34 = r29);
      }
      if (r28 <= e34) return this.logger.warn(`Vertex index ${e34} is out of bounds of the mesh position buffer`), false;
    } else if (r28 % 3 != 0) return this.logger.warn("Mesh position buffer length must be a multiple of 9 if no component faces are defined (3 values per vertex * 3 vertices per triangle)"), false;
    return true;
  }
  _isOutsideClippingArea(e33) {
    if (!this._context.clippingExtent) return false;
    const t30 = e33.vertexAttributes?.position;
    if (!t30) return false;
    const r28 = this._context.elevationProvider.spatialReference, o25 = n11(e33, r28 ?? e33.spatialReference);
    return !!o25 && (m2(o25, rt2), !A(rt2, this._context.clippingExtent));
  }
  _createGeometryInfo(e33, t30, r28) {
    if (!J(e33.spatialReference, this._context.renderCoordsHelper.spatialReference)) return this.logger.warn("Geometry spatial reference is not compatible with the view"), null;
    if (!this._validateVertexSpace(e33)) return null;
    if (this._isOutsideClippingArea(e33)) return null;
    const o25 = this._createBuffers(e33, t30);
    if (null == o25) return null;
    const { positionBuffer: n24, uvBuffer: a26, colorBuffer: s27, symbolColorBuffer: i24, normalBuffer: l25, tangentBuffer: c26, objectTransformation: u30, geometryTransformation: f19 } = o25, p14 = e33.components ?? ot4, h19 = new Array();
    let d16 = false;
    const g13 = I(Ke, u30), x12 = this._context.localOriginFactory.getOrigin(g13);
    for (const m21 of p14) {
      if (!this._validateFaces(e33, m21)) return null;
      const t31 = Ie(e33, m21);
      if (0 === t31.length) continue;
      const o26 = Be(n24, l25, m21, t31);
      o26.didFlipNormals && (d16 = true);
      const u31 = [["position", new t12(n24, t31, 3, true)], ["normal", new t12(o26.normals, o26.indices, 3, true)]];
      s27 && u31.push(["color", new t12(s27, t31, 4, true)]), i24 && u31.push(["symbolColor", new t12(i24, U(t31.length), 4, true)]), a26 && u31.push(["uv0", new t12(a26, t31, 2, true)]), c26 && u31.push(["tangent", new t12(c26, t31, 4, true)]);
      const p15 = this._context.stage.renderView.getObjectAndLayerIdColor({ graphicUid: r28, layerViewUid: this._context.layerViewUid }), g14 = this._getOrCreateMaterial(e33, m21), _13 = new m7(g14, u31, null, 0, p15);
      _13.transformation = f19, _13.localOrigin = x12, h19.push(_13);
    }
    return d16 && this.logger.warn("Normals have been automatically flipped to be consistent with the counter clock wise face winding order. It is better to generate mesh geometries that have consistent normals."), { geometries: h19, objectTransformation: u30 };
  }
  _updateMaterialParameters(e33) {
    this._materialInfoCache.forEachMaterialInfo(e33), this._fastUpdateProcessor.forEachMaterialInfo(e33), this._fastUpdateProcessor.forEachClonedMaterial((e34, t30) => {
      t30.setParameters(e34.parameters);
    });
  }
  _validateVertexSpace(e33) {
    const { _context: { graphicsCoreOwner: { view: { state: { viewingMode: t30 } } } } } = this, { vertexSpace: r28 } = e33;
    return 2 !== t30 || "local" !== r28.type || (this.logger.warn("Displaying a mesh with a local vertex space in a view in local viewing mode is not supported."), false);
  }
  test() {
    return { ...super.test(), materials: this._materialInfoCache.materials };
  }
  get _materialColor() {
    return this.symbolLayer.material?.color;
  }
};
var Se = class {
  constructor(e33, t30, r28) {
    this.normals = e33, this.indices = t30, this.didFlipNormals = r28;
  }
};
function Ie(e33, t30) {
  return t30.faces ?? A3(e33.vertexAttributes.position.length / 3);
}
function Be(e33, t30, r28, o25) {
  switch (r28.shading || "flat") {
    default:
    case "source":
      return Ee(e33, t30, r28, o25);
    case "flat":
      return Ue(e33, o25);
    case "smooth":
      return Oe(e33, o25);
  }
}
function Ue(e33, t30) {
  const r28 = n8(t30.length), o25 = new Array(3 * t30.length);
  for (let n24 = 0; n24 < t30.length; n24 += 3) {
    const a26 = Ve(e33, t30, n24, Ze);
    for (let e34 = 0; e34 < 3; e34++) r28[n24 + e34] = a26[e34], o25[n24 + e34] = n24 / 3;
  }
  return new Se(r28, o25, false);
}
function Ee(e33, t30, r28, o25) {
  if (null == t30) return Ue(e33, o25);
  let n24 = false;
  if (!r28.trustSourceNormals) for (let a26 = 0; a26 < o25.length; a26 += 3) {
    Ve(e33, o25, a26, Ze);
    for (let e34 = 0; e34 < 3; e34++) {
      const r29 = 3 * o25[a26 + e34];
      Ke[0] = t30[r29], Ke[1] = t30[r29 + 1], Ke[2] = t30[r29 + 2], P3(Ze, Ke) < 0 && (t30[r29] = -t30[r29], t30[r29 + 1] = -t30[r29 + 1], t30[r29 + 2] = -t30[r29 + 2], n24 = true);
    }
  }
  return new Se(t30, o25, n24);
}
function Oe(e33, t30) {
  const r28 = {};
  for (let a26 = 0; a26 < t30.length; a26 += 3) {
    const o26 = Ve(e33, t30, a26, Ze);
    for (let e34 = 0; e34 < 3; e34++) {
      const n25 = t30[a26 + e34];
      let s27 = r28[n25];
      s27 || (s27 = { normal: n2(), count: 0 }, r28[n25] = s27), u8(s27.normal, s27.normal, o26), s27.count++;
    }
  }
  const o25 = n8(3 * t30.length), n24 = new Array(3 * t30.length);
  for (let a26 = 0; a26 < t30.length; a26++) {
    const e34 = r28[t30[a26]];
    1 !== e34.count && (A2(e34.normal, e34.normal), e34.count = 1);
    for (let t31 = 0; t31 < 3; t31++) o25[3 * a26 + t31] = e34.normal[t31];
    n24[a26] = a26;
  }
  return new Se(o25, n24, false);
}
function Fe(e33, t30, r28, o25, n24, a26) {
  const s27 = 3 * t30[r28], i24 = 3 * t30[r28 + 1], l25 = 3 * t30[r28 + 2];
  o25[0] = e33[s27], o25[1] = e33[s27 + 1], o25[2] = e33[s27 + 2], n24[0] = e33[i24], n24[1] = e33[i24 + 1], n24[2] = e33[i24 + 2], a26[0] = e33[l25], a26[1] = e33[l25 + 1], a26[2] = e33[l25 + 2];
}
function Ve(e33, t30, r28, o25) {
  return Fe(e33, t30, r28, Ke, Qe, Xe), c2(Qe, Qe, Ke), c2(Xe, Xe, Ke), _3(Ke, Qe, Xe), A2(o25, Ke), o25;
}
function $e(e33) {
  if (!e33) return null;
  const { scale: t30, offset: o25, rotation: n24 } = e33;
  return { scale: t30, offset: o25, rotation: s3(n24) };
}
function Ge(e33 = "repeat") {
  if ("string" == typeof e33) {
    const t30 = De(e33);
    return { s: t30, t: t30 };
  }
  return { s: De(e33.horizontal), t: De(e33.vertical) };
}
function De(e33) {
  switch (e33) {
    case "clamp":
      return 33071;
    case "mirror":
      return 33648;
    default:
      return 10497;
  }
}
function Le(e33) {
  const t30 = e33.vertexAttributes.color;
  if (null == t30) return false;
  for (let r28 = 3; r28 < t30.length; r28 += 4) if (255 !== t30[r28]) return true;
  return false;
}
function Ne(t30, r28, o25) {
  r28.diffuse = u10.toUnitRGB(t30), r28.opacity = "opaque" === o25.alphaMode ? 1 : t30.a;
}
function He(e33) {
  return e33.data ?? e33.url;
}
function ke(t30) {
  return null == t30 ? "-" : t30 instanceof u10 ? t30.toHex() : t30.contentHash;
}
function ze(e33) {
  const { offset: t30, scale: r28, rotation: o25 } = e33 ?? Ye;
  return `${t30[0]},${t30[1]},${o25},${r28[0]},${r28[1]}`;
}
function qe(e33) {
  return e33.vertexAttributes.color;
}
function We(e33) {
  return 1 === (e33.material?.color?.a ?? 0);
}
var Ye = new p5();
var Je = n2();
var Ke = n2();
var Qe = n2();
var Xe = n2();
var Ze = n2();
var et2 = e10();
var tt4 = e10();
var rt2 = u7();
var ot4 = [new h4()];
var nt2 = n2();

// node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DLodInstanceGraphicLayer.js
var m16 = class {
  constructor(t30, e33, i24, n24, s27) {
    this.graphics3DSymbolLayer = t30, this.instanceIndex = e33, this.elevationAligner = i24, this.elevationContext = n24, this._highlightOrderMap = s27, this.type = "lod-instance", this._highlights = /* @__PURE__ */ new Set(), this.alignedSampledElevation = 0, this.isElevationSource = false, this.needsElevationUpdates = false, this._highlightName = null;
  }
  initialize() {
  }
  setVisibility(t30) {
    const { instanceData: e33 } = this;
    t30 !== e33.getVisible(this.instanceIndex) && e33.setVisible(this.instanceIndex, t30);
  }
  destroy() {
    null != this.instanceIndex && (this.instanceData.removeInstance(this.instanceIndex), this.graphics3DSymbolLayer.notifyDestroyGraphicLayer(this));
  }
  get usedMemory() {
    return this.graphics3DSymbolLayer.usedMemory;
  }
  alignWithElevation(t30, e33) {
    if (this.elevationAligner) {
      const i24 = (i25, n25) => c12(i25, t30, this.elevationContext, e33, n25), n24 = this.elevationAligner(this, this.elevationContext, t30.spatialReference, i24, e33);
      null != n24 && (this.alignedSampledElevation = n24);
    }
  }
  getCenterObjectSpace(t30 = n2()) {
    return this.instanceData.getCombinedLocalTransform(this.instanceIndex, b9), E3(t30, this._lodRenderer.baseBoundingSphere.center, b9);
  }
  getBoundingBoxObjectSpace(t30 = u7()) {
    this.instanceData.getCombinedLocalTransform(this.instanceIndex, b9);
    const n24 = this._lodRenderer.baseBoundingBox;
    q3(t30);
    for (let s27 = 0; s27 < 8; ++s27) o7(u26, 1 & s27 ? n24[3] : n24[0], 2 & s27 ? n24[4] : n24[1], 4 & s27 ? n24[5] : n24[2]), E3(u26, u26, b9), l4(t30, u26);
    return t30;
  }
  computeAttachmentOrigin(t30) {
    this.instanceData.getGlobalTransform(this.instanceIndex, b9), t30.render.origin[0] += b9[12], t30.render.origin[1] += b9[13], t30.render.origin[2] += b9[14], t30.render.num++;
  }
  async getProjectedBoundingBox(t30, i24, n24, s27, h19) {
    const g13 = this.getBoundingBoxObjectSpace(h19), d16 = v6, m21 = C2(g13) ? 1 : d16.length;
    this.instanceData.getGlobalTransform(this.instanceIndex, b9);
    for (let a26 = 0; a26 < m21; a26++) {
      const t31 = d16[a26];
      u26[0] = g13[t31[0]], u26[1] = g13[t31[1]], u26[2] = g13[t31[2]], E3(u26, u26, b9), p12[3 * a26] = u26[0], p12[3 * a26 + 1] = u26[1], p12[3 * a26 + 2] = u26[2];
    }
    if (!t30(p12, 0, m21)) return null;
    q3(g13);
    let _13 = null;
    this.calculateRelativeScreenBounds && (_13 = this.calculateRelativeScreenBounds());
    for (let e33 = 0; e33 < 3 * m21; e33 += 3) {
      for (let t31 = 0; t31 < 3; t31++) g13[t31] = Math.min(g13[t31], p12[e33 + t31]), g13[t31 + 3] = Math.max(g13[t31 + 3], p12[e33 + t31]);
      _13 && n24.push({ location: p12.slice(e33, e33 + 3), screenSpaceBoundingRect: _13 });
    }
    if (i24 && (b3(g13, f14), "absolute-height" !== this.elevationContext.mode)) {
      let t31;
      const e33 = G2(g13, i24.service.spatialReference, i24);
      try {
        t31 = await i24.service.queryElevation(f14[0], f14[1], s27, e33, "ground");
      } catch (x12) {
      }
      null != t31 && G(g13, 0, 0, -this.alignedSampledElevation + t31);
    }
    return g13;
  }
  addObjectState(t30) {
    0 === t30.stateType && this.addObjectHighlightState(t30);
  }
  addObjectHighlightState(t30) {
    const e33 = new c7(t30.highlightName);
    this._addHighlightId(e33), t30.addExternal((t31) => {
      this._removeHighlightId(t31);
    }, e33);
  }
  removeObjectState(t30) {
    this._highlights.forEach((e33) => t30.remove(e33));
  }
  updateHighlights(t30) {
    this._highlightOrderMap = t30, this._updateHighlightOptions();
  }
  _calculateHighlightOptions() {
    let t30 = -1, e33 = null;
    return this._highlights.forEach(({ highlightName: i24 }) => {
      const n24 = this._highlightOrderMap.get(i24);
      void 0 !== n24 && n24 > t30 && (t30 = n24, e33 = i24);
    }), e33;
  }
  _addHighlightId(t30) {
    this._highlights.add(t30), this._updateHighlightOptions();
  }
  _removeHighlightId(t30) {
    this._highlights.delete(t30), this._updateHighlightOptions();
  }
  _updateHighlightOptions() {
    const t30 = this._calculateHighlightOptions();
    t30 !== this._highlightName && (this._highlightName = t30, this.instanceData.setHighlight(this.instanceIndex, t30));
  }
  get _lodRenderer() {
    return this.graphics3DSymbolLayer.lodRenderer;
  }
  get instanceData() {
    return this._lodRenderer.instanceData;
  }
};
var p12 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
var u26 = n2();
var f14 = n2();
var v6 = [[0, 1, 2], [3, 1, 2], [0, 4, 2], [3, 4, 2], [0, 1, 5], [3, 1, 5], [0, 4, 5], [3, 4, 5]];
var b9 = e10();

// node_modules/@arcgis/core/views/3d/layers/graphics/lodResourceUtils.js
function t27(e33, t30) {
  const s27 = e33.stageResources.geometries.map((r28) => new m8(new o12(r28), e33.stageResources.textures)), l25 = null == e33.lodThreshold || 0 === e33.lodThreshold && t30 > 0 ? u27(s27) : e33.lodThreshold;
  return new a12(s27, l25, e33.pivotOffset);
}
function s21(n24) {
  return new c8(n24.map((e33, n25) => t27(e33, n25)));
}
function u27(e33) {
  const n24 = e33.reduce((e34, n25) => e34 + n25.numTriangles, 0);
  return Math.sqrt(n24 * l17 / Math.PI);
}
var l17 = 20;

// node_modules/@arcgis/core/views/3d/layers/graphics/webStyleUtils.js
async function r21(r28) {
  if (null == r28 || null == r28.styleName && null == r28.styleUrl) return null;
  const o25 = r28.name;
  if (null == o25) throw new s("symbolstyleutils:style-symbol-reference-name-missing", "Missing name in style symbol reference");
  const u30 = { portal: r28.portal }, i24 = await i10(r28, u30).catch(() => null);
  if (null === i24) return null;
  const m21 = g3(o25, i24.data);
  if (m21 && !m21.formatInfos?.some((l25) => "gltf_basisu" === l25.type)) return null;
  const a26 = await j4(i24, o25, u30, y3, { acceptedFormats: ["web-gltf-basisu", "web-gltf", "web"] }).catch(() => null);
  if (null === a26 || "point-3d" !== a26.type) return null;
  const y9 = a26.symbolLayers.items[0];
  return "object" === y9.type ? y9.resource : null;
}

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/lodRendering/InstanceOctree.js
var h11 = class extends S {
  constructor(e33, r28) {
    super((t30) => R3(this._instanceData.view.boundingSphere.getVec(t30, m17)), { maximumDepth: 25 }), this._instanceData = e33, this._boundingSphere = r28, this._tmpSphere = P4(), this._tmpMat4 = e10();
  }
  addInstance(t30) {
    const e33 = this._instanceData.view.boundingSphere, s27 = this._instanceData.getCombinedModelTransform(t30, this._tmpMat4);
    D(this._tmpSphere, this._boundingSphere.center, s27), this._tmpSphere[3] = this._boundingSphere.radius * m5(s27), e33.setVec(t30, H(this._tmpSphere)), this.add([t30]);
  }
  removeInstance(t30) {
    this.remove([t30]);
  }
};
var m17 = n5();

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/lodRendering/LevelSelector.js
var e28 = class {
  constructor(e33, i24) {
    this._worldSpaceRadius = e33, this._minScreenSpaceRadii = i24;
  }
  selectLevel(e33, i24, t30) {
    const c26 = t30.computeScreenPixelSizeAt(e33), r28 = this._worldSpaceRadius * i24 / c26;
    let s27 = 0;
    for (let a26 = 1; a26 < this._minScreenSpaceRadii.length; ++a26) r28 >= this._minScreenSpaceRadii[a26] && (s27 = a26);
    return s27;
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/GLMaterials.js
var t28 = class {
  constructor(t30, s27) {
    this._material = t30, this._repository = s27, this._map = /* @__PURE__ */ new Map();
  }
  dispose() {
    this._map.forEach((t30, s27) => {
      null != t30 && this._repository.release(this._material, s27);
    });
  }
  load(t30, s27, e33) {
    const r28 = this._material.produces.get(s27);
    if (!r28?.(e33)) return null;
    this._map.has(e33) || this._map.set(e33, this._repository.acquire(this._material, s27, e33));
    const i24 = this._map.get(e33);
    if (i24) {
      if (2 === i24.ensureResources(t30)) return i24;
      this._repository.requestRender();
    }
    return null;
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/lodRendering/LodComponentData.js
var o20 = class {
  constructor(o25, i24) {
    this.geometry = i24;
    const n24 = o25.renderContext.rctx, m21 = i24.renderGeometry, { material: a26, layout: u30, buffer: l25 } = m21;
    this._materials = o25.materials, a26.setParameters({ instancedDoublePrecision: true }), this.glMaterials = new t28(a26, this._materials), this.vbo = new r14(n24, t7(u30), l25), this.vao = new r15(n24, this.vbo);
  }
  destroy() {
    this.glMaterials.dispose(), this.vbo.dispose(), this.vao.dispose();
  }
  get material() {
    return this.geometry.renderGeometry.material;
  }
  get layout() {
    return this.geometry.renderGeometry.layout;
  }
  get boundingInfo() {
    return this.geometry.boundingInfo;
  }
  get numTriangles() {
    return this.numVertices / 3;
  }
  get numVertices() {
    return this.geometry.renderGeometry.numVertices;
  }
  get usedMemory() {
    return 128 + this.vbo.usedMemory + this.vao.usedMemory;
  }
  intersect(e33, t30, r28, s27, o25, i24, n24, m21) {
    return this.geometry.intersect(e33, t30, r28, s27, o25, i24, n24, m21);
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/lodRendering/LodLevel.js
var a21 = class _a {
  static async create(e33, r28, i24) {
    const s27 = await Promise.allSettled(r28.components.map((o25) => e33.controller.schedule(() => new o20(e33, o25.geometry), i24))), c26 = s27.map((o25) => "fulfilled" === o25.status ? o25.value : null).filter(N);
    if (a3(i24) || c26.length !== s27.length) {
      c26.forEach((o25) => o25.destroy()), s2(i24);
      for (const o25 of s27) if ("rejected" === o25.status) throw o25.reason;
    }
    return new _a(r28.minScreenSpaceRadius, c26);
  }
  constructor(o25, n24) {
    this.minScreenSpaceRadius = o25, this.components = n24;
  }
  destroy() {
    this.components.forEach((o25) => o25.destroy());
  }
  intersect(o25, n24, t30, e33, r28, i24, s27) {
    this.components.forEach((c26) => c26.intersect(o25, n24, t30, e33, r28, i24, this.boundingSphere, s27));
  }
  get boundingBox() {
    if (null == this._boundingBox) {
      const o25 = q3();
      this.components.forEach((n24) => {
        null != n24.boundingInfo && (l4(o25, n24.boundingInfo.bbMin), l4(o25, n24.boundingInfo.bbMax));
      }), this._boundingBox = o25;
    }
    return this._boundingBox;
  }
  get boundingSphere() {
    if (null == this._boundingSphere) {
      const o25 = this.boundingBox, n24 = n2();
      b3(o25, n24), this._boundingSphere = { center: n24, radius: 0.5 * F(o25) };
    }
    return this._boundingSphere;
  }
  get triangleCount() {
    return this.components.reduce((o25, n24) => o25 + n24.numTriangles, 0);
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/lodRendering/LodRenderer.js
var B6 = (e33) => {
  const t30 = e33.baseBoundingSphere.radius, r28 = e33.levels.map((e34) => e34.minScreenSpaceRadius);
  return new e28(t30, r28);
};
var F6 = class extends u16 {
  constructor(e33, t30) {
    super(e33), this.type = 3, this.isGround = false, this._levels = [], this._defaultRenderInstanceData = new Array(), this._highlightRenderInstanceDatas = /* @__PURE__ */ new Map(), this._instanceIndex = 0, this._cycleStartIndex = 0, this._slicePlane = false, this._camera = new tt2(), this._updateCyclesWithStaticCamera = -1, this._needFullCycle = false, this.produces = /* @__PURE__ */ new Map([[2, (e34) => this._produces(e34)], [4, (e34) => !!this._hasTransparentLevels() && this._produces(e34)]]), this._instanceData = new F4({ shaderTransformation: e33.shaderTransformation }, e33.symbol.materialParameters), this.addHandles(t30.registerTask(f4.LOD_RENDERER, this));
  }
  initialize() {
    this._instanceBufferLayout = u15(this.symbol.materialParameters), this._glInstanceBufferLayout = t7(this._instanceBufferLayout, 1), this.addHandles([this._instanceData.events.on("instances-changed", () => this._requestUpdateCycle()), this._instanceData.events.on("instance-transform-changed", ({ index: e33 }) => {
      this._requestUpdateCycle(), this.metadata.notifyGraphicGeometryChanged(e33);
    }), this._instanceData.events.on("instance-visibility-changed", ({ index: e33 }) => {
      this._requestUpdateCycle(true), this.metadata.notifyGraphicVisibilityChanged(e33);
    }), this._instanceData.events.on("instance-highlight-changed", () => this._requestUpdateCycle(true))]);
  }
  get _allRenderInstanceData() {
    return [this._defaultRenderInstanceData, ...this._highlightRenderInstanceDatas.values()];
  }
  get _allRenderInstanceDataExceptHighlightShadow() {
    const e33 = [this._defaultRenderInstanceData];
    for (const t30 of this._highlightRenderInstanceDatas) t30[0] !== c11 && e33.push(t30[1]);
    return e33;
  }
  hasHighlight(e33) {
    return this._highlightRenderInstanceDatas.has(e33);
  }
  get _enableLevelSelection() {
    return this.symbol.levels.length > 1;
  }
  get levels() {
    return this._levels;
  }
  get baseBoundingBox() {
    return this._levels[this._levels.length - 1].boundingBox;
  }
  get baseBoundingSphere() {
    return this._levels[this._levels.length - 1].boundingSphere;
  }
  get baseMaterial() {
    return this._levels[this._levels.length - 1].components[0].material;
  }
  get slicePlaneEnabled() {
    return this._slicePlane;
  }
  set slicePlaneEnabled(e33) {
    this._slicePlane = e33;
  }
  get layerViewUid() {
    return this.metadata.layerViewUid;
  }
  get instanceData() {
    return this._instanceData;
  }
  get hasEmitters() {
    return this._levels.some((e33) => e33.components.some((e34) => e34.material.hasEmissions));
  }
  get usedMemory() {
    return this._allRenderInstanceData.reduce((e33, t30) => t30.reduce((e34, t31) => e34 + t31.usedMemory, e33), this._levels.reduce((e33, t30) => e33 + t30.components.reduce((e34, t31) => e34 + t31.usedMemory, 0), 0));
  }
  get renderStats() {
    const e33 = this._instanceData.size, t30 = [];
    return this._levels.forEach((e34, r28) => {
      const s27 = this._allRenderInstanceData[0][r28].size + this._allRenderInstanceData[1][r28].size, n24 = e34.triangleCount;
      t30.push({ renderedInstances: s27, renderedTriangles: s27 * n24, trianglesPerInstance: n24 });
    }), { totalInstances: e33, renderedInstances: t30.reduce((e34, t31) => e34 + t31.renderedInstances, 0), renderedTriangles: t30.reduce((e34, t31) => e34 + t31.renderedTriangles, 0), levels: t30 };
  }
  _createRenderInstanceDataArray() {
    const { rctx: e33 } = this._context.renderContext;
    return this.symbol.levels.map((t30) => new o15(e33, this._instanceBufferLayout));
  }
  async initializeRenderContext(e33, r28) {
    this._context = e33, this._defaultRenderInstanceData = this._createRenderInstanceDataArray();
    const s27 = await Promise.allSettled(this.symbol.levels.map((t30) => a21.create(e33, t30, r28))), n24 = s27.map((e34) => "fulfilled" === e34.status ? e34.value : null).filter(N);
    if (a3(r28) || n24.length !== s27.length) {
      n24.forEach((e34) => e34.destroy()), s2(r28);
      for (const e34 of s27) if ("rejected" === e34.status) throw e34.reason;
    }
    this._levels = n24, this._levelSelector = B6(this);
  }
  uninitializeRenderContext() {
    this._invalidateOctree(), this._levels.forEach((e33) => e33.destroy()), this._defaultRenderInstanceData.forEach((e33) => e33.destroy()), this._highlightRenderInstanceDatas.forEach((e33) => e33.forEach((e34) => e34.destroy()));
  }
  _hasTransparentLevels() {
    return this._levels.some((e33) => e33.components.some((e34) => {
      const t30 = e34.material.produces.get(4);
      return t30?.(0);
    }));
  }
  hasHighlights() {
    return n(this._highlightRenderInstanceDatas, (e33) => e33.some((e34) => e34.size > 0));
  }
  _produces(e33) {
    return (9 !== e33 || this.hasHighlights()) && (5 !== e33 || this.hasHighlight(c11));
  }
  prepareRender(e33) {
    if (!t13.LOD_INSTANCE_RENDERER_DISABLE_UPDATES) {
      if (this._enableLevelSelection) {
        const t30 = e33.bind.contentCamera.equals(this._camera);
        this._camera.copyFrom(e33.bind.contentCamera), t30 || this._requestUpdateCycle();
      }
      this._needFullCycle && (this.runTask(F2), this._needFullCycle = false);
    }
  }
  acquireTechniques(e33) {
    if (!this.baseMaterial.visible || !this.baseMaterial.isVisibleForOutput(e33.output)) return null;
    const t30 = this._getInstanceDatas(e33);
    if (!t30) return null;
    const r28 = new Array(), s27 = this.levels;
    return t30.forEach((t31) => s27.forEach(({ components: s28 }, n24) => s28.forEach((s29) => r28.push(this._beginComponent(e33, t31[n24], s29))))), r28;
  }
  render(e33, t30) {
    const r28 = this._getInstanceDatas(e33);
    if (!r28 || null == t30) return;
    let s27 = 0;
    const n24 = this.levels;
    r28.forEach((r29) => n24.forEach(({ components: n25 }, a26) => n25.forEach((n26) => this._renderComponent(e33, t30[s27++], r29[a26], n26, a26)))), e33.rctx.unbindBuffer(34962), e33.rctx.bindVAO(null);
  }
  _getInstanceDatas(e33) {
    const { output: t30, bind: r28 } = e33, s27 = 9 === t30, n24 = 5 === t30, a26 = 6 !== t30;
    if (!s27 && !n24) return a26 ? this._allRenderInstanceData : this._allRenderInstanceDataExceptHighlightShadow;
    const { _highlightRenderInstanceDatas: i24 } = this;
    if (a26) {
      if (s27) {
        const e35 = r28.highlight?.name;
        if (!e35) return null;
        const t31 = i24.get(e35);
        return t31 ? [t31] : null;
      }
      const e34 = i24.get(c11);
      return n24 ? e34 ? [e34] : null : Array.from(i24.values());
    }
    return null;
  }
  intersect(e33, t30, r28, s27) {
    if (!this.baseMaterial.visible || null == this._octree) return;
    const n24 = n2();
    c2(n24, s27, r28);
    const a26 = (n25) => {
      this._instanceData.getCombinedModelTransform(n25, N3), e33.transform.set(N3), E3(G5, r28, e33.transform.inverse), E3(W4, s27, e33.transform.inverse);
      const a27 = this._instanceData.getState(n25), i24 = this._instanceData.getLodLevel(n25), o25 = this._levels.length;
      4 & a27 && (s9(!!(18 & a27), "invalid instance state"), s9(i24 >= 0 && i24 < o25, "invaid lod level"), this._levels[i24].intersect(e33, t30, G5, W4, n25, this.metadata, o25));
    };
    this.baseMaterial.parameters.verticalOffset ? this._octree.forEach(a26) : this._octree.forEachAlongRay(r28, n24, a26);
  }
  notifyShaderTransformationChanged() {
    this._invalidateOctree(), this._requestUpdateCycle();
  }
  get _octree() {
    if (null == this._octreeCached) {
      const e33 = this._instanceData, t30 = e33.view?.state;
      if (!t30) return null;
      this._octreeCached = new h11(e33, this.baseBoundingSphere);
      for (let r28 = 0; r28 < e33.capacity; ++r28) 18 & t30.get(r28) && this._octreeCached.addInstance(r28);
    }
    return this._octreeCached;
  }
  _invalidateOctree() {
    this._octreeCached = u(this._octreeCached);
  }
  queryDepthRange(e33) {
    if (null == this._octree) return new t20();
    const t30 = e33.viewForward, r28 = this._octree.findClosest(t30, 1, e33.frustum), s27 = this._octree.findClosest(t30, -1, e33.frustum);
    if (null == r28 || null == s27) return new t20();
    const n24 = e33.eye, a26 = this._instanceData.view;
    a26.boundingSphere.getVec(r28, z5), c2(z5, z5, n24);
    const i24 = P3(z5, t30) - z5[3];
    a26.boundingSphere.getVec(s27, z5), c2(z5, z5, n24);
    const o25 = P3(z5, t30) + z5[3];
    return new t20(i24, o25);
  }
  _requestUpdateCycle(e33 = false) {
    this._updateCyclesWithStaticCamera = -1, this._cycleStartIndex = this._instanceIndex, e33 && (this._needFullCycle = true, this._context.requestRender());
  }
  _startUpdateCycle() {
    this._updateCyclesWithStaticCamera++, this._allRenderInstanceData.forEach((e33) => e33.forEach((e34) => e34.startUpdateCycle()));
  }
  get readyToRun() {
    return this._instanceData.size > 0 && this._updateCyclesWithStaticCamera < 1;
  }
  runTask(e33) {
    const { _enableLevelSelection: t30, _camera: s27, _levelSelector: a26 } = this;
    this._allRenderInstanceData.forEach((e34) => e34.forEach((e35) => e35.beginUpdate()));
    const i24 = this._instanceData, o25 = i24.view;
    let l25 = i24.size;
    const c26 = i24.capacity;
    let h19 = this._instanceIndex;
    const d16 = Math.ceil(c26 / 500), { _highlightRenderInstanceDatas: u30 } = this;
    for (let m21 = 0; m21 < l25 && !e33.done; ++m21) {
      h19 === this._cycleStartIndex && this._startUpdateCycle();
      const m22 = o25.state.get(h19);
      let f19 = 0;
      if (!(1 & m22)) {
        h19 = h19 + 1 === c26 ? 0 : h19 + 1, l25++;
        continue;
      }
      const p14 = o25.lodLevel.get(h19);
      if (2 & m22 && this._defaultRenderInstanceData[p14].freeTail(), 16 & m22) {
        const e34 = i24.geHighlightOptionsPrev(h19);
        if (e34) {
          const t31 = u30.get(e34);
          if (!t31) throw new s("internal:lod-renderer", "Internal error in lodRenderer");
          t31[p14].freeTail(), t31.every((e35) => e35.isEmpty) && (t31.forEach((e35) => e35.destroy()), u30.delete(e34));
        }
      }
      if (32 & m22) i24.freeInstance(h19);
      else if (4 & m22) {
        let e34 = 0;
        if (t30 && (o25.modelOrigin.getVec(h19, P7), e34 = a26.selectLevel(P7, i24.getCombinedMedianScaleFactor(h19), s27)), f19 = -83 & m22, e34 >= 0) if (8 & m22) {
          const t31 = i24.getHighlightName(h19);
          if (t31) {
            const s28 = () => {
              const e35 = this._createRenderInstanceDataArray();
              return e35.forEach((e36) => e36.beginUpdate()), e35;
            }, a27 = e(u30, t31, s28);
            if (e34 >= a27.length) throw new s("internal:lod-renderer", `LodRenderer internal error - missing lodLevel ${e34}`);
            H4(a27[e34], o25, h19);
          }
          f19 |= 16;
        } else H4(this._defaultRenderInstanceData[e34], o25, h19), f19 |= 2;
        o25.state.set(h19, f19), o25.lodLevel.set(h19, e34);
      } else f19 = -83 & m22, o25.state.set(h19, f19);
      const _13 = !!(18 & m22), g13 = !!(18 & f19);
      null != this._octreeCached && (!_13 && g13 ? this._octreeCached.addInstance(h19) : _13 && !g13 ? this._octreeCached.removeInstance(h19) : _13 && g13 && 64 & m22 && (this._octreeCached.removeInstance(h19), this._octreeCached.addInstance(h19))), h19 = h19 + 1 === c26 ? 0 : h19 + 1, h19 % d16 === 0 && e33.madeProgress(), _13 !== g13 && this.metadata.notifyGraphicVisibilityChanged(h19), g13 && 64 & m22 && this.metadata.notifyGraphicGeometryChanged(h19);
    }
    this._instanceIndex = h19, this._allRenderInstanceData.forEach((e34) => e34.forEach((e35) => e35.endUpdate())), this._context.requestRender();
  }
  _beginComponent(e33, t30, r28) {
    if (0 === t30.size) return null;
    const s27 = r28.glMaterials.load(e33.rctx, e33.bind.slot, e33.output);
    return s27?.beginSlot(e33.bind);
  }
  _renderComponent(e33, t30, r28, s27, n24) {
    if (!t30) return;
    const { bind: a26, rctx: i24 } = e33;
    i24.runAppleAmdDriverHelper();
    const o25 = i24.bindTechnique(t30, a26, s27.material.parameters, Y4), l25 = this._glInstanceBufferLayout;
    o25.assertCompatibleVertexAttributeLocations(s27.vao, n7(l25)), i24.bindVAO(s27.vao), t13.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL && 0 === e33.output && (o25.setUniform4fv("externalColor", k7[Math.min(n24, k7.length - 1)]), o25.setUniform1i("symbolColorMixMode", l10.replace));
    const c26 = r28.capacity, h19 = r28.headIndex, d16 = r28.tailIndex, u30 = r28.firstIndex, m21 = (e34, n25) => {
      R4(i24, o25.locations, r28.buffer, e34), i24.drawArraysInstanced(t30.primitiveType, 0, s27.numVertices, n25 - e34);
    };
    s27.material.transparent && null != u30 ? h19 > d16 ? (s9(u30 >= d16 && u30 <= h19, "invalid firstIndex"), m21(u30, h19), m21(d16, u30)) : h19 < d16 && (u30 <= h19 ? (s9(u30 >= 0 && u30 <= h19, "invalid firstIndex"), m21(u30, h19), m21(d16, c26), m21(0, u30)) : (s9(u30 >= d16 && u30 <= c26, "invalid firstIndex"), m21(u30, c26), m21(0, h19), m21(d16, u30))) : h19 > d16 ? m21(d16, h19) : h19 < d16 && (m21(0, h19), m21(d16, c26));
  }
};
function H4(e33, t30, r28) {
  const s27 = e33.allocateHead();
  V2(t30, r28, e33.view, s27);
}
function V2(e33, t30, r28, s27) {
  l13(e33.modelOrigin, t30, r28.modelOriginHi, r28.modelOriginLo, s27), r28.model.copyFrom(s27, e33.model, t30), r28.modelNormal.copyFrom(s27, e33.modelNormal, t30), e33.color && r28.color && r28.color.copyFrom(s27, e33.color, t30), e33.olidColor && r28.olidColor && r28.olidColor.copyFrom(s27, e33.olidColor, t30), e33.featureAttribute && r28.featureAttribute && r28.featureAttribute.copyFrom(s27, e33.featureAttribute, t30);
}
__decorate([m({ constructOnly: true })], F6.prototype, "symbol", void 0), __decorate([m({ constructOnly: true })], F6.prototype, "metadata", void 0), __decorate([m({ constructOnly: true })], F6.prototype, "shaderTransformation", void 0), __decorate([m()], F6.prototype, "_instanceData", void 0), __decorate([m()], F6.prototype, "_cycleStartIndex", void 0), __decorate([m({ readOnly: true })], F6.prototype, "_enableLevelSelection", null), __decorate([m()], F6.prototype, "_updateCyclesWithStaticCamera", void 0), __decorate([m({ readOnly: true })], F6.prototype, "readyToRun", null), F6 = __decorate([a2("esri.views.3d.webgl-engine.lib.lodRendering.LodRenderer")], F6);
var P7 = n2();
var z5 = n5();
var N3 = e10();
var G5 = n2();
var W4 = n2();
var k7 = [e12(1, 0, 1, 1), e12(0, 0, 1, 1), e12(0, 1, 0, 1), e12(1, 1, 0, 1), e12(1, 0, 0, 1)];
var Y4 = new A6();

// node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DObjectSymbolLayer.js
var ne3 = class {
  constructor(e33, t30, s27, r28, i24, a26, o25, n24, l25, c26, h19 = null) {
    this.lodResources = e33, this.lodRenderer = t30, this.stageResources = s27, this.resourceSize = r28, this.isEsriSymbolResource = i24, this.isWosr = a26, this.resourceBoundingBox = o25, this.symbolSize = n24, this.extentPadding = l25, this.physicalBasedRenderingEnabled = c26, this.pivotOffset = h19;
  }
};
var le2 = class extends m13 {
  getCachedSize() {
    const [e33, t30, s27] = null != this._resources ? this._resources.symbolSize : [1, 1, 1];
    return { width: e33, depth: t30, height: s27 };
  }
  constructor(e33, t30, s27, r28) {
    super(e33, t30, s27, r28, de2(t30)), this._resources = null, this._instanceIndexToGraphicUid = /* @__PURE__ */ new Map(), this._hasLoadedPBRTextures = false, this._disposeResourceHandles = new Array(), this.skipHighSymbolLodsChanged = false, this.ensureDrapedStatus(false), this._hasLoadedPBRTextures = s27.physicalBasedRenderingEnabled;
  }
  async doLoad(e33) {
    if (!this._drivenProperties.size) {
      const e34 = Z2(this.symbolLayer);
      if (e34) throw new Error(e34);
    }
    if (this._isPrimitive) {
      const t30 = this.symbolLayer.resource, s27 = t30 && S2(t30?.primitive) ? t30.primitive : d3;
      this._resources = await this._createResourcesForPrimitive(s27, e33);
    } else {
      const t30 = await r21(this.symbol.styleOrigin), s27 = t30?.href ?? this.symbolLayer.resource?.href;
      this._resources = await this._createResourcesForUrl(s27, e33);
    }
    this.layerOpacityChanged(), this.slicePlaneEnabledChanged(), this.physicalBasedRenderingChanged(), this.updateComplexity();
  }
  get extentPadding() {
    return null != this._resources ? this._resources.extentPadding : 0;
  }
  get _isPrimitive() {
    return null != this._primitive;
  }
  get lodRenderer() {
    return this._resources?.lodRenderer;
  }
  get materials() {
    return this._resources?.stageResources.materials ?? [];
  }
  async _createResourcesForPrimitive(t30, s27) {
    const r28 = this.symbolLayer, i24 = u7(c5(t30)), a26 = u4(p2(i24)), o25 = u4(t10(a26, r28)), n24 = r7(o25), c26 = false, h19 = false, d16 = r28?.material, m21 = { usePBR: this._context.physicalBasedRenderingEnabled, isSchematic: true, mrrFactors: o16, ambient: _2, diffuse: _2, opacity: 1, hasSlicePlane: this._context.slicePlaneEnabled, castShadows: r28.castShadows, emissiveStrength: d16?.emissive?.strength ?? 0, emissiveSource: 1, offsetTransparentBackfaces: false, drivenOpacity: this.needsDrivenTransparentPass }, u30 = !!m21.usePBR, y9 = this.symbol;
    "point-3d" === y9.type && y9.verticalOffset && (m21.verticalOffset = new a18(y9.verticalOffset), m21.castShadows = false), this._context.screenSizePerspectiveEnabled && (m21.screenSizePerspective = this.view.screenSizePerspective.parameters), this._hasDrivenColorOrOpacity ? m21.externalColor = O3 : m21.externalColor = u10.toUnitRGBA(this._materialColor) ?? a7, this._fastUpdates = K3(this._context.renderer, this._fastVisualVariableConvertOptions(i24, o25, a26, null)), m21.instanced = true, this._fastUpdates ? (Object.assign(m21, this._fastUpdates.materialParameters), m21.instancedFeatureAttribute = true) : this._hasDrivenColorOrOpacity && (m21.instancedColor = true);
    const _13 = new P5(m21, this._context);
    _13.setParameters({ cullFace: me2(_13.transparent) });
    const g13 = l9(t30, _13);
    if (!g13) throw new Error(`Unknown object symbol primitive: ${t30}`);
    const v12 = await this._createStageResources(g13, u30, s27), P11 = await this._createLodRenderer(g13, s27);
    return new ne3(g13, P11, v12, a26, c26, h19, i24, o25, n24, u30);
  }
  async _createResourcesForUrl(e33, t30) {
    const r28 = { instanced: true, hasSlicePlane: this._context.slicePlaneEnabled, castShadows: this.symbolLayer.castShadows }, i24 = { spherical: this._context.spherical, materialParameters: r28, streamDataRequester: this._context.streamDataRequester, cache: this._context.sharedResources.objectResourceCache, compressionOptions: { compressionTracker: this._context.compressionTracker, compressionCallback: () => this.updateComplexity() } };
    this._fastUpdates = K3(this._context.renderer, this._fastVisualVariableConvertOptions(null, null, null, null)), this._fastUpdates ? (Object.assign(i24.materialParameters, this._fastUpdates.materialParameters), i24.materialParameters.instancedFeatureAttribute = true) : this._hasDrivenColorOrOpacity && (i24.materialParameters.instancedColor = true);
    const a26 = this.symbol;
    if ("point-3d" === a26.type && a26.verticalOffset) {
      const { screenLength: e34, minWorldLength: t31, maxWorldLength: r29 } = a26.verticalOffset;
      i24.materialParameters.verticalOffset = { screenLength: u3(e34), minWorldLength: t31 || 0, maxWorldLength: null != r29 ? r29 : 1 / 0 }, i24.materialParameters.castShadows = false;
    }
    const o25 = this._context.physicalBasedRenderingEnabled;
    i24.signal = t30, i24.usePBR = o25, i24.skipHighLods = this._context.skipHighSymbolLods;
    const n24 = await z3(e33, i24), c26 = n24.isEsriSymbolResource, h19 = n24.isWosr, d16 = s21(n24.lods), m21 = this._context, u30 = this.symbolLayer.material, f19 = this._getExternalColorParameters(u30), y9 = this.needsDrivenTransparentPass, _13 = d16.getMaterials();
    _13.forEach((e34) => {
      e34.setParameters({ ...f19, drivenOpacity: y9 }), m21.screenSizePerspectiveEnabled && e34.setParameters({ screenSizePerspective: this.view.screenSizePerspective.parameters });
    });
    const g13 = n24.referenceBoundingBox, b14 = u4(p2(g13)), v12 = u4(d16.levels[0].pivotOffset), P11 = u4(t10(b14, this.symbolLayer)), x12 = r7(P11), R9 = this._fastUpdates;
    Q2(R9, this._context.renderer, this._fastVisualVariableConvertOptions(g13, P11, b14, v12)) && _13.forEach((e34) => e34.setParameters(R9.materialParameters));
    const S10 = await this._createStageResources(d16, o25, t30), L2 = await this._createLodRenderer(d16, t30);
    return new ne3(d16, L2, S10, b14, c26, h19, g13, P11, x12, o25, v12);
  }
  _addDisposeResource(e33) {
    this._disposeResourceHandles.push(e33);
  }
  async _createStageResources(e33, s27, r28) {
    const i24 = this._context.stage, a26 = e33.getMaterials();
    s27 !== this._context.physicalBasedRenderingEnabled && this.physicalBasedRenderingChanged();
    const o25 = e33.getTextures();
    i24.addTextures(o25), this._addDisposeResource(() => {
      o25.forEach((e34) => e34.unload()), i24.removeTextures(o25);
    }), await Promise.all(o25.map((e34) => this._context.stage.schedule(() => e34.load(i24.renderView.renderingContext), r28))), s2(r28);
    const n24 = e33.getEngineGeometries();
    return { materials: a26, textures: o25, geometries: n24 };
  }
  async _createLodRenderer(e33, t30) {
    const s27 = this._context.stage, r28 = { layerViewUid: this._context.layerViewUid, graphicUid: (e34) => this._instanceIndexToGraphicUid.get(e34), notifyGraphicGeometryChanged: (e34) => this._context.notifyGraphicGeometryChanged(this._instanceIndexToGraphicUid.get(e34)), notifyGraphicVisibilityChanged: (e34) => this._context.notifyGraphicVisibilityChanged(this._instanceIndexToGraphicUid.get(e34)) }, i24 = this._fastUpdates, a26 = new F6({ symbol: e33, metadata: r28, shaderTransformation: i24 ? { applyTransform: (e34, t31, s28) => {
      e34.getFeatureAttribute(t31, ye2), n3(s28, Z3(i24.materialParameters, ye2, s28));
    }, scaleFactor: (e34, t31, s28) => {
      t31.getFeatureAttribute(s28, ye2), tt(e34, i24.materialParameters, ye2);
    } } : null }, this._context.scheduler);
    return a26.slicePlaneEnabled = this._context.slicePlaneEnabled, this._addDisposeResource(() => {
      s27.removeRenderPlugin(a26), a26.destroy();
    }), await s27.addRenderPlugin(a26, t30), a26;
  }
  _getExternalColorParameters(t30) {
    const s27 = {};
    if (s27.externalColor = O3, !this._drivenProperties.color && null != t30?.color) {
      const r28 = u10.toUnitRGBA(t30.color);
      this._drivenProperties.opacity && (r28[3] = NaN), s27.externalColor = r28;
    }
    return s27.emissiveStrength = t30?.emissive?.strength ?? 1, s27.emissiveSource = l6(t30?.emissive?.source ?? "emissive"), s27;
  }
  destroy() {
    super.destroy(), this._cleanupResources();
  }
  _cleanupResources() {
    this._disposeResourceHandles.forEach((e33) => e33()), this._disposeResourceHandles.length = 0, this._resources = null;
  }
  createGraphics3DGraphic(e33) {
    const t30 = e33.graphic;
    if (!this._validateGeometry(t30.geometry)) return null;
    const s27 = d9(t30.geometry);
    if (null == s27) return this.logger.warn(`unsupported geometry type for object symbol: ${t30.geometry.type}`), null;
    const r28 = this.createElevationContextForGraphic(t30), i24 = e33.renderingInfo;
    return this._createAs3DShape(t30, s27, i24, r28, t30.uid);
  }
  notifyDestroyGraphicLayer(e33) {
    this._instanceIndexToGraphicUid.delete(e33.instanceIndex);
  }
  graphicLayerToGraphicId() {
    return 0;
  }
  layerOpacityChanged() {
    if (null == this._resources) return;
    const e33 = this._getLayerOpacity(), t30 = this._resources.stageResources.materials;
    for (let s27 = 0; s27 < t30.length; s27++) {
      const r28 = t30[s27];
      r28.setParameters({ layerOpacity: e33 }), this._isPrimitive && r28.setParameters({ cullFace: me2(r28.transparent) });
    }
  }
  layerScreenSizePerspectiveChanged() {
    if (null == this._resources) return;
    const e33 = this._context.screenSizePerspectiveEnabled ? this.view.screenSizePerspective.parameters : null;
    for (const t30 of this._resources.stageResources.materials) t30.setParameters({ screenSizePerspective: e33 });
  }
  layerElevationInfoChanged(e33, t30) {
    return this.updateGraphics3DGraphicElevationInfo(e33, t30, m11);
  }
  slicePlaneEnabledChanged() {
    if (null == this._resources) return true;
    this._resources.lodRenderer.slicePlaneEnabled = this._context.slicePlaneEnabled;
    for (const e33 of this._resources.stageResources.materials) e33.setParameters({ hasSlicePlane: this._context.slicePlaneEnabled });
    return true;
  }
  physicalBasedRenderingChanged() {
    if (null == this._resources) return true;
    const { stageResources: e33, isWosr: t30 } = this._resources;
    for (const s27 of e33.materials) this._isPrimitive ? s27.setParameters({ usePBR: this._context.physicalBasedRenderingEnabled, isSchematic: true }) : t30 || s27.setParameters({ usePBR: this._context.physicalBasedRenderingEnabled, isSchematic: false });
    return false !== this._hasLoadedPBRTextures || true !== this._context.physicalBasedRenderingEnabled || (this._hasLoadedPBRTextures = true, false);
  }
  applyRendererDiff(e33, t30) {
    if (null == this._resources) return 0;
    const { stageResources: { materials: s27 }, lodRenderer: r28, resourceBoundingBox: i24, symbolSize: a26, resourceSize: o25, pivotOffset: n24 } = this._resources;
    for (const l25 in e33.diff) {
      if ("visualVariables" !== l25) return 0;
      if (!Q2(this._fastUpdates, t30, this._fastVisualVariableConvertOptions(i24, a26, o25, n24))) return 0;
      for (const e34 of s27) e34.setParameters(this._fastUpdates.materialParameters);
      r28.notifyShaderTransformationChanged();
    }
    return 2;
  }
  computeComplexity() {
    if (null == this._resources) return super.computeComplexity();
    const e33 = this._resources.lodResources, t30 = w5(e33.levels), s27 = e33.computeUsedMemory(), r28 = { ...C3(this.symbol, this.symbolLayer), resourceBytes: s27 };
    return new e24({ verticesPerFeature: t30, memory: r28 });
  }
  _hasLodRenderer() {
    return null != this._resources;
  }
  _createAs3DShape(e33, t30, s27, r28, i24) {
    if (!this._hasLodRenderer() || null == this._resources) return null;
    const a26 = this.getFastUpdateAttrValues(e33), o25 = this._context.clippingExtent;
    if (i8(t30, ue2, this._context.elevationProvider.spatialReference), null != o25 && !V(o25, ue2)) return null;
    const n24 = he2(r28), l25 = this._computeGlobalTransform(t30, r28, fe2, _e2), c26 = this._computeLocalTransform(this._resources, this.symbolLayer, s27, pe2), h19 = this._resources.lodRenderer.instanceData, d16 = h19.addInstance();
    this._instanceIndexToGraphicUid.set(d16, i24), h19.setLocalTransform(d16, c26, false), h19.setGlobalTransform(d16, l25), a26 && h19.setFeatureAttribute(d16, a26), null == this._fastUpdates && this._hasDrivenColorOrOpacity && h19.setColor(d16, this._getDrivenUInt8ColorWithNaNSupport(s27, this._materialColor, !this._isPrimitive));
    const m21 = this._context.stage.renderView.olidRenderHelper;
    if (m21) {
      const e34 = m21.getObjectAndLayerIdColor({ graphicUid: i24, layerViewUid: this._context.layerViewUid });
      h19.setObjectAndLayerIdColor(d16, e34);
    }
    const u30 = new m16(this, d16, g5, r28, this._context.stage.view.state.highlightOrderMap);
    return n24 && (u30.alignedSampledElevation = _e2.sampledElevation), u30.needsElevationUpdates = m11(r28.mode), f12(u30, t30, this._context.elevationProvider), u30;
  }
  _computeGlobalTransform(e33, t30, s27, r28) {
    return c12(e33, this._context.elevationProvider, t30, this._context.renderCoordsHelper, r28), ue2[0] = e33.x, ue2[1] = e33.y, ue2[2] = r28.z, f6(e33.spatialReference, ue2, s27, this._context.renderCoordsHelper.spatialReference), s27;
  }
  _computeLocalTransform(e33, t30, s27, i24) {
    return o(i24), this._applyObjectRotation(s27, false, i24), this._applyObjectRotation(t30, true, i24), this._applyObjectScale(e33, s27, i24), this._applyAnchor(e33, t30, i24), i24;
  }
  _applyObjectScale(e33, t30, s27) {
    if (this._fastUpdates?.requiresShaderTransformation) return;
    const r28 = this._drivenProperties.size && t30.size ? t30.size : e33.symbolSize, a26 = D2(r28, e33.symbolSize, e33.resourceSize, this._context.renderCoordsHelper.unitInMeters);
    1 === a26[0] && 1 === a26[1] && 1 === a26[2] || f3(s27, s27, a26);
  }
  prepareSymbolLayerPatch(e33) {
    if ("partial" !== e33.diff.type) return;
    const t30 = e33.diff.diff;
    this._preparePatchTransform(e33, t30), this._preparePatchColor(e33, t30);
  }
  updateGeometry(e33, t30) {
    if (null == this._resources) return true;
    const s27 = e33.geometry;
    if (!s27) return false;
    const r28 = d9(s27);
    if (null == r28) return false;
    const i24 = this.getGeometryElevationMode(s27), { elevationContext: a26 } = t30;
    return a26.mode === i24 && (a26.updateFeatureExpressionFeature(e33, this._context.layer), this._computeGlobalTransform(r28, a26, fe2, _e2), he2(a26) && (t30.alignedSampledElevation = _e2.sampledElevation), this._resources.lodRenderer.instanceData.setGlobalTransform(t30.instanceIndex, fe2, true), f12(t30, r28, this._context.elevationProvider), true);
  }
  _preparePatchTransform(e33, t30) {
    if (!(t30.heading || t30.tilt || t30.roll || t30.width || t30.height || t30.depth || t30.anchor || t30.anchorPosition)) return;
    if (null == this._resources) return;
    const s27 = (e34, t31, s28) => (null != e34 && "complete" === e34.type ? e34.newValue : t31) ?? s28, r28 = s27(t30.heading, this.symbolLayer.heading, 0), i24 = s27(t30.tilt, this.symbolLayer.tilt, 0), a26 = s27(t30.roll, this.symbolLayer.roll, 0), o25 = s27(t30.width, this.symbolLayer.width, void 0), n24 = s27(t30.height, this.symbolLayer.height, void 0), l25 = s27(t30.depth, this.symbolLayer.depth, void 0), c26 = s27(t30.anchor, this.symbolLayer.anchor, void 0), h19 = s27(t30.anchorPosition, this.symbolLayer.anchorPosition, void 0);
    delete t30.heading, delete t30.tilt, delete t30.roll, delete t30.width, delete t30.height, delete t30.depth, delete t30.anchor, delete t30.anchorPosition;
    const d16 = { heading: r28, tilt: i24, roll: a26, anchor: c26, anchorPosition: h19 }, m21 = this._resources;
    1 === this.loadStatus && e33.symbolLayerStatePatches.push(() => {
      m21.symbolSize = u4(t10(m21.resourceSize, { width: o25, height: n24, depth: l25, isPrimitive: this._isPrimitive }));
    }), e33.graphics3DGraphicPatches.push(({ instanceIndex: e34 }, t31) => {
      const s28 = this._computeLocalTransform(m21, d16, t31, pe2);
      m21.lodRenderer.instanceData.setLocalTransform(e34, s28, true);
    });
  }
  _preparePatchColor(t30, s27) {
    if (!s27.material || "partial" !== s27.material.type) return;
    const r28 = s27.material.diff;
    if (!r28.color || "complete" !== r28.color.type || null == r28.color.newValue || null == r28.color.oldValue) return;
    const i24 = r28.color.newValue, a26 = null != i24 ? u10.toUnitRGBA(i24) : s6;
    delete r28.color;
    const o25 = this._resources;
    if (null == o25) return;
    const n24 = this._isPrimitive;
    t30.graphics3DGraphicPatches.push(({ instanceIndex: e33 }) => {
      if (this._hasDrivenColorOrOpacity) o25.lodRenderer.instanceData.setColor(e33, a26);
      else {
        const e34 = { externalColor: a26 };
        for (const t31 of o25.stageResources.materials) t31.setParameters(e34), n24 && t31.setParameters({ cullFace: me2(t31.transparent) });
      }
    });
  }
  _applyObjectRotation(e33, t30, s27) {
    if (!this._fastUpdates?.requiresShaderTransformation || !t30) return E4(e33.heading, e33.tilt, e33.roll, s27);
  }
  _applyAnchor(e33, t30, s27) {
    if (this._fastUpdates?.requiresShaderTransformation) return;
    const r28 = ce2(e33.resourceBoundingBox, e33.pivotOffset, t30);
    r28 && i4(s27, s27, r28);
  }
  _fastVisualVariableConvertOptions(e33, t30, s27, r28) {
    const i24 = null != e33 ? u4(p2(e33)) : _2, a26 = null != e33 ? ce2(e33, r28, this.symbolLayer) : a4, o25 = this._context.renderCoordsHelper.unitInMeters, n24 = D2(null != t30 ? t30 : void 0, t30, s27, o25), l25 = r3(this.symbolLayer.tilt || 0, this.symbolLayer.roll || 0, this.symbolLayer.heading || 0);
    return new G3({ supports: { size: true, color: true, rotation: true, opacity: false }, modelSize: i24, symbolSize: t30 ?? _2, unitInMeters: o25, anchor: a26, scale: n24, rotation: l25, fallbackColor: this._getFallbackOpacityAndColor(), fallbackSize: n24 });
  }
  get _primitive() {
    const { resource: e33 } = this.symbolLayer;
    return null != e33?.href ? null : e33?.primitive ?? d3;
  }
  _getFallbackOpacityAndColor() {
    return u10.toUnitRGBA(this._materialColor) ?? (this._isPrimitive ? a7 : O3);
  }
  get _materialColor() {
    return this.symbolLayer.material?.color;
  }
};
function ce2(e33, t30, s27) {
  const r28 = n2();
  switch (s27.anchor) {
    case "center":
      s7(r28, b3(e33)), y2(r28, r28);
      break;
    case "top": {
      const t31 = b3(e33);
      o7(r28, -t31[0], -t31[1], -e33[5]);
      break;
    }
    case "bottom": {
      const t31 = b3(e33);
      o7(r28, -t31[0], -t31[1], -e33[2]);
      break;
    }
    case "relative": {
      const t31 = b3(e33), i24 = p2(e33), a26 = s27.anchorPosition, o25 = a26 ? r3(a26.x, a26.y, a26.z) : a4;
      e14(r28, i24, o25), u8(r28, r28, t31), y2(r28, r28);
      break;
    }
    default:
      null != t30 ? y2(r28, t30) : s7(r28, a4);
  }
  return r28;
}
function he2(e33) {
  return "absolute-height" !== e33.mode;
}
function de2(e33) {
  return 1 === (e33.material?.color?.a ?? 0) && null == e33.resource?.href;
}
function me2(e33) {
  return e33 ? 0 : 2;
}
var ue2 = n2();
var pe2 = e10();
var fe2 = e10();
var ye2 = n5();
var _e2 = new x4();

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/Path.js
var h12 = class {
  constructor(t30, i24, s27, h19, o25) {
    this.vertices = t30, this.positionsES = i24, this.offset = h19, this.positions = o25;
    const n24 = t30.length, v12 = Math.floor(n24 / 2), g13 = this.offset + 3 * v12, f19 = s27[g13], r28 = s27[g13 + 1], c26 = s27[g13 + 2];
    this.origin = r3(f19, r28, c26);
    const l25 = this.offset + 3 * n24;
    for (let e33 = this.offset; e33 < l25; e33 += 3) o25[e33] = s27[e33] - f19, o25[e33 + 1] = s27[e33 + 1] - r28, o25[e33 + 2] = s27[e33 + 2] - c26;
    this.updatePathVertexInformation();
  }
  updatePathVertexInformation() {
    const e33 = this.vertices.length, h19 = this.vertices[0];
    let o25 = this.offset;
    const n24 = this.positions;
    h19.vRight[0] = n24[o25 + 3] - n24[o25], h19.vRight[1] = n24[o25 + 4] - n24[o25 + 1], h19.vRight[2] = n24[o25 + 5] - n24[o25 + 2], o25 += 3;
    let v12 = r7(h19.vRight);
    h19.vMinSiblingLength = v12, A2(h19.vRight, h19.vRight);
    let g13 = h19;
    for (let f19 = 1; f19 < e33; ++f19) {
      const h20 = this.vertices[f19];
      if (h20.vLeft = g13.vRight, f19 < e33 - 1) {
        h20.vRight[0] = n24[o25 + 3] - n24[o25], h20.vRight[1] = n24[o25 + 4] - n24[o25 + 1], h20.vRight[2] = n24[o25 + 5] - n24[o25 + 2];
        const s27 = r7(h20.vRight);
        h20.vMinSiblingLength = Math.min(v12, s27), v12 = s27, A2(h20.vRight, h20.vRight);
      } else s7(h20.vRight, h20.vLeft), h20.vMinSiblingLength = v12;
      g13 = h20, o25 += 3;
    }
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/PathBuilder.js
var h13 = class {
  constructor(s27, o25, h19, n24, a26, p14 = {}) {
    this.path = s27, this.profile = o25, this.extruder = h19, this.startCap = n24, this.endCap = a26, this.options = p14, this._extrusionVertexCount = 0;
    const l25 = this.path.vertices.length - 2;
    this.numExtrusionProfiles = h19.numProfilesPerJoin() * l25 + 2, this.numVerticesTotal = o25.vertices.length * this.numExtrusionProfiles, this.startCap.vertexBufferStart = this.numVerticesTotal;
    const u30 = this.startCap.numVertices;
    this.numVerticesTotal += u30, this.endCap.vertexBufferStart = this.numVerticesTotal;
    const x12 = this.endCap.numVertices;
    this.numVerticesTotal += x12, this.pathVertexData = a9(1 * this.numVerticesTotal), this.profileRightAxes = t8(2 * this.numVerticesTotal), this.profileUpAxes = t8(2 * this.numVerticesTotal), this.profileVertexAndNormals = n13(4 * this.numVerticesTotal), this.profileAuxData = n13(3 * this.numVerticesTotal), this.positions = e16(s27.positions, s27.offset, 3 * s27.vertices.length), this._rebuildGeometry(), this._buildTopology();
  }
  emitVertex(t30, e33, i24, s27, r28) {
    let h19 = 4 * this._extrusionVertexCount;
    if (this.profileVertexAndNormals[h19] = i24[0], this.profileVertexAndNormals[h19 + 1] = i24[1], this.profileVertexAndNormals[h19 + 2] = s27[0], this.profileVertexAndNormals[h19 + 3] = s27[1], this.pathVertexData[this._extrusionVertexCount] = t30, h19 = 3 * this._extrusionVertexCount, r28) {
      const e34 = this.path.vertices[t30], i25 = e34.maxStretchDistance;
      this.profileAuxData[h19] = e34.rotationRight[0] * i25, this.profileAuxData[h19 + 1] = e34.rotationRight[1] * i25;
    } else this.profileAuxData[h19] = this.profileAuxData[h19 + 1] = 0;
    this.profileAuxData[h19 + 2] = 0, e17(this.profileRightAxes, this._extrusionVertexCount, e33.right[0], e33.right[1], e33.right[2]), e17(this.profileUpAxes, this._extrusionVertexCount, e33.up[0], e33.up[1], e33.up[2]), ++this._extrusionVertexCount;
  }
  emitCapVertex(t30, e33, i24, s27, r28, h19) {
    let n24 = 4 * this._extrusionVertexCount;
    this.profileVertexAndNormals[n24] = i24[0], this.profileVertexAndNormals[n24 + 1] = i24[1], this.profileVertexAndNormals[n24 + 2] = s27[0], this.profileVertexAndNormals[n24 + 3] = s27[1], n24 = 3 * this._extrusionVertexCount, this.profileAuxData[n24] = r28, this.profileAuxData[n24 + 1] = h19, this.profileAuxData[n24 + 2] = 1, e17(this.profileRightAxes, this._extrusionVertexCount, e33.right[0], e33.right[1], e33.right[2]), e17(this.profileUpAxes, this._extrusionVertexCount, e33.up[0], e33.up[1], e33.up[2]), this.pathVertexData[this._extrusionVertexCount] = t30, ++this._extrusionVertexCount;
  }
  _rebuildGeometry() {
    this._extrusionVertexCount = 0;
    const { positions: e33, offset: i24, vertices: s27 } = this.path;
    this.positions = e16(e33, i24, 3 * s27.length);
    let r28 = 0;
    const o25 = (t30, e34, i25, s28, o26) => this.emitCapVertex(r28, t30, e34, i25, s28, o26), h19 = (t30, e34, i25, s28) => this.emitVertex(r28, t30, e34, i25, s28);
    for (this.startCap.rebuildConnectingProfileGeometry(s27[r28], this.profile, o25), r28 = 1; r28 < s27.length - 1; ++r28) this.extruder.extrude(s27[r28], this.profile, h19);
    this.endCap.rebuildConnectingProfileGeometry(s27[r28], this.profile, o25), r28 = 0, this.startCap.rebuildCapGeometry(s27[r28], o25), r28 = s27.length - 1, this.endCap.rebuildCapGeometry(s27[r28], o25);
  }
  _buildTopology() {
    const t30 = this.profile.vertices.length, e33 = this.profile.numSegments, i24 = this.numExtrusionProfiles - 1;
    let r28 = 3 * (2 * (e33 * i24));
    this.startCap.indexBufferStart = r28, this.startCap.firstProfileVertexIndex = 0, r28 += this.startCap.numIndices, this.endCap.indexBufferStart = r28, this.endCap.firstProfileVertexIndex = t30 * (this.numExtrusionProfiles - 1);
    const o25 = new Array(), h19 = new Array(), n24 = (t31, e34, i25) => {
      o25.push(t31), o25.push(e34), o25.push(i25), h19.push(this.pathVertexData[t31]), h19.push(this.pathVertexData[e34]), h19.push(this.pathVertexData[i25]);
    };
    for (let s27 = 0; s27 < e33; ++s27) {
      const e34 = this.profile.indices[2 * s27], r29 = this.profile.indices[2 * s27 + 1];
      for (let s28 = 0; s28 < i24; ++s28) {
        const i25 = s28 * t30 + e34, o26 = (s28 + 1) * t30 + r29, h20 = s28 * t30 + r29;
        n24(i25, (s28 + 1) * t30 + e34, o26), n24(i25, o26, h20);
      }
    }
    this.startCap.buildTopology(this.path.vertices[0], n24), this.endCap.buildTopology(this.path.vertices[this.path.vertices.length - 1], n24), this.vertexIndices = e15(o25), this.pathVertexIndices = e15(h19);
  }
  onPathChanged() {
    this._rebuildGeometry();
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/PathCapBuilder.js
var o21 = class {
  rebuildConnectingProfileGeometry(e33, t30, s27) {
    for (let i24 = 0; i24 < t30.vertices.length; ++i24) s27(e33.frame, t30.vertices[i24], t30.normals[i24], 0, 0);
  }
};
var l18 = class extends o21 {
  constructor() {
    super(), this.numVertices = 0, this.numIndices = 0;
  }
  rebuildCapGeometry() {
  }
  buildTopology() {
  }
};
var f15 = class extends o21 {
  constructor(e33, t30 = 0, s27 = false) {
    super(), this.profile = e33, this.profilePlaneOffset = t30, this.flip = s27;
  }
  get numVertices() {
    return this.profile.vertices.length;
  }
  get numIndices() {
    return 3 * this.profile.numSegments;
  }
  rebuildConnectingProfileGeometry(e33, t30, s27) {
    const i24 = this.profilePlaneOffset;
    for (let r28 = 0; r28 < t30.vertices.length; ++r28) s27(e33.frame, t30.vertices[r28], t30.normals[r28], i24, 0);
  }
  rebuildCapGeometry(t30, s27) {
    const i24 = this.profile, r28 = this.flip ? 1 : -1, n24 = this.profilePlaneOffset, o25 = m18;
    o2(o25, 0, 0);
    for (let e33 = 0; e33 < i24.vertices.length; ++e33) s27(t30.frame, i24.vertices[e33], o25, n24, r28);
  }
  buildTopology(e33, t30) {
    const s27 = this.profile, i24 = this.vertexBufferStart + s27.indices[0];
    for (let r28 = 1; r28 < s27.numSegments; ++r28) {
      const e34 = s27.indices[2 * r28], n24 = s27.indices[2 * r28 + 1], o25 = this.vertexBufferStart + e34, l25 = this.vertexBufferStart + n24;
      this.flip ? t30(l25, o25, i24) : t30(i24, o25, l25);
    }
  }
};
var h14 = class extends o21 {
  constructor(e33) {
    super(), this.flip = false, this.sign = 0, this.breakNormals = false, this.numSegments = 3, this.profile = e33.profile, this.flip = e33.flip, this.sign = this.flip ? 1 : -1, this.breakNormals = e33.breakNormals, this.numSegments = e33.subdivisions;
  }
  get numVertices() {
    let e33 = this.profile.vertices.length * (this.numSegments - 1) + this.profile.poles.length;
    return this.breakNormals && (e33 += this.profile.vertices.length), e33;
  }
  get numIndices() {
    let e33 = 0;
    const t30 = this.profile;
    e33 += 2 * t30.numSegments * (this.numSegments - 1);
    for (let s27 = 0; s27 < t30.numSegments; ++s27) {
      const i24 = t30.indices[2 * s27], r28 = t30.indices[2 * s27 + 1];
      t30.poleIndices[i24] === t30.poleIndices[r28] ? e33 += 1 : e33 += 2;
    }
    return 3 * e33;
  }
  rebuildCapGeometry(n24, o25) {
    const l25 = this.profile, f19 = n24.frame, h19 = 0.5 * this.sign, p14 = c19, a26 = m18;
    o2(a26, 0, 0);
    for (const e33 of l25.poles) e33.normal ? o25(f19, e33.position, e33.normal, h19, 0) : o25(f19, e33.position, a26, h19, this.sign);
    if (this.breakNormals) for (let e33 = 0; e33 < l25.vertices.length; ++e33) o25(f19, l25.vertices[e33], l25.normals[e33], 0, 0);
    for (let e33 = 0; e33 < this.numSegments - 1; ++e33) {
      const n25 = (1 - (e33 + 1) / this.numSegments) * Math.PI * 0.5, c26 = Math.sin(n25), m21 = Math.cos(n25);
      for (let e34 = 0; e34 < l25.vertices.length; ++e34) {
        const n26 = l25.poles[l25.poleIndices[e34]];
        e8(p14, l25.vertices[e34], n26.position), l3(p14, p14, c26), n26.normal ? (u6(p14, p14, n26.position), o25(f19, p14, n26.normal, h19 * m21, 0)) : (v(a26, p14), l3(a26, a26, c26), u6(p14, p14, n26.position), o25(f19, p14, a26, h19 * m21, this.sign * m21));
      }
    }
  }
  buildTopology(e33, t30) {
    const s27 = this.profile, i24 = this.breakNormals ? this.vertexBufferStart + s27.poles.length : this.firstProfileVertexIndex, r28 = this.breakNormals ? this.vertexBufferStart + s27.poles.length + s27.vertices.length : this.vertexBufferStart + s27.poles.length;
    for (let n24 = 0; n24 < s27.numSegments; ++n24) {
      const e34 = s27.indices[2 * n24], o25 = s27.indices[2 * n24 + 1], l25 = this.vertexBufferStart + s27.poleIndices[e34], f19 = this.vertexBufferStart + s27.poleIndices[o25];
      let h19 = i24 + e34, c26 = i24 + o25;
      for (let i25 = 0; i25 < this.numSegments - 1; ++i25) {
        const n25 = r28 + i25 * s27.vertices.length + e34, l26 = r28 + i25 * s27.vertices.length + o25;
        this.flip ? (t30(n25, c26, h19), t30(c26, n25, l26)) : (t30(h19, c26, n25), t30(l26, n25, c26)), h19 = n25, c26 = l26;
      }
      this.flip ? (t30(l25, c26, h19), l25 !== f19 && t30(l25, f19, c26)) : (t30(h19, c26, l25), l25 !== f19 && t30(c26, f19, l25));
    }
  }
};
var c19 = n6();
var m18 = n6();

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/PathExtruder.js
var c20 = class {
  numProfilesPerJoin() {
    return 1;
  }
  extrude(t30, e33, r28) {
    for (let s27 = 0; s27 < e33.vertices.length; ++s27) r28(t30.frame, e33.vertices[s27], e33.normals[s27], false);
  }
};
var a22 = class {
  constructor(t30, e33) {
    this.cutoffAngle = t30, this.numBendSubdivisions = e33;
  }
  numProfilesPerJoin() {
    return this.numBendSubdivisions + 1;
  }
  extrude(e33, s27, i24) {
    const o25 = h15, { rotationAngle: n24, rotationRight: c26, frame: a26 } = e33;
    if (Math.abs(n24) >= this.cutoffAngle) {
      const l25 = e33.rotationFrameUp;
      for (let h19 = 0; h19 < this.numBendSubdivisions + 1; ++h19) {
        p(u28, 0.5 * -n24 + h19 * n24 / this.numBendSubdivisions, l25), m19(o25, a26, u28);
        for (let t30 = 0; t30 < s27.vertices.length; ++t30) {
          if (j(s27.vertices[t30], c26) * n24 >= 0) i24(o25, s27.vertices[t30], s27.normals[t30], false);
          else {
            i24(a26, e33.applyMiterStretch(f16, s27.vertices[t30]), s27.normals[t30], true);
          }
        }
      }
    } else for (let t30 = 0; t30 < this.numBendSubdivisions + 1; ++t30) for (let o26 = 0; o26 < s27.vertices.length; ++o26) {
      const t31 = j(s27.vertices[o26], c26) * n24 >= 0;
      i24(a26, e33.applyMiterStretch(f16, s27.vertices[o26]), s27.normals[o26], !t31);
    }
  }
};
var l19 = class {
  constructor() {
    this.up = n2(), this.right = n2();
  }
};
function m19(t30, e33, r28) {
  E3(t30.up, e33.up, r28), E3(t30.right, e33.right, r28);
}
var f16 = n6();
var u28 = e10();
var h15 = new l19();

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/PathGeometry.js
var e29 = class extends m7 {
  constructor(t30, e33, r28, s27, i24, n24) {
    super(t30, e33, null, 0, n24), this.path = r28, this.geometrySR = s27, this.stencilWidth = i24;
  }
};
function r22(t30) {
  return "path" in t30;
}

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/PathGeometryData.js
var w7 = class {
  constructor(t30) {
    this.builder = t30;
  }
  onPathChanged(t30) {
    this.builder.onPathChanged();
  }
};
var y4 = class extends w7 {
  constructor(t30) {
    super(t30), this.color = r6(255, 255, 255, 255), this._size = n6(), this.positions = n8(3 * this.builder.numVerticesTotal), this.normals = new Int16Array(2 * this.builder.numVerticesTotal);
  }
  bakeVertexColors(t30) {
    a6(this.color, t30);
  }
  bake(a26) {
    r4(this._size, a26);
    const { numVerticesTotal: c26, pathVertexData: p14, positions: u30, profileRightAxes: m21, profileUpAxes: f19, profileVertexAndNormals: d16, profileAuxData: b14 } = this.builder;
    for (let t30 = 0; t30 < c26; ++t30) {
      let c27 = p14[t30];
      c27 *= 3;
      const v12 = _8;
      let A9 = 0, w11 = 0;
      const y9 = u9(I5, m21, t30), j15 = u9(k8, f19, t30), D6 = 4 * t30, P11 = o2(V3, d16[D6] * a26[0], d16[D6 + 1] * a26[1]), F10 = 3 * t30;
      if (1 === b14[F10 + 2]) _3(v12, j15, y9), A9 = b14[F10] * a26[0], w11 = b14[F10 + 1];
      else {
        const t31 = C5, a27 = z6;
        o2(t31, b14[F10], b14[F10 + 1]);
        const l25 = q2(t31);
        v(t31, t31);
        const c28 = j(P11, t31);
        if (Math.abs(c28) > l25) {
          o2(a27, -t31[1], t31[0]);
          const i24 = j(P11, a27);
          l3(t31, t31, l25 * Math.sign(c28)), l3(a27, a27, i24), u6(P11, t31, a27);
        }
        o7(v12, 0, 0, 0);
      }
      const N4 = y9[0] * P11[0] + j15[0] * P11[1], R9 = y9[1] * P11[0] + j15[1] * P11[1], M8 = y9[2] * P11[0] + j15[2] * P11[1];
      this.positions[F10] = u30[c27] + N4 + v12[0] * A9, this.positions[F10 + 1] = u30[c27 + 1] + R9 + v12[1] * A9, this.positions[F10 + 2] = u30[c27 + 2] + M8 + v12[2] * A9;
      const T10 = d16[D6 + 2], U9 = d16[D6 + 3];
      e17(this.normals, t30, y9[0] * T10 + j15[0] * U9 + v12[0] * w11, y9[1] * T10 + j15[1] * U9 + v12[1] * w11, y9[2] * T10 + j15[2] * U9 + v12[2] * w11);
    }
  }
  createGeometryData() {
    const t30 = this.builder.vertexIndices;
    return [["position", new t12(this.positions, t30, 3, true)], ["normalCompressed", new t12(this.normals, t30, 2, true)], ["color", new t12(this.color, U(t30.length), 4, true)]];
  }
  onPathChanged(t30) {
    super.onPathChanged(t30), this.bake(this.size);
  }
  intersect(t30, e33, i24, s27) {
    const o25 = this.builder.vertexIndices, r28 = new s10(this.positions, 3), n24 = o25.length / 3;
    M4(t30, e33, 0, n24, o25, r28, void 0, i24, (t31, e34, i25) => s27(t31, i25, e34));
  }
  get size() {
    return this._size;
  }
};
var j9 = class extends w7 {
  constructor(t30, e33, i24, s27) {
    super(t30), this.sizeAttributeValue = e33, this.colorAttributeValue = i24, this.opacityAttributeValue = s27, this.baked = new y4(t30), this._vvSize = n8(this.builder.path.vertices.length).fill(e33), this._vvColor = n13(this.builder.path.vertices.length).fill(i24), this._vvOpacity = n13(this.builder.path.vertices.length).fill(s27);
  }
  createGeometryData() {
    const t30 = this.builder, { pathVertexIndices: e33, vertexIndices: i24 } = t30;
    return [["position", new t12(t30.positions, e33, 3, true)], ["profileVertexAndNormal", new t12(t30.profileVertexAndNormals, i24, 4, true)], ["profileAuxData", new t12(t30.profileAuxData, i24, 3, true)], ["profileRight", new t12(t30.profileRightAxes, i24, 2, true)], ["profileUp", new t12(t30.profileUpAxes, i24, 2, true)], ["sizeFeatureAttribute", new t12(this._vvSize, e33, 1, true)], ["colorFeatureAttribute", new t12(this._vvColor, e33, 1, true)], ["opacityFeatureAttribute", new t12(this._vvOpacity, e33, 1, true)]];
  }
  onPathChanged(t30) {
    super.onPathChanged(t30);
    const e33 = t30.getMutableAttribute("position");
    e33 && (e33.data = this.builder.positions);
  }
};
var V3 = n6();
var C5 = n6();
var z6 = n6();
var _8 = n2();
var I5 = n2();
var k8 = n2();

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/pathGeometryUtils.js
function l20(l25, v12) {
  let h19 = null;
  const u30 = l25.vertices.length, j15 = 0.99619469809, R9 = n2(), y9 = n2(), b14 = n2(), x12 = n2(), L2 = n2(), d16 = n2(), k14 = j5();
  let q9 = l25.vertices[0];
  s7(y9, v12), o7(R9, 0, 1, 0), dt(q9.vRight, y9, R9, R9, b14, y9, j15), s7(q9.frame.up, y9), s7(q9.frame.right, b14);
  const G7 = l25.positions;
  let M8 = l25.offset;
  h19 = q9;
  for (let m21 = 1; m21 < u30; ++m21) {
    q9 = l25.vertices[m21], u8(L2, q9.vLeft, q9.vRight);
    let a26 = r7(L2);
    a26 > 0 ? (a26 = 1 / Math.sqrt(a26), L2[0] = L2[0] * a26, L2[1] = L2[1] * a26, L2[2] = L2[2] * a26) : (L2[0] = q9.vRight[0], L2[1] = q9.vRight[1], L2[2] = q9.vRight[2]), d16[0] = G7[M8] + h19.frame.up[0], d16[1] = G7[M8 + 1] + h19.frame.up[1], d16[2] = G7[M8 + 2] + h19.frame.up[2], M8 += 3;
    const v13 = o7(n20, G7[M8], G7[M8 + 1], G7[M8 + 2]);
    U2(v13, L2, k14);
    K2(k14, k4(d16, q9.vLeft), x12) ? (x12[0] -= G7[M8], x12[1] -= G7[M8 + 1], x12[2] -= G7[M8 + 2], A2(y9, x12), _3(b14, L2, y9), A2(b14, b14)) : dt(L2, h19.frame.up, h19.frame.right, R9, b14, y9, j15), s7(q9.frame.up, y9), s7(q9.frame.right, b14), h19 = q9;
  }
}
var n20 = n2();

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/PathProfile.js
var r23 = class {
  constructor() {
    this.vertices = new Array(), this.normals = new Array(), this.indices = new Array(), this.poles = new Array(), this.poleIndices = new Array();
  }
  addVertex(t30, e33) {
    return this.vertices.push(t6(t30)), this.normals.push(t6(e33)), this.vertices.length - 1;
  }
  addPole(t30, e33 = null) {
    return this.poles.push({ position: t6(t30), normal: e33 ? t6(e33) : null }), this.poles.length - 1;
  }
  addSegment(t30, e33 = null) {
    this.indices.push(t30.v0), this.indices.push(t30.v1), e33 && (this.poleIndices.push(e33.v0), this.poleIndices.push(e33.v1));
  }
  get numSegments() {
    return this.indices.length / 2;
  }
  translate(t30, e33) {
    for (const s27 of this.vertices) s27[0] += t30, s27[1] += e33;
    for (const s27 of this.poles) s27.position[0] += t30, s27.position[1] += e33;
  }
  get usedMemory() {
    return this.vertices.length * i6(this.vertices[0]) * 2 + i6(this.indices);
  }
};
var n21 = { top: [0, -0.5], bottom: [0, 0.5] };
function i18(t30) {
  const s27 = 0.5, i24 = c14, d16 = new r23(), a26 = { v0: 0, v1: 0 };
  d16.addPole(r8(0, 0));
  for (let o25 = 0; o25 < i24; ++o25) {
    const t31 = 2 * o25 * Math.PI / i24, r28 = Math.cos(t31), n24 = Math.sin(t31), a27 = r8(r28 * s27, n24 * s27), c27 = r8(r28, n24);
    d16.addVertex(a27, c27);
  }
  for (let e33 = 0; e33 < i24 - 1; ++e33) {
    const t31 = { v0: e33, v1: e33 + 1 };
    d16.addSegment(t31, a26);
  }
  const c26 = { v0: i24 - 1, v1: 0 };
  if (d16.addSegment(c26, a26), "center" !== t30) {
    const e33 = n21[t30];
    d16.translate(e33[0], e33[1]);
  }
  return d16;
}
var d11 = { center: i18("center"), top: i18("top"), bottom: i18("bottom") };
var a23 = { center: c21("center"), top: c21("top"), bottom: c21("bottom") };
function c21(t30) {
  const s27 = 1, o25 = 1, i24 = new r23(), d16 = r8(0.5 * -s27, 0.5 * -o25), a26 = r8(0.5 * s27, 0.5 * -o25), c26 = r8(0.5 * s27, 0.5 * o25), h19 = r8(0.5 * -s27, 0.5 * o25), l25 = r8(0, -1), v12 = r8(1, 0), m21 = r8(0, 1), p14 = r8(-1, 0);
  if (i24.addPole(r8(0, 0.5 * o25), m21), i24.addPole(r8(0, 0.5 * o25)), i24.addPole(r8(0, 0.5 * -o25)), i24.addPole(r8(0, 0.5 * -o25), l25), i24.addVertex(d16, l25), i24.addVertex(a26, l25), i24.addSegment({ v0: 0, v1: 1 }, { v0: 3, v1: 3 }), i24.addVertex(a26, v12), i24.addVertex(c26, v12), i24.addSegment({ v0: 2, v1: 3 }, { v0: 2, v1: 1 }), i24.addVertex(c26, m21), i24.addVertex(h19, m21), i24.addSegment({ v0: 4, v1: 5 }, { v0: 0, v1: 0 }), i24.addVertex(h19, p14), i24.addVertex(d16, p14), i24.addSegment({ v0: 6, v1: 7 }, { v0: 1, v1: 2 }), "center" !== t30) {
    const e33 = n21[t30];
    i24.translate(e33[0], e33[1]);
  }
  return i24;
}

// node_modules/@arcgis/core/core/libs/gl-matrix-2/math/mat2.js
function n22(t30, n24) {
  return t30[0] = n24[0], t30[1] = n24[1], t30[2] = n24[2], t30[3] = n24[3], t30;
}
function r24(t30) {
  return t30[0] = 1, t30[1] = 0, t30[2] = 0, t30[3] = 1, t30;
}
function a24(t30, n24, r28, a26, u30) {
  return t30[0] = n24, t30[1] = r28, t30[2] = a26, t30[3] = u30, t30;
}
function u29(t30, n24) {
  if (t30 === n24) {
    const r28 = n24[1];
    t30[1] = n24[2], t30[2] = r28;
  } else t30[0] = n24[0], t30[1] = n24[2], t30[2] = n24[1], t30[3] = n24[3];
  return t30;
}
function o22(t30, n24) {
  const r28 = n24[0], a26 = n24[1], u30 = n24[2], o25 = n24[3];
  let e33 = r28 * o25 - u30 * a26;
  return e33 ? (e33 = 1 / e33, t30[0] = o25 * e33, t30[1] = -a26 * e33, t30[2] = -u30 * e33, t30[3] = r28 * e33, t30) : null;
}
function e30(t30, n24) {
  const r28 = n24[0];
  return t30[0] = n24[3], t30[1] = -n24[1], t30[2] = -n24[2], t30[3] = r28, t30;
}
function c22(t30) {
  return t30[0] * t30[3] - t30[2] * t30[1];
}
function s22(t30, n24, r28) {
  const a26 = n24[0], u30 = n24[1], o25 = n24[2], e33 = n24[3], c26 = r28[0], s27 = r28[1], i24 = r28[2], f19 = r28[3];
  return t30[0] = a26 * c26 + o25 * s27, t30[1] = u30 * c26 + e33 * s27, t30[2] = a26 * i24 + o25 * f19, t30[3] = u30 * i24 + e33 * f19, t30;
}
function i19(t30, n24, r28) {
  const a26 = n24[0], u30 = n24[1], o25 = n24[2], e33 = n24[3], c26 = Math.sin(r28), s27 = Math.cos(r28);
  return t30[0] = a26 * s27 + o25 * c26, t30[1] = u30 * s27 + e33 * c26, t30[2] = a26 * -c26 + o25 * s27, t30[3] = u30 * -c26 + e33 * s27, t30;
}
function f17(t30, n24, r28) {
  const a26 = n24[0], u30 = n24[1], o25 = n24[2], e33 = n24[3], c26 = r28[0], s27 = r28[1];
  return t30[0] = a26 * c26, t30[1] = u30 * c26, t30[2] = o25 * s27, t30[3] = e33 * s27, t30;
}
function l21(t30, n24) {
  const r28 = Math.sin(n24), a26 = Math.cos(n24);
  return t30[0] = a26, t30[1] = r28, t30[2] = -r28, t30[3] = a26, t30;
}
function M5(t30, n24) {
  return t30[0] = n24[0], t30[1] = 0, t30[2] = 0, t30[3] = n24[1], t30;
}
function h16(t30) {
  return "mat2(" + t30[0] + ", " + t30[1] + ", " + t30[2] + ", " + t30[3] + ")";
}
function b10(t30) {
  return Math.sqrt(t30[0] ** 2 + t30[1] ** 2 + t30[2] ** 2 + t30[3] ** 2);
}
function m20(t30, n24, r28, a26) {
  return t30[2] = a26[2] / a26[0], r28[0] = a26[0], r28[1] = a26[1], r28[3] = a26[3] - t30[2] * r28[1], [t30, n24, r28];
}
function d12(t30, n24, r28) {
  return t30[0] = n24[0] + r28[0], t30[1] = n24[1] + r28[1], t30[2] = n24[2] + r28[2], t30[3] = n24[3] + r28[3], t30;
}
function p13(t30, n24, r28) {
  return t30[0] = n24[0] - r28[0], t30[1] = n24[1] - r28[1], t30[2] = n24[2] - r28[2], t30[3] = n24[3] - r28[3], t30;
}
function y5(t30, n24) {
  return t30[0] === n24[0] && t30[1] === n24[1] && t30[2] === n24[2] && t30[3] === n24[3];
}
function x6(n24, r28) {
  const a26 = n24[0], u30 = n24[1], o25 = n24[2], e33 = n24[3], c26 = r28[0], s27 = r28[1], i24 = r28[2], f19 = r28[3], l25 = e6();
  return Math.abs(a26 - c26) <= l25 * Math.max(1, Math.abs(a26), Math.abs(c26)) && Math.abs(u30 - s27) <= l25 * Math.max(1, Math.abs(u30), Math.abs(s27)) && Math.abs(o25 - i24) <= l25 * Math.max(1, Math.abs(o25), Math.abs(i24)) && Math.abs(e33 - f19) <= l25 * Math.max(1, Math.abs(e33), Math.abs(f19));
}
function S5(t30, n24, r28) {
  return t30[0] = n24[0] * r28, t30[1] = n24[1] * r28, t30[2] = n24[2] * r28, t30[3] = n24[3] * r28, t30;
}
function j10(t30, n24, r28, a26) {
  return t30[0] = n24[0] + r28[0] * a26, t30[1] = n24[1] + r28[1] * a26, t30[2] = n24[2] + r28[2] * a26, t30[3] = n24[3] + r28[3] * a26, t30;
}
var _9 = s22;
var g11 = p13;
var q6 = Object.freeze(Object.defineProperty({ __proto__: null, LDU: m20, add: d12, adjoint: e30, copy: n22, determinant: c22, equals: x6, exactEquals: y5, frob: b10, fromRotation: l21, fromScaling: M5, identity: r24, invert: o22, mul: _9, multiply: s22, multiplyScalar: S5, multiplyScalarAndAdd: j10, rotate: i19, scale: f17, set: a24, str: h16, sub: g11, subtract: p13, transpose: u29 }, Symbol.toStringTag, { value: "Module" }));

// node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/mat2f64.js
function e31() {
  return [1, 0, 0, 1];
}
function t29(e33) {
  return [e33[0], e33[1], e33[2], e33[3]];
}
function n23(e33, t30, n24, r28) {
  return [e33, t30, n24, r28];
}
var r25 = Object.freeze(Object.defineProperty({ __proto__: null, clone: t29, create: e31, fromValues: n23 }, Symbol.toStringTag, { value: "Module" }));

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/PathVertex.js
var b11 = class {
  constructor() {
    this.vLeft = n2(), this.vRight = n2(), this.vMinSiblingLength = 0, this.frame = new l19();
  }
  setFrameFromUpVector(t30) {
    s7(this.frame.up, t30), u8(y6, this.vLeft, this.vRight), A2(y6, y6), g2(I6, this.frame.up, P3(y6, this.frame.up)), c2(D4, y6, I6), A2(D4, D4), _3(this.frame.right, D4, this.frame.up);
  }
  get foldingAngle() {
    return Math.PI - this.rotationAngle;
  }
};
var R5 = class extends b11 {
  get rotationFrameUp() {
    return this.frame.up;
  }
  get rotationRight() {
    return s8;
  }
  get rotationAngle() {
    g2(w8, this.frame.up, P3(this.frame.up, this.vLeft)), c2(w8, this.vLeft, w8), y2(w8, w8), A2(w8, w8), g2(P8, this.frame.up, P3(this.frame.up, this.vRight)), c2(P8, this.vRight, P8), A2(P8, P8), _3(U6, this.rotationFrameUp, this.vLeft);
    return Math.sign(P3(U6, this.vRight)) * (Math.PI - b2(P3(w8, P8)));
  }
  get maxStretchDistance() {
    return Math.abs(this.vMinSiblingLength / Math.cos(0.5 * this.foldingAngle));
  }
  applyMiterStretch(t30, r28) {
    const s27 = this.rotationAngle;
    if (Math.abs(s27) <= 0) return r28;
    const e33 = h(Math.cos(0.5 * s27));
    return o2(t30, (e33 - 1 + 1) * r28[0], r28[1]);
  }
};
var x7 = class extends b11 {
  get rotationFrameUp() {
    const t30 = Math.sign(P3(this.frame.right, this.vRight));
    return _3(A7, this.vRight, this.vLeft), g2(A7, A7, t30), A2(A7, A7);
  }
  get rotationRight() {
    const t30 = this.rotationFrameUp, i24 = P3(t30, this.frame.up), r28 = P3(t30, this.frame.right);
    return g2(S6, this.frame.up, -r28), g2(F7, this.frame.right, i24), u8(S6, S6, F7), A2(S6, S6), L(d13, this.frame, S6), d13;
  }
  get rotationAngle() {
    const i24 = Math.sign(P3(this.frame.right, this.vRight));
    return y2(U6, this.vLeft), -i24 * (Math.PI - b2(P3(U6, this.vRight)));
  }
  get maxStretchDistance() {
    return Math.abs(this.vMinSiblingLength * h(Math.cos(0.5 * this.foldingAngle)));
  }
  applyMiterStretch(t30, s27) {
    const a26 = this.rotationAngle;
    if (0 === Math.abs(a26)) return s27;
    const h19 = h(Math.cos(0.5 * a26)), n24 = this.rotationRight, o25 = a24(k9, 1 + (h19 - 1) * n24[0] * n24[0], (h19 - 1) * n24[0] * n24[1], (h19 - 1) * n24[0] * n24[1], 1 + (h19 - 1) * n24[1] * n24[1]);
    return P(t30, s27, o25);
  }
};
function L(t30, i24, r28) {
  o2(t30, P3(r28, i24.right), P3(r28, i24.up));
}
function j11(t30) {
  switch (t30) {
    case 0:
      return new R5();
    case 1:
      return new x7();
  }
}
var A7 = n2();
var d13 = n6();
var S6 = n2();
var F7 = n2();
var U6 = n2();
var w8 = n2();
var P8 = n2();
var I6 = n2();
var y6 = n2();
var D4 = n2();
var k9 = e31();

// node_modules/@arcgis/core/views/3d/webgl-engine/materials/PathTechnique.js
var P9 = class extends u21 {
  constructor() {
    super(...arguments), this.ambient = e5(0.2, 0.2, 0.2), this.diffuse = e5(0.8, 0.8, 0.8), this.opacity = 1, this.origin = n2(), this.modelTransformation = null, this.mrrFactors = t18, this.emissiveStrength = 0, this.emissiveSource = 1, this.emissiveBaseColor = a4;
  }
};
var V4 = class extends m10 {
  constructor(e33, r28) {
    super(e33, r28, new t16(I2, () => import("./Path.glsl-JWL5OCJ5.js")), x8(r28).locations);
  }
  initializePipeline(e33) {
    const { output: r28, transparent: t30, hasSlicePlane: i24, doubleSidedMode: s27, hasOccludees: l25, oitPass: a26 } = e33, c26 = 0 === a26, b14 = 2 === a26;
    return T3({ blending: o13(r28) && t30 ? a15(a26) : null, culling: i24 && !t30 && 0 !== s27 ? o14 : null, depthTest: { func: p6(a26) }, depthWrite: c26 || b14 ? c9 : null, drawBuffers: g4(r28, d5(a26, r28)), colorWrite: d4, stencilWrite: l25 ? f8 : null, stencilTest: l25 ? c10 : null, polygonOffset: c26 || b14 ? null : b6 });
  }
};
function x8(e33) {
  const r28 = Q().vec3f("position").vec4f16("profileVertexAndNormal").vec2i16("profileRight", { glNormalized: true }).vec2i16("profileUp", { glNormalized: true });
  return e33.hasVVSize && r28.f32("sizeFeatureAttribute"), e33.hasVVColor && r28.f32("colorFeatureAttribute"), e33.hasVVOpacity && r28.f32("opacityFeatureAttribute"), e21() && r28.vec4u8("olidColor"), r28.vec3f16("profileAuxData"), r28.freeze();
}

// node_modules/@arcgis/core/views/3d/webgl-engine/materials/PathTechniqueConfiguration.js
var i20 = class extends e20 {
  constructor(e33) {
    super(), this.spherical = e33, this.pbrMode = 0, this.doubleSidedMode = 0, this.emissionSource = 0, this.receiveShadows = false, this.receiveAmbientOcclusion = false, this.hasVVSize = false, this.hasVVColor = false, this.hasVVOpacity = false, this.transparent = false, this.hasOccludees = false, this.terrainDepthTest = false, this.cullAboveTerrain = false, this.snowCover = false, this.textureCoordinateType = 0, this.occlusionPass = false, this.hasVVInstancing = false, this.useCustomDTRExponentForWater = false, this.useFillLights = false, this.hasColorTexture = false, this.hasMetallicRoughnessTexture = false, this.hasOcclusionTexture = false, this.hasNormalTexture = false, this.draped = false, this.overlayEnabled = false;
  }
  get discardInvisibleFragments() {
    return this.transparent;
  }
};
__decorate([i13({ count: 7 })], i20.prototype, "pbrMode", void 0), __decorate([i13({ count: 3 })], i20.prototype, "doubleSidedMode", void 0), __decorate([i13({ count: 8 })], i20.prototype, "emissionSource", void 0), __decorate([i13()], i20.prototype, "receiveShadows", void 0), __decorate([i13()], i20.prototype, "receiveAmbientOcclusion", void 0), __decorate([i13()], i20.prototype, "hasVVSize", void 0), __decorate([i13()], i20.prototype, "hasVVColor", void 0), __decorate([i13()], i20.prototype, "hasVVOpacity", void 0), __decorate([i13()], i20.prototype, "transparent", void 0), __decorate([i13()], i20.prototype, "hasOccludees", void 0), __decorate([i13()], i20.prototype, "terrainDepthTest", void 0), __decorate([i13()], i20.prototype, "cullAboveTerrain", void 0), __decorate([i13()], i20.prototype, "snowCover", void 0);

// node_modules/@arcgis/core/views/3d/webgl-engine/materials/PathMaterial.js
var _10 = class extends s13 {
  constructor(t30, e33) {
    super(t30, w9), this.supportsEdges = true, this._pp0 = r3(0, 0, 1), this._pp1 = r3(0, 0, 0), this.produces = /* @__PURE__ */ new Map([[2, (t31) => (this.parameters.castShadows && n14(t31) || r12(t31)) && !this.transparent], [4, (t31) => (this.parameters.castShadows && n14(t31) || r12(t31)) && this.transparent]]), this._configuration = new i20(e33.spherical);
  }
  get hasEmissions() {
    return this.parameters.emissiveStrength > 0;
  }
  getConfiguration(t30, e33) {
    return super.getConfiguration(t30, e33, this._configuration), this._configuration.hasVVSize = this.parameters.hasVVSize, this._configuration.hasVVColor = this.parameters.hasVVColor, this._configuration.hasVVOpacity = this.parameters.hasVVOpacity, this._configuration.hasSlicePlane = this.parameters.hasSlicePlane, this._configuration.transparent = this.transparent, this._configuration.hasOccludees = e33.hasOccludees, o13(t30) ? (this._configuration.doubleSidedMode = this.parameters.doubleSided && "normal" === this.parameters.doubleSidedType ? 1 : this.parameters.doubleSided && "winding-order" === this.parameters.doubleSidedType ? 2 : 0, this._configuration.receiveShadows = e33.shadowMap.enabled, this._configuration.receiveAmbientOcclusion = null != e33.ssao) : this._configuration.receiveShadows = this._configuration.receiveAmbientOcclusion = false, this._configuration.pbrMode = this.parameters.usePBR ? 2 : 0, this._configuration.emissionSource = this.parameters.usePBR ? 1 : 0, this._configuration.oitPass = e33.oitPass, this._configuration.terrainDepthTest = e33.terrainDepthTest, this._configuration.cullAboveTerrain = e33.cullAboveTerrain, this._configuration.snowCover = e33.snowCover > 0, this._configuration;
  }
  isVisibleForOutput(t30) {
    return 4 !== t30 && 6 !== t30 && 5 !== t30 || this.parameters.castShadows;
  }
  get visible() {
    return this.parameters.opacity >= o17;
  }
  intersect(t30, e33, i24, s27, r28, a26) {
    this._intersect(t30, i24, s27, r28, a26);
  }
  intersectDraped(t30, e33, i24, s27) {
    return this._pp0[0] = this._pp1[0] = i24[0], this._pp0[1] = this._pp1[1] = i24[1], this._intersect(t30, e33, this._pp0, this._pp1, s27);
  }
  _intersect(i24, r28, a26, o25, n24) {
    const h19 = i24;
    if (!r22(h19)) return;
    const m21 = h19.path, l25 = t6(this.parameters.size);
    if (this.parameters.vvSize) {
      const { offset: e33, factor: i25, minSize: s27, maxSize: r29, fallback: a27 } = this.parameters.vvSize, o26 = m21.sizeAttributeValue;
      Number.isNaN(o26) ? (l25[0] *= a27[0], l25[1] *= a27[2]) : (l25[0] *= r2(e33[0] + o26 * i25[0], s27[0], r29[0]), l25[1] *= r2(e33[2] + o26 * i25[2], s27[2], r29[2]));
    }
    const f19 = new a16(r28.tolerance, false, r28.options.normalRequired), d16 = Math.max(l25[0], l25[1]), b14 = i24.boundingInfo;
    if (null == b14) return void v7(m21, l25, a26, o25, f19, n24);
    const g13 = a5(b14.bbMin[0] - d16, b14.bbMin[1] - d16, b14.bbMin[2] - d16, b14.bbMax[0] + d16, b14.bbMax[1] + d16, b14.bbMax[2] + d16), _13 = [o25[0] - a26[0], o25[1] - a26[1], o25[2] - a26[2]], S10 = Math.sqrt(_13[0] * _13[0] + _13[1] * _13[1] + _13[2] * _13[2]), w11 = [S10 / _13[0], S10 / _13[1], S10 / _13[2]];
    U3(g13, a26, w11, r28.tolerance) && v7(m21, l25, a26, o25, f19, n24);
  }
  createBufferWriter() {
    return new s14(x8(this.parameters));
  }
  createGLMaterial(t30) {
    return new S7(t30);
  }
  get transparent() {
    const { parameters: t30 } = this;
    return t30.drivenOpacity || t30.opacity < 1;
  }
};
var S7 = class extends t15 {
  beginSlot(t30) {
    return this.getTechnique(V4, t30);
  }
};
function v7(t30, e33, i24, s27, r28, a26) {
  t30.baked.size && t30.baked.size[0] === e33[0] && t30.baked.size[1] === e33[1] || t30.baked.bake(e33), t30.baked.intersect(i24, s27, r28, a26);
}
var w9 = class extends P9 {
  constructor() {
    super(...arguments), this.doubleSided = false, this.doubleSidedType = "normal", this.castShadows = true, this.hasSlicePlane = false, this.drivenOpacity = false, this.usePBR = false;
  }
};

// node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DPathSymbolLayer.js
var Y5 = ["polyline"];
var $3 = class extends m13 {
  constructor(e33, t30, r28, i24) {
    super(e33, t30, r28, i24, se(t30)), this._intrinsicSize = r8(1, 1), this._upVectorAlignment = 1, this._stencilWidth = 0.1, this.ensureDrapedStatus(false);
  }
  async doLoad() {
    const e33 = this.symbolLayer, r28 = null != e33.width ? e33.width : e33.height, i24 = null != e33.height ? e33.height : r28;
    this._vvConvertOptions = new G3({ supports: { size: true, color: true, rotation: false, opacity: true }, modelSize: [1, 1, 1], symbolSize: [r28, 1, i24], unitInMeters: this._context.renderCoordsHelper.unitInMeters, fallbackColor: this._getFallbackOpacityAndColor(O3), fallbackSize: [r28, 1, i24] });
    const s27 = this._context.renderer?.visualVariables;
    this._fastUpdates = s27?.length ? K3(this._context.renderer, this._vvConvertOptions) : null;
    const n24 = e33.anchor || "center";
    this._upVectorAlignment = "heading" === e33.profileRotation ? 0 : 1;
    const h19 = e33.profile || "circle";
    switch (h19) {
      default:
      case "circle":
        this._profile = d11[n24];
        break;
      case "quad":
        this._profile = a23[n24];
    }
    switch (e33.join) {
      case "round":
        this._extruder = new a22(0, o19);
        break;
      case "bevel":
        this._extruder = new a22(0, 1);
        break;
      case "miter":
        this._extruder = new a22(0.8 * Math.PI, 1);
        break;
      default:
        this._extruder = new c20();
    }
    switch (this._cap) {
      case "none":
        this._startCap = new l18(), this._endCap = new l18();
        break;
      case "butt":
      default:
        this._startCap = new f15(this._profile, 0), this._endCap = new f15(this._profile, 0, true);
        break;
      case "square":
        this._startCap = new f15(this._profile, -0.5), this._endCap = new f15(this._profile, 0.5, true);
        break;
      case "round": {
        const e34 = "quad" === h19;
        this._startCap = new h14({ profile: this._profile, flip: false, breakNormals: e34, subdivisions: t22 }), this._endCap = new h14({ profile: this._profile, flip: true, breakNormals: e34, subdivisions: t22 });
        break;
      }
    }
    const c26 = this._materialColor, m21 = this._getCombinedOpacityAndColor(c26), f19 = u4(m21), d16 = m21[3], u30 = this.needsDrivenTransparentPass, g13 = e33.material?.emissive, _13 = { diffuse: f19, ambient: f19, emissiveStrength: g13?.strength ?? 0, emissiveSource: 1, opacity: d16, drivenOpacity: u30, hasVertexColors: false, hasSlicePlane: this._context.slicePlaneEnabled, castShadows: this.symbolLayer.castShadows, offsetTransparentBackfaces: true };
    if (!this._drivenProperties.size && (o2(this._intrinsicSize, r28, i24), !k5(this._intrinsicSize[0]) || !k5(this._intrinsicSize[1]))) throw new s("graphics3dpathsymbollayer:invalid-size", "Symbol sizes may not be negative values");
    let b14;
    this._fastUpdates?.visualVariables.size || l3(this._intrinsicSize, this._intrinsicSize, 1 / this._context.renderCoordsHelper.unitInMeters), this._fastUpdates ? b14 = new _10({ ..._13, ...this._fastUpdates.materialParameters, size: o8(this._intrinsicSize) }, this._context) : (_13.hasVertexColors = this._drivenProperties.color || this._drivenProperties.opacity, _13.normalType = 1, b14 = new P5(_13, this._context)), b14.setParameters({ usePBR: this._context.physicalBasedRenderingEnabled, isSchematic: true }), this._materials[0] = b14, this._updateTransparentDepedentMaterialParameters();
  }
  createGraphics3DGraphic(e33) {
    const t30 = e33.graphic;
    if (!this._validateGeometry(t30.geometry, Y5, this.symbolLayer.type)) return null;
    const r28 = this.createElevationContextForGraphic(t30);
    return this._createAs3DShape(e33, r28);
  }
  layerOpacityChanged() {
    const e33 = this._materialColor, t30 = this._getCombinedOpacity(e33), r28 = this._materials[0];
    r28 && (r28.setParameters({ opacity: t30 }), this._updateTransparentDepedentMaterialParameters());
  }
  layerScreenSizePerspectiveChanged() {
  }
  layerElevationInfoChanged(e33, t30) {
    return this.updateGraphics3DGraphicElevationInfo(e33, t30, m11);
  }
  slicePlaneEnabledChanged() {
    return this._materials[0]?.setParameters({ hasSlicePlane: this._context.slicePlaneEnabled }), true;
  }
  physicalBasedRenderingChanged() {
    return this._materials[0]?.setParameters({ usePBR: this._context.physicalBasedRenderingEnabled, isSchematic: true }), true;
  }
  applyRendererDiff(e33, t30) {
    for (const r28 in e33.diff) {
      if ("visualVariables" !== r28) return 0;
      if (!Q2(this._fastUpdates, t30, this._vvConvertOptions)) return 0;
      this._materials[0]?.setParameters(this._fastUpdates.materialParameters);
    }
    return 2;
  }
  _getVertexData(e33) {
    let t30 = 0;
    const r28 = e33.paths, i24 = [], s27 = e33.spatialReference, a26 = this._context.elevationProvider.spatialReference, o25 = this._context.renderCoordsHelper.spatialReference;
    for (const c26 of r28) t30 += c26.length;
    const n24 = e11(3 * t30);
    let l25, h19 = 0;
    for (const c26 of r28) {
      i24.push({ offset: h19, numVertices: c26.length });
      for (const t31 of c26) n24[h19++] = t31[0], n24[h19++] = t31[1], n24[h19++] = e33.hasZ ? t31[2] : 0;
    }
    return null == a26 || s27.equals(a26) || o5(n24, s27, 0, n24, a26, 0, t30) ? (null == a26 || a26.equals(o25) ? l25 = o3(n24) : (l25 = e11(3 * t30), o5(n24, a26, 0, l25, o25, 0, t30)), { pathVertexDataInfos: i24, vertexDataES: n24, vertexDataRS: l25 }) : null;
  }
  _createAs3DShape(e33, t30) {
    const { graphic: a26, renderingInfo: o25 } = e33, n24 = a26.geometry, l25 = this._getVertexData(n24);
    if (null == l25) return this.logger.warn("PathSymbol3DLayer geometry failed to be created (failed to project geometry to view spatial reference)"), null;
    if (0 === l25.pathVertexDataInfos.length) return 0 !== n24.paths.length && n24.paths.some((e34) => e34.length > 0) || this.logger.warn("PathSymbol3DLayer geometry failed to be created (no paths were defined)"), null;
    const p14 = new Array(), m21 = n24.spatialReference, f19 = u7(), _13 = this._context.renderCoordsHelper, b14 = new r16(l25.vertexDataES), x12 = a26.uid, S10 = n8(l25.vertexDataRS.length);
    for (const d16 of l25.pathVertexDataInfos) {
      const e34 = d16.numVertices;
      if (e34 < 2) continue;
      const n25 = d16.offset;
      if (null != this._context.clippingExtent && (o4(l25.vertexDataES, n25, e34, f19), !A(f19, this._context.clippingExtent))) continue;
      const y9 = new Array(), v12 = n25 + 3 * e34;
      for (let r28 = n25; r28 < v12; r28 += 3) {
        b14.offset = r28;
        const e35 = u17(b14, this._context.elevationProvider, t30, _13);
        o7(ae3, l25.vertexDataRS[r28], l25.vertexDataRS[r28 + 1], l25.vertexDataRS[r28 + 2]), _13.setAltitude(ae3, e35), l25.vertexDataRS[r28] = ae3[0], l25.vertexDataRS[r28 + 1] = ae3[1], l25.vertexDataRS[r28 + 2] = ae3[2], y9.push(j11(this._upVectorAlignment));
      }
      const C7 = new h12(y9, l25.vertexDataES, l25.vertexDataRS, n25, S10);
      ee(C7, this._upVectorAlignment, this._context.renderCoordsHelper);
      const P12 = new h13(C7, this._profile, this._extruder, this._startCap, this._endCap);
      let D7 = null;
      if (this._fastUpdates) {
        const e35 = this._fastUpdates.visualVariables, t31 = ot2(e35.size?.field, a26), r28 = ot2(e35.color?.field, a26), i24 = ot2(e35.opacity?.field, a26);
        D7 = new j9(P12, t31, r28, i24);
      } else {
        const e35 = t6(this._intrinsicSize);
        if (this._drivenProperties.size) {
          const t32 = o25.size ?? ["symbol-value", "symbol-value", "symbol-value"];
          e35[0] *= te(t32[0], "symbol-value" === t32[2] ? this.symbolLayer.height || 0 : t32[2], this.symbolLayer.width || 0), e35[1] *= te(t32[2], "symbol-value" === t32[0] ? this.symbolLayer.width || 0 : t32[0], this.symbolLayer.height || 0);
        }
        const t31 = new y4(P12);
        t31.bake(e35);
        const r28 = this._getDrivenColor(o25);
        r28 && t31.bakeVertexColors(r28), D7 = t31;
      }
      const j15 = D7.createGeometryData(), V8 = this._context.stage.renderView.getObjectAndLayerIdColor({ graphicUid: x12, layerViewUid: this._context.layerViewUid }), U9 = new e29(this._materials[0], j15, D7, m21, this._stencilWidth, V8);
      U9.transformation = i4(e10(), r5, P12.path.origin), p14.push(U9);
    }
    if (0 === p14.length) return null;
    const P11 = new W({ geometries: p14, layerViewUid: this._context.layerViewUid, graphicUid: x12 }), D6 = new O2(this, P11, null, (e34, t31, r28, i24, s27) => ie2(e34, t31, i24, s27, this._upVectorAlignment), t30, null);
    return D6.alignedSampledElevation = 0, D6.needsElevationUpdates = m11(t30.mode), D6;
  }
  _getDrivenColor(e33) {
    return this._hasDrivenColorOrOpacity ? this._getDrivenUInt8ColorWithNaNSupport(e33, this._materialColor, false) : null;
  }
  get _materialColor() {
    return this.symbolLayer.material?.color;
  }
  _getFallbackOpacityAndColor(t30) {
    return u10.toUnitRGBA(this._materialColor) ?? t30;
  }
  get _cap() {
    return this.symbolLayer.cap || "butt";
  }
  _updateTransparentDepedentMaterialParameters() {
    const e33 = this._materials[0];
    e33 && e33.setParameters({ cullFace: e33.transparent || "none" === this._cap ? 0 : 2 });
  }
};
function ee(e33, t30, r28) {
  const { origin: i24, positions: s27 } = e33;
  let a26 = e33.offset;
  switch (t30) {
    default:
    case 0:
      for (const t31 of e33.vertices) ae3[0] = s27[a26++] + i24[0], ae3[1] = s27[a26++] + i24[1], ae3[2] = s27[a26++] + i24[2], r28.worldUpAtPosition(ae3, ae3), t31.setFrameFromUpVector(ae3);
      break;
    case 1:
      ae3[0] = s27[a26] + i24[0], ae3[1] = s27[a26 + 1] + i24[1], ae3[2] = s27[a26 + 2] + i24[2], r28.worldUpAtPosition(ae3, ae3), l20(e33, ae3);
  }
}
function te(e33, t30, r28) {
  switch (e33) {
    case "symbol-value":
      return r28;
    case "proportional":
      return t30;
    default:
      return e33;
  }
}
function re(e33, t30, r28, i24) {
  let s27 = 0;
  const { origin: a26, vertices: o25, positions: n24, positionsES: l25 } = e33, h19 = e33.offset + 3 * o25.length;
  for (let p14 = e33.offset; p14 < h19; p14 += 3) o7(ae3, l25[p14], l25[p14 + 1], l25[p14 + 2]), r28(ae3, oe), s27 += oe.sampledElevation, ae3[0] = n24[p14] + a26[0], ae3[1] = n24[p14 + 1] + a26[1], ae3[2] = n24[p14 + 2] + a26[2], i24.setAltitude(ae3, oe.z), n24[p14] = ae3[0] - a26[0], n24[p14 + 1] = ae3[1] - a26[1], n24[p14 + 2] = ae3[2] - a26[2];
  return e33.updatePathVertexInformation(), s27 / o25.length;
}
function ie2(e33, t30, r28, i24, s27) {
  const a26 = e33.stageObject, o25 = a26.geometries;
  let n24 = 0;
  for (const l25 of o25) {
    if (!r22(l25)) continue;
    const e34 = l25.path, o26 = e34.builder.path;
    n24 += re(o26, t30, r28, i24), 0 !== s27 && ee(o26, s27, i24), e34.onPathChanged(l25), l25.invalidateBoundingInfo(), a26.geometryVertexAttributeUpdated(l25, "position");
  }
  return n24 / o25.length;
}
function se(e33) {
  return 1 === (e33.material?.color?.a ?? 0);
}
var ae3 = n2();
var oe = new x4();

// node_modules/@arcgis/core/views/3d/layers/support/uvUtils.js
function j12(t30, r28, e33, s27, a26 = 1) {
  if (e33.isGeographic && 1 === s27) {
    const t31 = e11(r28.length), o25 = r28.length, s28 = E(e33);
    for (let e34 = 0; e34 < o25; e34 += 3) g(r28, e34, t31, e34, s28);
    r28 = t31;
  }
  o2(_11, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY);
  for (let o25 = 0; o25 < r28.length; o25 += 3) _11[0] = Math.min(_11[0], r28[o25]), _11[1] = Math.min(_11[1], r28[o25 + 1]);
  const i24 = _11[0] % a26, n24 = _11[1] % a26, m21 = _11[0] - i24, c26 = _11[1] - n24;
  for (let o25 = 0; o25 < r28.length; o25 += 3) {
    const e34 = o25 / 3 * 4;
    t30[e34] = (r28[o25] - m21) / a26, t30[e34 + 1] = (r28[o25 + 1] - c26) / a26, t30[e34 + 2] = m21 / a26, t30[e34 + 3] = c26 / a26;
  }
}
function T6(t30, r28, m21, c26, l25 = 1) {
  o7(F8, 1, 0, 0), o7(V5, 0, 1, 0), o7(Y6, 0, 0, 1), D5(M6, m21), z2(E7, m21) && O5(E7, F8, V5, Y6, c26, M6), o2(_11, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY), o2(y7, Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY);
  for (let o25 = 0; o25 < m21.length; o25 += 3) {
    o7(x9, m21[o25], m21[o25 + 1], m21[o25 + 2]);
    const t31 = P3(F8, x9), r29 = P3(V5, x9);
    _11[0] = Math.min(_11[0], t31), _11[1] = Math.min(_11[1], r29), y7[0] = Math.max(y7[0], t31), y7[1] = Math.max(y7[1], r29);
  }
  const f19 = P3(Y6, M6);
  q7(P10, _11[0], _11[1], f19, F8, V5, Y6), q7(v8, y7[0], _11[1], f19, F8, V5, Y6), q7(A8, _11[0], y7[1], f19, F8, V5, Y6), c2(v8, v8, P10), g2(v8, v8, 0.5), c2(A8, A8, P10), g2(A8, A8, 0.5), u8(P10, P10, v8), u8(P10, P10, A8);
  const I9 = _11[0] % l25, h19 = _11[1] % l25, N4 = _11[0] - I9, p14 = _11[1] - h19;
  for (let o25 = 0; o25 < m21.length; o25 += 3) {
    o7(x9, m21[o25], m21[o25 + 1], m21[o25 + 2]);
    const a26 = o25 / 3, i24 = 4 * a26;
    t30[i24] = (P3(F8, x9) - N4) / l25, t30[i24 + 1] = (P3(V5, x9) - p14) / l25, t30[i24 + 2] = N4 / l25, t30[i24 + 3] = p14 / l25;
    const n24 = 9 * a26;
    for (let t31 = 0; t31 < 3; t31++) r28[n24 + t31] = P10[t31], r28[n24 + t31 + 3] = v8[t31], r28[n24 + t31 + 6] = A8[t31];
  }
}
var M6 = n2();
var x9 = n2();
var E7 = j5();
var F8 = n2();
var V5 = n2();
var Y6 = n2();
var _11 = n6();
var y7 = n6();
var P10 = n2();
var v8 = n2();
var A8 = n2();
function O5(t30, o25, r28, a26, n24, I9) {
  null != n24 ? (n24.basisMatrixAtPosition(I9, S8), o7(G6, S8[0], S8[1], S8[2]), o7(d14, S8[4], S8[5], S8[6]), o7(k10, S8[8], S8[9], S8[10])) : (o7(G6, 1, 0, 0), o7(d14, 0, 1, 0), o7(k10, 0, 0, 1));
  const h19 = k3(t30);
  P3(h19, k10) < 0 && g2(h19, h19, -1), s7(a26, h19);
  const N4 = P3(h19, d14), p14 = P3(h19, G6);
  Math.abs(N4) > Math.abs(p14) ? (q4(o25, G6, h19, -p14), A2(o25, o25), _3(r28, o25, h19), A2(r28, r28), g2(r28, r28, -1)) : (q4(r28, d14, h19, -N4), A2(r28, r28), _3(o25, r28, h19), A2(o25, o25));
}
var S8 = e10();
var G6 = n2();
var d14 = n2();
var k10 = n2();
function D5(t30, o25) {
  o7(U7, 0, 0, 0);
  for (let r28 = 0; r28 < o25.length - 3; r28 += 3) U7[0] += o25[r28], U7[1] += o25[r28 + 1], U7[2] += o25[r28 + 2];
  g2(t30, U7, 1 / (o25.length / 3 - 1));
}
var U7 = n2();
function q7(t30, o25, r28, s27, a26, i24, n24) {
  o7(t30, o25 * a26[0] + r28 * i24[0] + s27 * n24[0], o25 * a26[1] + r28 * i24[1] + s27 * n24[1], o25 * a26[2] + r28 * i24[2] + s27 * n24[2]);
}

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/PatternTechnique.js
var S9 = class extends m10 {
  constructor(e33, t30) {
    super(e33, t30, new t16(x5, () => import("./Pattern.glsl-QYCBYELS.js")), b12(t30).locations);
  }
  _setPipelineState(e33, r28) {
    const { oitPass: i24, output: l25, cullFace: m21, draped: S10, hasOccludees: b14, polygonOffset: v12 } = e33, y9 = 0 === i24;
    return T3({ blending: o13(l25) ? a15(i24) : null, culling: _5(m21), depthTest: S10 ? null : { func: p6(i24) }, depthWrite: i14(e33), drawBuffers: g4(l25, d5(i24, l25)), colorWrite: d4, stencilWrite: b14 ? f8 : null, stencilTest: b14 ? r28 ? t17 : c10 : null, polygonOffset: y9 ? v12 ? j13 : null : m9(e33) });
  }
  initializePipeline(e33) {
    return this._occludeePipelineState = this._setPipelineState(e33, true), this._setPipelineState(e33, false);
  }
  getPipeline(e33) {
    return e33 ? this._occludeePipelineState : super.getPipeline();
  }
};
var j13 = { factor: 1, units: 1 };
function b12(t30) {
  const r28 = Q().vec3f("position").vec4f("uvMapSpace");
  return t30.draped || r28.mat3f("boundingRect"), t30.hasVVColor ? r28.f32("colorFeatureAttribute") : r28.vec4u8("color"), e21() && r28.vec4u8("olidColor"), r28.freeze();
}

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/PatternTechniqueConfiguration.js
var s23 = class extends e20 {
  constructor() {
    super(...arguments), this.cullFace = 0, this.style = 0, this.hasVertexColors = false, this.polygonOffset = false, this.hasOccludees = false, this.enableOffset = true, this.terrainDepthTest = false, this.cullAboveTerrain = false, this.hasVVColor = false, this.draped = false, this.textureCoordinateType = 0, this.emissionSource = 0, this.discardInvisibleFragments = true, this.writeDepth = true, this.occlusionPass = false, this.hasVVInstancing = false, this.hasVVSize = false, this.hasVVOpacity = false, this.overlayEnabled = false, this.snowCover = false;
  }
};
__decorate([i13({ count: 3 })], s23.prototype, "cullFace", void 0), __decorate([i13({ count: 6 })], s23.prototype, "style", void 0), __decorate([i13()], s23.prototype, "hasVertexColors", void 0), __decorate([i13()], s23.prototype, "polygonOffset", void 0), __decorate([i13()], s23.prototype, "hasOccludees", void 0), __decorate([i13()], s23.prototype, "enableOffset", void 0), __decorate([i13()], s23.prototype, "terrainDepthTest", void 0), __decorate([i13()], s23.prototype, "cullAboveTerrain", void 0), __decorate([i13()], s23.prototype, "hasVVColor", void 0), __decorate([i13()], s23.prototype, "draped", void 0);

// node_modules/@arcgis/core/views/3d/webgl-engine/materials/PatternMaterial.js
var _12 = class extends i16 {
  constructor(e33) {
    super(e33, x10), this._configuration = new s23(), this.supportsEdges = true, this.produces = /* @__PURE__ */ new Map([[2, (e34) => t14(e34)], [4, (e34) => o13(e34)], [5, (e34) => b5(e34)], [18, (e34) => this.parameters.draped && x2(e34)]]);
  }
  getConfiguration(e33, t30) {
    return super.getConfiguration(e33, t30, this._configuration), this._configuration.cullFace = this.parameters.cullFace, this._configuration.hasVertexColors = this.parameters.hasVertexColors && !this.parameters.vvColor, this._configuration.hasSlicePlane = this.parameters.hasSlicePlane, this._configuration.polygonOffset = this.parameters.polygonOffset, this._configuration.style = this.parameters.style, this._configuration.draped = this.parameters.draped, this._configuration.oitPass = t30.oitPass, this._configuration.enableOffset = t30.camera.relativeElevation < l11, this._configuration.terrainDepthTest = t30.terrainDepthTest && o13(e33), this._configuration.cullAboveTerrain = t30.cullAboveTerrain, this._configuration.hasVVColor = !!this.parameters.vvColor, this._configuration;
  }
  get visible() {
    return this.parameters.color[3] >= o17;
  }
  createGLMaterial(e33) {
    return new j14(e33);
  }
  createBufferWriter() {
    return new v9(b12(this.parameters));
  }
};
var j14 = class extends t15 {
  beginSlot(e33) {
    return this.getTechnique(S9, e33);
  }
};
var v9 = class extends s14 {
  write(e33, s27, i24, o25, a26, n24) {
    const c26 = j6(i24, o25, this.layout, e33, s27, a26, n24);
    for (const l25 of this.layout.fields.keys()) {
      const s28 = i24.get(l25), o26 = s28?.indices;
      if (s28 && o26) switch (l25) {
        case "uvMapSpace": {
          s9(4 === s28.size);
          const e34 = a26.getField(l25, T2);
          e34 && h7(s28, e34, n24);
          break;
        }
        case "boundingRect": {
          s9(9 === s28.size);
          const r28 = a26.getField(l25, d2);
          r28 && C6(s28, e33, r28, n24);
          break;
        }
      }
    }
    return c26;
  }
};
function C6(e33, t30, r28, s27) {
  const { data: i24, indices: o25 } = e33, a26 = t30, n24 = r28.typedBuffer, c26 = r28.typedBufferStride, f19 = o25.length;
  s27 *= c26;
  for (let l25 = 0; l25 < f19; ++l25) {
    const e34 = 9 * o25[l25], t31 = i24[e34], r29 = i24[e34 + 1], f20 = i24[e34 + 2];
    n24[s27] = a26[0] * t31 + a26[4] * r29 + a26[8] * f20 + a26[12], n24[s27 + 1] = a26[1] * t31 + a26[5] * r29 + a26[9] * f20 + a26[13], n24[s27 + 2] = a26[2] * t31 + a26[6] * r29 + a26[10] * f20 + a26[14];
    for (let o26 = 3; o26 < 9; ++o26) n24[s27 + o26] = i24[e34 + o26];
    s27 += c26;
  }
}
var x10 = class extends t19 {
  constructor() {
    super(...arguments), this.color = r6(1, 1, 1, 1), this.hasVertexColors = false, this.polygonOffset = false, this.hasSlicePlane = false, this.cullFace = 0, this.hasOccludees = false, this.style = 2, this.draped = true;
  }
};

// node_modules/@arcgis/core/views/3d/layers/support/patternUtils.js
function o23(e33, r28) {
  const o25 = e33?.pattern;
  return null == o25 ? new m12(r28) : "none" === o25.style || "solid" === o25.style ? ("none" === o25.style && (r28.color = r6(0, 0, 0, 0), r28.forceTransparentMode = true), new m12(r28)) : (r28.style = i21(o25.style), new _12(r28));
}
function i21(t30) {
  switch (t30) {
    case "horizontal":
      return 0;
    case "vertical":
      return 1;
    case "cross":
      return 2;
    case "forward-diagonal":
      return 3;
    case "backward-diagonal":
      return 4;
    case "diagonal-cross":
      return 5;
    default:
      return;
  }
}
function s24(t30) {
  return t30.material instanceof _12 && !t30.material.parameters.draped;
}
function c23(t30, e33) {
  if (s24(t30)) {
    const a26 = t30.attributes.get("position").data, n24 = t30.getMutableAttribute("uvMapSpace").data, o25 = t30.getMutableAttribute("boundingRect").data;
    T6(n24, o25, a26, e33);
  }
}
function l22(t30, r28, a26, n24, o25) {
  const i24 = f11(t30, r28, a26, n24, o25), s27 = t30.stageObject.geometries;
  for (const e33 of s27) c23(e33, o25);
  return i24;
}

// node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DPolygonFillSymbolLayer.js
var T7 = ["polyline", "polygon", "extent"];
var _H = class _H extends m13 {
  constructor(e33, t30, i24, r28) {
    super(e33, t30, i24, r28, K6(t30)), this._needsUV = false, this._materials = [];
  }
  async doLoad() {
    this._fastUpdates = K3(this._context.renderer, this._vvConvertOptions);
  }
  get _materialColor() {
    return this.symbolLayer.material?.color;
  }
  _createMaterials() {
    if (this._materials.length > 0) return;
    const e33 = this._materialColor, i24 = this._getCombinedOpacityAndColor(e33);
    this._materials[0] = o23(this.symbolLayer, { color: i24, forceTransparentMode: this.needsDrivenTransparentPass, discardInvisibleFragments: true, polygonOffset: false, hasVertexColors: true, draped: this.draped, hasSlicePlane: this._context.slicePlaneEnabled, ...this._fastUpdates?.materialParameters }), this._needsUV = this._materials[0] instanceof _12;
    const r28 = this.symbolLayer.outline;
    if (J6(r28)) {
      const e34 = n19(r28.pattern);
      this._materials[1] = new J3({ width: u3(r28.size), color: this._getOutlineColor(), hasPolygonOffset: true, hasSlicePlane: this._context.slicePlaneEnabled, isClosed: true, stipplePattern: e34, cap: r20(r28.patternCap || "butt"), screenSizePerspective: this._outlineScreenSizePerspective }, this.view.state.isGlobal);
    }
  }
  get _outlineScreenSizePerspective() {
    return !this.draped && n15(this._context.layer.screenSizePerspectiveEnabled) ? this.view.screenSizePerspective.parameters : null;
  }
  createGraphics3DGraphic(e33) {
    const t30 = e33.graphic;
    if (!this._validateGeometry(t30.geometry, T7, this.symbolLayer.type)) return null;
    const i24 = this._getDrivenUInt8Color(e33.renderingInfo, this._materialColor, false), r28 = this.createElevationContextForGraphic(t30);
    return this.ensureDrapedStatus("on-the-ground" === r28.mode), this._createMaterials(), this.draped ? this._createAsOverlay(t30, i24) : this._createAs3DShape(t30, i24, r28);
  }
  applyRendererDiff(e33, t30) {
    for (const i24 in e33.diff) {
      if ("visualVariables" !== i24) return 0;
      if (!Q2(this._fastUpdates, t30, this._vvConvertOptions)) return 0;
      this._materials[0]?.setParameters(this._fastUpdates.materialParameters);
    }
    return 2;
  }
  layerOpacityChanged() {
    if (null != this._materials[0]) {
      const e33 = this._materials[0].parameters.color, t30 = this._materialColor, i24 = this._getCombinedOpacity(t30);
      this._materials[0].setParameters({ color: [e33[0], e33[1], e33[2], i24], forceTransparentMode: this.needsDrivenTransparentPass });
    }
    if (null != this._materials[1]) {
      const e33 = this._materials[1].parameters.color;
      this._materials[1].setParameters({ color: [e33[0], e33[1], e33[2], this._getOutlineOpacity()] });
    }
  }
  layerScreenSizePerspectiveChanged() {
    this._materials[1]?.setParameters({ screenSizePerspective: this._outlineScreenSizePerspective });
  }
  layerElevationInfoChanged(e33, t30, i24) {
    const r28 = this._elevationContext.mode, s27 = f10(_H.elevationModeChangeTypes, i24, r28);
    if (1 !== s27) return s27;
    const o25 = d7(r28);
    return this.updateGraphics3DGraphicElevationInfo(e33, t30, () => o25);
  }
  slicePlaneEnabledChanged() {
    if (this._materials[0]?.setParameters({ hasSlicePlane: this._context.slicePlaneEnabled }), this._materials[1]) {
      const e33 = { hasSlicePlane: this._context.slicePlaneEnabled };
      this._materials[1].setParameters(e33);
    }
    return true;
  }
  physicalBasedRenderingChanged() {
    return true;
  }
  _createAs3DShape(e33, t30, i24) {
    const r28 = l15(e33.geometry);
    if (!r28) return null;
    const s27 = r18(r28, this._context.elevationProvider, this._context.renderCoordsHelper, i24), o25 = new W5(s27, t30, this._context.layerViewUid, e33.uid), n24 = o25.renderData.position.length / 3;
    if (this._needsUV && (o25.uvMapSpace = n8(4 * n24, true), o25.boundingRect = e11(9 * n24), T6(o25.uvMapSpace, o25.boundingRect, o25.renderData.position, this._context.renderCoordsHelper)), o25.olidColor = this._context.stage.renderView?.getObjectAndLayerIdColor(o25), this._createAs3DShapeFill(e33, o25), this._materials[1] && this._createAs3DShapeOutline(o25), this._logGeometryCreationWarnings(o25.renderData, r28.rings, "rings", "FillSymbol3DLayer"), 0 === o25.outGeometries.length) return null;
    const a26 = new W({ geometries: o25.outGeometries, castShadow: false, layerViewUid: this._context.layerViewUid, graphicUid: e33.uid }), l25 = new O2(this, a26, null, l22, i24);
    return l25.alignedSampledElevation = o25.renderData.sampledElevation, l25.needsElevationUpdates = d7(i24.mode), l25;
  }
  _createAs3DShapeFill(e33, t30) {
    const i24 = t30.renderData.polygons;
    for (const { position: r28, mapPositions: o25, holeIndices: a26, index: l25, count: c26 } of i24) {
      if (null != this._context.clippingExtent && (m2(o25, k11), !A(k11, this._context.clippingExtent))) continue;
      const i25 = u22(o25, a26, this._context.elevationProvider.spatialReference);
      if (0 === i25.length) continue;
      const h19 = this._fastUpdates?.visualVariables.color, d16 = s19({ material: this._materials[0], indices: i25, mapPositions: o25, attributeData: { position: r28, color: h19 ? null : t30.color, colorFeature: h19 ? ot2(h19.field, e33) : null, uvMapSpace: this._needsUV ? e16(t30.uvMapSpace, 4 * l25, 4 * c26) : null, boundingRect: this._needsUV ? i5(t30.boundingRect, 9 * l25, 9 * c26) : null, olidColor: t30.olidColor } });
      t30.outGeometries.push(d16);
    }
  }
  _createAs3DShapeOutline(e33) {
    if (null == this._materials[1]) return;
    const t30 = e33.renderData.outlines;
    for (const { mapPositions: i24, position: r28 } of t30) {
      if (null != this._context.clippingExtent && (m2(i24, k11), !A(k11, this._context.clippingExtent))) continue;
      const t31 = f7(this._materials[1], { overlayInfo: null, removeDuplicateStartEnd: true, mapPositions: i24, attributeData: { position: r28 } }, e33.olidColor);
      e33.outGeometries.push(t31);
    }
  }
  _createAsOverlay(e33, t30) {
    const i24 = l15(e33.geometry);
    if (null == i24) return null;
    this._materials[0].renderPriority = this._renderPriority + this._renderPriorityStep / 2, null != this._materials[1] && (this._materials[1].renderPriority = this._renderPriority);
    const r28 = p10(i24, this._context.overlaySR), s27 = new q8(r28, t30, this._context.layerViewUid, e33.uid), o25 = s27.renderData.position.length / 3;
    return this._needsUV && (s27.uvMapSpace = n8(4 * o25, true), j12(s27.uvMapSpace, s27.renderData.position, this._context.overlaySR, this._context.graphicsCoreOwner.view.state.viewingMode)), s27.outBoundingBox = q3(), s27.olidColor = this._context.stage.renderView?.getObjectAndLayerIdColor(s27), this._createAsOverlayFill(e33, s27), this._materials[1] && this._createAsOverlayOutline(s27), this._logGeometryCreationWarnings(s27.renderData, i24.rings, "rings", "FillSymbol3DLayer"), 0 === s27.outGeometries.length ? null : new c18(this, s27.outGeometries, s27.outBoundingBox, this._context.drapeSourceRenderer);
  }
  _createAsOverlayFill(e33, t30) {
    const r28 = t30.renderData.polygons;
    for (const { position: o25, holeIndices: a26, index: c26, count: p14 } of r28) {
      const r29 = m2(o25, k11);
      if (!A(r29, this._context.clippingExtent)) continue;
      const h19 = e18(o25, a26, 3);
      if (0 === h19.length) continue;
      M(t30.outBoundingBox, r29);
      const d16 = this._fastUpdates?.visualVariables.color, m21 = s19({ material: this._materials[0], indices: h19, attributeData: { position: o25, color: d16 ? null : t30.color, colorFeature: d16 ? ot2(d16.field, e33) : null, uvMapSpace: this._needsUV ? e16(t30.uvMapSpace, 4 * c26, 4 * p14) : null, olidColor: t30.olidColor } });
      t30.outGeometries.push(new h8(m21, t30));
    }
  }
  _createAsOverlayOutline(e33) {
    if (null == this._materials[1]) return;
    const t30 = e33.renderData.outlines;
    for (let i24 = 0; i24 < t30.length; ++i24) {
      const { position: r28 } = t30[i24];
      if (m2(r28, k11), !A(k11, this._context.clippingExtent)) continue;
      M(e33.outBoundingBox, k11);
      const o25 = f7(this._materials[1], { overlayInfo: { spatialReference: this._context.overlaySR, renderCoordsHelper: this._context.renderCoordsHelper }, removeDuplicateStartEnd: true, attributeData: { position: r28 } }, e33.olidColor);
      e33.outGeometries.push(new h8(o25, e33));
    }
  }
  _getOutlineOpacity() {
    const e33 = this.symbolLayer?.outline?.color;
    return (this.draped ? 1 : this._getLayerOpacity()) * (null != e33 ? e33.a : 0);
  }
  _getOutlineColor() {
    const t30 = this.symbolLayer?.outline?.color, i24 = this._getOutlineOpacity();
    return A4(null != t30 ? u10.toUnitRGB(t30) : null, i24);
  }
  test() {
    return { ...super.test(), createAsOverlay: (e33, t30) => this._createAsOverlay(e33, t30), createAs3DShape: (e33, t30, i24) => this._createAs3DShape(e33, t30, i24) };
  }
  get _vvConvertOptions() {
    return new G3({ supports: { size: false, color: true, rotation: false, opacity: false }, fallbackColor: u10.toUnitRGBA(this._materialColor) ?? a7 });
  }
};
_H.elevationModeChangeTypes = { definedChanged: 2, staysOnTheGround: 0, onTheGroundChanged: 2 };
var H5 = _H;
var k11 = u7();
var W5 = class extends p9 {
  constructor(e33, t30, i24, r28) {
    super(e33, i24, r28), this.color = t30;
  }
};
var q8 = class extends p9 {
  constructor(e33, t30, i24, r28) {
    super(e33, i24, r28), this.color = t30;
  }
};
function J6(e33) {
  return null != e33?.size && e33.size > 0 && null != e33.color && (null == e33.pattern || "style" !== e33.pattern.type || "none" !== e33.pattern.style);
}
function K6(e33) {
  return 1 === (e33.material?.color?.a ?? 0);
}

// node_modules/@arcgis/core/views/3d/layers/graphics/LabelParameters.js
var i22 = class {
  constructor(i24, r28 = "center", c26 = false, a26 = n6(), o25 = r6(0, 0, 0, -1), l25 = "world", f19 = n2(), n24 = 0) {
    this.verticalOffset = i24, this.anchor = r28, this.hasLabelVerticalOffset = c26, this.screenOffset = a26, this.centerOffset = o25, this.centerOffsetUnits = l25, this.translation = f19, this.elevationOffset = n24;
  }
};
var r26 = class {
  constructor(e33, s27 = "center", i24 = "center", r28 = null, c26 = n6(), a26 = true) {
    this.placement = e33, this.horizontalPlacement = s27, this.verticalPlacement = i24, this.text = r28, this.displaySize = c26, this.isFocused = a26;
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/TextRenderParameters.js
var s25 = class _s {
  constructor(o25) {
    this.definition = o25, this.key = JSON.stringify(o25), this.haloSize = Math.round(o25.halo.size), this.textStyle = a25(o25.color), this.haloStyle = l23(o25.halo.color), this.backgroundStyle = 0 !== o25.background.color[3] ? a25(o25.background.color) : null;
  }
  fontString(o25) {
    const t30 = this.definition.font, e33 = "sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji";
    return `${t30.style} ${t30.weight} ${o25}px ${t30.family}, ${e33}`;
  }
  setFontProperties(o25, t30) {
    o25.font = this.fontString(t30), o25.textAlign = "left", o25.textBaseline = "alphabetic";
  }
  static async fromSymbol(l25, a26) {
    const f19 = l25?.material?.color, m21 = u10.toUnitRGBA(f19) ?? a7, g13 = null != l25.size ? u3(l25.size) : 12, u30 = l25.lineHeight, d16 = null != l25.background ? u10.toUnitRGBA(l25.background.color) : a7, h19 = { family: l25.font?.family ?? "sans-serif", decoration: l25.font?.decoration ?? "none", weight: l25.font?.weight ?? "normal", style: l25.font?.style ?? "normal" }, y9 = l25.halo, b14 = null != y9?.color && y9.size > 0 ? { size: u3(y9.size), color: u10.toUnitRGBA(y9.color) } : { size: 0, color: a7 }, p14 = new _s({ color: m21, size: g13, background: { color: d16, padding: null != l25.background ? [0.65 * g13, 0.5 * g13] : [0, 0], borderRadius: null != l25.background ? g13 * (6 / 16) : 0 }, lineSpacingFactor: u30, font: h19, halo: b14, pixelRatio: a26 });
    if (l25.font) {
      let o25 = false;
      const r28 = p14.fontString(g13);
      try {
        o25 = (await document.fonts.load(r28)).some((o26) => !i9(o26));
      } catch (S10) {
        i.getLogger("esri.views.3d.webgl-engine.lib.TextRenderParameters").warnOnce(`Failed to preload font '${r28}'. Some text symbology may be rendered using the default browser font.`);
      }
      if (!o25 && !c24.has(l25.font.family)) try {
        await c4(l25.font);
      } catch (S10) {
      }
    }
    return p14;
  }
};
function l23(o25) {
  return `rgb(${o25.slice(0, 3).map((o26) => Math.floor(255 * o26)).toString()})`;
}
function a25(o25) {
  return `rgba(${o25.slice(0, 3).map((o26) => Math.floor(255 * o26)).toString()},${o25[3]})`;
}
var c24 = /* @__PURE__ */ new Set(["Arial", "Times New Roman", "Courier New", "serif", "sans-serif", "monospace", "cursive", "fantasy", "system-ui", "ui-serif", "ui-sans-serif", "ui-monospace", "ui-rounded", "math", "emoji", "fangsong"]);

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/TextTextureAtlas.js
var x11 = 4096;
var v10 = class extends b {
  constructor(e33) {
    super(e33), this.id = e3(), this.events = new i2(), this._glTexture = null, this._atlas = new y8(256, 256), this._needsRepack = false, this._canRepack = true, this._elementsToRender = /* @__PURE__ */ new Map(), this._elements = /* @__PURE__ */ new Map(), this._uvCallbacks = /* @__PURE__ */ new Map(), this.updating = false;
  }
  initialize() {
    this._canvas = document.createElement("canvas"), this._canvas.setAttribute("id", "textAtlasCanvas"), this._canvas.setAttribute("style", "display:none"), this._ctx = this._canvas.getContext("2d"), this._stage = this.view.stage, this._stage.addTexture(this), this._updateCanvasElementSize(this._atlas), this._reset();
  }
  unload() {
    this._glTexture = r(this._glTexture), this._frameWorker = l2(this._frameWorker), this.updating = false, this.events.emit("unloaded");
  }
  get loaded() {
    return null != this._glTexture;
  }
  get glTexture() {
    return this._glTexture;
  }
  static get maxSize() {
    return b13 = n18.stableRendering ? T8 : 0, [x11 - T8 - b13, x11 - T8 - b13 - w10];
  }
  load(e33) {
    if (this._glTexture) return this._glTexture;
    const t30 = new h6();
    return t30.wrapMode = 33071, t30.samplingMode = 9987, t30.hasMipmap = true, t30.preMultiplyAlpha = true, t30.maxAnisotropy = e33.parameters.maxMaxAnisotropy, this._glTexture = new A5(e33, t30, this._canvas), this._frameWorker = this.view.resourceController.scheduler.registerTask(f4.TEXT_TEXTURE_ATLAS, this), this.setDirty(), this._glTexture;
  }
  dispose() {
    this._elements.clear(), this._elementsToRender.clear(), this._frameWorker = l2(this._frameWorker), this._glTexture && (this._stage.removeTexture(this), this._glTexture = r(this._glTexture)), this._canvas.width = 0, this._canvas.height = 0, this._canvas = null, this._ctx = null;
  }
  _updateCanvasElementSize(e33) {
    this._canvas.width = e33.width, this._canvas.height = e33.height;
  }
  _resizeAtlas(e33, t30) {
    const { width: s27, height: i24 } = this._atlas;
    s27 === e33 && i24 === t30 || (this._atlas.width = e33, this._atlas.height = t30, this._glTexture?.resize(e33, t30), this._glTexture?.updateData(0, 0, 0, s27, i24, this._canvas), this._updateCanvasElementSize(this._atlas), this._elements.forEach((e34) => this._uvCallbacks.get(e34.textRenderer.key)?.forEach((t31) => t31(e34.uv))), this._reset());
  }
  _reset() {
    this._elementsToRender.clear(), this._atlas.reset(), this._needsRepack = true, this.setDirty();
  }
  _addAtlasElement(e33, t30, s27, i24) {
    const r28 = this._atlas;
    if (r28.width < s27 || r28.height < i24) return false;
    let h19 = r28.cursors.get(i24);
    if (!h19) {
      if (r28.height < r28.nextY + i24) return false;
      h19 = [new R6(r28.nextY)], r28.cursors.set(i24, h19), r28.nextY += i24;
    }
    let n24 = h19.find((e34) => r28.width >= e34.x + s27);
    if (null == n24) {
      if (r28.height < r28.nextY + i24) return false;
      n24 = new R6(r28.nextY), r28.nextY += i24, h19.push(n24);
    }
    return e33.setNewPosition(n24), this._elements.set(t30, e33), this._elementsToRender.set(t30, e33), n24.x += s27, true;
  }
  _ensureCallbacks(e33) {
    const t30 = this._uvCallbacks.get(e33);
    if (t30) return t30;
    const s27 = /* @__PURE__ */ new Set();
    return this._uvCallbacks.set(e33, s27), s27;
  }
  _addCallback(e33, t30) {
    this._ensureCallbacks(e33).add(t30);
  }
  _removeCallback(e33, t30) {
    const s27 = this._uvCallbacks.get(e33);
    return !(!s27?.delete(t30) || 0 !== s27.size) && (this._uvCallbacks.delete(e33), true);
  }
  _processAddition(e33) {
    const t30 = e33.textRenderer.key;
    if (this._needsRepack) return void this._elements.set(t30, e33);
    const s27 = this._atlas, i24 = e33.textRenderer.renderedWidth, r28 = e33.textRenderer.renderedHeight, h19 = i24 + T8, n24 = r28 + T8 + w10;
    if (!this._addAtlasElement(e33, t30, h19, n24)) {
      if (this._canRepack) this._reset();
      else if (s27.width < h19) {
        const e34 = r11(Math.max(h19, 1.5 * s27.width), x11);
        this._resizeAtlas(e34, s27.height);
      } else {
        const e34 = s27.nextY + n24, t31 = r11(Math.max(e34, 1.5 * s27.height), x11);
        if (t31 > s27.height) this._resizeAtlas(s27.width, t31);
        else if (s27.width < x11) {
          const e35 = r11(1.5 * s27.width, x11);
          this._resizeAtlas(e35, s27.height);
        }
      }
      this._elements.set(t30, e33);
    }
  }
  _renderElement(e33) {
    const t30 = e33.commitNewPosition(), s27 = e33.textRenderer;
    this._ctx.clearRect(t30[0] - T8, t30[1] - T8, s27.renderedWidth + 2 * T8, s27.renderedHeight + 2 * T8), s27.render(this._ctx, t30[0], t30[1]), this._uvCallbacks.get(s27.key)?.forEach((t31) => t31(e33.uv));
  }
  get readyToRun() {
    return this.updating;
  }
  runTask(e33) {
    if (null == this._glTexture) return o6;
    for (; this._needsRepack && (this._canRepack || this._atlas.height < x11 && this._atlas.height < x11); ) {
      this._canRepack = this._needsRepack = false;
      const t30 = this._elements;
      this._elements = /* @__PURE__ */ new Map(), t30.forEach((e34) => this._processAddition(e34)), e33.madeProgress();
    }
    if (this._elementsToRender.size > 0) {
      for (const [t30, s27] of this._elementsToRender) {
        if (e33.done) break;
        this._renderElement(s27), this._elementsToRender.delete(t30), e33.madeProgress();
      }
      this._glTexture.setData(this._canvas);
    }
    this.updating = this._elementsToRender.size > 0;
  }
  addText(e33, t30) {
    const s27 = e33.key;
    this._addCallback(s27, t30);
    let i24 = this._elements.get(s27);
    return i24 ? E2(i24.uv, a7) || t30(i24.uv) : (i24 = new k12(e33), this._processAddition(i24), this.setDirty()), { remove: () => this._removeText(e33, t30) };
  }
  _removeText(e33, t30) {
    const s27 = e33.key;
    this._elements.get(s27) && this._removeCallback(s27, t30) && (this._elements.delete(s27), this._elementsToRender.delete(s27), this._canRepack = true);
  }
  setDirty() {
    this._glTexture && (this.updating = true);
  }
  get test() {
  }
  get usedMemory() {
    return (this._glTexture?.usedMemory ?? 0) + (this._canvas?.width ?? 0) * (this._canvas?.height ?? 0) * 4;
  }
};
__decorate([m({ constructOnly: true })], v10.prototype, "view", void 0), __decorate([m({ type: Boolean })], v10.prototype, "updating", void 0), v10 = __decorate([a2("esri.views.3d.webgl-engine.lib.TextTextureAtlas")], v10);
var T8 = 2;
var w10 = 2;
var k12 = class {
  constructor(e33) {
    this.textRenderer = e33, this._uv = n5(), this._newPosition = [0, 0];
  }
  get uv() {
    if (null == this._xOffset || null == this._yOffset) return a7;
    const { renderedWidth: e33, renderedHeight: t30 } = this.textRenderer;
    return s5(this._uv, this._xOffset, this._yOffset + t30, this._xOffset + e33, this._yOffset);
  }
  setNewPosition(e33) {
    this._newPosition[0] = e33.x, this._newPosition[1] = e33.y;
  }
  commitNewPosition() {
    return this._xOffset = this._newPosition[0], this._yOffset = this._newPosition[1], this._newPosition;
  }
  get xOffset() {
    return this._xOffset;
  }
  get yOffset() {
    return this._yOffset;
  }
};
var y8 = class {
  constructor(e33, t30) {
    this.width = e33, this.height = t30, this.cursors = /* @__PURE__ */ new Map(), this.nextY = 0;
  }
  reset() {
    this.cursors.clear(), this.nextY = b13;
  }
};
var R6 = class {
  constructor(e33) {
    this.y = e33, this.x = b13;
  }
};
var b13 = 0;

// node_modules/@arcgis/core/views/3d/webgl-engine/lib/TextTextureFactory.js
var i23 = class {
  constructor(e33, n24, i24) {
    this._renderer = new r10(e33, n24, i24, v10.maxSize);
  }
  get key() {
    return this._renderer.key;
  }
  get baselineAnchorY() {
    return 1 - this._renderer.firstRenderedBaselinePosition / this._renderer.renderedHeight;
  }
  get displayWidth() {
    return this._renderer.displayWidth;
  }
  get displayHeight() {
    return this._renderer.displayHeight;
  }
  create() {
    const r28 = a10(s26, this._renderer.renderedWidth, this._renderer.renderedHeight), t30 = r28.getContext("2d");
    return t30.save(), this._renderer.render(t30, 0, 0), t30.restore(), new M3(r28, { wrap: { s: 33071, t: 33071 }, noUnpackFlip: false, mipmap: true, preMultiplyAlpha: true });
  }
};
var s26 = { canvas: null };

// node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DTextSymbolLayer.js
var R7 = e5(0, 0, 1);
var T9 = class extends m13 {
  constructor(e33, t30, r28, s27) {
    super(e33, t30, r28, s27), this._elevationOptions = { supportsOffsetAdjustment: true, supportsOnTheGround: false }, this.ensureDrapedStatus(false);
  }
  async doLoad() {
    if (!this._drivenProperties.size) {
      const t30 = Z2(this.symbolLayer.size);
      if (t30) throw new s("graphics3dtextsymbollayer:invalid-size", t30);
    }
    await this._createTextRenderParameters();
  }
  async _createTextRenderParameters() {
    const e33 = this._context.graphicsCoreOwner.view.state.rasterPixelRatio;
    this._textRenderParameters = await s25.fromSymbol(this.symbolLayer, e33);
  }
  destroy() {
    super.destroy();
  }
  createGraphics3DGraphic(e33) {
    const t30 = e33.graphic, r28 = d9(t30.geometry);
    if (null == r28) return this.logger.warn(`unsupported geometry type for text symbol: ${t30.geometry.type}`), null;
    const s27 = this.view.focusAreasView?.containsGeometry(r28) ?? true, n24 = this.symbolLayer.text;
    if (null == n24 || "" === n24) return null;
    const i24 = o10(this.symbol) && this.symbol.hasVisibleVerticalOffset() ? this.symbol.verticalOffset : null;
    if (null != i24 && !l7(this.symbolLayer)) return this.logger.errorOncePerTick(`Callouts and vertical offset on text symbols are currently only supported with 'center' horizontal alignment (not with '${this.symbolLayer.horizontalAlignment}' alignment)`), null;
    const { verticalAlignment: o25 } = this.symbolLayer, a26 = new i22(i24);
    u12(o25, a26.screenOffset);
    const l25 = new r26(a26, this.symbolLayer.horizontalAlignment, m6(o25));
    return l25.isFocused = s27 ?? l25.isFocused, this._createAs3DShape(t30, r28, n24, l25);
  }
  get needsUpdateFocus() {
    return true;
  }
  createLabel(e33, t30, r28, s27, n24) {
    const i24 = e33.graphic, o25 = d9(i24.geometry);
    if (null == o25) return this.logger.warn(`unsupported geometry type for label: ${i24.geometry.type}`), null;
    const a26 = this.view.focusAreasView?.containsGeometry(o25) ?? true, l25 = t30.text;
    return !l25 || /^\s+$/.test(l25) ? null : (t30.isFocused = a26 ?? t30.isFocused, this._createAs3DShape(i24, o25, l25, t30, r28, s27, n24));
  }
  createElevationContextForGraphic(e33, t30 = 0) {
    const r28 = super.createElevationContextForGraphic(e33);
    return r28.addOffsetRenderUnits(t30), r28;
  }
  updateElevationContextForGraphic(e33, t30, r28 = 0) {
    super.updateElevationContextForGraphic(e33, t30), e33.addOffsetRenderUnits(r28);
  }
  layerOpacityChanged() {
    return this.logger.warn("layer opacity change not yet implemented in Graphics3DTextSymbolLayer"), false;
  }
  layerScreenSizePerspectiveChanged(e33, t30) {
    const r28 = !this.draped && this._context.screenSizePerspectiveEnabled, s27 = r28 ? this.view.screenSizePerspective.labelParameters : null, n24 = r28 ? this.view.screenSizePerspective.parameters : null;
    V6(e33, t30, (e34) => {
      for (const t31 of e34.stageObject.geometries) t31.material.setParameters({ screenSizePerspective: s27, screenSizePerspectiveAlignment: n24 });
    });
  }
  layerElevationInfoChanged(e33, t30) {
    return V6(e33, t30, (e34, t31) => {
      this.graphics3DGraphicLayerElevationInfoChanged(t31, e34);
    }), 1;
  }
  slicePlaneEnabledChanged(e33, t30) {
    return V6(e33, t30, (e34) => {
      for (const t31 of e34.stageObject.geometries) t31.material.setParameters({ hasSlicePlane: this._context.slicePlaneEnabled });
    }), true;
  }
  physicalBasedRenderingChanged() {
    return true;
  }
  get pixelRatioChanged() {
    return false;
  }
  graphics3DGraphicLayerElevationInfoChanged(e33, t30) {
    const { elevationContext: r28, metadata: s27 } = t30;
    this.updateElevationContextForGraphic(r28, e33, s27?.elevationOffset ?? 0), t30.needsElevationUpdates = d7(r28.mode) || "absolute-height" === r28.mode;
  }
  updateGeometry(e33, t30) {
    const r28 = e33.geometry;
    if (this.draped || !r28 || !this._validateGeometry(r28)) return false;
    const { elevationContext: s27, stageObject: n24 } = t30;
    if (s27.mode !== this.getGeometryElevationMode(r28)) return false;
    const i24 = d9(r28);
    if (!i24) return false;
    s27.updateFeatureExpressionFeature(e33, this._context.layer);
    const o25 = u20(n24, this._context, i24, s27);
    if (null == o25) return false;
    const a26 = g6(this._context, i24);
    return n24.geometries[0].localOrigin === a26 && (t30.alignedSampledElevation = o25, f12(t30, i24, this._context.elevationProvider), true);
  }
  _defaultElevationInfoNoZ() {
    return I7;
  }
  _createAs3DShape(e33, a26, c26, m21, g13, y9 = null, v12 = () => m21.placement.elevationOffset) {
    const x12 = this.createElevationContextForGraphic(e33, m21.placement.elevationOffset), b14 = e33.uid;
    let O6 = null, w11 = null;
    if (null == y9) {
      const e34 = s11(m21.horizontalPlacement);
      O6 = new i23(c26, e34, this._textRenderParameters);
      let s27 = null;
      if (null != this._context.sharedResources.textures) {
        w11 = this._context.sharedResources.textures.fromData(O6.key, () => O6.create()), w11.texture.events.on("unloaded", () => s27 = t(s27));
        const e35 = this._context.stage.renderView.textures.acquire(w11.texture.id);
        if (null == e35 || C(e35)) return w11.release(), null;
        s27 = e35;
      }
    }
    const j15 = !!has("enable-feature:non-occluded-hud"), S10 = H6(O6, m21), _13 = { occlusionTest: !j15, occludedFragmentFade: j15, horizonCullingEnabled: j15 && this._context.spherical, screenOffset: m21.placement.screenOffset, anchorPosition: S10, polygonOffset: true, color: [1, 1, 1, 1], centerOffsetUnits: m21.placement.centerOffsetUnits, depthEnabled: false, drawAsLabel: true, isLabel: true, isFocused: m21.isFocused };
    if ("polyline" === e33.geometry?.type && (_13.shaderPolygonOffset = 1e-4), y9 ? _13.textureId = y9.id : w11 && (_13.textureId = w11.texture.id), null != m21.placement.verticalOffset) {
      const { screenLength: e34, minWorldLength: t30, maxWorldLength: r28 } = m21.placement.verticalOffset;
      _13.verticalOffset = { screenLength: u3(e34), minWorldLength: t30 || 0, maxWorldLength: null != r28 ? r28 : 1 / 0 };
    }
    const E8 = this._context.graphicsCoreOwner.view.focusAreasView?.polygons.length, z8 = { screenOffset: _13.screenOffset, anchorPosition: S10, centerOffsetUnits: _13.centerOffsetUnits, verticalOffset: _13.verticalOffset, shaderPolygonOffset: _13.shaderPolygonOffset, occlusionTest: _13.occlusionTest, isFocused: m21.isFocused, focusStyle: this.view.map?.focusAreas.style ?? "none" };
    if (this._context.screenSizePerspectiveEnabled) {
      const { parameters: e34, labelParameters: t30 } = this.view.screenSizePerspective, r28 = e19(this._textRenderParameters);
      _13.screenSizePerspective = t30, _13.screenSizePerspectiveMinPixelReferenceSize = r28.maxHeight, _13.screenSizePerspectiveAlignment = e34, z8.fontHeight = r28.maxHeight;
    }
    _13.hasSlicePlane = this._context.slicePlaneEnabled;
    const A9 = this._context.spherical, T10 = g13 ? JSON.stringify(z8) : "";
    let V8 = g13?.get(T10);
    if (null == V8) {
      if (!m21.isFocused && E8) {
        const e34 = this.view.map?.focusAreas.style;
        _13.color = c17(_13.color, e34), _13.outlineColor = c17(_13.outlineColor, e34);
      }
      V8 = new ie(_13, A9), g13?.set(T10, V8);
    }
    const I9 = m21.placement.translation, W7 = O6 ? r8(O6.displayWidth, O6.displayHeight) : l5, M8 = m21.placement.centerOffset, $4 = R7, k14 = y9 ? r6(0, 0, 0, 0) : null, N4 = at(V8, { normal: $4, position: I9, size: W7, centerOffsetAndDistance: M8, uvi: k14 }), q9 = p8(this._context, a26, N4, x12, b14);
    if (null == q9) return null;
    const B8 = (t30, r28, s27, n24, i24, o25) => {
      const a27 = v12() || m21.placement.elevationOffset;
      return this.updateElevationContextForGraphic(r28, e33, a27), u18(t30, r28, s27, n24, i24, o25);
    }, J7 = new O2(this, q9.object, w11, B8, x12);
    J7.alignedSampledElevation = q9.sampledElevation, J7.needsElevationUpdates = d7(x12.mode) || "absolute-height" === x12.mode, J7.getScreenSize = (e34 = n6()) => (e34[0] = O6 ? O6.displayWidth : m21.displaySize[0], e34[1] = O6 ? O6.displayHeight : m21.displaySize[1], e34);
    const Y7 = new t23(m21.placement.elevationOffset, c26);
    return J7.metadata = Y7, f12(J7, a26, this._context.elevationProvider), J7;
  }
};
function V6(e33, t30, r28) {
  e33?.forEach((e34) => {
    const s27 = t30(e34);
    null != s27 && r28(s27, e34.graphic);
  });
}
function H6(e33, t30) {
  if ("baseline" === t30.verticalPlacement) {
    const r29 = n12[t30.horizontalPlacement], s27 = null != e33 ? e33.baselineAnchorY : 0;
    return r8(r29, s27);
  }
  const r28 = l8(t30.horizontalPlacement, t30.verticalPlacement);
  return i12[r28];
}
var I7 = { mode: "relative-to-ground", offset: 0 };

// node_modules/@arcgis/core/views/3d/webgl-engine/materials/WaterTechnique.js
var h17 = class extends m10 {
  constructor(e33, t30) {
    super(e33, t30, new t16(C4, () => import("./WaterSurface.glsl-BYZL6TYV.js")), e21() ? c13.locations : r17.locations);
  }
  initializePipeline(e33) {
    const { oitPass: r28, output: t30, transparent: s27, draped: d16 } = e33;
    return T3({ blending: 3 !== t30 && 9 !== t30 && 10 !== t30 && s27 ? a15(r28) : null, depthTest: d16 ? null : { func: p6(r28) }, depthWrite: i14(e33), drawBuffers: d5(r28, t30), colorWrite: d4, polygonOffset: m9(e33) });
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/materials/WaterGLMaterial.js
var r27 = class extends t15 {
  ensureResources(e33) {
    return this._techniques.context.waterTextures.ensureResources(e33);
  }
  beginSlot(e33) {
    const r28 = this._techniques.context.waterTextures.passParameters;
    return this._material.setParameters({ wavePerturbation: r28.wavePerturbation, waveNormal: r28.waveNormal }), this.getTechnique(h17, e33);
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/materials/WaterTechniqueConfiguration.js
var o24 = class extends e20 {
  constructor(e33) {
    super(), this.spherical = e33, this.receiveShadows = false, this.transparent = false, this.enableOffset = true, this.writeDepth = false, this.screenSpaceReflections = false, this.cloudReflections = false, this.draped = false, this.terrainDepthTest = false, this.cullAboveTerrain = false, this.textureCoordinateType = 0, this.emissionSource = 0, this.pbrMode = 3, this.occlusionPass = false, this.useCustomDTRExponentForWater = true, this.highStepCount = true, this.useFillLights = false, this.overlayEnabled = false, this.snowCover = false;
  }
  get discardInvisibleFragments() {
    return this.transparent && this.writeDepth;
  }
};
__decorate([i13()], o24.prototype, "receiveShadows", void 0), __decorate([i13()], o24.prototype, "transparent", void 0), __decorate([i13()], o24.prototype, "enableOffset", void 0), __decorate([i13()], o24.prototype, "writeDepth", void 0), __decorate([i13()], o24.prototype, "screenSpaceReflections", void 0), __decorate([i13()], o24.prototype, "cloudReflections", void 0), __decorate([i13()], o24.prototype, "draped", void 0), __decorate([i13()], o24.prototype, "terrainDepthTest", void 0), __decorate([i13()], o24.prototype, "cullAboveTerrain", void 0);

// node_modules/@arcgis/core/views/3d/webgl-engine/materials/WaterMaterial.js
var d15 = class extends i16 {
  constructor(t30, e33) {
    super(t30, g12), this.produces = /* @__PURE__ */ new Map([[2, (t31) => o13(t31) && !this.parameters.transparent || t14(t31)], [4, (t31) => o13(t31) && this.parameters.transparent || t14(t31)], [18, (t31) => this.parameters.draped && o13(t31) || 3 === t31 || t14(t31)], [19, (t31) => 3 === t31]]), this._configuration = new o24(e33.spherical);
  }
  getConfiguration(t30, e33) {
    return super.getConfiguration(t30, e33, this._configuration), this._configuration.writeDepth = true, this._configuration.receiveShadows = o13(t30) && e33.shadowMap.enabled, this._configuration.hasSlicePlane = this.parameters.hasSlicePlane, this._configuration.transparent = this.parameters.transparent, this._configuration.screenSpaceReflections = null != e33.ssr.lastFrameColor, this._configuration.cloudReflections = null != e33.clouds.data, this._configuration.draped = this.parameters.draped, this._configuration.oitPass = e33.oitPass, this._configuration.enableOffset = e33.camera.relativeElevation < l11, this._configuration.terrainDepthTest = e33.terrainDepthTest && o13(t30), this._configuration.cullAboveTerrain = e33.cullAboveTerrain, this._configuration;
  }
  get visible() {
    return true;
  }
  update(e33) {
    return this.setParameters({ timeElapsed: u2(e33.time) * this.parameters.animationSpeed }, false), this._animationEnabled(e33.camera) && e33.dt > 0;
  }
  _animationEnabled(t30) {
    const e33 = Math.min(t30.relativeElevation, t30.distance);
    return Math.sqrt(this.parameters.waveTextureRepeat / this.parameters.waveStrength) * e33 < v11;
  }
  createGLMaterial(t30) {
    return new r27(t30);
  }
  createBufferWriter() {
    return new s14(e21() ? c13 : r17);
  }
  get test() {
  }
};
var g12 = class extends a14 {
  constructor() {
    super(...arguments), this.waveStrength = 0.06, this.waveTextureRepeat = 32, this.waveDirection = r8(1, 0), this.waveVelocity = 0.05, this.flowStrength = 0.015, this.flowOffset = -0.5, this.animationSpeed = 0.35, this.timeElapsed = 0, this.color = r6(0, 0, 0, 0), this.transparent = true, this.hasSlicePlane = false, this.draped = false, this.origin = n2(), this.modelTransformation = null;
  }
};
var v11 = 35e3;

// node_modules/@arcgis/core/views/3d/webgl-engine/materials/internal/waterMaterialUtils.js
var e32 = { "calm-small": { waveStrength: 5e-3, perturbationStrength: 0.02, textureRepeat: 12, waveVelocity: 0.01 }, "rippled-small": { waveStrength: 0.02, perturbationStrength: 0.09, textureRepeat: 32, waveVelocity: 0.07 }, "slight-small": { waveStrength: 0.05, perturbationStrength: 0.07, textureRepeat: 28, waveVelocity: 0.1 }, "moderate-small": { waveStrength: 0.075, perturbationStrength: 0.07, textureRepeat: 24, waveVelocity: 0.1 }, "calm-medium": { waveStrength: 3125e-6, perturbationStrength: 0.01, textureRepeat: 8, waveVelocity: 0.02 }, "rippled-medium": { waveStrength: 0.035, perturbationStrength: 0.015, textureRepeat: 12, waveVelocity: 0.07 }, "slight-medium": { waveStrength: 0.06, perturbationStrength: 0.015, textureRepeat: 8, waveVelocity: 0.12 }, "moderate-medium": { waveStrength: 0.09, perturbationStrength: 0.03, textureRepeat: 4, waveVelocity: 0.12 }, "calm-large": { waveStrength: 0.01, perturbationStrength: 0, textureRepeat: 4, waveVelocity: 0.05 }, "rippled-large": { waveStrength: 0.025, perturbationStrength: 0.01, textureRepeat: 8, waveVelocity: 0.11 }, "slight-large": { waveStrength: 0.06, perturbationStrength: 0.02, textureRepeat: 3, waveVelocity: 0.13 }, "moderate-large": { waveStrength: 0.14, perturbationStrength: 0.03, textureRepeat: 2, waveVelocity: 0.15 } };

// node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DWaterSymbolLayer.js
var U8 = ["polyline", "polygon", "extent"];
var _B = class _B extends m13 {
  constructor(e33, t30, r28, i24) {
    super(e33, t30, r28, i24);
  }
  async doLoad() {
  }
  createGraphics3DGraphic(e33) {
    const t30 = e33.graphic;
    if (!this._validateGeometry(t30.geometry, U8, this.symbolLayer.type)) return null;
    const r28 = this.createElevationContextForGraphic(t30);
    return this.ensureDrapedStatus("on-the-ground" === r28.mode), this.ensureMaterial(), this.draped ? this._createAsOverlay(t30) : this._createAs3DShape(t30, r28, t30.uid);
  }
  ensureMaterial() {
    if (this._materials[0]) return;
    const t30 = new g12(), r28 = u10.toUnitRGBA(this.symbolLayer.color);
    r28[3] *= this._getLayerOpacity(), t30.color = r28, t30.transparent = r28[3] < 1 || this.needsDrivenTransparentPass, t30.waveDirection = null != this.symbolLayer.waveDirection ? M7(this.symbolLayer.waveDirection) : r8(0, 0);
    const i24 = this.symbolLayer.waveStrength + "-" + this.symbolLayer.waterbodySize, n24 = e32[i24];
    t30.waveStrength = n24.waveStrength, t30.waveTextureRepeat = n24.textureRepeat, t30.waveVelocity = n24.waveVelocity, t30.flowStrength = n24.perturbationStrength, t30.hasSlicePlane = this._context.slicePlaneEnabled, t30.draped = this.draped, this._materials[0] = new d15(t30, this._context);
  }
  layerOpacityChanged() {
    if (null == this._materials[0]) return;
    const e33 = this._materials[0].parameters.color, t30 = this.symbolLayer.color.a * this._getLayerOpacity(), r28 = t30 < 1 || this.needsDrivenTransparentPass;
    this._materials[0].setParameters({ color: [e33[0], e33[1], e33[2], t30], transparent: r28 });
  }
  layerScreenSizePerspectiveChanged() {
  }
  layerElevationInfoChanged(e33, t30, r28) {
    const i24 = this._elevationContext.mode, o25 = f10(_B.elevationModeChangeTypes, r28, i24);
    if (1 !== o25) return o25;
    const n24 = d7(i24);
    return this.updateGraphics3DGraphicElevationInfo(e33, t30, () => n24);
  }
  slicePlaneEnabledChanged() {
    return this._materials[0]?.setParameters({ hasSlicePlane: this._context.slicePlaneEnabled }), true;
  }
  physicalBasedRenderingChanged() {
    return true;
  }
  get needsDrivenTransparentPass() {
    return false;
  }
  _createAs3DShape(e33, t30, r28) {
    const i24 = l15(e33.geometry);
    if (null == i24) return null;
    const o25 = r18(i24, this._context.elevationProvider, this._context.renderCoordsHelper, t30), n24 = o25.position.length / 3, s27 = n8(2 * n24);
    R8(s27, o25.mapPositions, n24, this._context.elevationProvider.spatialReference);
    const a26 = new k13(o25, s27, this._context.layerViewUid, e33.uid);
    if (a26.olidColor = this._context.stage.renderView?.getObjectAndLayerIdColor(a26), this._create3DShapeGeometries(a26), this._logGeometryCreationWarnings(a26.renderData, i24.rings, "rings", "WaterSymbol3DLayer"), 0 === a26.outGeometries.length) return null;
    const l25 = new W({ geometries: a26.outGeometries, castShadow: false, layerViewUid: this._context.layerViewUid, graphicUid: r28 }), c26 = new O2(this, l25, null, f11, t30);
    return c26.alignedSampledElevation = a26.renderData.sampledElevation, c26.needsElevationUpdates = d7(t30.mode), c26;
  }
  _create3DShapeGeometries(e33) {
    const t30 = e33.renderData.polygons, i24 = e33.uvCoords;
    for (const { count: o25, index: n24, position: s27, mapPositions: a26, holeIndices: c26 } of t30) {
      if (null != this._context.clippingExtent && (m2(a26, W6), !A(W6, this._context.clippingExtent))) continue;
      const t31 = e18(a26, c26, 3);
      if (0 === t31.length) continue;
      const p14 = e16(i24, 2 * n24, 2 * o25), m21 = c15({ material: this._materials[0], indices: t31, mapPositions: a26, attributeData: { position: s27, uv0: p14 } }, e33.olidColor);
      e33.outGeometries.push(m21);
    }
  }
  _createAsOverlay(e33) {
    const t30 = l15(e33.geometry);
    if (null == t30) return null;
    this._materials[0].renderPriority = this._renderPriority;
    const r28 = p10(t30, this._context.overlaySR), i24 = r28.position.length / 3, o25 = n8(2 * i24);
    R8(o25, r28.position, i24, this._context.overlaySR);
    const n24 = new F9(r28, o25, this._context.layerViewUid, e33.uid);
    return n24.olidColor = this._context.stage.renderView?.getObjectAndLayerIdColor(n24), n24.outBoundingBox = q3(), this._createAsOverlayWater(n24), this._logGeometryCreationWarnings(n24.renderData, t30.rings, "rings", "WaterSymbol3DLayer"), 0 === n24.outGeometries.length ? null : new c18(this, n24.outGeometries, n24.outBoundingBox, this._context.drapeSourceRenderer);
  }
  _createAsOverlayWater(e33) {
    const t30 = e33.uvCoords, i24 = e33.renderData.polygons;
    for (const { position: o25, holeIndices: n24, index: s27, count: a26 } of i24) {
      if (m2(o25, W6), !A(W6, this._context.clippingExtent)) continue;
      M(e33.outBoundingBox, W6);
      const i25 = e18(o25, n24, 3);
      if (0 === i25.length) continue;
      const c26 = e16(t30, 2 * s27, 2 * a26), p14 = c15({ material: this._materials[0], indices: i25, attributeData: { position: o25, uv0: c26 } }, e33.olidColor);
      e33.outGeometries.push(new h8(p14, e33));
    }
  }
  test() {
    return { ...super.test(), create3DShape: (e33) => this._createAs3DShape(e33.graphic, e33.elevationContext, e33.graphicUid), ensureMaterial: () => this.ensureMaterial() };
  }
};
_B.unitSizeOfTexture = 100;
_B.elevationModeChangeTypes = { definedChanged: 2, staysOnTheGround: 0, onTheGroundChanged: 2 };
var B7 = _B;
function M7(e33) {
  const t30 = n6(), r28 = u5(e33);
  return t30[0] = Math.sin(r28), t30[1] = Math.cos(r28), t30;
}
function R8(e33, r28, o25, n24) {
  const a26 = ae(n24);
  K(z7);
  for (let t30 = 0; t30 < o25; t30++) o2(I8, r28[3 * t30], r28[3 * t30 + 1]), f2(z7, I8);
  m3(z7, z7, a26);
  const l25 = z7[0] % B7.unitSizeOfTexture, c26 = z7[1] % B7.unitSizeOfTexture;
  V7[0] = z7[0] - l25, V7[1] = z7[1] - c26;
  for (let t30 = 0; t30 < o25; t30++) e33[2 * t30] = (r28[3 * t30] * a26 - V7[0]) / B7.unitSizeOfTexture, e33[2 * t30 + 1] = (r28[3 * t30 + 1] * a26 - V7[1]) / B7.unitSizeOfTexture;
}
var V7 = n6();
var z7 = i3();
var I8 = n6();
var W6 = u7();
var k13 = class extends p9 {
  constructor(e33, t30, r28, i24) {
    super(e33, r28, i24), this.uvCoords = t30;
  }
};
var F9 = class extends p9 {
  constructor(e33, t30, r28, i24) {
    super(e33, r28, i24), this.uvCoords = t30;
  }
};

// node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DSymbolLayerFactory.js
function l24(o25, e33, t30, m21) {
  const i24 = h18[o25.type]?.[e33.type] || c25[e33.type];
  return i24 ? new i24(o25, e33, t30, m21) : (i.getLogger("esri.views.3d.layers.graphics.Graphics3DSymbolLayerFactory").error("GraphicsLayerFactory#make", `unknown symbol type ${e33.type}`), null);
}
var c25 = { icon: he, object: le2, line: W2, path: $3, fill: H5, extrude: K4, text: T9, water: B7 };
var h18 = { "mesh-3d": { fill: Pe } };
export {
  l24 as make
};
//# sourceMappingURL=Graphics3DSymbolLayerFactory-TMTKRGVS.js.map
