{
  "version": 3,
  "sources": ["../../@arcgis/core/layers/graphics/data/FeatureIdInfo.js", "../../@arcgis/core/views/2d/layers/features/sources/FeatureSourceQueryInfo.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nfunction*e(e){switch(e.type){case\"object-id\":case\"unique-id-simple\":return void(yield e.fieldName);case\"unique-id-composite\":return void(yield*e.fieldNames)}}export{e as getFeatureIdInfoFieldNames};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport has from\"../../../../../core/has.js\";import{sqlAnd as e}from\"../../../../../core/sql.js\";import t from\"../../../../../geometry/SpatialReference.js\";import{getClauseForScaleRange as r}from\"../../../../../layers/support/displayFilterUtils.js\";import a from\"../../../../../rest/support/Query.js\";import i from\"../../../../../time/TimeExtent.js\";const s=4;function o(e){switch(e.type){case\"object-id\":case\"unique-id-simple\":return`${e.fieldName} ASC`;case\"unique-id-composite\":return`${e.fieldNames.join(\",\")} ASC`}}function n(e,r,a){const s=o(a.featureIdInfo);return{returnCentroid:\"esriGeometryPolygon\"===a.serviceGeometryType&&!e.queryMetadata.supportsCentroidOnDegeneratedQuantizedGeometry&&!e.queryMetadata.supportsDegeneratedQuantizedGeometry,returnGeometry:!0,timeReferenceUnknownClient:a.timeReferenceUnknownClient??void 0,outSpatialReference:t.fromJSON(e.outSpatialReference),orderByFields:\"memory\"===e.type?[]:[s],where:r.definitionExpression??\"1=1\",outFields:r.availableFields,multipatchOption:\"esriGeometryMultiPatch\"===a.serviceGeometryType?\"xyFootprint\":null,gdbVersion:r.gdbVersion,historicMoment:r.historicMoment?new Date(r.historicMoment):null,timeExtent:r.timeExtent?i.fromJSON(r.timeExtent):null}}class u{static create(e,t,r){const a=t.queryScaleRanges,i=t.displayFilterInfo;return new u(n(e,t,r),i,a,r.subtypeField,t.customParameters,r.geometryType,e.queryMetadata)}constructor(e,t,r,a,i,s,o){this._queryParams=e,this._displayFilter=t,this._queryScaleRanges=r,this._subtypeField=a,this._customParameters=i,this._geometryType=s,this._queryMetadata=o}get pageSize(){if(null==this._queryMetadata)throw new Error(\"InternalError: Service does not support paged queries\");const e=this._queryMetadata.supportsMaxRecordCountFactor?s:null,t=(this._queryMetadata.maxRecordCount??8e3)*(e??1);return Math.min(8e3,t)}get objectIdsQueryPageSize(){return this._queryMetadata?.maxRecordCount??2e3}updateHistoricMoment(e){this._queryParams.historicMoment=e}updateFields(e){this._queryParams.outFields=e}createPatchFieldsQuery(e,t,r){if(!t.getSize())return null;const a=e.clone();if(\"*\"===this._queryParams.outFields[0]){if(\"*\"===(a.outFields??[])[0])return null;a.outFields=this._queryParams.outFields}else{const e=new Set(this._queryParams.outFields),r=[];for(const a of e)t.hasField(a)||r.push(a);if(0===r.length)return null;a.outFields=r}a.returnGeometry=!1,a.returnCentroid=!1,a.quantizationParameters=null,a.cacheHint=!0;const i={inner:a,customParameters:this._customParameters};if(has(\"esri-tiles-debug\")&&null!=r){const e=r.chunkId.toString().replaceAll(\"/\",\".\");i.customParameters=i.customParameters?{...i.customParameters,chunkId:e}:{chunkId:e}}return i}createQuery(e={}){if(!this._queryParams)throw new Error(\"InternalError: queryInfo should be defined\");return{inner:new a({...this._queryParams,...e}),customParameters:this._customParameters}}createTileQuery(t,a){if(null==this._queryMetadata)throw new Error(\"InternalError: Service does not support tile queries\");const i=this.createQuery(a),o=i.inner;if(this._queryScaleRanges?.length){const r=this._queryScaleRanges.filter(e=>(!e.minScale||e.minScale>=t.maxScale)&&(!e.maxScale||e.maxScale<=t.minScale)).map(e=>e.subtypeCode);if(r.length){const t=`${this._subtypeField} IN (${r})`;o.where=e(o.where,t)}}if(this._displayFilter&&(o.where=e(o.where,r(this._displayFilter,t.minScale,t.maxScale))),o.quantizationParameters=a.quantizationParameters??t.getQuantizationParameters(),o.resultType=\"tile\",o.geometry=t.extent,this._queryMetadata.supportsQuantization?\"esriGeometryPolyline\"===this._geometryType&&(o.maxAllowableOffset=t.resolution*has(\"feature-polyline-generalization-factor\")):\"esriGeometryPolyline\"!==this._geometryType&&\"esriGeometryPolygon\"!==this._geometryType||(o.maxAllowableOffset=t.resolution,\"esriGeometryPolyline\"===this._geometryType&&(o.maxAllowableOffset*=has(\"feature-polyline-generalization-factor\"))),o.defaultSpatialReferenceEnabled=this._queryMetadata.supportsDefaultSpatialReference,o.compactGeometryEnabled=this._queryMetadata.supportsCompactGeometry,this._queryMetadata.supportsMaxRecordCountFactor&&(o.maxRecordCountFactor=s),has(\"esri-tiles-debug\")){const e=t.id.replaceAll(\"/\",\".\");i.customParameters=i.customParameters?{...i.customParameters,tileId:e}:{tileId:e}}return i}createPagedTileQuery(e,t){const r=this.pageSize;return this.createTileQuery(e,{start:r*t,num:r,returnExceededLimitFeatures:!0})}createPagedQuery(e,t){const r=this.pageSize;return this.createQuery({start:r*e,num:r,returnExceededLimitFeatures:!0,maxRecordCountFactor:s,quantizationParameters:t,cacheHint:!0})}createObjectIdsQuery(e){return this.createQuery({objectIds:e,outFields:[\"*\"]})}}export{u as FeatureSourceQueryInfo};\n"],
  "mappings": "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",
  "names": ["e", "e", "s", "o", "r", "a", "t"]
}
