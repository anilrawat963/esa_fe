import {
  r as r4
} from "./chunk-UP6PVI7I.js";
import {
  f
} from "./chunk-B6U4OZGR.js";
import {
  b as b2
} from "./chunk-H4PQ35LQ.js";
import {
  A as A2,
  A2 as A3,
  D,
  E,
  M as M2,
  S2,
  V,
  h as h3,
  p as p2,
  r as r3
} from "./chunk-7YU4QEOZ.js";
import "./chunk-QMZNFXS2.js";
import {
  g as g2,
  w3 as w
} from "./chunk-K5ZF6G4K.js";
import "./chunk-6AWERJZ7.js";
import "./chunk-MLUR3X6U.js";
import "./chunk-I7PJIK77.js";
import "./chunk-Y2GQGUGW.js";
import {
  S,
  s as s4
} from "./chunk-SUOIQXQ3.js";
import "./chunk-TNKZDDMZ.js";
import "./chunk-Z3EPMK46.js";
import "./chunk-VHCNEAMV.js";
import "./chunk-2XEDAAX5.js";
import "./chunk-H6PLTW7B.js";
import "./chunk-36YQJD5W.js";
import "./chunk-BQ6DEXWK.js";
import "./chunk-3SCRAN3E.js";
import "./chunk-NTNXXNRP.js";
import "./chunk-QCJFPBRP.js";
import "./chunk-X4ZPIDID.js";
import "./chunk-V4S4W4OB.js";
import "./chunk-IGRCAVBL.js";
import {
  k
} from "./chunk-Q3JOE7TC.js";
import "./chunk-GD72EK2J.js";
import "./chunk-6WSJV2UJ.js";
import {
  G as G2,
  z
} from "./chunk-2EBLSEHZ.js";
import "./chunk-B3BLJNSM.js";
import "./chunk-ALKEERWI.js";
import "./chunk-JBTWCDRR.js";
import "./chunk-U6CJFTOF.js";
import "./chunk-FHCV4NTV.js";
import "./chunk-2JMKFI2D.js";
import "./chunk-QYAMBIRP.js";
import "./chunk-EOQ2S5UA.js";
import "./chunk-WBXDB33U.js";
import {
  I as I2
} from "./chunk-XTEXJOLG.js";
import "./chunk-YE4E5JCT.js";
import "./chunk-SXZO7ULH.js";
import "./chunk-GVMCGYZ6.js";
import "./chunk-JHV6OBEB.js";
import "./chunk-VNSHGTPN.js";
import "./chunk-NHFKDWOM.js";
import "./chunk-WHHIH5YU.js";
import "./chunk-5LMH6D7V.js";
import "./chunk-BZLHV37L.js";
import "./chunk-V6V3WWJF.js";
import "./chunk-EK7HOTRR.js";
import "./chunk-ZVTEFYZX.js";
import "./chunk-LPUPM55U.js";
import "./chunk-RORL5XZJ.js";
import "./chunk-E64QZ35H.js";
import "./chunk-FXT57D73.js";
import "./chunk-CJCWAWMZ.js";
import "./chunk-TCIOA3WX.js";
import "./chunk-5IXGYDQ3.js";
import "./chunk-RKVVFTIZ.js";
import "./chunk-WJ5RYEGC.js";
import "./chunk-7TAAMEZT.js";
import "./chunk-4POFO7MP.js";
import "./chunk-257FD5T2.js";
import "./chunk-ZNI54T6D.js";
import {
  n as n5
} from "./chunk-E7PJOFGP.js";
import {
  h as h2,
  y
} from "./chunk-4VQDBNTM.js";
import {
  t
} from "./chunk-3BNOOWTA.js";
import "./chunk-AIJLLSRB.js";
import "./chunk-VX2NEBRT.js";
import "./chunk-HOJHSMLY.js";
import "./chunk-QSGJ3ECU.js";
import "./chunk-52SEOH5H.js";
import "./chunk-7HTU7ZUX.js";
import {
  n as n2,
  s as s3
} from "./chunk-WDTGOP77.js";
import {
  A,
  I,
  P as P2,
  c,
  g,
  q,
  r as r2,
  s as s2,
  u as u2
} from "./chunk-VYMBX5H5.js";
import "./chunk-BPTFV5VM.js";
import "./chunk-647DAMHU.js";
import "./chunk-O6G3PPOK.js";
import "./chunk-ZKNZTIAS.js";
import "./chunk-OJMISN3F.js";
import "./chunk-EFV6H5NA.js";
import "./chunk-XDLV73DB.js";
import "./chunk-ARTU4L55.js";
import "./chunk-5ONGWFJ3.js";
import "./chunk-BBYMM7CM.js";
import "./chunk-EM7Y2JZC.js";
import "./chunk-QZQPB5XR.js";
import "./chunk-AQFRVV3U.js";
import "./chunk-MUBG7EZN.js";
import "./chunk-TMVLBQMP.js";
import "./chunk-6IHS6RYH.js";
import "./chunk-OJBEN6CV.js";
import "./chunk-TU5E6NPS.js";
import "./chunk-RKNCTZBL.js";
import {
  n as n4
} from "./chunk-36OXW4YN.js";
import "./chunk-PEL3D3ZN.js";
import "./chunk-Q5KWD3VQ.js";
import "./chunk-BUQC3CLV.js";
import "./chunk-W5S3VUFT.js";
import "./chunk-7YH7T6CS.js";
import "./chunk-3T4IXPP4.js";
import "./chunk-XTZAIV4X.js";
import "./chunk-63LDVRFI.js";
import "./chunk-TJTOV6JD.js";
import {
  _ as _2
} from "./chunk-C3FRY5U4.js";
import "./chunk-JNJX34GB.js";
import "./chunk-3STJRSDT.js";
import "./chunk-67Q6KVC6.js";
import {
  n as n3
} from "./chunk-23NJHA5Q.js";
import "./chunk-4LA6K4VI.js";
import "./chunk-KEZCWFAR.js";
import {
  m as m3
} from "./chunk-JZUJ34RR.js";
import "./chunk-PMGS7UDU.js";
import "./chunk-3GHCGAH2.js";
import "./chunk-HWUOAPTX.js";
import "./chunk-QHCKOBU7.js";
import "./chunk-K2OZ6WVC.js";
import "./chunk-MC6NAKKX.js";
import "./chunk-TF6255HN.js";
import "./chunk-GD4FJL3C.js";
import "./chunk-C5OQVQZF.js";
import {
  u as u4
} from "./chunk-F7DKSAOI.js";
import "./chunk-4SOQWNPG.js";
import "./chunk-LTULADK2.js";
import "./chunk-35ST7YRB.js";
import "./chunk-EDA5QFHZ.js";
import "./chunk-XL5QPCXN.js";
import {
  N,
  W
} from "./chunk-2LC2762W.js";
import "./chunk-W6HOAVT4.js";
import "./chunk-DTZUXJMD.js";
import "./chunk-YLAGKT2D.js";
import "./chunk-6YRQYUCY.js";
import "./chunk-6KDQMJAI.js";
import "./chunk-UDHS2MGH.js";
import "./chunk-QF7FRVN6.js";
import "./chunk-ENINOZUZ.js";
import "./chunk-P6IKJIMO.js";
import "./chunk-MHV23XAQ.js";
import "./chunk-V2X4OKYI.js";
import "./chunk-LPZUGJNG.js";
import "./chunk-XLOINTMG.js";
import "./chunk-MA3QDRC3.js";
import "./chunk-W6J7XCPU.js";
import "./chunk-ONXWBTTM.js";
import "./chunk-T7F6Q6JJ.js";
import "./chunk-YDTPM7OQ.js";
import {
  n
} from "./chunk-75XOUSSS.js";
import "./chunk-TH4EQWJJ.js";
import "./chunk-7P2ANHQ3.js";
import "./chunk-XCKT47LJ.js";
import {
  m as m2
} from "./chunk-3FUHCAX3.js";
import {
  P
} from "./chunk-PZ5RULLK.js";
import "./chunk-OPJX4KXH.js";
import "./chunk-LTPHDYPK.js";
import "./chunk-3OVERDFX.js";
import "./chunk-FPMLKIDB.js";
import {
  e as e2,
  o,
  v
} from "./chunk-AZXJIEZ6.js";
import "./chunk-Q75WYS7K.js";
import "./chunk-H74Q4SYB.js";
import {
  h,
  l
} from "./chunk-2OFHDVO5.js";
import "./chunk-TFJXG32O.js";
import "./chunk-DDOCCRD4.js";
import "./chunk-5UPBUJPC.js";
import "./chunk-THQO67BJ.js";
import "./chunk-4YDOPHTZ.js";
import "./chunk-YY5PITIH.js";
import {
  u as u3
} from "./chunk-CCQFL76O.js";
import "./chunk-CSMCPN64.js";
import "./chunk-GY6YF4EN.js";
import "./chunk-7H3U4IJR.js";
import {
  M,
  s
} from "./chunk-SMWUT52Z.js";
import {
  _
} from "./chunk-AXZMNHTN.js";
import "./chunk-5T3MJDSR.js";
import {
  G,
  T,
  ae,
  p
} from "./chunk-NMQNUPE4.js";
import "./chunk-6KIXN4DJ.js";
import "./chunk-7DGJB37R.js";
import "./chunk-234CIOHE.js";
import "./chunk-V2H77UEV.js";
import "./chunk-WRA2WBYC.js";
import "./chunk-XWE6BM2U.js";
import "./chunk-SOIZOFSB.js";
import "./chunk-XXLHAM2M.js";
import {
  b,
  m,
  r2 as r
} from "./chunk-5EI5H4QX.js";
import {
  a2 as a
} from "./chunk-ZIE53VIV.js";
import {
  __decorate
} from "./chunk-SS5CLIUY.js";
import "./chunk-R54Q5TGA.js";
import "./chunk-6SSZNBOK.js";
import "./chunk-LZ2XTYP2.js";
import "./chunk-45CFSCQX.js";
import "./chunk-A5XN2VFT.js";
import "./chunk-65HD3WXL.js";
import "./chunk-4DGC7CBY.js";
import {
  e,
  u2 as u
} from "./chunk-GNMPGHLQ.js";
import "./chunk-QY7XKUIV.js";
import "./chunk-AL6YUTZM.js";
import "./chunk-G26ADAPQ.js";

// node_modules/@arcgis/core/views/2d/interactive/editingTools/draw/symbols.js
var t2 = new n3({ data: { type: "CIMSymbolReference", symbol: { type: "CIMLineSymbol", symbolLayers: [{ type: "CIMSolidStroke", effects: [{ type: "CIMGeometricEffectDashes", dashTemplate: [3.75, 3.75], lineDashEnding: "HalfPattern", controlPointEnding: "NoConstraint" }], enable: true, capStyle: "Butt", joinStyle: "Round", miterLimit: 10, width: 1.6, color: [255, 255, 255, 255] }, { type: "CIMSolidStroke", enable: true, capStyle: "Butt", joinStyle: "Round", miterLimit: 10, width: 2, color: [0, 0, 0, 255] }] } } });
var l2 = new u4({ style: "circle", size: 6, color: [127, 127, 127, 1], outline: { color: [50, 50, 50], width: 1 } });
var i = new u4({ style: "circle", size: 6, color: [255, 127, 0, 1], outline: { color: [50, 50, 50], width: 1 } });

// node_modules/@arcgis/core/views/2d/interactive/editingTools/draw/DrawGraphicTool2D.js
var E2 = class extends A2 {
  constructor(e4) {
    super(e4), this._visualElementGraphics = { regularVertices: null, activeVertex: null, activeEdge: null }, this.activeFillSymbol = null, this.type = "draw-2d", this._visualElementSymbols = { outline: e4.activeLineSymbol ?? t2, regularVertices: e4.regularVerticesSymbol ?? l2, activeVertex: e4.activeVertexSymbol ?? i, fill: e4.activeFillSymbol }, e4.activeVertexSymbol || this.addHandles(l(() => this.view?.effectiveTheme?.accentColor, (e5) => {
      if (!e5) return;
      const t3 = this._visualElementSymbols.activeVertex.clone().set({ color: e5 });
      this._visualElementGraphics.activeVertex?.set("symbol", t3), this._visualElementSymbols = { ...this._visualElementSymbols, activeVertex: t3 };
    }, h));
  }
  normalizeCtorArgs(e4) {
    const t3 = { ...e4 };
    return delete t3.activeFillSymbol, delete t3.activeVertexSymbol, delete t3.regularVerticesSymbol, delete t3.activeLineSymbol, t3;
  }
  initializeGraphic(e4) {
    return null != this._visualElementSymbols.fill && (e4.symbol = this._visualElementSymbols.fill), this.internalGraphicsLayer.graphics.sort(G3), e();
  }
  makeDrawOperation() {
    const { defaultZ: e4, hasZ: t3, view: i2 } = this;
    return this._createOrUpdateGraphic(null), new A3({ view: i2, manipulators: this.manipulators, geometryType: M2(this.geometryType), drawingMode: this.mode, hasZ: t3, defaultZ: e4, snapToSceneEnabled: this.snapToScene, drawSurface: new h3(i2, t3, e4), hasM: false, snappingManager: this.snappingManager, snappingVisualizer: new f(this.internalGraphicsLayer), graphic: this.graphic, cursor: this.cursor, constraintsEnabled: true, automaticLengthMeasurementUtils: this.automaticLengthMeasurementUtils });
  }
  onActiveVertexChanged(e4) {
    if ("point" === this.geometryType) return e();
    const [s6, a2] = e4, l3 = new _({ x: s6, y: a2, spatialReference: this.view.spatialReference });
    return null != this._visualElementGraphics.activeVertex ? (this._visualElementGraphics.activeVertex.geometry = l3, e()) : (this._visualElementGraphics.activeVertex = new _2({ geometry: l3, symbol: this._visualElementSymbols.activeVertex, attributes: { displayOrder: 2 } }), this.internalGraphicsLayer.add(this._visualElementGraphics.activeVertex), this.internalGraphicsLayer.graphics.sort(G3), e(() => {
      null != this._visualElementGraphics.activeVertex && (this.internalGraphicsLayer.remove(this._visualElementGraphics.activeVertex), this._visualElementGraphics.activeVertex = u(this._visualElementGraphics.activeVertex));
    }));
  }
  onCursorEdgeChanged(e4) {
    return null != this._visualElementGraphics.activeEdge ? (this._visualElementGraphics.activeEdge.geometry = e4, e()) : (this._visualElementGraphics.activeEdge = new _2({ geometry: e4, symbol: this._visualElementSymbols.outline, attributes: { displayOrder: 0 } }), this.internalGraphicsLayer.add(this._visualElementGraphics.activeEdge), this.internalGraphicsLayer.graphics.sort(G3), e(() => {
      null != this._visualElementGraphics.activeEdge && (this.internalGraphicsLayer.remove(this._visualElementGraphics.activeEdge), this._visualElementGraphics.activeEdge = u(this._visualElementGraphics.activeEdge));
    }));
  }
  onRegularVerticesChanged(e4) {
    const s6 = new m2({ points: e4, spatialReference: this.view.spatialReference });
    return null != this._visualElementGraphics.regularVertices ? (this._visualElementGraphics.regularVertices.geometry = s6, e()) : (this._visualElementGraphics.regularVertices = new _2({ geometry: s6, symbol: this._visualElementSymbols.regularVertices, attributes: { displayOrder: 1 } }), this.internalGraphicsLayer.add(this._visualElementGraphics.regularVertices), this.internalGraphicsLayer.graphics.sort(G3), e(() => {
      null != this._visualElementGraphics.regularVertices && (this.internalGraphicsLayer.remove(this._visualElementGraphics.regularVertices), this._visualElementGraphics.regularVertices = u(this._visualElementGraphics.regularVertices));
    }));
  }
};
function G3(e4, t3) {
  return (e4.attributes?.displayOrder ?? -1 / 0) - (t3.attributes?.displayOrder ?? -1 / 0);
}
__decorate([m()], E2.prototype, "activeFillSymbol", void 0), __decorate([m({ readOnly: true })], E2.prototype, "type", void 0), __decorate([m({ constructOnly: true, nonNullable: true })], E2.prototype, "view", void 0), E2 = __decorate([a("esri.views.2d.interactive.editingTools.draw.DrawGraphicTool2D")], E2);

// node_modules/@arcgis/core/views/2d/interactive/editingTools/manipulations/Manipulation.js
var r5 = class {
  get hovering() {
    return this.someManipulator((r7) => r7.hovering);
  }
  get grabbing() {
    return this.someManipulator((r7) => r7.grabbing);
  }
  get dragging() {
    return this.someManipulator((r7) => r7.dragging);
  }
  hasManipulator(r7) {
    return this.someManipulator((t3) => t3 === r7);
  }
  someManipulator(r7) {
    let t3 = false;
    return this.forEachManipulator((a2) => {
      !t3 && r7(a2) && (t3 = true);
    }), t3;
  }
};

// node_modules/@arcgis/core/views/2d/interactive/editingTools/manipulations/DragManipulation.js
var e3 = class extends r5 {
  constructor(t3) {
    super(), this._view = t3.view, this._tool = t3.tool, this._graphic = t3.graphic, this._manipulator = this._createManipulator(), this.forEachManipulator((t4) => this._tool.manipulators.add(t4));
  }
  destroy() {
    this.forEachManipulator((t3) => {
      this._tool.manipulators.remove(t3), t3.destroy();
    }), this._tool = null, this._view = null, this._manipulator = null, this._graphic = null;
  }
  forEachManipulator(t3) {
    t3(this._manipulator, 0);
  }
  createDragPipeline(t3, a2) {
    let e4 = null, n8 = null, s6 = 0, l3 = 0, p4 = 0;
    const { offsetX: c2, offsetY: h4, size: u6 } = s4(this._graphic.symbol);
    return p2(this._manipulator, (i2, o2) => {
      o2.next((i3) => {
        if ("start" === i3.action) {
          const i4 = t3();
          e4 = i4.editGeometryOperations, n8 = i4.constraints;
        }
        return i3;
      }).next(E(this._view)).next((t4) => {
        const { x: i3, y: r7, z: o3 } = t4.mapEnd;
        if (n8 && (i3 + c2 < n8.xmin || r7 + h4 - u6 < n8.ymin || i3 + c2 > n8.xmax || r7 + h4 - u6 > n8.ymax)) return t4;
        ("start" === t4.action || 0 === s6 && 0 === l3 && 0 === p4) && (s6 = t4.mapStart.x, l3 = t4.mapStart.y, p4 = t4.mapStart.z);
        const m4 = i3 - s6, _3 = r7 - l3, f3 = o3 - p4;
        s6 = i3, l3 = r7, p4 = o3;
        const v3 = "start" === t4.action ? 0 : 1, x2 = e4.move(m4, _3, f3, v3);
        return a2(t4, x2), t4;
      });
    });
  }
  _createManipulator() {
    const t3 = this._view, i2 = this._graphic;
    return new S({ view: t3, graphic: i2, selectable: true, cursor: "move" });
  }
};

// node_modules/@arcgis/core/views/2d/interactive/editingTools/ControlPointsTransformTool.js
var f2 = { up: "ArrowUp", down: "ArrowDown", left: "ArrowLeft", right: "ArrowRight", toggleOpacity: "t", shift: "Shift", primaryKey: t };
var u5 = 1;
var P3 = 10;
var v2 = new u3("#009af2");
var S3 = class extends r3 {
  constructor(t3) {
    super(t3), this._isOpacityToggled = false, this._isModifierActive = false, this._factor = 1, this._initialControlPoints = null, this._graphicsLayer = new n4({ internal: true, listMode: "hide", visible: false, effect: "drop-shadow(0px, 0px, 3px)", title: "ControlPointsTransformationTool layer" }), this._undoStack = [], this._redoStack = [], this._sharedUndoStack = [], this._sharedRedoStack = [], this._highlightHandle = null, this.activeHandle = 0, this.type = "reshape";
  }
  initialize() {
    this._initialize();
  }
  destroy() {
    const { map: t3 } = this.view;
    this._controlPointManipulations.forEach((t4) => t4.destroy()), this._controlPointEditGeometryOperations.forEach((t4) => t4.destroy()), t3.removeMany([this._graphicsLayer]), this._graphicsLayer.removeAll(), this._graphicsLayer = u(this._graphicsLayer), this._georeference = null, this._controlPointGraphics = null, this._controlPointManipulations = null, this._graphicsLayer = null, this._controlPointEditGeometryOperations = null, this._undoStack = null, this._redoStack = null, this._initialControlPoints = null, this._sharedUndoStack = null, this._sharedRedoStack = null;
  }
  get _hasValidSpatialReference() {
    return p(this.view.spatialReference);
  }
  onActivate() {
    this.visible = true;
  }
  onDeactivate() {
    this.visible = false;
  }
  onShow() {
    this._graphicsLayer.visible = true;
  }
  onHide() {
    this._graphicsLayer.visible = false;
  }
  canUndo() {
    const t3 = this._undoStack[this._undoStack.length - 1];
    return null != t3 && this._controlPointEditGeometryOperations[t3].canUndo;
  }
  canRedo() {
    const t3 = this._redoStack[this._redoStack.length - 1];
    return null != t3 && this._controlPointEditGeometryOperations[t3].canRedo;
  }
  undo() {
    if (this._undoStack.length > 0) {
      const t3 = this._undoStack.pop();
      this._controlPointEditGeometryOperations[t3].undo(), this.updateGraphics(), this._redoStack.push(t3);
    }
  }
  redo() {
    if (this._redoStack.length > 0) {
      const t3 = this._redoStack.pop();
      this._controlPointEditGeometryOperations[t3].redo(), this.updateGraphics(), this._undoStack.push(t3);
    }
  }
  refresh() {
    const { mediaElement: t3 } = this;
    if (null == t3.georeference) return;
    const e4 = t3.georeference;
    "control-points" === e4.type && null != e4.coords && (this._georeference = e4, this._georeference.controlPoints.forEach(({ mapPoint: t4 }, e5) => {
      const i2 = this._controlPointEditGeometryOperations[e5], o2 = i2.data.parts[0].vertices[0];
      i2.setVertexPosition(o2, i2.data.coordinateHelper.pointToVector(t4));
    }), this.updateGraphics());
  }
  reset() {
    this._georeference.controlPoints = this._initialControlPoints, this.refresh(), this._sharedUndoStack.length = 0, this._sharedRedoStack.length = 0;
  }
  updateGraphics() {
    const t3 = this._georeference, e4 = t3.controlPoints, i2 = e4[0].mapPoint.spatialReference, o2 = this._hasValidSpatialReference;
    this._georeference.controlPoints = this._controlPointEditGeometryOperations.map((r7, s6) => {
      const a2 = r7.data.geometry;
      return this._controlPointGraphics[s6].geometry = a2, { mapPoint: W(a2, i2), sourcePoint: o2 ? e4[s6].sourcePoint : t3.toSource(a2) };
    });
  }
  updateActiveHandle(t3) {
    if (this.activeHandle === t3) return;
    const e4 = this._controlPointGraphics[this.activeHandle].symbol.clone();
    k(e4, this.view.effectiveTheme.accentColor), this._controlPointGraphics[this.activeHandle].symbol = e4;
    const i2 = this._controlPointGraphics[t3].symbol.clone();
    k(i2, v2), this._controlPointGraphics[t3].symbol = i2, this.activeHandle = t3, this.view.surface === document.activeElement && this.highlightActiveHandle();
  }
  async highlightActiveHandle() {
    this.removeHighlightActiveHandle();
    const t3 = await this.view.whenLayerView(this._graphicsLayer);
    this._highlightHandle = t3.highlight(this._controlPointGraphics[this.activeHandle]);
  }
  removeHighlightActiveHandle() {
    this._highlightHandle && this._highlightHandle.remove();
  }
  setSharedUndoStack(t3) {
    this._sharedUndoStack = t3;
  }
  setSharedRedoStack(t3) {
    this._sharedRedoStack = t3;
  }
  async _initialize() {
    const { view: t3, mediaElement: e4 } = this;
    if (null == e4.georeference) return;
    const o2 = e4.georeference;
    "control-points" === o2.type && null != o2.coords && (this._georeference = o2, this._initialControlPoints = this._georeference.controlPoints, t3.map.addMany([this._graphicsLayer]), t3.focus(), this.visible = false, this.finishToolCreation(), await this._loadProjectionEngine(), this._controlPointEditGeometryOperations = this._georeference.controlPoints.map(({ mapPoint: e5 }) => g2.fromGeometry(W(e5, t3.spatialReference), 2)), this._controlPointGraphics = this._controlPointEditGeometryOperations.map((t4, e5) => new _2({ symbol: new n3({ data: { type: "CIMSymbolReference", symbol: { type: "CIMPointSymbol", symbolLayers: [{ type: "CIMVectorMarker", enable: true, colorLocked: true, anchorPoint: { x: 0, y: -15.75 }, anchorPointUnits: "Absolute", dominantSizeAxis3D: "Y", size: 9, billboardMode3D: "FaceNearPlane", frame: { xmin: 0, ymin: 0, xmax: 84.3, ymax: 84.3 }, markerGraphics: [{ type: "CIMMarkerGraphic", geometry: { rings: [[[83.2, 32.5], [84.3, 40.7], [83.8, 48.9], [81.7, 56.9], [78.1, 64.3], [73, 70.9], [66.9, 76.4], [59.7, 80.5], [51.9, 83.2], [43.7, 84.3], [35.4, 83.8], [27.4, 81.7], [20, 78], [13.4, 73], [7.9, 66.8], [3.8, 59.7], [1.1, 51.9], [0, 43.7], [0.5, 35.4], [2.6, 27.4], [6.3, 20], [11.3, 13.4], [17.5, 7.9], [24.7, 3.8], [32.5, 1.1], [39.8, 0.1], [47.1, 0.3], [54.3, 1.8], [61.1, 4.5], [67.4, 8.4], [72.9, 13.3], [77.4, 19.1], [80.9, 25.5], [83.2, 32.5]]] }, symbol: { type: "CIMPolygonSymbol", symbolLayers: [{ type: "CIMSolidFill", enable: true, color: [255, 255, 255, 255] }] } }], scaleSymbolsProportionally: true, respectFrame: true, clippingPath: { type: "CIMClippingPath", clippingType: "Intersect", path: { rings: [[[0, 0], [84.3, 0], [84.3, 84.3], [0, 84.3], [0, 0]]] } }, rotation: 0 }, { type: "CIMVectorMarker", enable: true, anchorPoint: { x: 0, y: -11.25 }, anchorPointUnits: "Absolute", dominantSizeAxis3D: "Y", size: 22.5, billboardMode3D: "FaceNearPlane", frame: { xmin: 0, ymin: 0, xmax: 197.7, ymax: 294.7 }, markerGraphics: [{ type: "CIMMarkerGraphic", geometry: { rings: [[[98.9, 0], [119.4, 23.2], [139.4, 49.3], [156.8, 75.2], [171.2, 100.8], [182.4, 125.3], [190.6, 148.8], [195.7, 171.4], [197.7, 192.9], [197.7, 195.8], [197.7, 200.3], [197.6, 202.5], [197.5, 204.8], [197.3, 207.1], [197, 209.4], [196.7, 211.7], [196.4, 214.1], [196, 216.4], [195.5, 218.7], [195, 221.1], [194.4, 223.4], [193.7, 225.8], [193, 228.1], [192.2, 230.5], [191.4, 232.8], [190.5, 235.1], [189.5, 237.5], [188.5, 239.7], [187.4, 242], [186.2, 244.3], [185, 246.5], [183.7, 248.7], [182.4, 250.9], [181, 253.1], [179.5, 255.2], [178, 257.3], [176.4, 259.4], [174.7, 261.4], [173.1, 263.3], [171.3, 265.3], [169.5, 267.2], [167.7, 269], [165.8, 270.8], [163.9, 272.5], [161.9, 274.2], [159.9, 275.8], [157.8, 277.4], [155.7, 278.9], [153.6, 280.4], [151.4, 281.7], [149.2, 283.1], [147, 284.4], [144.8, 285.6], [142.5, 286.7], [140.3, 287.8], [138, 288.8], [135.7, 289.8], [133.4, 290.7], [131, 291.5], [128.7, 292.3], [126.4, 293], [124, 293.6], [121.7, 294.2], [119.4, 294.7], [117, 295.2], [114.7, 295.6], [112.4, 296], [110.1, 296.3], [107.8, 296.5], [105.5, 296.7], [103.3, 296.8], [101.1, 296.9], [98.8, 296.9], [83.1, 295.7], [67.8, 292], [53.3, 285.9], [39.9, 277.5], [28.1, 267.2], [18, 255.1], [10, 241.5], [4.2, 226.9], [0.9, 211.5], [0, 195.8], [0.1, 192.9], [2.1, 171.4], [7.2, 148.8], [15.4, 125.3], [26.6, 100.8], [41, 75.2], [58.4, 49.3], [78.4, 23.2], [98.9, 0]]] }, symbol: { type: "CIMPolygonSymbol", symbolLayers: [{ type: "CIMSolidFill", enable: true, color: e5 === this.activeHandle ? v2.toArray() : this.view.effectiveTheme.accentColor.toArray() }] } }], scaleSymbolsProportionally: true, respectFrame: true, clippingPath: { type: "CIMClippingPath", clippingType: "Intersect", path: { rings: [[[0, 0], [197.7, 0], [197.7, 294.7], [0, 294.7], [0, 0]]] } }, rotation: 0 }], haloSize: 1, scaleX: 1, angleAlignment: "Display", angle: 0 } } }), geometry: t4.data.geometry })), this._graphicsLayer.graphics.addMany([...this._controlPointGraphics]), this._controlPointManipulations = this._controlPointGraphics.map((e5) => new e3({ tool: this, view: t3, graphic: e5 })), this.addHandles([...this._controlPointManipulations.map((t4, e5) => t4.createDragPipeline(this._getInfo.bind(this, e5), (t5, i2) => {
      "start" === t5.action && (this._undoStack.push(e5), this._redoStack = [], this._sharedUndoStack.push({ tool: this, operation: i2 }), this._sharedRedoStack.length = 0), this.updateGraphics();
    })), l(() => this.view.scale, () => this.active ? this.updateGraphics() : null)]), this._controlPointManipulations.forEach((t4, e5) => {
      const i2 = (t5) => {
        this.addHandles([t5.events.on(["click", "grab-changed"], (t6) => this.updateActiveHandle(e5))]);
      };
      t4.forEachManipulator(i2);
    }), this.addHandles([t3.on("key-down", (i2) => {
      t3.activeTool === this && (i2.key !== f2.shift || i2.repeat || (this._isModifierActive = true, i2.stopPropagation()), i2.key !== f2.toggleOpacity || i2.repeat || (e4.opacity *= this._isOpacityToggled ? 2 : 0.5, this._isOpacityToggled = !this._isOpacityToggled, i2.stopPropagation()), i2.key !== f2.primaryKey || i2.repeat || (this._factor = P3, i2.stopPropagation()), this._isModifierActive && (i2.key === f2.up && (this._move(0, this._factor), i2.stopPropagation()), i2.key === f2.down && (this._move(0, -this._factor), i2.stopPropagation()), i2.key === f2.left && (this._move(-this._factor, 0), i2.stopPropagation()), i2.key === f2.right && (this._move(this._factor, 0), i2.stopPropagation())));
    }), t3.on("key-up", (e5) => {
      t3.activeTool === this && (e5.key === f2.shift && (this._isModifierActive = false, e5.stopPropagation()), e5.key === f2.primaryKey && (this._factor = u5, e5.stopPropagation()));
    })]));
  }
  async _loadProjectionEngine() {
    const t3 = this._georeference.controlPoints[0].mapPoint;
    return N(t3.spatialReference, this.view.spatialReference);
  }
  _getInfo(t3) {
    return { editGeometryOperations: this._controlPointEditGeometryOperations[t3], constraints: this._hasValidSpatialReference ? null : { xmin: 0, ymin: 0, xmax: this._georeference.width, ymax: this._georeference.height } };
  }
  _move(t3, e4) {
    const i2 = this._controlPointEditGeometryOperations[this.activeHandle].move(t3 * this.view.resolution, e4 * this.view.resolution, 0, 0);
    this._sharedUndoStack.push({ tool: this, operation: i2 }), this._sharedRedoStack.length = 0, this.updateGraphics();
  }
};
__decorate([m()], S3.prototype, "_hasValidSpatialReference", null), __decorate([m()], S3.prototype, "activeHandle", void 0), __decorate([m({ constructOnly: true, nonNullable: true })], S3.prototype, "mediaElement", void 0), __decorate([m({ readOnly: true })], S3.prototype, "type", void 0), __decorate([m({ constructOnly: true })], S3.prototype, "view", void 0), S3 = __decorate([a("esri.views.2d.interactive.editingTools.ControlPointsTransformTool")], S3);

// node_modules/@arcgis/core/views/2d/interactive/editingTools/manipulations/utils.js
function n6(t3, e4) {
  "start" === t3.action ? e4.cursor = "grabbing" : e4.cursor = "grab";
}
var s5 = class {
  constructor() {
    this._lastDragEvent = null, this.next = new D(), this._enabled = false;
  }
  get enabled() {
    return this._enabled;
  }
  set enabled(t3) {
    if (this._enabled !== t3 && null != this._lastDragEvent) {
      const e4 = { ...this._lastDragEvent, action: "update" };
      t3 && this._adjustScaleFactors(e4), this.next.execute(e4);
    }
    this._enabled = t3;
  }
  createDragEventPipelineStep() {
    return this._lastDragEvent = null, (t3) => (this._lastDragEvent = "end" !== t3.action ? { ...t3 } : null, this._enabled && this._adjustScaleFactors(t3), t3);
  }
  _adjustScaleFactors(t3) {
    const e4 = 0 !== t3.direction[0] && 0 !== t3.direction[1] ? Math.max(Math.abs(t3.factor1), Math.abs(t3.factor2)) : 0 === t3.direction[0] ? Math.abs(t3.factor2) : Math.abs(t3.factor1);
    t3.factor1 = t3.factor1 < 0 ? -e4 : e4, t3.factor2 = t3.factor2 < 0 ? -e4 : e4;
  }
};
var r6 = class {
  constructor() {
    this._lastDragEvent = null, this.next = new D(), this._enabled = false;
  }
  get enabled() {
    return this._enabled;
  }
  set enabled(t3) {
    if (this._enabled !== t3 && null != this._lastDragEvent) {
      const e4 = { ...this._lastDragEvent, action: "update" };
      t3 && this._adjustRotateAngle(e4), this.next.execute(e4);
    }
    this._enabled = t3;
  }
  createDragEventPipelineStep() {
    return this._lastDragEvent = null, (t3) => (this._lastDragEvent = "end" !== t3.action ? { ...t3 } : null, this._enabled && this._adjustRotateAngle(t3), t3);
  }
  _adjustRotateAngle(a2) {
    const n8 = M(a2.rotateAngle);
    a2.rotateAngle = s(5 * Math.round(n8 / 5));
  }
};

// node_modules/@arcgis/core/views/2d/interactive/editingTools/manipulations/RotateManipulation.js
var p3 = class extends r5 {
  constructor(i2) {
    super(), this._handles = new r(), this._originCache = n(), this._view = i2.view, this._tool = i2.tool, this._graphic = i2.graphic, this._snapRotation = i2.snapRotation, this._manipulator = this._createManipulator(), this._handles.add([this._manipulator.events.on("grab-changed", (t3) => n6(t3, this._manipulator))]), this.forEachManipulator((t3) => this._tool.manipulators.add(t3));
  }
  destroy() {
    this._handles.destroy(), this.forEachManipulator((t3) => {
      this._tool.manipulators.remove(t3), t3.destroy();
    }), this._tool = null, this._view = null, this._manipulator = null, this._snapRotation = null, this._graphic = null, this._handles = null, this._originCache = null;
  }
  forEachManipulator(t3) {
    t3(this._manipulator, 2);
  }
  createDragPipeline(t3, r7) {
    let a2 = null, o2 = null;
    return p2(this._manipulator, (n8, l3) => {
      l3.next((i2) => {
        if ("start" === i2.action) {
          n8.cursor = "grabbing";
          const i3 = t3();
          a2 = i3.plane, o2 = i3.editGeometryOperations;
        }
        return i2;
      }).next(E(this._view)).next((t4) => ({ ...t4, rotateAngle: b2(t4.mapStart, t4.mapEnd, { x: a2.origin[0], y: a2.origin[1] }, true) })).next(this._snapRotation.createDragEventPipelineStep(), this._snapRotation.next).next((t4) => {
        const e4 = s2(this._originCache, a2.origin), n9 = "start" === t4.action ? 0 : 1, s6 = o2.rotate(e4, t4.rotateAngle, n9, 1);
        return V(s6, a2), r7(t4, s6), t4;
      }).next((t4) => ("end" === t4.action && (n8.cursor = "grab"), t4));
    });
  }
  _createManipulator() {
    const t3 = this._view, i2 = this._graphic;
    return new S({ view: t3, graphic: i2, selectable: true, cursor: "grab" });
  }
};

// node_modules/@arcgis/core/views/2d/interactive/editingTools/manipulations/ScaleManipulation.js
var b3 = 10;
var x = 1e-6;
var C = 0.3;
function y2(t3) {
  const i2 = r2(t3.basis1), e4 = r2(t3.basis2);
  return C * Math.min(i2, e4);
}
var j = class extends r5 {
  constructor(i2) {
    super(), this._handles = new r(), this._planeStart = z(), this._displayPlaneStart = z(), this._originCache = n(), this._axisCache = n2(), this._renderStartCache = n(), this._renderEndCache = n(), this._resizeOriginCache = n(), this._view = i2.view, this._tool = i2.tool, this._graphic = i2.graphic, this._direction = i2.direction, this._preserveAspectRatio = i2.preserveAspectRatio, this._manipulator = this._createManipulator(), this._handles.add([this._manipulator.events.on("grab-changed", (t3) => n6(t3, this._manipulator))]), this.forEachManipulator((t3) => this._tool.manipulators.add(t3));
  }
  destroy() {
    this._handles.destroy(), this.forEachManipulator((t3) => {
      this._tool.manipulators.remove(t3), t3.destroy();
    }), this._tool = null, this._view = null, this._graphic = null, this._manipulator = null, this._direction = null, this._handles = null, this._planeStart = null, this._displayPlaneStart = null, this._originCache = null, this._axisCache = null, this._renderStartCache = null, this._renderEndCache = null, this._resizeOriginCache = null, this._preserveAspectRatio = null;
  }
  forEachManipulator(t3) {
    t3(this._manipulator, 1);
  }
  createDragPipeline(t3, r7) {
    let h4 = null, c2 = null, _3 = null, d2 = 0, g3 = null, C2 = null;
    const j2 = this._planeStart, w2 = this._displayPlaneStart, S4 = this._direction;
    return p2(this._manipulator, (m4, E3) => {
      E3.next((i2) => {
        if ("start" === i2.action) {
          m4.cursor = "grabbing";
          const i3 = t3();
          h4 = i3.plane, c2 = i3.displayPlane, _3 = i3.editGeometryOperations, d2 = b3 * this._view.resolution, G2(h4, j2), G2(c2, w2);
          const e4 = G(_3.data.spatialReference);
          g3 = e4 ? e4.valid[1] - e4.valid[0] - 3 * b3 * this._view.resolution : null;
        }
        return i2;
      }).next(E(this._view)).next((t4) => {
        const i2 = s2(this._renderStartCache, [t4.mapStart.x, t4.mapStart.y, 0]), e4 = s2(this._renderEndCache, [t4.mapEnd.x, t4.mapEnd.y, 0]), r8 = s2(this._resizeOriginCache, w2.origin);
        q(r8, r8, w2.basis1, -S4[0]), q(r8, r8, w2.basis2, -S4[1]), c(e4, e4, r8), c(i2, i2, r8);
        const h5 = 0 !== S4[0] && 0 !== S4[1], p4 = y2(w2), u6 = y2(c2) / p4, _4 = (t5, r9) => {
          if (0 === t5) return 1;
          let a2 = r2(r9), s6 = 0.5 * t5 * P2(r9, e4) / a2;
          const n8 = s6 < 0 ? -1 : 1;
          if (h5) {
            s6 += (a2 - 0.5 * t5 * P2(r9, i2) / a2) * n8 * u6;
          }
          const c3 = a2 < 1.5 * d2 ? 1 : x;
          return a2 = Math.max(a2 - d2, x), n8 > 0 && (s6 -= b3 * this._view.resolution), n8 * Math.max(n8 * (s6 / a2), c3);
        }, m5 = _4(S4[0], w2.basis1), f3 = _4(S4[1], w2.basis2);
        return { ...t4, direction: S4, factor1: m5, factor2: f3 };
      }).next(this._preserveAspectRatio.createDragEventPipelineStep(), this._preserveAspectRatio.next).next((t4) => {
        const n8 = s2(this._originCache, j2.origin);
        q(n8, n8, j2.basis1, -S4[0]), q(n8, n8, j2.basis2, -S4[1]);
        const o2 = o(this._axisCache, j2.basis1[0], j2.basis1[1]);
        v(o2, o2);
        const l3 = _3.data.allVerticesUnordered, c3 = "start" === t4.action ? 0 : 1, u6 = _3.scaleVertices(l3, n8, o2, t4.factor1, t4.factor2, c3, 1);
        return g3 && g3 < _3.data.geometry.extent.width && C2 ? _3.updateVertices(l3, C2) : (G2(j2, h4), V(u6, h4), C2 = u6.operation, r7(t4, u6)), t4;
      }).next((t4) => ("end" === t4.action && (m4.cursor = "grab"), t4));
    });
  }
  _createManipulator() {
    return new S({ view: this._view, graphic: this._graphic, selectable: true, cursor: "grab" });
  }
};

// node_modules/@arcgis/core/views/2d/interactive/editingTools/TransformTool.js
var V2 = 80;
var q2 = 10;
var F = 30;
var N2 = [[1, 1], [1, -1], [-1, -1], [-1, 1], [1, 0], [0, -1], [-1, 0], [0, 1]];
var J = 1;
var K = 10;
var Q = class extends r3 {
  constructor(e4) {
    super(e4), this._initialControlPoints = null, this._initialGeometry = null, this._graphic = null, this._planeCache = z(), this._displayPlaneCache = z(), this._mainAxisCache = n2(), this._rotationHandleCache = n(), this._cornerA = n(), this._cornerB = n(), this._cornerC = n(), this._cornerD = n(), this._avgAB = n(), this._avgBC = n(), this._avgCD = n(), this._avgDA = n(), this._preserveAspectRatio = new s5(), this._snapRotation = new r6(), this._graphicsLayer = new n4({ internal: true, listMode: "hide", visible: false, title: "TransformTool layer" }), this._sharedUndoStack = [], this._sharedRedoStack = [], this._isOpacityToggled = false, this._factor = J, this.preserveAspectRatio = null, this.snapRotation = null, this.type = "transform";
  }
  initialize() {
    this._initialize();
  }
  destroy() {
    const { map: e4 } = this.view;
    this._dragManipulation.destroy(), this._rotateManipulation.destroy(), this._scaleManipulations.forEach((e5) => e5.destroy()), this._editGeometryOperations.destroy(), e4.removeMany([this._graphicsLayer]), this._graphicsLayer.removeAll(), this._graphicsLayer = u(this._graphicsLayer), this._initialControlPoints = null, this._initialGeometry = null, this._graphic = null, this._preserveAspectRatio = null, this._snapRotation = null, this._planeCache = null, this._displayPlaneCache = null, this._rotationHandleCache = null, this._mainAxisCache = null, this._cornerA = null, this._cornerB = null, this._cornerC = null, this._cornerD = null, this._avgAB = null, this._avgBC = null, this._avgCD = null, this._avgDA = null, this._sharedUndoStack = null, this._sharedRedoStack = null;
  }
  get _plane() {
    const e4 = this._graphic.geometry;
    if (null == e4) return null;
    const t3 = this._editGeometryOperations.data, i2 = t3.parts[0].segments[0], s6 = e2(this._mainAxisCache, i2.leftVertex.pos, i2.rightVertex.pos);
    v(s6, s6);
    let o2 = V2 * this.view.resolution;
    const a2 = this.view.spatialReference;
    return T(a2, e4.spatialReference) && (o2 *= ae(a2) / ae(e4.spatialReference)), S2(s6, t3, o2, this._planeCache);
  }
  get _displayPlane() {
    const e4 = this._plane;
    if (!e4) return null;
    const t3 = this._displayPlaneCache;
    G2(e4, t3);
    const i2 = q2 * this.view.resolution;
    return g(t3.basis1, t3.basis1, 1 + i2 / r2(t3.basis1)), g(t3.basis2, t3.basis2, 1 + i2 / r2(t3.basis2)), t3;
  }
  get _backgroundGraphicGeometry() {
    const e4 = this._displayPlane;
    if (!e4) return null;
    const t3 = this.view.spatialReference;
    return this._updateDisplayPlaneConrers(e4), new P({ spatialReference: t3, rings: [[this._cornerA, this._cornerB, this._cornerC, this._cornerD, this._cornerA]] });
  }
  get _rotateGraphicGeometry() {
    const e4 = this._plane;
    if (!e4) return null;
    const t3 = this._rotationHandleCache;
    return A(t3, e4.basis1), g(t3, t3, F * this.view.resolution), u2(t3, t3, e4.origin), u2(t3, t3, e4.basis1), new _({ x: t3[0], y: t3[1], spatialReference: this.view.spatialReference });
  }
  get _scaleGraphicGeometries() {
    const e4 = this._displayPlane;
    if (!e4) return [];
    const t3 = this.view.spatialReference;
    this._updateDisplayPlaneConrers(e4);
    const { _cornerA: i2, _cornerB: s6, _cornerC: o2, _cornerD: r7 } = this, a2 = I(this._avgAB, i2, s6, 0.5), n8 = I(this._avgBC, s6, o2, 0.5), h4 = I(this._avgCD, o2, r7, 0.5), c2 = I(this._avgDA, r7, i2, 0.5);
    return [new _({ x: i2[0], y: i2[1], spatialReference: t3 }), new _({ x: s6[0], y: s6[1], spatialReference: t3 }), new _({ x: o2[0], y: o2[1], spatialReference: t3 }), new _({ x: r7[0], y: r7[1], spatialReference: t3 }), new _({ x: a2[0], y: a2[1], spatialReference: t3 }), new _({ x: n8[0], y: n8[1], spatialReference: t3 }), new _({ x: h4[0], y: h4[1], spatialReference: t3 }), new _({ x: c2[0], y: c2[1], spatialReference: t3 })];
  }
  onActivate() {
    this.visible = true;
  }
  onDeactivate() {
    this.visible = false;
  }
  onShow() {
    this._graphicsLayer.visible = true;
  }
  onHide() {
    this._graphicsLayer.visible = false;
  }
  canUndo() {
    return this._editGeometryOperations.canUndo;
  }
  canRedo() {
    return this._editGeometryOperations.canRedo;
  }
  undo() {
    this._editGeometryOperations.undo(), this.updateGraphics();
  }
  redo() {
    this._editGeometryOperations.redo(), this.updateGraphics();
  }
  refresh() {
    const { view: e4, target: t3 } = this, i2 = "georeference" in t3 ? t3.georeference.coords : t3.geometry, s6 = this._editGeometryOperations, o2 = s6.data.parts[0].vertices, r7 = w.fromGeometry(W(i2, e4.spatialReference), 2).parts[0].vertices;
    o2.forEach((e5, t4) => {
      s6.setVertexPosition(e5, r7[t4].pos);
    }), this.updateGraphics();
  }
  reset() {
    const { target: e4 } = this;
    if ("georeference" in e4) {
      const t3 = e4.georeference;
      "control-points" === t3.type && (t3.controlPoints = this._initialControlPoints);
    } else e4.geometry = this._initialGeometry;
    this.refresh(), this._sharedUndoStack.length = 0, this._sharedRedoStack.length = 0;
  }
  updateGraphics() {
    const e4 = this._editGeometryOperations.data.geometry;
    if ("georeference" in this.target) {
      this.target.georeference.coords = e4;
    }
    this._graphic.geometry = e4, this._backgroundGraphic.geometry = this._backgroundGraphicGeometry, this._rotateGraphic.geometry = this._rotateGraphicGeometry, this._scaleGraphicGeometries.forEach((e5, t3) => {
      this._scaleGraphics[t3].geometry = e5;
    });
  }
  setSharedUndoStack(e4) {
    this._sharedUndoStack = e4;
  }
  setSharedRedoStack(e4) {
    this._sharedRedoStack = e4;
  }
  async _initialize() {
    const { view: e4, target: s6 } = this;
    if ("georeference" in s6) {
      const e5 = s6.georeference;
      this._graphic = new _2({ geometry: e5.coords }), this._initialControlPoints = "control-points" === e5.type ? e5.controlPoints : null;
    } else this._graphic = s6, this._initialGeometry = s6.geometry;
    e4.map.addMany([this._graphicsLayer]), e4.focus(), this.visible = false, this.finishToolCreation(), await this._loadProjectionEngine(), this._editGeometryOperations = g2.fromGeometry(W(this._graphic.geometry, e4.spatialReference), 2), this._backgroundGraphic = new _2({ symbol: new m3({ color: "transparent", outline: { type: "simple-line", color: e4.effectiveTheme.accentColor, width: 2 } }), geometry: this._backgroundGraphicGeometry }), this._rotateGraphic = new _2({ symbol: new u4({ color: I2(e4.effectiveTheme.accentColor), outline: { type: "simple-line", color: e4.effectiveTheme.accentColor, width: 1 } }), geometry: this._rotateGraphicGeometry }), this._scaleGraphics = this._scaleGraphicGeometries.map((s7) => new _2({ symbol: new u4({ size: 6, style: "square", color: I2(e4.effectiveTheme.accentColor), outline: { type: "simple-line", color: e4.effectiveTheme.accentColor, width: 1 } }), geometry: s7 })), this._graphicsLayer.graphics.addMany([this._backgroundGraphic, this._rotateGraphic, ...this._scaleGraphics]), this._dragManipulation = new e3({ tool: this, view: e4, graphic: this._graphic }), this._rotateManipulation = new p3({ tool: this, view: e4, graphic: this._rotateGraphic, snapRotation: this._snapRotation }), this._scaleManipulations = this._scaleGraphics.map((t3, i2) => new j({ tool: this, view: e4, graphic: t3, direction: N2[i2], preserveAspectRatio: this._preserveAspectRatio })), this.addHandles([this._dragManipulation.createDragPipeline(this._getInfo.bind(this), this._updateGraphics.bind(this)), this._rotateManipulation.createDragPipeline(this._getInfo.bind(this), this._updateGraphics.bind(this)), ...this._scaleManipulations.map((e5) => e5.createDragPipeline(this._getInfo.bind(this), this._updateGraphics.bind(this))), l(() => this.view.scale, () => this.active ? this.updateGraphics() : null), e4.on("click", async (t3) => {
      if (null != e4.activeTool && e4.activeTool !== this) return;
      const i2 = n5(t3), o2 = [];
      e4.map.allLayers.forEach((e5) => {
        "vector-tile" !== e5.type && "imagery" !== e5.type || o2.push(e5);
      });
      const r8 = await this.view.hitTest(i2, { exclude: o2 }), a3 = r8.results;
      if (0 === a3.length) e4.activeTool = null;
      else {
        const t4 = r4(r8.results), i3 = "georeference" in s6, o3 = a3.map((e5) => "media" === e5.type ? e5.element : null).filter(Boolean), n8 = new Set([...this._graphicsLayer.graphics, i3 ? null : s6].filter(Boolean));
        i3 && o3.includes(s6) || null != t4 && n8.has(t4.graphic) ? null == e4.activeTool && (e4.activeTool = this) : e4.activeTool = null;
      }
    })]);
    const r7 = (e5) => {
      this.addHandles(e5.events.on("grab-changed", (e6) => {
        "georeference" in s6 && ("start" === e6.action ? s6.opacity *= 0.5 : "end" === e6.action && (s6.opacity *= 2));
      }));
    };
    this._dragManipulation.forEachManipulator(r7), this._rotateManipulation.forEachManipulator(r7), this._scaleManipulations.forEach((e5) => e5.forEachManipulator(r7));
    const a2 = new y();
    a2.addToggle(h2.preserveAspectRatio, () => {
      null == this.preserveAspectRatio && (this._preserveAspectRatio.enabled = !this._preserveAspectRatio.enabled);
    }), a2.addToggle(h2.rotateIncrements, () => {
      null == this.snapRotation && (this._snapRotation.enabled = !this._snapRotation.enabled);
    }), a2.add(h2.toggleOpacity, () => {
      "georeference" in s6 && (s6.opacity *= this._isOpacityToggled ? 2 : 0.5, this._isOpacityToggled = !this._isOpacityToggled);
    }), a2.addToggle(h2.factorModifier, (e5) => this._factor = "key-down" === e5.type ? K : J), a2.add(h2.scaleUp, () => this._scale(this._factor)), a2.add(h2.scaleDown, () => this._scale(-this._factor)), a2.add(h2.moveUp, () => this._move(0, this._factor)), a2.add(h2.moveDown, () => this._move(0, -this._factor)), a2.add(h2.moveLeft, () => this._move(-this._factor, 0)), a2.add(h2.moveRight, () => this._move(this._factor, 0)), this.addHandles([e4.on("key-down", (t3) => {
      e4.activeTool === this && a2.dispatch(e4.inputManager, t3);
    }), e4.on("key-up", (t3) => {
      e4.activeTool === this && a2.dispatch(e4.inputManager, t3);
    })]);
  }
  async _loadProjectionEngine() {
    const e4 = this._graphic.geometry;
    return N(e4.spatialReference, this.view.spatialReference);
  }
  _updateDisplayPlaneConrers(e4) {
    const { basis1: t3, basis2: i2, origin: s6 } = e4, o2 = this._cornerA;
    u2(o2, s6, t3), u2(o2, o2, i2);
    const r7 = this._cornerB;
    u2(r7, s6, t3), c(r7, r7, i2);
    const a2 = this._cornerC;
    c(a2, s6, t3), c(a2, a2, i2);
    const n8 = this._cornerD;
    c(n8, s6, t3), u2(n8, n8, i2);
  }
  _getInfo() {
    return { editGeometryOperations: this._editGeometryOperations, plane: this._plane, displayPlane: this._displayPlane };
  }
  _updateGraphics(e4, t3) {
    "start" === e4.action && (this._sharedUndoStack.push({ tool: this, operation: t3 }), this._sharedRedoStack.length = 0), this.updateGraphics();
  }
  _scale(e4) {
    const t3 = this._editGeometryOperations, i2 = t3.data.geometry.extent?.width, s6 = (i2 + e4 * this.view.resolution) / i2, o2 = t3.scale(this._plane.origin, s3, s6, s6, 0, 1);
    this._sharedUndoStack.push({ tool: this, operation: o2 }), this._sharedRedoStack.length = 0, this.updateGraphics();
  }
  _move(e4, t3) {
    const i2 = this._editGeometryOperations.move(e4 * this.view.resolution, t3 * this.view.resolution, 0, 0);
    this._sharedUndoStack.push({ tool: this, operation: i2 }), this._sharedRedoStack.length = 0, this.updateGraphics();
  }
};
__decorate([m()], Q.prototype, "_plane", null), __decorate([m()], Q.prototype, "_backgroundGraphicGeometry", null), __decorate([m()], Q.prototype, "_rotateGraphicGeometry", null), __decorate([m()], Q.prototype, "_scaleGraphicGeometries", null), __decorate([m()], Q.prototype, "preserveAspectRatio", void 0), __decorate([m()], Q.prototype, "snapRotation", void 0), __decorate([m({ constructOnly: true, nonNullable: true })], Q.prototype, "target", void 0), __decorate([m({ readOnly: true })], Q.prototype, "type", void 0), __decorate([m({ constructOnly: true })], Q.prototype, "view", void 0), Q = __decorate([a("esri.views.2d.interactive.editingTools.TransformTool")], Q);

// node_modules/@arcgis/core/views/2d/interactive/editingTools/MediaTransformToolsWrapper.js
var n7 = { redo: "r", undo: "z" };
var d = class extends b {
  constructor(o2) {
    super(o2), this._transformTool = null, this._controlPointsTransformTool = null, this._advancedModeTransformTool = null, this._activeTool = null, this._sharedUndoStack = [], this._sharedRedoStack = [], this._originalOpacity = null, this.activeHandle = 0;
  }
  initialize() {
    const { view: o2, mediaElement: t3, preserveAspectRatio: s6, snapRotation: i2, advancedMode: d2 } = this;
    this._originalOpacity = t3.opacity, this._transformTool = new Q({ target: t3, view: o2, preserveAspectRatio: s6, snapRotation: i2 }), this._controlPointsTransformTool = new S3({ mediaElement: t3, view: o2 }), this._advancedModeTransformTool = new S3({ mediaElement: d2.mediaElement, view: d2.view }), this._transformTool.setSharedUndoStack(this._sharedUndoStack), this._transformTool.setSharedRedoStack(this._sharedRedoStack), this._controlPointsTransformTool.setSharedUndoStack(this._sharedUndoStack), this._controlPointsTransformTool.setSharedRedoStack(this._sharedRedoStack), this._advancedModeTransformTool.setSharedUndoStack(this._sharedUndoStack), this._advancedModeTransformTool.setSharedRedoStack(this._sharedRedoStack);
    const l3 = t3.georeference, c2 = d2.mediaElement.georeference;
    d2.view.tools.addMany([this._advancedModeTransformTool]), "controlPoints" in c2 && "controlPoints" in l3 && this.addHandles([d2.view.on("key-down", (o3) => {
      o3.key === n7.undo && this.canUndo() && (this.undo(), o3.stopPropagation()), o3.key === n7.redo && this.canRedo() && (this.redo(), o3.stopPropagation());
    }), d2.view.on("focus", async (o3) => {
      this._controlPointsTransformTool.removeHighlightActiveHandle(), await this._advancedModeTransformTool.highlightActiveHandle();
    }), l(() => c2.controlPoints, (o3) => {
      l3.controlPoints = o3.map(({ sourcePoint: o4 }, t4) => ({ sourcePoint: o4, mapPoint: l3.controlPoints[t4].mapPoint })), this._activeTool?.refresh();
    }), l(() => this._controlPointsTransformTool.activeHandle, (o3) => {
      this._advancedModeTransformTool.updateActiveHandle(o3), this.activeHandle = o3;
    }), l(() => this._advancedModeTransformTool.activeHandle, (o3) => {
      this._controlPointsTransformTool.updateActiveHandle(o3), this.activeHandle = o3;
    })]), this.addHandles([o2.on("key-down", (o3) => {
      o3.key === n7.undo && this.canUndo() && (this.undo(), o3.stopPropagation()), o3.key === n7.redo && this.canRedo() && (this.redo(), o3.stopPropagation());
    }), o2.on("focus", async (o3) => {
      this._advancedModeTransformTool.removeHighlightActiveHandle(), await this._controlPointsTransformTool.highlightActiveHandle();
    })]), o2.tools.addMany([this._transformTool, this._controlPointsTransformTool]), o2.activeTool = this._transformTool, this._activeTool = this._transformTool, o2.focus();
  }
  destroy() {
    this._transformTool?.destroy(), this._controlPointsTransformTool?.destroy(), this._transformTool = null, this._controlPointsTransformTool = null, this._advancedModeTransformTool = null, this._activeTool = null, this._sharedUndoStack = null, this._sharedRedoStack = null;
  }
  canUndo() {
    return this._sharedUndoStack.length > 0;
  }
  canRedo() {
    return this._sharedRedoStack.length > 0;
  }
  undo() {
    if (this._sharedUndoStack.length > 0) {
      const { tool: o2, operation: t3 } = this._sharedUndoStack.pop();
      o2 !== this._activeTool && o2.refresh(), t3.undo(), o2.updateGraphics(), this._sharedRedoStack.push({ tool: o2, operation: t3 }), this._activeTool !== o2 && this._activeTool?.refresh();
    }
  }
  redo() {
    if (this._sharedRedoStack.length > 0) {
      const { tool: o2, operation: t3 } = this._sharedRedoStack.pop();
      o2 !== this._activeTool && o2.refresh(), t3.apply(), o2.updateGraphics(), this._sharedUndoStack.push({ tool: o2, operation: t3 }), this._activeTool !== o2 && this._activeTool?.refresh();
    }
  }
  refresh() {
    this._activeTool.refresh();
  }
  reset() {
    this._activeTool.reset(), this._advancedModeTransformTool.reset();
  }
  async enableAdvancedMode() {
    this.view.activeTool = this._controlPointsTransformTool, this._activeTool = this._controlPointsTransformTool, this._activeTool.refresh(), await this.advancedMode.view.when(), this.advancedMode.view.activeTool = this._advancedModeTransformTool, this._originalOpacity = this._controlPointsTransformTool.mediaElement.opacity, this._controlPointsTransformTool.mediaElement.opacity = 0.25 * this._originalOpacity;
  }
  disableAdvancedMode() {
    this.view.activeTool = this._transformTool, this._activeTool = this._transformTool, this._activeTool.refresh(), this.advancedMode.view.activeTool = null, this._controlPointsTransformTool.mediaElement.opacity = this._originalOpacity;
  }
};
__decorate([m()], d.prototype, "activeHandle", void 0), __decorate([m({ constructOnly: true })], d.prototype, "advancedMode", void 0), __decorate([m()], d.prototype, "preserveAspectRatio", void 0), __decorate([m()], d.prototype, "snapRotation", void 0), __decorate([m({ constructOnly: true, nonNullable: true })], d.prototype, "mediaElement", void 0), __decorate([m({ constructOnly: true })], d.prototype, "view", void 0), d = __decorate([a("esri.views.2d.interactive.editingTools.MediaTransformToolsWrapper")], d);
export {
  S3 as ControlPointsTransformTool,
  E2 as DrawGraphicTool2D,
  d as MediaTransformToolsWrapper,
  Q as TransformTool
};
//# sourceMappingURL=editingTools-7G272MXS.js.map
